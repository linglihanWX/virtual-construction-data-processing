(function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=537)})([function(e,t,r){var n=r(3);var i=r(37);var a=r(20);var o=r(19);var s=r(28);var u="prototype";var l=function(e,t,r){var c=e&l.F;var f=e&l.G;var d=e&l.S;var h=e&l.P;var v=e&l.B;var p=f?n:d?n[t]||(n[t]={}):(n[t]||{})[u];var _=f?i:i[t]||(i[t]={});var y=_[u]||(_[u]={});var m,g,F,w;if(f)r=t;for(m in r){g=!c&&p&&p[m]!==undefined;F=(g?p:r)[m];w=v&&g?s(F,n):h&&typeof F=="function"?s(Function.call,F):F;if(p)o(p,m,F,e&l.U);if(_[m]!=F)a(_,m,w);if(h&&y[m]!=F)y[m]=F}};n.core=i;l.F=1;l.G=2;l.S=4;l.P=8;l.B=16;l.W=32;l.U=64;l.R=128;e.exports=l},function(e,t,r){"use strict";t.__esModule=true;t.default=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}},function(e,t,r){var n=r(5);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var r=e.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=r},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return true}}},function(e,t){e.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},function(e,t,r){"use strict";t.__esModule=true;var n=r(173);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;(0,i.default)(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}()},function(e,t,r){var n=r(98)("wks");var i=r(58);var a=r(3).Symbol;var o=typeof a=="function";var s=e.exports=function(e){return n[e]||(n[e]=o&&a[e]||(o?a:i)("Symbol."+e))};s.store=n},function(e,t,r){var n=r(34);var i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(2);var i=r(209);var a=r(36);var o=Object.defineProperty;t.f=r(10)?Object.defineProperty:function e(t,r,s){n(t);r=a(r,true);n(s);if(i)try{return o(t,r,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");if("value"in s)t[r]=s.value;return t}},function(e,t,r){e.exports=!r(4)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdMisc=undefined;var n=r(1);var i=s(n);var a=r(330);var o=r(175);function s(e){return e&&e.__esModule?e:{default:e}}var u=function e(){(0,i.default)(this,e)};u.FdGeometric=a.FdGeometric;u.FdMath=o.FdMath;var l=r(123);if(typeof window.mobx==="undefined"){window.mobx=l}t.FdMisc=u},function(e,t,r){var n=r(35);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(111)("wks");var i=r(80);var a=r(16).Symbol;var o=typeof a=="function";var s=e.exports=function(e){return n[e]||(n[e]=o&&a[e]||(o?a:i)("Symbol."+e))};s.store=n},function(e,t){var r=e.exports={version:"2.5.5"};if(typeof __e=="number")__e=r},function(e,t){e.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(e,t){var r=e.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=r},function(e,t,r){var n=r(16);var i=r(14);var a=r(48);var o=r(44);var s=r(47);var u="prototype";var l=function(e,t,r){var c=e&l.F;var f=e&l.G;var d=e&l.S;var h=e&l.P;var v=e&l.B;var p=e&l.W;var _=f?i:i[t]||(i[t]={});var y=_[u];var m=f?n:d?n[t]:(n[t]||{})[u];var g,F,w;if(f)r=t;for(g in r){F=!c&&m&&m[g]!==undefined;if(F&&s(_,g))continue;w=F?m[g]:r[g];_[g]=f&&typeof m[g]!="function"?r[g]:v&&F?a(w,n):p&&m[g]==w?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};t[u]=e[u];return t}(w):h&&typeof w=="function"?a(Function.call,w):w;if(h){(_.virtual||(_.virtual={}))[g]=w;if(e&l.R&&y&&!y[g])o(y,g,w)}}};l.F=1;l.G=2;l.S=4;l.P=8;l.B=16;l.W=32;l.U=64;l.R=128;e.exports=l},function(e,t,r){var n=r(0);var i=r(4);var a=r(35);var o=/"/g;var s=function(e,t,r,n){var i=String(a(e));var s="<"+t;if(r!=="")s+=" "+r+'="'+String(n).replace(o,"&quot;")+'"';return s+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(s);n(n.P+n.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)}},function(e,t,r){var n=r(3);var i=r(20);var a=r(24);var o=r(58)("src");var s="toString";var u=Function[s];var l=(""+u).split(s);r(37).inspectSource=function(e){return u.call(e)};(e.exports=function(e,t,r,s){var u=typeof r=="function";if(u)a(r,"name")||i(r,"name",t);if(e[t]===r)return;if(u)a(r,o)||i(r,o,e[t]?""+e[t]:l.join(String(t)));if(e===n){e[t]=r}else if(!s){delete e[t];i(e,t,r)}else if(e[t]){e[t]=r}else{i(e,t,r)}})(Function.prototype,s,function e(){return typeof this=="function"&&this[o]||u.call(this)})},function(e,t,r){var n=r(9);var i=r(59);e.exports=r(10)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){e[t]=r;return e}},function(e,t,r){var n=r(24);var i=r(12);var a=r(149)("IE_PROTO");var o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){e=i(e);if(n(e,a))return e[a];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?o:null}},function(e,t,r){var n=r(75);var i=r(59);var a=r(23);var o=r(36);var s=r(24);var u=r(209);var l=Object.getOwnPropertyDescriptor;t.f=r(10)?l:function e(t,r){t=a(t);r=o(r,true);if(u)try{return l(t,r)}catch(e){}if(s(t,r))return i(!n.f.call(t,r),t[r])}},function(e,t,r){var n=r(76);var i=r(35);e.exports=function(e){return n(i(e))}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPolylineEditor=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(11);var u=r(172);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._polylines={};this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._curGuid=undefined;this._startPoint=undefined;this._hasTempLine=false;this._tempLine=undefined;this._tempPoint={};this._startCapture=false;this._bKeydown=false;this._lineWidth=2;this._autoClose=true;this._autoDelLines=false;this._singleLineMode=false;this._heightOffset=0;this._hanlder=undefined;this._editPTs=[];this._editIndex=0;this._editPl=undefined;this._editPt=undefined;this._editTran=new u.FdTransformHelper(t);this._editTran.setAxisSize(5);this._editLsnr=undefined}(0,o.default)(e,[{key:"pleOptions",get:function e(){var t=[];for(var r in this._polylines){t.push({pts:this._polylines[r].pts})}return t},set:function e(t){this.removeAll();for(var r in t){var n=t[r].pts;this.setStartPt(n[0]);for(var i=0;i<n.length-1;i++){this.addResult(n[i+1])}}this._startPoint=undefined;this._curGuid=undefined}}]);return e}();c.prototype.run=function(){this.registerHandlers();this._startCapture=true;this._event.raiseEvent("Start",{})};c.prototype.start=function(){console.log("start");this.run()};c.prototype.callbackPt=function(e,t){t=this._editPts[this._editIndex];return t};c.prototype.startEditPt=function(){if(!this._editPt){var e=new Freedo.CallbackProperty(this.callbackPt.bind(this),false);this._editPt=this._viewer.entities.add({position:e,point:{pixelSize:10,color:Freedo.Color.YELLOW.withAlpha(.9)}})}this._editPt.boundingSphere=new Freedo.BoundingSphere(this._editPts[this._editIndex],10);this._editPt.modelMatrix=Freedo.clone(Freedo.Matrix4.IDENTITY,true);this._viewer.camera.viewBoundingSphere(this._editPt.boundingSphere,new Freedo.HeadingPitchRange(10,-.5,0));this._viewer.camera.lookAtTransform(Freedo.Matrix4.IDENTITY);this._editTran.setData([this._editPt]);this._editTran.start("MOVE")};c.prototype.startEdit=function(e){this._editPts=Freedo.clone(e,true);this._editPl=this._viewer.scene.primitives.add(this.createLinePrimitive(e));this._editIndex=0;this.startEditPt();if(this._editLsnr)this._editLsnr();var t=this;this._editLsnr=this._editTran.on(function(e,r){if(e=="Transforming"){var n=t._editPts[t._editIndex];var i=Freedo.Cartographic.fromDegrees(r.TMoveX,r.TMoveY,r.TMoveZ);t._editPts[t._editIndex]=Freedo.Cartographic.toCartesian(i)}if(e=="Transformed"){t._editPt.boundingSphere=new Freedo.BoundingSphere(t._editPts[t._editIndex],10);if(t._editPl)t._viewer.scene.primitives.remove(t._editPl);t._editPl=t._viewer.scene.primitives.add(t.createLinePrimitive(t._editPts));var i=Freedo.Cartographic.fromDegrees(r.TMoveX,r.TMoveY,r.TMoveZ);t._event.raiseEvent("Transformed",{positionG:i})}})};c.prototype.editPre=function(){this._editIndex-=1;if(this._editIndex<0)this._editIndex=0;this.startEditPt()};c.prototype.editNext=function(){this._editIndex+=1;if(this._editIndex>this._editPts.length-1)this._editIndex=this._editPts.length-1;this.startEditPt()};c.prototype.endEdit=function(){this._editTran.cancel();this._viewer.entities.remove(this._editPt);this._viewer.scene.primitives.remove(this._editPl);this._event.raiseEvent("EditEnd",{pts:this._editPts})};c.prototype.setAutoLoop=function(e){this._autoClose=e};c.prototype.setAutoDelLines=function(e){this._autoDelLines=e};c.prototype.setHeightOffset=function(e){this._heightOffset=e};c.prototype.onKeyDown=function(){if(!this._startCapture)return;this.bKeydown=true;if(window.event.keyCode==27){this.onMouseRightClick(undefined)}};c.prototype.onKeyUp=function(){if(!this._startCapture)return;this.bKeydown=false};c.prototype.setStartPt=function(e){this._startPoint=e;this._curGuid=Freedo.createGuid();this._polylines[this._curGuid]={};this._polylines[this._curGuid].lines=[];this._polylines[this._curGuid].pts=[];this._polylines[this._curGuid].ptsG=[];this._polylines[this._curGuid].pts[0]=e};c.prototype.callbackX=function(){this._viewer.scene.requestRender();return[this._startPoint,this._tempPoint]};c.prototype.updateTmpLine=function(e){var t=s.FdMisc.FdGeometric.pickPositionG(this._viewer,e);if(Freedo.defined(t)){var r;if(this._viewer.scene.globe)r=s.FdMisc.FdGeometric.tc(t);else r=new Freedo.Cartesian3(t[0],t[1],t[2]);this._tempPoint=r;if(!this._hasTempLine){this._hasTempLine=true;var n=new Freedo.CallbackProperty(this.callbackX.bind(this),false);this._tempLine=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:n,followSurface:this._viewer.scene.globe?true:false,width:this._lineWidth,show:true,material:Freedo.Color.YELLOW,depthFailMaterial:Freedo.Color.RED}})}}};c.prototype.removeTmpLine=function(){if(this._tempLine){this._viewer.entities.remove(this._tempLine);this._tempLine=undefined;this._hasTempLine=false}};c.prototype.createLinePrimitive=function(e){var t,r;if(this._viewer.scene.globe){r=true}else{r=false}t=new Freedo.PolylineGeometry({positions:e,width:2,followSurface:r,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT});return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:t}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(0,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-1,units:-1},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(0,0,1,1)}}})})})};c.prototype.addResult=function(e){console.log("addResult");var t=[this._startPoint,e];var r=this._viewer.scene.primitives.add(this.createLinePrimitive([t[0],t[1]]));if(Freedo.defined(this._polylines[this._curGuid])){this._polylines[this._curGuid].lines.push(r);this._polylines[this._curGuid].pts.push(e);if(this._viewer.scene.globe){var n=s.FdMisc.FdGeometric.tg(e);this._polylines[this._curGuid].ptsG.push(n)}else{this._polylines[this._curGuid].ptsG.push(e)}}this._startPoint=FreeDo.clone(e,true);this._endPoint=undefined;this._viewer.scene.requestRender()};c.prototype.pickStartPoint=function(e){var t=s.FdMisc.FdGeometric.pickPositionG(this._viewer,e);if(Freedo.defined(t)){t[2]+=this._heightOffset;if(this._viewer.scene.globe){this._startPoint=s.FdMisc.FdGeometric.tc(t);this._polylines[this._curGuid].pts.push(s.FdMisc.FdGeometric.tc(t))}else{this._startPoint=new Freedo.Cartesian3(t[0],t[1],t[2]);this._polylines[this._curGuid].pts.push(this._startPoint)}this._polylines[this._curGuid].ptsG.push(t);this._event.raiseEvent("PointAdded",{position:t})}};c.prototype.pickEndPoint=function(e){console.log("pickEndPoint");var t=s.FdMisc.FdGeometric.pickPositionG(this._viewer,e);if(Freedo.defined(t)){t[2]+=this._heightOffset;if(this._viewer.scene.globe)this.addResult(s.FdMisc.FdGeometric.tc(t));else this.addResult(new Freedo.Cartesian3(t[0],t[1],t[2]));this._event.raiseEvent("PointAdded",{position:t})}};c.prototype.onMouseLeftClick=function(e){console.log("onMouseLeftClick");if(!this._startCapture)return;if(!Freedo.defined(this._curGuid)){this._curGuid=Freedo.createGuid();this._polylines[this._curGuid]={};this._polylines[this._curGuid].lines=[];this._polylines[this._curGuid].pts=[];this._polylines[this._curGuid].ptsG=[]}if(!Freedo.defined(this._polylines[this._curGuid]))return;if(this._startPoint){this.pickEndPoint(e.position)}else{this.pickStartPoint(e.position)}};c.prototype.delResult=function(e){if(!e)e=this._curGuid;var t=this._polylines[e].lines;if(t){for(var r in t){var n=t[r];this._viewer.scene.primitives.remove(n)}}delete this._polylines[e];this._viewer.scene.requestRender()};c.prototype.polylineAdded=function(){var e={id:this._curGuid,polyline:this._polylines[this._curGuid]};this._event.raiseEvent("PLAdd",e);this._event.raiseEvent("DataChanged",e);if(this._autoDelLines){var t=this._polylines[this._curGuid].lines;for(var r in t){var n=t[r];this._viewer.scene.primitives.remove(n)}delete this._polylines[this._curGuid].lines}this._viewer.scene.requestRender()};c.prototype.onMouseRightClick=function(e){if(!this._startCapture)return;if(!!this._startPoint){var t=this._polylines[this._curGuid].pts[0];var r=this._polylines[this._curGuid].pts[this._polylines[this._curGuid].pts.length-1];if(this._autoClose){var n=this._viewer.scene.primitives.add(this.createLinePrimitive([r,t]));this._polylines[this._curGuid].lines.push(n);this._polylines[this._curGuid].pts.push(t);var i=s.FdMisc.FdGeometric.tg(t);this._polylines[this._curGuid].ptsG.push(i);if(this._polylines[this._curGuid].pts.length<=3){this.delResult(this._curGuid)}}else{if(this._polylines[this._curGuid].pts.length<=1){this.delResult(this._curGuid)}}if(this._polylines[this._curGuid])this.polylineAdded();this.removeTmpLine();this._startPoint=undefined;this._curGuid=undefined}this._viewer.scene.requestRender()};c.prototype.forceFinish=function(){this.onMouseRightClick()};c.prototype.onMouseMove=function(e){if(!this._startCapture)return;if(this._startPoint&&!FreeDo.Cartesian3.equals(e.endPosition,e.startPosition)){this.updateTmpLine(e.endPosition)}};c.prototype.registerHandlers=function(){console.log("registerHandlers");this._hanlder=this._hanlder&&this._hanlder.destroy();this._hanlder=new FreeDo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.onMouseLeftClick.bind(this),FreeDo.ScreenSpaceEventType.LEFT_CLICK);this._hanlder.setInputAction(this.onMouseRightClick.bind(this),FreeDo.ScreenSpaceEventType.RIGHT_CLICK);this._hanlder.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE)};c.prototype.getData=function(){return this._polylines};c.prototype.cancel=function(){this._startCapture=false;this._hanlder=this._hanlder&&this._hanlder.destroy();this._event.raiseEvent("Cancel",{})};c.prototype.removeAll=function(){for(var e in this._polylines){for(var t in this._polylines[e].lines){var r=this._polylines[e].lines[t];this._viewer.scene.primitives.remove(r)}delete this._polylines[e]}this.removeTmpLine();this._startPoint=undefined;this._curGuid=undefined;this._viewer.scene.requestRender()};c.prototype.hideAll=function(){for(var e in this._polylines){for(var t in this._polylines[e].lines){var r=this._polylines[e].lines[t];r.show=false}}this._viewer.scene.requestRender()};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.reset=function(){this.cancel()};c.prototype.dispose=function(){this.reset()};t.FdPolylineEditor=c},function(e,t,r){"use strict";var n=r(4);e.exports=function(e,t){return!!e&&n(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(15);e.exports=function(e,t,r){n(e);if(t===undefined)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){e.exports=!r(64)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(e,t){e.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},function(e,t,r){var n=r(40);var i=r(174);var a=r(120);var o=Object.defineProperty;t.f=r(29)?Object.defineProperty:function e(t,r,s){n(t);r=a(r,true);n(s);if(i)try{return o(t,r,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");if("value"in s)t[r]=s.value;return t}},function(e,t,r){var n=r(28);var i=r(76);var a=r(12);var o=r(8);var s=r(132);e.exports=function(e,t){var r=e==1;var u=e==2;var l=e==3;var c=e==4;var f=e==6;var d=e==5||f;var h=t||s;return function(t,s,v){var p=a(t);var _=i(p);var y=n(s,v,3);var m=o(_.length);var g=0;var F=r?h(t,m):u?h(t,0):undefined;var w,b;for(;m>g;g++)if(d||g in _){w=_[g];b=y(w,g,p);if(e){if(r)F[g]=b;else if(b)switch(e){case 3:return true;case 5:return w;case 6:return g;case 2:F.push(w)}else if(c)return false}}return f?-1:l||c?c:F}}},function(e,t,r){var n=r(0);var i=r(37);var a=r(4);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e];var o={};o[e]=t(r);n(n.S+n.F*a(function(){r(1)}),"Object",o)}},function(e,t){var r=Math.ceil;var n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(5);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;if(typeof(r=e.valueOf)=="function"&&!n(i=r.call(e)))return i;if(!t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r=e.exports={version:"2.5.5"};if(typeof __e=="number")__e=r},function(e,t,r){"use strict";t.__esModule=true;var n=r(100);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(){var t=e.apply(this,arguments);return new i.default(function(e,r){function n(a,o){try{var s=t[a](o);var u=s.value}catch(e){r(e);return}if(s.done){e(u)}else{return i.default.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}},function(e,t,r){e.exports=r(227)},function(e,t,r){var n=r(30);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n=r(188);var i=r(0);var a=r(98)("metadata");var o=a.store||(a.store=new(r(185)));var s=function(e,t,r){var i=o.get(e);if(!i){if(!r)return undefined;o.set(e,i=new n)}var a=i.get(t);if(!a){if(!r)return undefined;i.set(t,a=new n)}return a};var u=function(e,t,r){var n=s(t,r,false);return n===undefined?false:n.has(e)};var l=function(e,t,r){var n=s(t,r,false);return n===undefined?undefined:n.get(e)};var c=function(e,t,r,n){s(r,n,true).set(e,t)};var f=function(e,t){var r=s(e,t,false);var n=[];if(r)r.forEach(function(e,t){n.push(t)});return n};var d=function(e){return e===undefined||typeof e=="symbol"?e:String(e)};var h=function(e){i(i.S,"Reflect",e)};e.exports={store:o,map:s,has:u,get:l,set:c,keys:f,key:d,exp:h}},function(e,t,r){"use strict";if(r(10)){var n=r(57);var i=r(3);var a=r(4);var o=r(0);var s=r(88);var u=r(126);var l=r(28);var c=r(51);var f=r(59);var d=r(20);var h=r(49);var v=r(34);var p=r(8);var _=r(183);var y=r(55);var m=r(36);var g=r(24);var F=r(74);var w=r(5);var b=r(12);var C=r(135);var P=r(54);var x=r(21);var M=r(53).f;var S=r(133);var T=r(58);var E=r(7);var D=r(32);var A=r(97);var O=r(90);var k=r(130);var L=r(66);var I=r(93);var R=r(52);var N=r(131);var B=r(193);var j=r(9);var G=r(22);var H=j.f;var V=G.f;var X=i.RangeError;var Y=i.TypeError;var z=i.Uint8Array;var Z="ArrayBuffer";var U="Shared"+Z;var W="BYTES_PER_ELEMENT";var q="prototype";var Q=Array[q];var K=u.ArrayBuffer;var J=u.DataView;var $=D(0);var ee=D(2);var te=D(3);var re=D(4);var ne=D(5);var ie=D(6);var ae=A(true);var oe=A(false);var se=k.values;var ue=k.keys;var le=k.entries;var ce=Q.lastIndexOf;var fe=Q.reduce;var de=Q.reduceRight;var he=Q.join;var ve=Q.sort;var pe=Q.slice;var _e=Q.toString;var ye=Q.toLocaleString;var me=E("iterator");var ge=E("toStringTag");var Fe=T("typed_constructor");var we=T("def_constructor");var be=s.CONSTR;var Ce=s.TYPED;var Pe=s.VIEW;var xe="Wrong length!";var Me=D(1,function(e,t){return Ae(O(e,e[we]),t)});var Se=a(function(){return new z(new Uint16Array([1]).buffer)[0]===1});var Te=!!z&&!!z[q].set&&a(function(){new z(1).set({})});var Ee=function(e,t){var r=v(e);if(r<0||r%t)throw X("Wrong offset!");return r};var De=function(e){if(w(e)&&Ce in e)return e;throw Y(e+" is not a typed array!")};var Ae=function(e,t){if(!(w(e)&&Fe in e)){throw Y("It is not a typed array constructor!")}return new e(t)};var Oe=function(e,t){return ke(O(e,e[we]),t)};var ke=function(e,t){var r=0;var n=t.length;var i=Ae(e,n);while(n>r)i[r]=t[r++];return i};var Le=function(e,t,r){H(e,t,{get:function(){return this._d[r]}})};var Ie=function e(t){var r=b(t);var n=arguments.length;var i=n>1?arguments[1]:undefined;var a=i!==undefined;var o=S(r);var s,u,c,f,d,h;if(o!=undefined&&!C(o)){for(h=o.call(r),c=[],s=0;!(d=h.next()).done;s++){c.push(d.value)}r=c}if(a&&n>2)i=l(i,arguments[2],2);for(s=0,u=p(r.length),f=Ae(this,u);u>s;s++){f[s]=a?i(r[s],s):r[s]}return f};var Re=function e(){var t=0;var r=arguments.length;var n=Ae(this,r);while(r>t)n[t]=arguments[t++];return n};var Ne=!!z&&a(function(){ye.call(new z(1))});var Be=function e(){return ye.apply(Ne?pe.call(De(this)):De(this),arguments)};var je={copyWithin:function e(t,r){return B.call(De(this),t,r,arguments.length>2?arguments[2]:undefined)},every:function e(t){return re(De(this),t,arguments.length>1?arguments[1]:undefined)},fill:function e(t){return N.apply(De(this),arguments)},filter:function e(t){return Oe(this,ee(De(this),t,arguments.length>1?arguments[1]:undefined))},find:function e(t){return ne(De(this),t,arguments.length>1?arguments[1]:undefined)},findIndex:function e(t){return ie(De(this),t,arguments.length>1?arguments[1]:undefined)},forEach:function e(t){$(De(this),t,arguments.length>1?arguments[1]:undefined)},indexOf:function e(t){return oe(De(this),t,arguments.length>1?arguments[1]:undefined)},includes:function e(t){return ae(De(this),t,arguments.length>1?arguments[1]:undefined)},join:function e(t){return he.apply(De(this),arguments)},lastIndexOf:function e(t){return ce.apply(De(this),arguments)},map:function e(t){return Me(De(this),t,arguments.length>1?arguments[1]:undefined)},reduce:function e(t){return fe.apply(De(this),arguments)},reduceRight:function e(t){return de.apply(De(this),arguments)},reverse:function e(){var t=this;var r=De(t).length;var n=Math.floor(r/2);var i=0;var a;while(i<n){a=t[i];t[i++]=t[--r];t[r]=a}return t},some:function e(t){return te(De(this),t,arguments.length>1?arguments[1]:undefined)},sort:function e(t){return ve.call(De(this),t)},subarray:function e(t,r){var n=De(this);var i=n.length;var a=y(t,i);return new(O(n,n[we]))(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,p((r===undefined?i:y(r,i))-a))}};var Ge=function e(t,r){return Oe(this,pe.call(De(this),t,r))};var He=function e(t){De(this);var r=Ee(arguments[1],1);var n=this.length;var i=b(t);var a=p(i.length);var o=0;if(a+r>n)throw X(xe);while(o<a)this[r+o]=i[o++]};var Ve={entries:function e(){return le.call(De(this))},keys:function e(){return ue.call(De(this))},values:function e(){return se.call(De(this))}};var Xe=function(e,t){return w(e)&&e[Ce]&&typeof t!="symbol"&&t in e&&String(+t)==String(t)};var Ye=function e(t,r){return Xe(t,r=m(r,true))?f(2,t[r]):V(t,r)};var ze=function e(t,r,n){if(Xe(t,r=m(r,true))&&w(n)&&g(n,"value")&&!g(n,"get")&&!g(n,"set")&&!n.configurable&&(!g(n,"writable")||n.writable)&&(!g(n,"enumerable")||n.enumerable)){t[r]=n.value;return t}return H(t,r,n)};if(!be){G.f=Ye;j.f=ze}o(o.S+o.F*!be,"Object",{getOwnPropertyDescriptor:Ye,defineProperty:ze});if(a(function(){_e.call({})})){_e=ye=function e(){return he.call(this)}}var Ze=h({},je);h(Ze,Ve);d(Ze,me,Ve.values);h(Ze,{slice:Ge,set:He,constructor:function(){},toString:_e,toLocaleString:Be});Le(Ze,"buffer","b");Le(Ze,"byteOffset","o");Le(Ze,"byteLength","l");Le(Ze,"length","e");H(Ze,ge,{get:function(){return this[Ce]}});e.exports=function(e,t,r,u){u=!!u;var l=e+(u?"Clamped":"")+"Array";var f="get"+e;var h="set"+e;var v=i[l];var y=v||{};var m=v&&x(v);var g=!v||!s.ABV;var b={};var C=v&&v[q];var S=function(e,r){var n=e._d;return n.v[f](r*t+n.o,Se)};var T=function(e,r,n){var i=e._d;if(u)n=(n=Math.round(n))<0?0:n>255?255:n&255;i.v[h](r*t+i.o,n,Se)};var E=function(e,t){H(e,t,{get:function(){return S(this,t)},set:function(e){return T(this,t,e)},enumerable:true})};if(g){v=r(function(e,r,n,i){c(e,v,l,"_d");var a=0;var o=0;var s,u,f,h;if(!w(r)){f=_(r);u=f*t;s=new K(u)}else if(r instanceof K||(h=F(r))==Z||h==U){s=r;o=Ee(n,t);var y=r.byteLength;if(i===undefined){if(y%t)throw X(xe);u=y-o;if(u<0)throw X(xe)}else{u=p(i)*t;if(u+o>y)throw X(xe)}f=u/t}else if(Ce in r){return ke(v,r)}else{return Ie.call(v,r)}d(e,"_d",{b:s,o:o,l:u,e:f,v:new J(s)});while(a<f)E(e,a++)});C=v[q]=P(Ze);d(C,"constructor",v)}else if(!a(function(){v(1)})||!a(function(){new v(-1)})||!I(function(e){new v;new v(null);new v(1.5);new v(e)},true)){v=r(function(e,r,n,i){c(e,v,l);var a;if(!w(r))return new y(_(r));if(r instanceof K||(a=F(r))==Z||a==U){return i!==undefined?new y(r,Ee(n,t),i):n!==undefined?new y(r,Ee(n,t)):new y(r)}if(Ce in r)return ke(v,r);return Ie.call(v,r)});$(m!==Function.prototype?M(y).concat(M(m)):M(y),function(e){if(!(e in v))d(v,e,y[e])});v[q]=C;if(!n)C.constructor=v}var D=C[me];var A=!!D&&(D.name=="values"||D.name==undefined);var O=Ve.values;d(v,Fe,true);d(C,Ce,l);d(C,Pe,true);d(C,we,v);if(u?new v(1)[ge]!=l:!(ge in C)){H(C,ge,{get:function(){return l}})}b[l]=v;o(o.G+o.W+o.F*(v!=y),b);o(o.S,l,{BYTES_PER_ELEMENT:t});o(o.S+o.F*a(function(){y.of.call(v,1)}),l,{from:Ie,of:Re});if(!(W in C))d(C,W,t);o(o.P,l,je);R(l);o(o.P+o.F*Te,l,{set:He});o(o.P+o.F*!A,l,Ve);if(!n&&C.toString!=_e)C.toString=_e;o(o.P+o.F*a(function(){new v(1).slice()}),l,{slice:Ge});o(o.P+o.F*(a(function(){return[1,2].toLocaleString()!=new v([1,2]).toLocaleString()})||!a(function(){C.toLocaleString.call([1,2])})),l,{toLocaleString:Be});L[l]=A?D:O;if(!n&&!A)d(C,me,O)}}else e.exports=function(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdCommon=undefined;var n=r(39);var i=h(n);var a=r(100);var o=h(a);var s=r(38);var u=h(s);var l=r(218);var c=h(l);var f=r(1);var d=h(f);function h(e){return e&&e.__esModule?e:{default:e}}var v=function e(){(0,d.default)(this,e)};v.fdAjax=function(e){e=e||{};e.type=(e.type||"GET").toUpperCase();e.dataType=e.dataType||"json";e.async=e.async||true;var t="";if(e.data){t=(0,c.default)(e.data)}if(window.XMLHttpRequest){var r=new XMLHttpRequest}else{var r=new ActiveXObject("Microsoft.XMLHTTP")}r.onreadystatechange=function(){if(r.readyState===4){var t=r.status;if(t>=200&&t<300){e.success&&e.success(r.responseText,r.responseXML)}else{e.fail&&e.fail(r.responseText,r.responseXML)}}};if(e.type==="GET"){r.open("GET",e.url+t,e.async);r.send(null)}else if(e.type==="POST"){r.open("POST",e.url,e.async);r.setRequestHeader("Content-type","application/json; charset=utf-8");if(e.token!==undefined){r.setRequestHeader("Authorization",e.token)}r.send(t)}};v.ajaxJson=function(){var e=(0,u.default)(i.default.mark(function e(t){var r;return i.default.wrap(function e(n){while(1){switch(n.prev=n.next){case 0:r=t.dataType||"json";return n.abrupt("return",new o.default(function(e,n){v.fdAjax({url:t.url,type:t.type||"POST",data:t.data||null,dataType:t.dataType||"json",success:function t(i,a){if(r==="json"){if(i){var o=JSON.parse(i);e(o)}else{n(i)}}else{e(a)}},fail:function e(t,r){var i=JSON.parse(t);n(i)}})}));case 2:case"end":return n.stop()}}},e,this)}));return function(t){return e.apply(this,arguments)}}();t.FdCommon=v},function(e,t,r){var n=r(31);var i=r(83);e.exports=r(29)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){e[t]=r;return e}},function(e,t,r){var n=r(7)("unscopables");var i=Array.prototype;if(i[n]==undefined)r(20)(i,n,{});e.exports=function(e){i[n][e]=true}},function(e,t,r){var n=r(58)("meta");var i=r(5);var a=r(24);var o=r(9).f;var s=0;var u=Object.isExtensible||function(){return true};var l=!r(4)(function(){return u(Object.preventExtensions({}))});var c=function(e){o(e,n,{value:{i:"O"+ ++s,w:{}}})};var f=function(e,t){if(!i(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!a(e,n)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[n].i};var d=function(e,t){if(!a(e,n)){if(!u(e))return true;if(!t)return false;c(e)}return e[n].w};var h=function(e){if(l&&v.NEED&&u(e)&&!a(e,n))c(e);return e};var v=e.exports={KEY:n,NEED:false,fastKey:f,getWeak:d,onFreeze:h}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(73);e.exports=function(e,t,r){n(e);if(t===undefined)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(19);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(28);var i=r(195);var a=r(135);var o=r(2);var s=r(8);var u=r(133);var l={};var c={};var t=e.exports=function(e,t,r,f,d){var h=d?function(){return e}:u(e);var v=n(r,f,t?2:1);var p=0;var _,y,m,g;if(typeof h!="function")throw TypeError(e+" is not iterable!");if(a(h))for(_=s(e.length);_>p;p++){g=t?v(o(y=e[p])[0],y[1]):v(e[p]);if(g===l||g===c)return g}else for(m=h.call(e);!(y=m.next()).done;){g=i(m,v,y.value,t);if(g===l||g===c)return g}};t.BREAK=l;t.RETURN=c},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||n!==undefined&&n in e){throw TypeError(r+": incorrect invocation!")}return e}},function(e,t,r){"use strict";var n=r(3);var i=r(9);var a=r(10);var o=r(7)("species");e.exports=function(e){var t=n[e];if(a&&t&&!t[o])i.f(t,o,{configurable:true,get:function(){return this}})}},function(e,t,r){var n=r(207);var i=r(148).concat("length","prototype");t.f=Object.getOwnPropertyNames||function e(t){return n(t,i)}},function(e,t,r){var n=r(2);var i=r(206);var a=r(148);var o=r(149)("IE_PROTO");var s=function(){};var u="prototype";var l=function(){var e=r(151)("iframe");var t=a.length;var n="<";var i=">";var o;e.style.display="none";r(147).appendChild(e);e.src="javascript:";o=e.contentWindow.document;o.open();o.write(n+"script"+i+"document.F=Object"+n+"/script"+i);o.close();l=o.F;while(t--)delete l[u][a[t]];return l()};e.exports=Object.create||function e(t,r){var a;if(t!==null){s[u]=n(t);a=new s;s[u]=null;a[o]=t}else a=l();return r===undefined?a:i(a,r)}},function(e,t,r){var n=r(34);var i=Math.max;var a=Math.min;e.exports=function(e,t){e=n(e);return e<0?i(e+t,0):a(e,t)}},function(e,t,r){var n=r(207);var i=r(148);e.exports=Object.keys||function e(t){return n(t,i)}},function(e,t){e.exports=false},function(e,t){var r=0;var n=Math.random();e.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++r+n).toString(36))}},function(e,t){e.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},function(e,t,r){"use strict";var n=r(292)(true);r(116)(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t;var t=this._i;var r;if(t>=e.length)return{value:undefined,done:true};r=n(e,t);this._i+=r.length;return{value:r,done:false}})},function(e,t,r){var n=r(118);var i=r(117);e.exports=function(e){return n(i(e))}},function(e,t){e.exports={}},function(e,t,r){r(299);var n=r(16);var i=r(44);var a=r(62);var o=r(13)("toStringTag");var s=("CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,"+"DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,"+"MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,"+"SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,"+"TextTrackList,TouchList").split(",");for(var u=0;u<s.length;u++){var l=s[u];var c=n[l];var f=c&&c.prototype;if(f&&!f[o])i(f,o,l);a[l]=a.Array}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return true}}},function(e,t,r){var n=r(5);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t){e.exports={}},function(e,t,r){var n=r(0);var i=r(35);var a=r(4);var o=r(145);var s="["+o+"]";var u="​";var l=RegExp("^"+s+s+"*");var c=RegExp(s+s+"*$");var f=function(e,t,r){var i={};var s=a(function(){return!!o[e]()||u[e]()!=u});var l=i[e]=s?t(d):o[e];if(r)i[r]=l;n(n.P+n.F*s,"String",i)};var d=f.trim=function(e,t){e=String(i(e));if(t&1)e=e.replace(l,"");if(t&2)e=e.replace(c,"");return e};e.exports=f},function(e,t,r){var n=r(9).f;var i=r(24);var a=r(7)("toStringTag");e.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,a))n(e,a,{configurable:true,value:t})}},function(e,t,r){var n=r(48);var i=r(287);var a=r(286);var o=r(40);var s=r(114);var u=r(167);var l={};var c={};var t=e.exports=function(e,t,r,f,d){var h=d?function(){return e}:u(e);var v=n(r,f,t?2:1);var p=0;var _,y,m,g;if(typeof h!="function")throw TypeError(e+" is not iterable!");if(a(h))for(_=s(e.length);_>p;p++){g=t?v(o(y=e[p])[0],y[1]):v(e[p]);if(g===l||g===c)return g}else for(m=h.call(e);!(y=m.next()).done;){g=i(m,v,y.value,t);if(g===l||g===c)return g}};t.BREAK=l;t.RETURN=c},function(e,t,r){var n=r(31).f;var i=r(47);var a=r(13)("toStringTag");e.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,a))n(e,a,{configurable:true,value:t})}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdBezierCurveAlgorithm=undefined;var n=r(1);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t,r,n,a){(0,i.default)(this,e);this.mPointA=t.position;this.mPointB=r.position;this.mControlPointA=n.position;this.mControlPointB=a.position};o.prototype.coefficients=function(e,t,r,n,i){var a=1-e;r=a*a;n=e*e;i=n*e;t=r*a;r*=3*e;n*=3*a;return{a:t,b:r,c:n,d:i}};o.prototype.getPointAt=function(e,t,r,n){if(e<0)e=0;if(e>1)e=1;var i,a,o,s;var u=this.coefficients(e,i,a,o,s);t=u.a*this.mPointA.x+u.b*this.mControlPointA.x+u.c*this.mControlPointB.x+u.d*this.mPointB.x;r=u.a*this.mPointA.y+u.b*this.mControlPointA.y+u.c*this.mControlPointB.y+u.d*this.mPointB.y;n=u.a*this.mPointA.z+u.b*this.mControlPointA.z+u.c*this.mControlPointB.z+u.d*this.mPointB.z;return{x:t,y:r,z:n}};o.prototype.getVertexForCurve=function(e){var t=0;var r=0;switch(e){case 1:t=1;r=2;break;case 2:t=.5;r=3;break;case 3:t=.2;r=6;break;case 4:t=.1;r=11;break;case 5:t=.05;r=21;break;case 6:t=.02;r=51;break;case 7:t=.01;r=101;break;case 8:t=.005;r=201;break;case 9:t=.0025;r=401;break;case 10:t=.00125;r=801;break;case 11:t=625e-6;r=1601;break;default:t=.005;r=201;break}var n=[];var i=0;for(var a=0;a<r;++a){var o={};var s=0,u=0,l=0;var c=this.getPointAt(i,s,u,l);o.x=c.x;o.y=c.y;o.z=c.z;n.push(o);i+=t}return n};t.FdBezierCurveAlgorithm=o},function(e,t){e.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(27);var i=r(7)("toStringTag");var a=n(function(){return arguments}())=="Arguments";var o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return e===undefined?"Undefined":e===null?"Null":typeof(r=o(t=Object(e),i))=="string"?r:a?n(t):(s=n(t))=="Object"&&typeof t.callee=="function"?"Arguments":s}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(27);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return n(e)=="String"?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){},function(e,t,r){var n=r(71);var i=r(13)("toStringTag");var a=n(function(){return arguments}())=="Arguments";var o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return e===undefined?"Undefined":e===null?"Null":typeof(r=o(t=Object(e),i))=="string"?r:a?n(t):(s=n(t))=="Object"&&typeof t.callee=="function"?"Arguments":s}},function(e,t){var r=0;var n=Math.random();e.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(169);var i=r(110);e.exports=Object.keys||function e(t){return n(t,i)}},function(e,t){e.exports=true},function(e,t){e.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdKeyboard=undefined;var n=r(1);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t){(0,i.default)(this,e);this._viewer=t;this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._divID=this._viewer._container.id;this._bActive=false;this._bRun=false;this._windowTimer=null;this._metaData=[]};o.prototype.enable=function(){this._bActive=true;this.setFocus();this.addEventLsnr();this._event.raiseEvent("StatusChanged",{status:this._bActive})};o.prototype.disable=function(){this._bActive=false;this._event.raiseEvent("StatusChanged",{status:this._bActive})};o.prototype.getStatus=function(){return this._bActive};o.prototype.setStatus=function(e){this._bActive=e};o.prototype.setFocus=function(){var e=document.getElementById(this._divID);e.setAttribute("tabindex",1);e.focus()};o.prototype.prevent=function(e){var t=e.keyCode||e.which;if(t==38||t==40||t==37||t==39||t==87||t==65||t==83||t==68){e.stopPropagation();e.preventDefault()}};o.prototype.onKeyDown=function(e){if(!this._bActive)return;e=window.event||e;var t=e.keyCode||e.which;this._metaData[e.keyCode]=true;this.startTimer();this.prevent(e)};o.prototype.onKeyUp=function(e){if(!this._bActive)return;e=window.event||e;var t=e.keyCode||e.which;this._metaData[e.keyCode]=false;this.stopTimer();this.prevent(e)};o.prototype.startTimer=function(e){var t=this;if(this._windowTimer==null){this._windowTimer=window.setInterval(function(){t._event.raiseEvent("timer",{metaData:t._metaData});t._event.raiseEvent("KeyPressed",{metaData:t._metaData})},33)}};o.prototype.stopTimer=function(e){if(this._windowTimer!=null){var t=true;for(var r in this._metaData){if(this._metaData[r]){t=false;break}}if(t){window.clearInterval(this._windowTimer);this._windowTimer=null}}};o.prototype.addEventLsnr=function(){var e=this;if(!this._bRun){this._bRun=true;var t=this._viewer.canvas;t.addEventListener("click",function(e){if(e.target===t){this.setAttribute("tabindex",1);this.focus()}});t.onkeydown=function(r){if(r.target===t){e.onKeyDown(r)}};t.onkeyup=function(r){if(r.target===t){e.onKeyUp(r)}}}};o.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};o.prototype.reset=function(){this._bActive=false};o.prototype.dispose=function(){this.reset()};t.FdKeyboard=o},function(e,t,r){"use strict";var n=r(0);var i=r(15);var a=r(28);var o=r(50);e.exports=function(e){n(n.S,e,{from:function e(t){var r=arguments[1];var n,s,u,l;i(this);n=r!==undefined;if(n)i(r);if(t==undefined)return new this;s=[];if(n){u=0;l=a(r,arguments[2],2);o(t,false,function(e){s.push(l(e,u++))})}else{o(t,false,s.push,s)}return new this(s)}})}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){n(n.S,e,{of:function e(){var t=arguments.length;var r=new Array(t);while(t--)r[t]=arguments[t];return new this(r)}})}},function(e,t,r){"use strict";e.exports=r(57)||!r(4)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){});delete r(3)[e]})},function(e,t,r){var n=r(3);var i=r(20);var a=r(58);var o=a("typed_array");var s=a("view");var u=!!(n.ArrayBuffer&&n.DataView);var l=u;var c=0;var f=9;var d;var h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");while(c<f){if(d=n[h[c++]]){i(d.prototype,o,true);i(d.prototype,s,true)}else l=false}e.exports={ABV:u,CONSTR:l,TYPED:o,VIEW:s}},function(e,t,r){"use strict";var n=r(3);var i=r(0);var a=r(19);var o=r(49);var s=r(46);var u=r(50);var l=r(51);var c=r(5);var f=r(4);var d=r(93);var h=r(68);var v=r(144);e.exports=function(e,t,r,p,_,y){var m=n[e];var g=m;var F=_?"set":"add";var w=g&&g.prototype;var b={};var C=function(e){var t=w[e];a(w,e,e=="delete"?function(e){return y&&!c(e)?false:t.call(this,e===0?0:e)}:e=="has"?function e(r){return y&&!c(r)?false:t.call(this,r===0?0:r)}:e=="get"?function e(r){return y&&!c(r)?undefined:t.call(this,r===0?0:r)}:e=="add"?function e(r){t.call(this,r===0?0:r);return this}:function e(r,n){t.call(this,r===0?0:r,n);return this})};if(typeof g!="function"||!(y||w.forEach&&!f(function(){(new g).entries().next()}))){g=p.getConstructor(t,e,_,F);o(g.prototype,r);s.NEED=true}else{var P=new g;var x=P[F](y?{}:-0,1)!=P;var M=f(function(){P.has(1)});var S=d(function(e){new g(e)});var T=!y&&f(function(){var e=new g;var t=5;while(t--)e[F](t,t);return!e.has(-0)});if(!S){g=t(function(t,r){l(t,g,e);var n=v(new m,t,g);if(r!=undefined)u(r,_,n[F],n);return n});g.prototype=w;w.constructor=g}if(M||T){C("delete");C("has");_&&C("get")}if(T||x)C(F);if(y&&w.clear)delete w.clear}h(g,e);b[e]=g;i(i.G+i.W+i.F*(g!=m),b);if(!y)p.setStrong(g,e,_);return g}},function(e,t,r){var n=r(2);var i=r(15);var a=r(7)("species");e.exports=function(e,t){var r=n(e).constructor;var o;return r===undefined||(o=n(r)[a])==undefined?t:i(o)}},function(e,t,r){"use strict";var n=r(20);var i=r(19);var a=r(4);var o=r(35);var s=r(7);e.exports=function(e,t,r){var u=s(e);var l=r(o,u,""[e]);var c=l[0];var f=l[1];if(a(function(){var t={};t[u]=function(){return 7};return""[e](t)!=7})){i(String.prototype,e,c);n(RegExp.prototype,u,t==2?function(e,t){return f.call(e,this,t)}:function(e){return f.call(e,this)})}}},function(e,t,r){"use strict";var n=r(2);e.exports=function(){var e=n(this);var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";if(e.unicode)t+="u";if(e.sticky)t+="y";return t}},function(e,t,r){var n=r(7)("iterator");var i=false;try{var a=[7][n]();a["return"]=function(){i=true};Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return false;var r=false;try{var a=[7];var o=a[n]();o.next=function(){return{done:r=true}};a[n]=function(){return o};e(a)}catch(e){}return r}},function(e,t,r){var n=r(5);var i=r(27);var a=r(7)("match");e.exports=function(e){var t;return n(e)&&((t=e[a])!==undefined?!!t:i(e)=="RegExp")}},function(e,t,r){var n=r(27);e.exports=Array.isArray||function e(t){return n(t)=="Array"}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(23);var i=r(8);var a=r(55);e.exports=function(e){return function(t,r,o){var s=n(t);var u=i(s.length);var l=a(o,u);var c;if(e&&r!=r)while(u>l){c=s[l++];if(c!=c)return true}else for(;u>l;l++)if(e||l in s){if(s[l]===r)return e||l||0}return!e&&-1}}},function(e,t,r){var n=r(3);var i="__core-js_shared__";var a=n[i]||(n[i]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e,t,r){"use strict";var n=r(73);function i(e){var t,r;this.promise=new e(function(e,n){if(t!==undefined||r!==undefined)throw TypeError("Bad Promise constructor");t=e;r=n});this.resolve=n(t);this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t,r){e.exports={default:r(225),__esModule:true}},function(e,t,r){var n=r(16);var i=r(14);var a=r(82);var o=r(102);var s=r(31).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:n.Symbol||{});if(e.charAt(0)!="_"&&!(e in t))s(t,e,{value:o.f(e)})}},function(e,t,r){t.f=r(13)},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){e.exports={default:r(277),__esModule:true}},function(e,t,r){var n=r(30);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){var n=r(80)("meta");var i=r(30);var a=r(47);var o=r(31).f;var s=0;var u=Object.isExtensible||function(){return true};var l=!r(64)(function(){return u(Object.preventExtensions({}))});var c=function(e){o(e,n,{value:{i:"O"+ ++s,w:{}}})};var f=function(e,t){if(!i(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!a(e,n)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[n].i};var d=function(e,t){if(!a(e,n)){if(!u(e))return true;if(!t)return false;c(e)}return e[n].w};var h=function(e){if(l&&v.NEED&&u(e)&&!a(e,n))c(e);return e};var v=e.exports={KEY:n,NEED:false,fastKey:f,getWeak:d,onFreeze:h}},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||n!==undefined&&n in e){throw TypeError(r+": incorrect invocation!")}return e}},function(e,t,r){var n=r(44);e.exports=function(e,t,r){for(var i in t){if(r&&e[i])e[i]=t[i];else n(e,i,t[i])}return e}},function(e,t,r){var n=r(117);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(16);var i="__core-js_shared__";var a=n[i]||(n[i]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e,t,r){var n=r(111)("keys");var i=r(80);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t){var r=Math.ceil;var n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(113);var i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(40);var i=r(296);var a=r(110);var o=r(112)("IE_PROTO");var s=function(){};var u="prototype";var l=function(){var e=r(121)("iframe");var t=a.length;var n="<";var i=">";var o;e.style.display="none";r(168).appendChild(e);e.src="javascript:";o=e.contentWindow.document;o.open();o.write(n+"script"+i+"document.F=Object"+n+"/script"+i);o.close();l=o.F;while(t--)delete l[u][a[t]];return l()};e.exports=Object.create||function e(t,r){var a;if(t!==null){s[u]=n(t);a=new s;s[u]=null;a[o]=t}else a=l();return r===undefined?a:i(a,r)}},function(e,t,r){"use strict";var n=r(82);var i=r(17);var a=r(170);var o=r(44);var s=r(62);var u=r(297);var l=r(70);var c=r(293);var f=r(13)("iterator");var d=!([].keys&&"next"in[].keys());var h="@@iterator";var v="keys";var p="values";var _=function(){return this};e.exports=function(e,t,r,y,m,g,F){u(r,t,y);var w=function(e){if(!d&&e in x)return x[e];switch(e){case v:return function t(){return new r(this,e)};case p:return function t(){return new r(this,e)}}return function t(){return new r(this,e)}};var b=t+" Iterator";var C=m==p;var P=false;var x=e.prototype;var M=x[f]||x[h]||m&&x[m];var S=M||w(m);var T=m?!C?S:w("entries"):undefined;var E=t=="Array"?x.entries||M:M;var D,A,O;if(E){O=c(E.call(new e));if(O!==Object.prototype&&O.next){l(O,b,true);if(!n&&typeof O[f]!="function")o(O,f,_)}}if(C&&M&&M.name!==p){P=true;S=function e(){return M.call(this)}}if((!n||F)&&(d||P||!x[f])){o(x,f,S)}s[t]=S;s[b]=_;if(m){D={values:C?S:w(p),keys:g?S:w(v),entries:T};if(F)for(A in D){if(!(A in x))a(x,A,D[A])}else i(i.P+i.F*(d||P),t,D)}return D}},function(e,t){e.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(71);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return n(e)=="String"?e.split(""):Object(e)}},function(e,t,r){e.exports={default:r(300),__esModule:true}},function(e,t,r){var n=r(30);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;if(typeof(r=e.valueOf)=="function"&&!n(i=r.call(e)))return i;if(!t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(30);var i=r(16).document;var a=n(i)&&n(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e){return typeof e==="undefined"?undefined:Freedo.Math.toDegrees(e)}function i(e){var t=e.positionCartographic;return[n(t.longitude),n(t.latitude),t.height,n(e.heading),n(e.pitch),n(e.roll)]}function a(e,t,r){var n=i(e);if(!_.isEqual(n,t)){var a=t;var o;if(!Freedo.Matrix4.equals(e.transform,Freedo.Matrix4.IDENTITY)){o=Freedo.Matrix4.clone(e.transform,o);e.lookAtTransform(Freedo.Matrix4.IDENTITY)}var s;if(typeof r==="undefined"){s={}}else{s=Freedo.clone(r,true)}s.destination=Freedo.Cartesian3.fromDegrees(a[0],a[1],a[2]);s.orientation={heading:Freedo.Math.toRadians(a[3]),pitch:Freedo.Math.toRadians(a[4]),roll:Freedo.Math.toRadians(a[5])};if(typeof o!=="undefined"&&typeof s.endTransform==="undefined"){s.endTransform=o}e.flyTo(s);return true}else{return false}}function o(e,t){var r=i(e);if(!_.isEqual(r,t)){var n=t;var a;if(!Freedo.Matrix4.equals(e.transform,Freedo.Matrix4.IDENTITY)){a=Freedo.Matrix4.clone(e.transform,a);e.lookAtTransform(Freedo.Matrix4.IDENTITY)}e.setView({destination:Freedo.Cartesian3.fromDegrees(n[0],n[1],n[2]),orientation:{heading:Freedo.Math.toRadians(n[3]),pitch:Freedo.Math.toRadians(n[4]),roll:Freedo.Math.toRadians(n[5])}});if(typeof a!=="undefined"){e.lookAtTransform(a)}return true}else{return false}}t.getCurrentCameraInfo=i;t.flyToByCameraInfo=a;t.goToByCameraInfo=o},function(e,t,r){"use strict";r.r(t);(function(e,n){r.d(t,"Reaction",function(){return Gr});r.d(t,"untracked",function(){return Lr});r.d(t,"IDerivationState",function(){return Pr});r.d(t,"createAtom",function(){return dt});r.d(t,"spy",function(){return F});r.d(t,"comparer",function(){return z});r.d(t,"isObservableObject",function(){return ge});r.d(t,"isBoxedObservable",function(){return se});r.d(t,"isObservableArray",function(){return xt});r.d(t,"ObservableMap",function(){return tt});r.d(t,"isObservableMap",function(){return rt});r.d(t,"transaction",function(){return $e});r.d(t,"observable",function(){return Xe});r.d(t,"computed",function(){return Ee});r.d(t,"isObservable",function(){return be});r.d(t,"isObservableProp",function(){return Ce});r.d(t,"isComputed",function(){return xe});r.d(t,"isComputedProp",function(){return Me});r.d(t,"extendObservable",function(){return Ae});r.d(t,"extendShallowObservable",function(){return De});r.d(t,"observe",function(){return Wr});r.d(t,"intercept",function(){return Kr});r.d(t,"autorun",function(){return Z});r.d(t,"reaction",function(){return q});r.d(t,"when",function(){return en});r.d(t,"action",function(){return O});r.d(t,"isAction",function(){return L});r.d(t,"runInAction",function(){return k});r.d(t,"keys",function(){return nn});r.d(t,"values",function(){return an});r.d(t,"set",function(){return on});r.d(t,"remove",function(){return sn});r.d(t,"has",function(){return un});r.d(t,"get",function(){return ln});r.d(t,"decorate",function(){return cn});r.d(t,"configure",function(){return fn});r.d(t,"onBecomeObserved",function(){return ot});r.d(t,"onBecomeUnobserved",function(){return st});r.d(t,"flow",function(){return hn});r.d(t,"toJS",function(){return _n});r.d(t,"trace",function(){return Br});r.d(t,"getDependencyTree",function(){return sr});r.d(t,"getObserverTree",function(){return lr});r.d(t,"_resetGlobalState",function(){return or});r.d(t,"_getGlobalState",function(){return ar});r.d(t,"getDebugName",function(){return at});r.d(t,"getAtom",function(){return nt});r.d(t,"_getAdministration",function(){return it});r.d(t,"_allowStateChanges",function(){return x});r.d(t,"isArrayLike",function(){return Ut});r.d(t,"_isComputingDerivation",function(){return Er});r.d(t,"onReactionError",function(){return Hr});r.d(t,"_interceptReads",function(){return yn});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};function a(e,t){i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var o=Object.assign||function e(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a))t[a]=r[a]}return t};function s(e,t){var r=typeof Symbol==="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{while((t===void 0||t-- >0)&&!(i=n.next()).done)a.push(i.value)}catch(e){o={error:e}}finally{try{if(i&&!i.done&&(r=n["return"]))r.call(n)}finally{if(o)throw o.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var l={};var c={};function f(e,t){var r=t?l:c;return r[e]||(r[e]={configurable:true,enumerable:t,get:function(){d(this);return this[e]},set:function(t){d(this);this[e]=t}})}function d(e){if(e.__mobxDidRunLazyInitializers===true)return;var t=e.__mobxDecorators;if(t){Ht(e,"__mobxDidRunLazyInitializers",true);for(var r in t){var n=t[r];n.propertyCreator(e,n.prop,n.descriptor,n.decoratorTarget,n.decoratorArguments)}}}function h(e,t){return function r(){var n;var i=function r(i,a,s,u){if(u===true){t(i,a,s,i,n);return null}if(false){}if(!Object.prototype.hasOwnProperty.call(i,"__mobxDecorators")){var l=i.__mobxDecorators;Ht(i,"__mobxDecorators",o({},l))}i.__mobxDecorators[a]={prop:a,propertyCreator:t,descriptor:s,decoratorTarget:i,decoratorArguments:n};return f(a,e)};if(v(arguments)){n=St;return i.apply(null,arguments)}else{n=Array.prototype.slice.call(arguments);return i}}}function v(e){return(e.length===2||e.length===3)&&typeof e[1]==="string"||e.length===4&&e[3]===true}function p(){return!!tr.spyListeners.length}function _(e){if(!tr.spyListeners.length)return;var t=tr.spyListeners;for(var r=0,n=t.length;r<n;r++)t[r](e)}function y(e){var t=o({},e,{spyReportStart:true});_(t)}var m={spyReportEnd:true};function g(e){if(e)_(o({},e,{spyReportEnd:true}));else _(m)}function F(e){tr.spyListeners.push(e);return It(function(){tr.spyListeners=tr.spyListeners.filter(function(t){return t!==e})})}function w(e,t){if(false){}var r=function(){return b(e,t,this,arguments)};r.isMobxAction=true;return r}function b(e,t,r,n){var i=C(e,t,r,n);try{return t.apply(r,n)}finally{P(i)}}function C(e,t,r,n){var i=p()&&!!e;var a=0;if(i){a=Date.now();var o=n&&n.length||0;var s=new Array(o);if(o>0)for(var u=0;u<o;u++)s[u]=n[u];y({type:"action",name:e,object:r,arguments:s})}var l=Ir();_r();var c=M(true);return{prevDerivation:l,prevAllowStateChanges:c,notifySpy:i,startTime:a}}function P(e){S(e.prevAllowStateChanges);yr();Rr(e.prevDerivation);if(e.notifySpy)g({time:Date.now()-e.startTime})}function x(e,t){var r=M(e);var n;try{n=t()}finally{S(r)}return n}function M(e){var t=tr.allowStateChanges;tr.allowStateChanges=e;return t}function S(e){tr.allowStateChanges=e}function T(){At("production"!=="production"&&"@action fields are not reassignable")}function E(e){return function(t,r,n){if(n){if(false){}if(n.value){return{value:w(e,n.value),enumerable:false,configurable:true,writable:true}}var i=n.initializer;return{enumerable:false,configurable:true,writable:true,initializer:function(){return w(e,i.call(this))}}}return D(e).apply(this,arguments)}}function D(e){return function(t,r,n){Object.defineProperty(t,r,{configurable:true,enumerable:false,get:function(){return undefined},set:function(t){Vt(this,r,O(e,t))}})}}function A(e,t,r,n){if(n===true){I(e,t,r.value);return null}if(r){return{configurable:true,enumerable:false,get:function(){I(this,t,r.value||r.initializer.call(this));return this[t]},set:T}}return{enumerable:false,configurable:true,set:function(e){I(this,t,e)},get:function(){return undefined}}}var O=function e(t,r,n,i){if(arguments.length===1&&typeof t==="function")return w(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof r==="function")return w(t,r);if(arguments.length===1&&typeof t==="string")return E(t);if(i===true){t[r]=w(t.name||r,n.value)}else{return E(r).apply(null,arguments)}};O.bound=A;function k(e,t){var r=typeof e==="string"?e:e.name||"<unnamed action>";var n=typeof e==="function"?e:t;if(false){}return b(r,n,this,undefined)}function L(e){return typeof e==="function"&&e.isMobxAction===true}function I(e,t,r){Ht(e,t,w(t,r.bind(e)))}var R=Object.prototype.toString;function N(e,t){return B(e,t)}function B(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return false;if(e!==e)return t!==t;var i=typeof e;if(i!=="function"&&i!=="object"&&typeof t!="object")return false;return j(e,t,r,n)}function j(e,t,r,n){e=G(e);t=G(t);var i=R.call(e);if(i!==R.call(t))return false;switch(i){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":if(+e!==+e)return+t!==+t;return+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return typeof Symbol!=="undefined"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var a=i==="[object Array]";if(!a){if(typeof e!="object"||typeof t!="object")return false;var o=e.constructor,s=t.constructor;if(o!==s&&!(typeof o==="function"&&o instanceof o&&typeof s==="function"&&s instanceof s)&&("constructor"in e&&"constructor"in t)){return false}}r=r||[];n=n||[];var u=r.length;while(u--){if(r[u]===e)return n[u]===t}r.push(e);n.push(t);if(a){u=e.length;if(u!==t.length)return false;while(u--){if(!B(e[u],t[u],r,n))return false}}else{var l=Object.keys(e),c;u=l.length;if(Object.keys(t).length!==u)return false;while(u--){c=l[u];if(!(H(t,c)&&B(e[c],t[c],r,n)))return false}}r.pop();n.pop();return true}function G(e){if(xt(e))return e.peek();if(Wt(e)||rt(e))return Qt(e.entries());return e}function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function V(e,t){return e===t}function X(e,t){return N(e,t)}function Y(e,t){return Zt(e,t)||V(e,t)}var z={identity:V,structural:X,default:Y};function Z(e,t){if(t===void 0){t=Tt}if(false){}var r=t&&t.name||e.name||"Autorun@"+Dt();var n=!t.scheduler&&!t.delay;var i;if(n){i=new Gr(r,function(){this.track(s)},t.onError)}else{var a=W(t);var o=false;i=new Gr(r,function(){if(!o){o=true;a(function(){o=false;if(!i.isDisposed)i.track(s)})}},t.onError)}function s(){e(i)}i.schedule();return i.getDisposer()}var U=function(e){return e()};function W(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:U}function q(e,t,r){if(r===void 0){r=Tt}if(typeof r==="boolean"){r={fireImmediately:r};Lt("Using fireImmediately as argument is deprecated. Use '{ fireImmediately: true }' instead")}if(false){}var n=r.name||"Reaction@"+Dt();var i=O(n,r.onError?Q(r.onError,t):t);var a=!r.scheduler&&!r.delay;var o=W(r);var s=true;var u=false;var l;var c=r.compareStructural?z.structural:r.equals||z.default;var f=new Gr(n,function(){if(s||a){d()}else if(!u){u=true;o(d)}},r.onError);function d(){u=false;if(f.isDisposed)return;var t=false;f.track(function(){var r=e(f);t=s||!c(l,r);l=r});if(s&&r.fireImmediately)i(l,f);if(!s&&t===true)i(l,f);if(s)s=false}f.schedule();return f.getDisposer()}function Q(e,t){return function(){try{return t.apply(this,arguments)}catch(t){e.call(this,t)}}}var K=function(){function e(e){var t=this;this.dependenciesState=Pr.NOT_TRACKING;this.observing=[];this.newObserving=null;this.isBeingObserved=false;this.isPendingUnobservation=false;this.observers=[];this.observersIndexes={};this.diffValue=0;this.runId=0;this.lastAccessedBy=0;this.lowestObserverState=Pr.UP_TO_DATE;this.unboundDepsCount=0;this.__mapid="#"+Dt();this.value=new Mr(null);this.isComputing=false;this.isRunningSetter=false;this.isTracing=xr.NONE;if("production"==="production"&&!e.get)return At("missing option for computed: get");this.derivation=e.get;this.name=e.name||"ComputedValue@"+Dt();if(e.set)this.setter=w(this.name+"-setter",e.set);this.equals=e.equals||(e.compareStructural||e.struct?z.structural:z.default);this.scope=e.context;this.requiresReaction=!!e.requiresReaction;if(e.keepAlive===true){Z(function(){return t.get()})}}e.prototype.onBecomeStale=function(){wr(this)};e.prototype.onBecomeUnobserved=function(){};e.prototype.onBecomeObserved=function(){};e.prototype.get=function(){if(this.isComputing)At("Cycle detected in computation "+this.name+": "+this.derivation);if(tr.inBatch===0){if(Tr(this)){this.warnAboutUntrackedRead();_r();this.value=this.computeValue(false);yr()}}else{mr(this);if(Tr(this))if(this.trackAndCompute())Fr(this)}var e=this.value;if(Sr(e))throw e.cause;return e};e.prototype.peek=function(){var e=this.computeValue(false);if(Sr(e))throw e.cause;return e};e.prototype.set=function(e){if(this.setter){Ot(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?");this.isRunningSetter=true;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=false}}else Ot(false,"production"!=="production"&&"[ComputedValue '"+this.name+"'] It is not possible to assign a new value to a computed value.")};e.prototype.trackAndCompute=function(){if(p()){_({object:this.scope,type:"compute",name:this.name})}var e=this.value;var t=this.dependenciesState===Pr.NOT_TRACKING;var r=this.computeValue(true);var n=t||Sr(e)||Sr(r)||!this.equals(e,r);if(n){this.value=r}return n};e.prototype.computeValue=function(e){this.isComputing=true;tr.computationDepth++;var t;if(e){t=Ar(this,this.derivation,this.scope)}else{if(tr.disableErrorBoundaries===true){t=this.derivation.call(this.scope)}else{try{t=this.derivation.call(this.scope)}catch(e){t=new Mr(e)}}}tr.computationDepth--;this.isComputing=false;return t};e.prototype.suspend=function(){kr(this);this.value=undefined};e.prototype.observe=function(e,t){var r=this;var n=true;var i=undefined;return Z(function(){var a=r.get();if(!n||t){var o=Ir();e({type:"update",object:r,newValue:a,oldValue:i});Rr(o)}n=false;i=a})};e.prototype.warnAboutUntrackedRead=function(){if(true)return;if(this.requiresReaction===true){At("[mobx] Computed value "+this.name+" is read outside a reactive context")}if(this.isTracing!==xr.NONE){console.log("[mobx.trace] '"+this.name+"' is being read outside a reactive context. Doing a full recompute")}if(tr.computedRequiresReaction){console.warn("[mobx] Computed value "+this.name+" is being read outside a reactive context. Doing a full recompute")}};e.prototype.toJSON=function(){return this.get()};e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"};e.prototype.valueOf=function(){return Jt(this.get())};return e}();K.prototype[Kt()]=K.prototype.valueOf;var J=zt("ComputedValue",K);function $(e){return e.interceptors!==undefined&&e.interceptors.length>0}function ee(e,t){var r=e.interceptors||(e.interceptors=[]);r.push(t);return It(function(){var e=r.indexOf(t);if(e!==-1)r.splice(e,1)})}function te(e,t){var r=Ir();try{var n=e.interceptors;if(n)for(var i=0,a=n.length;i<a;i++){t=n[i](t);Ot(!t||t.type,"Intercept handlers should return nothing or a change object");if(!t)break}return t}finally{Rr(r)}}function re(e){return e.changeListeners!==undefined&&e.changeListeners.length>0}function ne(e,t){var r=e.changeListeners||(e.changeListeners=[]);r.push(t);return It(function(){var e=r.indexOf(t);if(e!==-1)r.splice(e,1)})}function ie(e,t){var r=Ir();var n=e.changeListeners;if(!n)return;n=n.slice();for(var i=0,a=n.length;i<a;i++){n[i](t)}Rr(r)}var ae={};ft();var oe=function(e){a(t,e);function t(t,r,n,i){if(n===void 0){n="ObservableValue@"+Dt()}if(i===void 0){i=true}var a=e.call(this,n)||this;a.enhancer=r;a.hasUnreportedChange=false;a.value=r(t,undefined,n);if(i&&p()){_({type:"create",name:a.name,newValue:""+a.value})}return a}t.prototype.dehanceValue=function(e){if(this.dehancer!==undefined)return this.dehancer(e);return e};t.prototype.set=function(e){var t=this.value;e=this.prepareNewValue(e);if(e!==ae){var r=p();if(r){y({type:"update",name:this.name,newValue:e,oldValue:t})}this.setNewValue(e);if(r)g()}};t.prototype.prepareNewValue=function(e){Dr(this);if($(this)){var t=te(this,{object:this,type:"update",newValue:e});if(!t)return ae;e=t.newValue}e=this.enhancer(e,this.value,this.name);return this.value!==e?e:ae};t.prototype.setNewValue=function(e){var t=this.value;this.value=e;this.reportChanged();if(re(this)){ie(this,{type:"update",object:this,newValue:e,oldValue:t})}};t.prototype.get=function(){this.reportObserved();return this.dehanceValue(this.value)};t.prototype.intercept=function(e){return ee(this,e)};t.prototype.observe=function(e,t){if(t)e({object:this,type:"update",newValue:this.value,oldValue:undefined});return ne(this,e)};t.prototype.toJSON=function(){return this.get()};t.prototype.toString=function(){return this.name+"["+this.value+"]"};t.prototype.valueOf=function(){return Jt(this.get())};return t}(lt);oe.prototype[Kt()]=oe.prototype.valueOf;var se=zt("ObservableValue",oe);var ue=function(){function e(e,t,r){this.target=e;this.name=t;this.defaultEnhancer=r;this.values={}}e.prototype.read=function(e,t){if(this.target!==e){this.illegalAccess(e,t);return}return this.values[t].get()};e.prototype.write=function(e,t,r){var n=this.target;if(n!==e){this.illegalAccess(e,t);return}var i=this.values[t];if(i instanceof K){i.set(r);return}if($(this)){var a=te(this,{type:"update",object:n,name:t,newValue:r});if(!a)return;r=a.newValue}r=i.prepareNewValue(r);if(r!==ae){var s=re(this);var u=p();var a=s||u?{type:"update",object:n,oldValue:i.value,name:t,newValue:r}:null;if(u)y(o({},a,{name:this.name,key:t}));i.setNewValue(r);if(s)ie(this,a);if(u)g()}};e.prototype.remove=function(e){if(!this.values[e])return;var t=this.target;if($(this)){var r=te(this,{object:t,name:e,type:"remove"});if(!r)return}try{_r();var n=re(this);var i=p();var a=this.values[e].get();if(this.keys)this.keys.remove(e);delete this.values[e];delete this.target[e];var r=n||i?{type:"remove",object:t,oldValue:a,name:e}:null;if(i)y(o({},r,{name:this.name,key:e}));if(n)ie(this,r);if(i)g()}finally{yr()}};e.prototype.illegalAccess=function(e,t){return At("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")};e.prototype.observe=function(e,t){"production"!=="production"&&Ot(t!==true,"`observe` doesn't support the fire immediately property for observable objects.");return ne(this,e)};e.prototype.intercept=function(e){return ee(this,e)};e.prototype.getKeys=function(){var e=this;if(this.keys===undefined){this.keys=new gt(Object.keys(this.values).filter(function(t){return e.values[t]instanceof oe}),Ue,"keys("+this.name+")",true)}return this.keys.slice()};return e}();function le(e,t,r){if(t===void 0){t=""}if(r===void 0){r=ze}var n=e.$mobx;if(n)return n;"production"!=="production"&&Ot(Object.isExtensible(e),"Cannot make the designated object observable; it is not extensible");if(!jt(e))t=(e.constructor.name||"ObservableObject")+"@"+Dt();if(!t)t="ObservableObject@"+Dt();n=new ue(e,t,r);Vt(e,"$mobx",n);return n}function ce(e,t,r,n){var i=le(e);Yt(e,t);if($(i)){var a=te(i,{object:e,name:t,type:"add",newValue:r});if(!a)return;r=a.newValue}var o=i.values[t]=new oe(r,n,i.name+"."+t,false);r=o.value;Object.defineProperty(e,t,ve(t));if(i.keys)i.keys.push(t);ye(i,e,t,r)}function fe(e,t,r){var n=le(e);r.name=n.name+"."+t;r.context=e;n.values[t]=new K(r);Object.defineProperty(e,t,_e(t))}var de={};var he={};function ve(e){return de[e]||(de[e]={configurable:true,enumerable:true,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}function pe(e){var t=e.$mobx;if(!t){d(e);return e.$mobx}return t}function _e(e){return he[e]||(he[e]={configurable:true,enumerable:false,get:function(){return pe(this).read(this,e)},set:function(t){pe(this).write(this,e,t)}})}function ye(e,t,r,n){var i=re(e);var a=p();var s=i||a?{type:"add",object:t,name:r,newValue:n}:null;if(a)y(o({},s,{name:e.name,key:r}));if(i)ie(e,s);if(a)g()}var me=zt("ObservableObjectAdministration",ue);function ge(e){if(Bt(e)){d(e);return me(e.$mobx)}return false}function Fe(t){var r=h(true,function(e,r,n,i,a){var o=n?n.initializer?n.initializer.call(e):n.value:undefined;ce(e,r,o,t)});var n=typeof e!=="undefined"&&e.env&&"production"!=="production"?function e(){if(arguments.length<2)return At("Incorrect decorator invocation. @observable decorator doesn't expect any arguments");return r.apply(null,arguments)}:r;n.enhancer=t;return n}function we(e,t){if(e===null||e===undefined)return false;if(t!==undefined){if(false){}if(ge(e)){var r=e.$mobx;return r.values&&!!r.values[t]}return false}return ge(e)||!!e.$mobx||ct(e)||Zr(e)||J(e)}function be(e){if(arguments.length!==1)At("production"!=="production"&&"isObservable expects only 1 argument. Use isObservableProp to inspect the observability of a property");return we(e)}function Ce(e,t){if(typeof t!=="string")return At("production"!=="production"&&"expected a property name as second argument");return we(e,t)}function Pe(e,t){if(e===null||e===undefined)return false;if(t!==undefined){if(ge(e)===false)return false;if(!e.$mobx.values[t])return false;var r=nt(e,t);return J(r)}return J(e)}function xe(e){if(arguments.length>1)return At("production"!=="production"&&"isComputed expects only 1 argument. Use isObservableProp to inspect the observability of a property");return Pe(e)}function Me(e,t){if(typeof t!=="string")return At("production"!=="production"&&"isComputed expected a property name as second argument");return Pe(e,t)}var Se=h(false,function(e,t,r,n,i){var a=r.get,s=r.set;var u=i[0]||{};fe(e,t,o({},u,{get:a,set:s}))});var Te=Se({equals:z.structural});var Ee=function e(t,r,n){if(typeof r==="string"){return Se.apply(null,arguments)}if(t!==null&&typeof t==="object"&&arguments.length===1){return Se.apply(null,arguments)}if(false){}var i=typeof r==="object"?r:{};i.get=t;i.set=typeof r==="function"?r:i.set;i.name=i.name||t.name||"";return new K(i)};Ee.struct=Te;function De(e,t,r){Lt("'extendShallowObservable' is deprecated, use 'extendObservable(target, props, { deep: false })' instead");return Ae(e,t,r,ke)}function Ae(e,t,r,n){if(false){var i}n=Ie(n);var a=n.defaultDecorator||(n.deep===false?je:Ne);le(e,n.name,a.enhancer);_r();try{for(var i in t){var o=Object.getOwnPropertyDescriptor(t,i);if(false){}var s=r&&i in r?r[i]:o.get?Se:a;if(false){}var u=s(e,i,o,true);if(u)Object.defineProperty(e,i,u)}}finally{yr()}return e}var Oe={deep:true,name:undefined,defaultDecorator:undefined};var ke={deep:false,name:undefined,defaultDecorator:undefined};Object.freeze(Oe);Object.freeze(ke);function Le(e){if(!/^(deep|name|defaultDecorator)$/.test(e))At("invalid option for (extend)observable: "+e)}function Ie(e){if(e===null||e===undefined)return Oe;if(typeof e==="string")return{name:e,deep:true};if(false){}return e}function Re(e){return e.defaultDecorator?e.defaultDecorator.enhancer:e.deep===false?Ue:ze}var Ne=Fe(ze);var Be=Fe(Ze);var je=Fe(Ue);var Ge=Fe(We);function He(e,t,r){if(typeof arguments[1]==="string"){return Ne.apply(null,arguments)}if(be(e))return e;var n=jt(e)?Xe.object(e,t,r):Array.isArray(e)?Xe.array(e,t):Wt(e)?Xe.map(e,t):e;if(n!==e)return n;At("production"!=="production"&&"The provided value could not be converted into an observable. If you want just create an observable reference to the object use 'observable.box(value)'")}var Ve={box:function(e,t){if(arguments.length>2)Ye("box");var r=Ie(t);return new oe(e,Re(r),r.name)},shallowBox:function(e,t){if(arguments.length>2)Ye("shallowBox");Lt("observable.shallowBox","observable.box(value, { deep: false })");return Xe.box(e,{name:t,deep:false})},array:function(e,t){if(arguments.length>2)Ye("array");var r=Ie(t);return new gt(e,Re(r),r.name)},shallowArray:function(e,t){if(arguments.length>2)Ye("shallowArray");Lt("observable.shallowArray","observable.array(values, { deep: false })");return Xe.array(e,{name:t,deep:false})},map:function(e,t){if(arguments.length>2)Ye("map");var r=Ie(t);return new tt(e,Re(r),r.name)},shallowMap:function(e,t){if(arguments.length>2)Ye("shallowMap");Lt("observable.shallowMap","observable.map(values, { deep: false })");return Xe.map(e,{name:t,deep:false})},object:function(e,t,r){if(typeof arguments[1]==="string")Ye("object");var n=Ie(r);return Ae({},e,t,n)},shallowObject:function(e,t){if(typeof arguments[1]==="string")Ye("shallowObject");Lt("observable.shallowObject","observable.object(values, {}, { deep: false })");return Xe.object(e,{},{name:t,deep:false})},ref:je,shallow:Be,deep:Ne,struct:Ge};var Xe=He;Object.keys(Ve).forEach(function(e){return Xe[e]=Ve[e]});function Ye(e){At("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}function ze(e,t,r){if(be(e))return e;if(Array.isArray(e))return Xe.array(e,{name:r});if(jt(e))return Xe.object(e,undefined,{name:r});if(Wt(e))return Xe.map(e,{name:r});return e}function Ze(e,t,r){if(e===undefined||e===null)return e;if(ge(e)||xt(e)||rt(e))return e;if(Array.isArray(e))return Xe.array(e,{name:r,deep:false});if(jt(e))return Xe.object(e,undefined,{name:r,deep:false});if(Wt(e))return Xe.map(e,{name:r,deep:false});return At("production"!=="production"&&"The shallow modifier / decorator can only used in combination with arrays, objects and maps")}function Ue(e){return e}function We(e,t,r){if(false){}if(N(e,t))return t;return e}function qe(){return typeof Symbol==="function"&&Symbol.iterator||"@@iterator"}function Qe(e,t){Vt(e,qe(),t)}function Ke(e){e[qe()]=Je;return e}function Je(){return this}function $e(e,t){if(t===void 0){t=undefined}_r();try{return e.apply(t)}finally{yr()}}var et={};var tt=function(){function e(e,t,r){if(t===void 0){t=ze}if(r===void 0){r="ObservableMap@"+Dt()}this.enhancer=t;this.name=r;this.$mobx=et;this._keys=new gt(undefined,Ue,this.name+".keys()",true);if(typeof Map!=="function"){throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js")}this._data=new Map;this._hasMap=new Map;this.merge(e)}e.prototype._has=function(e){return this._data.has(e)};e.prototype.has=function(e){if(this._hasMap.has(e))return this._hasMap.get(e).get();return this._updateHasMapEntry(e,false).get()};e.prototype.set=function(e,t){var r=this._has(e);if($(this)){var n=te(this,{type:r?"update":"add",object:this,newValue:t,name:e});if(!n)return this;t=n.newValue}if(r){this._updateValue(e,t)}else{this._addValue(e,t)}return this};e.prototype.delete=function(e){var t=this;if($(this)){var r=te(this,{type:"delete",object:this,name:e});if(!r)return false}if(this._has(e)){var n=p();var i=re(this);var r=i||n?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;if(n)y(o({},r,{name:this.name,key:e}));$e(function(){t._keys.remove(e);t._updateHasMapEntry(e,false);var r=t._data.get(e);r.setNewValue(undefined);t._data.delete(e)});if(i)ie(this,r);if(n)g();return true}return false};e.prototype._updateHasMapEntry=function(e,t){var r=this._hasMap.get(e);if(r){r.setNewValue(t)}else{r=new oe(t,Ue,this.name+"."+e+"?",false);this._hasMap.set(e,r)}return r};e.prototype._updateValue=function(e,t){var r=this._data.get(e);t=r.prepareNewValue(t);if(t!==ae){var n=p();var i=re(this);var a=i||n?{type:"update",object:this,oldValue:r.value,name:e,newValue:t}:null;if(n)y(o({},a,{name:this.name,key:e}));r.setNewValue(t);if(i)ie(this,a);if(n)g()}};e.prototype._addValue=function(e,t){var r=this;$e(function(){var n=new oe(t,r.enhancer,r.name+"."+e,false);r._data.set(e,n);t=n.value;r._updateHasMapEntry(e,true);r._keys.push(e)});var n=p();var i=re(this);var a=i||n?{type:"add",object:this,name:e,newValue:t}:null;if(n)y(o({},a,{name:this.name,key:e}));if(i)ie(this,a);if(n)g()};e.prototype.get=function(e){if(this.has(e))return this.dehanceValue(this._data.get(e).get());return this.dehanceValue(undefined)};e.prototype.dehanceValue=function(e){if(this.dehancer!==undefined){return this.dehancer(e)}return e};e.prototype.keys=function(){return this._keys[qe()]()};e.prototype.values=function(){var e=this;var t=0;return Ke({next:function(){return t<e._keys.length?{value:e.get(e._keys[t++]),done:false}:{value:undefined,done:true}}})};e.prototype.entries=function(){var e=this;var t=0;return Ke({next:function(){if(t<e._keys.length){var r=e._keys[t++];return{value:[r,e.get(r)],done:false}}return{done:true}}})};e.prototype.forEach=function(e,t){var r=this;this._keys.forEach(function(n){return e.call(t,r.get(n),n,r)})};e.prototype.merge=function(e){var t=this;if(rt(e)){e=e.toJS()}$e(function(){if(jt(e))Object.keys(e).forEach(function(r){return t.set(r,e[r])});else if(Array.isArray(e))e.forEach(function(e){var r=s(e,2),n=r[0],i=r[1];return t.set(n,i)});else if(Wt(e))e.forEach(function(e,r){return t.set(r,e)});else if(e!==null&&e!==undefined)At("Cannot initialize map from "+e)});return this};e.prototype.clear=function(){var e=this;$e(function(){Lr(function(){e._keys.slice().forEach(function(t){return e.delete(t)})})})};e.prototype.replace=function(e){var t=this;$e(function(){var r=qt(e);var n=t._keys;var i=n.filter(function(e){return r.indexOf(e)===-1});i.forEach(function(e){return t.delete(e)});t.merge(e)});return this};Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:true,configurable:true});e.prototype.toPOJO=function(){var e=this;var t={};this._keys.forEach(function(r){return t[""+r]=e.get(r)});return t};e.prototype.toJS=function(){var e=this;var t=new Map;this._keys.forEach(function(r){return t.set(r,e.get(r))});return t};e.prototype.toJSON=function(){return this.toPOJO()};e.prototype.toString=function(){var e=this;return this.name+"[{ "+this._keys.map(function(t){return t+": "+(""+e.get(t))}).join(", ")+" }]"};e.prototype.observe=function(e,t){"production"!=="production"&&Ot(t!==true,"`observe` doesn't support fireImmediately=true in combination with maps.");return ne(this,e)};e.prototype.intercept=function(e){return ee(this,e)};return e}();Qe(tt.prototype,function(){return this.entries()});Vt(tt.prototype,typeof Symbol!=="undefined"?Symbol.toStringTag:"@@toStringTag","Map");var rt=zt("ObservableMap",tt);function nt(e,t){if(typeof e==="object"&&e!==null){if(xt(e)){if(t!==undefined)At("production"!=="production"&&"It is not possible to get index atoms from arrays");return e.$mobx.atom}if(rt(e)){var r=e;if(t===undefined)return nt(r._keys);var n=r._data.get(t)||r._hasMap.get(t);if(!n)At("production"!=="production"&&"the entry '"+t+"' does not exist in the observable map '"+at(e)+"'");return n}d(e);if(t&&!e.$mobx)e[t];if(ge(e)){if(!t)return At("production"!=="production"&&"please specify a property");var n=e.$mobx.values[t];if(!n)At("production"!=="production"&&"no observable property '"+t+"' found on the observable object '"+at(e)+"'");return n}if(ct(e)||J(e)||Zr(e)){return e}}else if(typeof e==="function"){if(Zr(e.$mobx)){return e.$mobx}}return At("production"!=="production"&&"Cannot obtain atom from "+e)}function it(e,t){if(!e)At("Expecting some object");if(t!==undefined)return it(nt(e,t));if(ct(e)||J(e)||Zr(e))return e;if(rt(e))return e;d(e);if(e.$mobx)return e.$mobx;At("production"!=="production"&&"Cannot obtain administration from "+e)}function at(e,t){var r;if(t!==undefined)r=nt(e,t);else if(ge(e)||rt(e))r=it(e);else r=nt(e);return r.name}function ot(e,t,r){return ut("onBecomeObserved",e,t,r)}function st(e,t,r){return ut("onBecomeUnobserved",e,t,r)}function ut(e,t,r,n){var i=typeof r==="string"?nt(t,r):nt(t);var a=typeof r==="string"?n:r;var o=i[e];if(typeof o!=="function")return At("production"!=="production"&&"Not an atom that can be (un)observed");i[e]=function(){o.call(this);a.call(this)};return function(){i[e]=o}}var lt;var ct;function ft(){if(lt)return;lt=function(){function e(e){if(e===void 0){e="Atom@"+Dt()}this.name=e;this.isPendingUnobservation=false;this.isBeingObserved=false;this.observers=[];this.observersIndexes={};this.diffValue=0;this.lastAccessedBy=0;this.lowestObserverState=Pr.NOT_TRACKING}e.prototype.onBecomeUnobserved=function(){};e.prototype.onBecomeObserved=function(){};e.prototype.reportObserved=function(){return mr(this)};e.prototype.reportChanged=function(){_r();gr(this);yr()};e.prototype.toString=function(){return this.name};return e}();ct=zt("Atom",lt)}function dt(e,t,r){if(t===void 0){t=Rt}if(r===void 0){r=Rt}var n=new lt(e);ot(n,t);st(n,r);return n}var ht=1e4;var vt=function(){var e=false;var t={};Object.defineProperty(t,"0",{set:function(){e=true}});Object.create(t)["0"]=1;return e===false}();var pt=0;var _t=function(){function e(){}return e}();function yt(e,t){if(typeof Object["setPrototypeOf"]!=="undefined"){Object["setPrototypeOf"](e.prototype,t)}else if(typeof e.prototype.__proto__!=="undefined"){e.prototype.__proto__=t}else{e["prototype"]=t}}yt(_t,Array.prototype);if(Object.isFrozen(Array)){["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(_t.prototype,e,{configurable:true,writable:true,value:Array.prototype[e]})})}var mt=function(){function e(e,t,r,n){this.array=r;this.owned=n;this.values=[];this.lastKnownLength=0;this.atom=new lt(e||"ObservableArray@"+Dt());this.enhancer=function(r,n){return t(r,n,e+"[..]")}}e.prototype.dehanceValue=function(e){if(this.dehancer!==undefined)return this.dehancer(e);return e};e.prototype.dehanceValues=function(e){if(this.dehancer!==undefined&&this.values.length>0)return e.map(this.dehancer);return e};e.prototype.intercept=function(e){return ee(this,e)};e.prototype.observe=function(e,t){if(t===void 0){t=false}if(t){e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0})}return ne(this,e)};e.prototype.getArrayLength=function(){this.atom.reportObserved();return this.values.length};e.prototype.setArrayLength=function(e){if(typeof e!=="number"||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e===t)return;else if(e>t){var r=new Array(e-t);for(var n=0;n<e-t;n++)r[n]=undefined;this.spliceWithArray(t,0,r)}else this.spliceWithArray(e,t-e)};e.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t;if(t>0&&e+t+1>pt)Ct(e+t+1)};e.prototype.spliceWithArray=function(e,t,r){var n=this;Dr(this.atom);var i=this.values.length;if(e===undefined)e=0;else if(e>i)e=i;else if(e<0)e=Math.max(0,i+e);if(arguments.length===1)t=i-e;else if(t===undefined||t===null)t=0;else t=Math.max(0,Math.min(t,i-e));if(r===undefined)r=St;if($(this)){var a=te(this,{object:this.array,type:"splice",index:e,removedCount:t,added:r});if(!a)return St;t=a.removedCount;r=a.added}r=r.length===0?r:r.map(function(e){return n.enhancer(e,undefined)});var o=r.length-t;this.updateArrayLength(i,o);var s=this.spliceItemsIntoValues(e,t,r);if(t!==0||r.length!==0)this.notifyArraySplice(e,r,s);return this.dehanceValues(s)};e.prototype.spliceItemsIntoValues=function(e,t,r){if(r.length<ht){return(i=this.values).splice.apply(i,u([e,t],r))}else{var n=this.values.slice(e,e+t);this.values=this.values.slice(0,e).concat(r,this.values.slice(e+t));return n}var i};e.prototype.notifyArrayChildUpdate=function(e,t,r){var n=!this.owned&&p();var i=re(this);var a=i||n?{object:this.array,type:"update",index:e,newValue:t,oldValue:r}:null;if(n)y(o({},a,{name:this.atom.name}));this.atom.reportChanged();if(i)ie(this,a);if(n)g()};e.prototype.notifyArraySplice=function(e,t,r){var n=!this.owned&&p();var i=re(this);var a=i||n?{object:this.array,type:"splice",index:e,removed:r,added:t,removedCount:r.length,addedCount:t.length}:null;if(n)y(o({},a,{name:this.atom.name}));this.atom.reportChanged();if(i)ie(this,a);if(n)g()};return e}();var gt=function(e){a(t,e);function t(t,r,n,i){if(n===void 0){n="ObservableArray@"+Dt()}if(i===void 0){i=false}var a=e.call(this)||this;var o=new mt(n,r,a,i);Vt(a,"$mobx",o);if(t&&t.length){a.spliceWithArray(0,0,t)}if(vt){Object.defineProperty(o.array,"0",Ft)}return a}t.prototype.intercept=function(e){return this.$mobx.intercept(e)};t.prototype.observe=function(e,t){if(t===void 0){t=false}return this.$mobx.observe(e,t)};t.prototype.clear=function(){return this.splice(0)};t.prototype.concat=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}this.$mobx.atom.reportObserved();return Array.prototype.concat.apply(this.peek(),e.map(function(e){return xt(e)?e.peek():e}))};t.prototype.replace=function(e){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,e)};t.prototype.toJS=function(){return this.slice()};t.prototype.toJSON=function(){return this.toJS()};t.prototype.peek=function(){this.$mobx.atom.reportObserved();return this.$mobx.dehanceValues(this.$mobx.values)};t.prototype.find=function(e,t,r){if(r===void 0){r=0}if(arguments.length===3)Lt("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return n===-1?undefined:this.get(n)};t.prototype.findIndex=function(e,t,r){if(r===void 0){r=0}if(arguments.length===3)Lt("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");var n=this.peek(),i=n.length;for(var a=r;a<i;a++)if(e.call(t,n[a],a,this))return a;return-1};t.prototype.splice=function(e,t){var r=[];for(var n=2;n<arguments.length;n++){r[n-2]=arguments[n]}switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(e);case 2:return this.$mobx.spliceWithArray(e,t)}return this.$mobx.spliceWithArray(e,t,r)};t.prototype.spliceWithArray=function(e,t,r){return this.$mobx.spliceWithArray(e,t,r)};t.prototype.push=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=this.$mobx;r.spliceWithArray(r.values.length,0,e);return r.values.length};t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]};t.prototype.shift=function(){return this.splice(0,1)[0]};t.prototype.unshift=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=this.$mobx;r.spliceWithArray(0,0,e);return r.values.length};t.prototype.reverse=function(){var e=this.slice();return e.reverse.apply(e,arguments)};t.prototype.sort=function(e){var t=this.slice();return t.sort.apply(t,arguments)};t.prototype.remove=function(e){var t=this.$mobx.dehanceValues(this.$mobx.values).indexOf(e);if(t>-1){this.splice(t,1);return true}return false};t.prototype.move=function(e,t){Lt("observableArray.move is deprecated, use .slice() & .replace() instead");function r(e){if(e<0){throw new Error("[mobx.array] Index out of bounds: "+e+" is negative")}var t=this.$mobx.values.length;if(e>=t){throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}}r.call(this,e);r.call(this,t);if(e===t){return}var n=this.$mobx.values;var i;if(e<t){i=u(n.slice(0,e),n.slice(e+1,t+1),[n[e]],n.slice(t+1))}else{i=u(n.slice(0,t),[n[e]],n.slice(t,e),n.slice(e+1))}this.replace(i)};t.prototype.get=function(e){var t=this.$mobx;if(t){if(e<t.values.length){t.atom.reportObserved();return t.dehanceValue(t.values[e])}console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}return undefined};t.prototype.set=function(e,t){var r=this.$mobx;var n=r.values;if(e<n.length){Dr(r.atom);var i=n[e];if($(r)){var a=te(r,{type:"update",object:this,index:e,newValue:t});if(!a)return;t=a.newValue}t=r.enhancer(t,i);var o=t!==i;if(o){n[e]=t;r.notifyArrayChildUpdate(e,t,i)}}else if(e===n.length){r.spliceWithArray(e,0,[t])}else{throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+n.length)}};return t}(_t);Qe(gt.prototype,function(){this.$mobx.atom.reportObserved();var e=this;var t=0;return Ke({next:function(){return t<e.length?{value:e[t++],done:false}:{done:true,value:undefined}}})});Object.defineProperty(gt.prototype,"length",{enumerable:false,configurable:true,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}});if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Ht(gt.prototype,typeof Symbol!=="undefined"?Symbol.toStringTag:"@@toStringTag","Array")}["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];Ot(typeof t==="function","Base function not defined on Array prototype: '"+e+"'");Ht(gt.prototype,e,function(){return t.apply(this.peek(),arguments)})});Gt(gt.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var Ft=wt(0);function wt(e){return{enumerable:false,configurable:false,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function bt(e){Object.defineProperty(gt.prototype,""+e,wt(e))}function Ct(e){for(var t=pt;t<e;t++)bt(t);pt=e}Ct(1e3);var Pt=zt("ObservableArrayAdministration",mt);function xt(e){return Bt(e)&&Pt(e.$mobx)}var Mt="An invariant failed, however the error is obfuscated because this is an production build.";var St=[];Object.freeze(St);var Tt={};Object.freeze(Tt);function Et(){return typeof window!=="undefined"?window:n}function Dt(){return++tr.mobxGuid}function At(e){Ot(false,e);throw"X"}function Ot(e,t){if(!e)throw new Error("[mobx] "+(t||Mt))}var kt=[];function Lt(e,t){if(true)return false;if(t){return Lt("'"+e+"', use '"+t+"' instead.")}if(kt.indexOf(e)!==-1)return false;kt.push(e);console.error("[mobx] Deprecated: "+e);return true}function It(e){var t=false;return function(){if(t)return;t=true;return e.apply(this,arguments)}}var Rt=function(){};function Nt(e){var t=[];e.forEach(function(e){if(t.indexOf(e)===-1)t.push(e)});return t}function Bt(e){return e!==null&&typeof e==="object"}function jt(e){if(e===null||typeof e!=="object")return false;var t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function Gt(e,t){for(var r=0;r<t.length;r++){Ht(e,t[r],e[t[r]])}}function Ht(e,t,r){Object.defineProperty(e,t,{enumerable:false,writable:true,configurable:true,value:r})}function Vt(e,t,r){Object.defineProperty(e,t,{enumerable:false,writable:false,configurable:true,value:r})}function Xt(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!r||r.configurable!==false&&r.writable!==false}function Yt(e,t){if(false){}}function zt(e,t){var r="isMobX"+e;t.prototype[r]=true;return function(e){return Bt(e)&&e[r]===true}}function Zt(e,t){return typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}function Ut(e){return Array.isArray(e)||xt(e)}function Wt(e){if(Et().Map!==undefined&&e instanceof Et().Map)return true;return false}function qt(e){if(jt(e))return Object.keys(e);if(Array.isArray(e))return e.map(function(e){var t=s(e,1),r=t[0];return r});if(Wt(e)||rt(e))return Qt(e.keys());return At("Cannot get keys from '"+e+"'")}function Qt(e){var t=[];while(true){var r=e.next();if(r.done)break;t.push(r.value)}return t}function Kt(){return typeof Symbol==="function"&&Symbol.toPrimitive||"@@toPrimitive"}function Jt(e){return e===null?null:typeof e==="object"?""+e:e}var $t=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","disableErrorBoundaries","runId"];var er=function(){function e(){this.version=5;this.trackingDerivation=null;this.computationDepth=0;this.runId=0;this.mobxGuid=0;this.inBatch=0;this.pendingUnobservations=[];this.pendingReactions=[];this.isRunningReactions=false;this.allowStateChanges=true;this.enforceActions=false;this.spyListeners=[];this.globalReactionErrorHandlers=[];this.computedRequiresReaction=false;this.disableErrorBoundaries=false}return e}();var tr=new er;var rr=false;{var nr=Et();if(!nr.__mobxInstanceCount){nr.__mobxInstanceCount=1}else{nr.__mobxInstanceCount++;setTimeout(function(){if(!rr){At("production"!=="production"&&"There are multiple mobx instances active. This might lead to unexpected results. See https://github.com/mobxjs/mobx/issues/1082 for details.")}},1)}}function ir(){rr=true;Et().__mobxInstanceCount--}function ar(){return tr}function or(){var e=new er;for(var t in e)if($t.indexOf(t)===-1)tr[t]=e[t];tr.allowStateChanges=!tr.enforceActions}function sr(e,t){return ur(nt(e,t))}function ur(e){var t={name:e.name};if(e.observing&&e.observing.length>0)t.dependencies=Nt(e.observing).map(ur);return t}function lr(e,t){return cr(nt(e,t))}function cr(e){var t={name:e.name};if(fr(e))t.observers=dr(e).map(cr);return t}function fr(e){return e.observers&&e.observers.length>0}function dr(e){return e.observers}function hr(e,t){var r=e.observers.length;if(r){e.observersIndexes[t.__mapid]=r}e.observers[r]=t;if(e.lowestObserverState>t.dependenciesState)e.lowestObserverState=t.dependenciesState}function vr(e,t){if(e.observers.length===1){e.observers.length=0;pr(e)}else{var r=e.observers;var n=e.observersIndexes;var i=r.pop();if(i!==t){var a=n[t.__mapid]||0;if(a){n[i.__mapid]=a}else{delete n[i.__mapid]}r[a]=i}delete n[t.__mapid]}}function pr(e){if(e.isPendingUnobservation===false){e.isPendingUnobservation=true;tr.pendingUnobservations.push(e)}}function _r(){tr.inBatch++}function yr(){if(--tr.inBatch===0){Yr();var e=tr.pendingUnobservations;for(var t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=false;if(r.observers.length===0){if(r.isBeingObserved){r.isBeingObserved=false;r.onBecomeUnobserved()}if(r instanceof K){r.suspend()}}}tr.pendingUnobservations=[]}}function mr(e){var t=tr.trackingDerivation;if(t!==null){if(t.runId!==e.lastAccessedBy){e.lastAccessedBy=t.runId;t.newObserving[t.unboundDepsCount++]=e;if(!e.isBeingObserved){e.isBeingObserved=true;e.onBecomeObserved()}}return true}else if(e.observers.length===0&&tr.inBatch>0){pr(e)}return false}function gr(e){if(e.lowestObserverState===Pr.STALE)return;e.lowestObserverState=Pr.STALE;var t=e.observers;var r=t.length;while(r--){var n=t[r];if(n.dependenciesState===Pr.UP_TO_DATE){if(n.isTracing!==xr.NONE){br(n,e)}n.onBecomeStale()}n.dependenciesState=Pr.STALE}}function Fr(e){if(e.lowestObserverState===Pr.STALE)return;e.lowestObserverState=Pr.STALE;var t=e.observers;var r=t.length;while(r--){var n=t[r];if(n.dependenciesState===Pr.POSSIBLY_STALE)n.dependenciesState=Pr.STALE;else if(n.dependenciesState===Pr.UP_TO_DATE)e.lowestObserverState=Pr.UP_TO_DATE}}function wr(e){if(e.lowestObserverState!==Pr.UP_TO_DATE)return;e.lowestObserverState=Pr.POSSIBLY_STALE;var t=e.observers;var r=t.length;while(r--){var n=t[r];if(n.dependenciesState===Pr.UP_TO_DATE){n.dependenciesState=Pr.POSSIBLY_STALE;if(n.isTracing!==xr.NONE){br(n,e)}n.onBecomeStale()}}}function br(e,t){console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'");if(e.isTracing===xr.BREAK){var r=[];Cr(sr(e),r,1);new Function("debugger;\n/*\nTracing '"+e.name+"'\n\nYou are entering this break point because derivation '"+e.name+"' is being traced and '"+t.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(e instanceof K?e.derivation.toString():"")+"\n\nThe dependencies for this derivation are:\n\n"+r.join("\n")+"\n*/\n    ")()}}function Cr(e,t,r){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(r).join("\t")+e.name);if(e.dependencies)e.dependencies.forEach(function(e){return Cr(e,t,r+1)})}var Pr;(function(e){e[e["NOT_TRACKING"]=-1]="NOT_TRACKING";e[e["UP_TO_DATE"]=0]="UP_TO_DATE";e[e["POSSIBLY_STALE"]=1]="POSSIBLY_STALE";e[e["STALE"]=2]="STALE"})(Pr||(Pr={}));var xr;(function(e){e[e["NONE"]=0]="NONE";e[e["LOG"]=1]="LOG";e[e["BREAK"]=2]="BREAK"})(xr||(xr={}));var Mr=function(){function e(e){this.cause=e}return e}();function Sr(e){return e instanceof Mr}function Tr(e){switch(e.dependenciesState){case Pr.UP_TO_DATE:return false;case Pr.NOT_TRACKING:case Pr.STALE:return true;case Pr.POSSIBLY_STALE:{var t=Ir();var r=e.observing,n=r.length;for(var i=0;i<n;i++){var a=r[i];if(J(a)){if(tr.disableErrorBoundaries){a.get()}else{try{a.get()}catch(e){Rr(t);return true}}if(e.dependenciesState===Pr.STALE){Rr(t);return true}}}Nr(e);Rr(t);return false}}}function Er(){return tr.trackingDerivation!==null}function Dr(e){var t=e.observers.length>0;if(tr.computationDepth>0&&t)At("production"!=="production"&&"Computed values are not allowed to cause side effects by changing observables that are already being observed. Tried to modify: "+e.name);if(!tr.allowStateChanges&&(t||tr.enforceActions==="strict"))At("production"!=="production"&&(tr.enforceActions?"Since strict-mode is enabled, changing observed observable values outside actions is not allowed. Please wrap the code in an `action` if this change is intended. Tried to modify: ":"Side effects like changing state are not allowed at this point. Are you trying to modify state from, for example, the render function of a React component? Tried to modify: ")+e.name)}function Ar(e,t,r){Nr(e);e.newObserving=new Array(e.observing.length+100);e.unboundDepsCount=0;e.runId=++tr.runId;var n=tr.trackingDerivation;tr.trackingDerivation=e;var i;if(tr.disableErrorBoundaries===true){i=t.call(r)}else{try{i=t.call(r)}catch(e){i=new Mr(e)}}tr.trackingDerivation=n;Or(e);return i}function Or(e){var t=e.observing;var r=e.observing=e.newObserving;var n=Pr.UP_TO_DATE;var i=0,a=e.unboundDepsCount;for(var o=0;o<a;o++){var s=r[o];if(s.diffValue===0){s.diffValue=1;if(i!==o)r[i]=s;i++}if(s.dependenciesState>n){n=s.dependenciesState}}r.length=i;e.newObserving=null;a=t.length;while(a--){var s=t[a];if(s.diffValue===0){vr(s,e)}s.diffValue=0}while(i--){var s=r[i];if(s.diffValue===1){s.diffValue=0;hr(s,e)}}if(n!==Pr.UP_TO_DATE){e.dependenciesState=n;e.onBecomeStale()}}function kr(e){var t=e.observing;e.observing=[];var r=t.length;while(r--)vr(t[r],e);e.dependenciesState=Pr.NOT_TRACKING}function Lr(e){var t=Ir();var r=e();Rr(t);return r}function Ir(){var e=tr.trackingDerivation;tr.trackingDerivation=null;return e}function Rr(e){tr.trackingDerivation=e}function Nr(e){if(e.dependenciesState===Pr.UP_TO_DATE)return;e.dependenciesState=Pr.UP_TO_DATE;var t=e.observing;var r=t.length;while(r--)t[r].lowestObserverState=Pr.UP_TO_DATE}function Br(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=false;if(typeof e[e.length-1]==="boolean")r=e.pop();var n=jr(e);if(!n){return At("production"!=="production"&&"'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly")}if(n.isTracing===xr.NONE){console.log("[mobx.trace] '"+n.name+"' tracing enabled")}n.isTracing=r?xr.BREAK:xr.LOG}function jr(e){switch(e.length){case 0:return tr.trackingDerivation;case 1:return nt(e[0]);case 2:return nt(e[0],e[1])}}var Gr=function(){function e(e,t,r){if(e===void 0){e="Reaction@"+Dt()}this.name=e;this.onInvalidate=t;this.errorHandler=r;this.observing=[];this.newObserving=[];this.dependenciesState=Pr.NOT_TRACKING;this.diffValue=0;this.runId=0;this.unboundDepsCount=0;this.__mapid="#"+Dt();this.isDisposed=false;this._isScheduled=false;this._isTrackPending=false;this._isRunning=false;this.isTracing=xr.NONE}e.prototype.onBecomeStale=function(){this.schedule()};e.prototype.schedule=function(){if(!this._isScheduled){this._isScheduled=true;tr.pendingReactions.push(this);Yr()}};e.prototype.isScheduled=function(){return this._isScheduled};e.prototype.runReaction=function(){if(!this.isDisposed){_r();this._isScheduled=false;if(Tr(this)){this._isTrackPending=true;try{this.onInvalidate();if(this._isTrackPending&&p()){_({name:this.name,type:"scheduled-reaction"})}}catch(e){this.reportExceptionInDerivation(e)}}yr()}};e.prototype.track=function(e){_r();var t=p();var r;if(t){r=Date.now();y({name:this.name,type:"reaction"})}this._isRunning=true;var n=Ar(this,e,undefined);this._isRunning=false;this._isTrackPending=false;if(this.isDisposed){kr(this)}if(Sr(n))this.reportExceptionInDerivation(n.cause);if(t){g({time:Date.now()-r})}yr()};e.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler){this.errorHandler(e,this);return}if(tr.disableErrorBoundaries)throw e;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this;console.error(r,e);if(p()){_({type:"error",name:this.name,message:r,error:""+e})}tr.globalReactionErrorHandlers.forEach(function(r){return r(e,t)})};e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;if(!this._isRunning){_r();kr(this);yr()}}};e.prototype.getDisposer=function(){var e=this.dispose.bind(this);e.$mobx=this;return e};e.prototype.toString=function(){return"Reaction["+this.name+"]"};e.prototype.trace=function(e){if(e===void 0){e=false}Br(this,e)};return e}();function Hr(e){tr.globalReactionErrorHandlers.push(e);return function(){var t=tr.globalReactionErrorHandlers.indexOf(e);if(t>=0)tr.globalReactionErrorHandlers.splice(t,1)}}var Vr=100;var Xr=function(e){return e()};function Yr(){if(tr.inBatch>0||tr.isRunningReactions)return;Xr(zr)}function zr(){tr.isRunningReactions=true;var e=tr.pendingReactions;var t=0;while(e.length>0){if(++t===Vr){console.error("Reaction doesn't converge to a stable state after "+Vr+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0]));e.splice(0)}var r=e.splice(0);for(var n=0,i=r.length;n<i;n++)r[n].runReaction()}tr.isRunningReactions=false}var Zr=zt("Reaction",Gr);function Ur(e){var t=Xr;Xr=function(r){return e(function(){return t(r)})}}function Wr(e,t,r,n){if(typeof r==="function")return Qr(e,t,r,n);else return qr(e,t,r)}function qr(e,t,r){return it(e).observe(t,r)}function Qr(e,t,r,n){return it(e,t).observe(r,n)}function Kr(e,t,r){if(typeof r==="function")return $r(e,t,r);else return Jr(e,t)}function Jr(e,t){return it(e).intercept(t)}function $r(e,t,r){return it(e,t).intercept(r)}function en(e,t,r){if(arguments.length===1||t&&typeof t==="object")return rn(e,t);return tn(e,t,r||{})}function tn(e,t,r){var n;if(typeof r.timeout==="number"){n=setTimeout(function(){if(!a.$mobx.isDisposed){a();var e=new Error("WHEN_TIMEOUT");if(r.onError)r.onError(e);else throw e}},r.timeout)}r.name=r.name||"When@"+Dt();var i=w(r.name+"-effect",t);var a=Z(function(t){if(e()){t.dispose();if(n)clearTimeout(n);i()}},r);return a}function rn(e,t){if(false){}var r;var n=new Promise(function(n,i){var a=tn(e,n,o({},t,{onError:i}));r=function(){a();i("WHEN_CANCELLED")}});n.cancel=r;return n}function nn(e){if(ge(e)){return e.$mobx.getKeys()}if(rt(e)){return e._keys.slice()}return At("production"!=="production"&&"'keys()' can only be used on observable objects and maps")}function an(e){if(ge(e)){return nn(e).map(function(t){return e[t]})}if(rt(e)){return nn(e).map(function(t){return e.get(t)})}if(xt(e)){return e.slice()}return At("production"!=="production"&&"'values()' can only be used on observable objects, arrays and maps")}function on(e,t,r){if(arguments.length===2){_r();var n=t;try{for(var i in n)on(e,i,n[i])}finally{yr()}return}if(ge(e)){var a=e.$mobx;var o=a.values[t];if(o){o.set(r)}else{ce(e,t,r,a.defaultEnhancer)}}else if(rt(e)){e.set(t,r)}else if(xt(e)){if(typeof t!=="number")t=parseInt(t,10);Ot(t>=0,"Not a valid index: '"+t+"'");_r();if(t>=e.length)e.length=t+1;e[t]=r;yr()}else{return At("production"!=="production"&&"'set()' can only be used on observable objects, arrays and maps")}}function sn(e,t){if(ge(e)){e.$mobx.remove(t)}else if(rt(e)){e.delete(t)}else if(xt(e)){if(typeof t!=="number")t=parseInt(t,10);Ot(t>=0,"Not a valid index: '"+t+"'");e.splice(t,1)}else{return At("production"!=="production"&&"'remove()' can only be used on observable objects, arrays and maps")}}function un(e,t){if(ge(e)){var r=it(e);r.getKeys();return r.values[t]instanceof oe}else if(rt(e)){return e.has(t)}else if(xt(e)){return t>=0&&t<e.length}else{return At("production"!=="production"&&"'has()' can only be used on observable objects, arrays and maps")}}function ln(e,t){if(!un(e,t))return undefined;if(ge(e)){return e[t]}else if(rt(e)){return e.get(t)}else if(xt(e)){return e[t]}else{return At("production"!=="production"&&"'get()' can only be used on observable objects, arrays and maps")}}function cn(e,t){"production"!=="production"&&Ot(jt(t),"Decorators should be a key value map");var r=typeof e==="function"?e.prototype:e;for(var n in t){var i=t[n];"production"!=="production"&&Ot(typeof i==="function","Decorate: expected a decorator function for '"+n+"'");var a=Object.getOwnPropertyDescriptor(r,n);var o=i(r,n,a);if(o)Object.defineProperty(r,n,o)}return e}function fn(e){var t=e.enforceActions,r=e.computedRequiresReaction,n=e.disableErrorBoundaries,i=e.arrayBuffer,a=e.reactionScheduler;if(t!==undefined){if(typeof t!=="boolean"&&t!=="strict")return fail("Invalid configuration for 'enforceActions': "+t);tr.enforceActions=t;tr.allowStateChanges=t===true||t==="strict"?false:true}if(r!==undefined){tr.computedRequiresReaction=!!r}if(e.isolateGlobalState===true){ir()}if(n!==undefined){if(n===true)console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on.");tr.disableErrorBoundaries=!!n}if(typeof i==="number"){Ct(i)}if(a){Ur(a)}}var dn=0;function hn(e){if(arguments.length!==1)At("production"&&"Flow expects one 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var r=this;var n=arguments;var i=++dn;var a=O(t+" - runid: "+i+" - init",e).apply(r,n);var o;var s=undefined;var u=new Promise(function(e,r){var n=0;o=r;function u(e){s=undefined;var o;try{o=O(t+" - runid: "+i+" - yield "+n++,a.next).call(a,e)}catch(e){return r(e)}c(o)}function l(e){s=undefined;var o;try{o=O(t+" - runid: "+i+" - yield "+n++,a.throw).call(a,e)}catch(e){return r(e)}c(o)}function c(t){if(t&&typeof t.then==="function"){t.then(c,r);return}if(t.done)return e(t.value);s=Promise.resolve(t.value);return s.then(u,l)}u(undefined)});u.cancel=O(t+" - runid: "+i+" - cancel",function(){try{if(s)vn(s);var e=a.return();var t=Promise.resolve(e.value);t.then(Rt,Rt);vn(t);o(new Error("FLOW_CANCELLED"))}catch(e){o(e)}});return u}}function vn(e){if(typeof e.cancel==="function")e.cancel()}var pn={detectCycles:true,exportMapsAsObjects:true};function _n(e,t,r){if(r===void 0){r=[]}if(typeof t==="boolean")t={detectCycles:t};if(!t)t=pn;var n=t.detectCycles===true;function i(t){if(n)r.push([e,t]);return t}if(be(e)){if(n&&r===null)r=[];if(n&&e!==null&&typeof e==="object"){for(var a=0,o=r.length;a<o;a++)if(r[a][0]===e)return r[a][1]}if(xt(e)){var s=i([]);var u=e.map(function(e){return _n(e,t,r)});s.length=u.length;for(var a=0,o=u.length;a<o;a++)s[a]=u[a];return s}if(ge(e)){var s=i({});nn(e);for(var l in e){s[l]=_n(e[l],t,r)}return s}if(rt(e)){if(t.exportMapsAsObjects===false){var c=i(new Map);e.forEach(function(e,n){c.set(n,_n(e,t,r))});return c}else{var f=i({});e.forEach(function(e,n){f[n]=_n(e,t,r)});return f}}if(se(e))return _n(e.get(),t,r)}return e}function yn(e,t,r){var n;if(rt(e)||xt(e)||se(e)){n=it(e)}else if(ge(e)){if(typeof t!=="string")return At("production"!=="production"&&"InterceptReads can only be used with a specific property, not with an object in general");n=it(e,t)}else{return At("production"!=="production"&&"Expected observable map, object or array as first array")}if(n.dehancer!==undefined)return At("production"!=="production"&&"An intercept reader was already established");n.dehancer=typeof t==="function"?t:r;return function(){n.dehancer=undefined}}try{"production"}catch(t){var mn=typeof window!=="undefined"?window:n;if(typeof e==="undefined")mn.process={};mn.process.env={}}(function(){function e(){}if(e.name!=="testCodeMinification"&&"production"!=="production"){console.warn("[mobx] you are running a minified build, but 'process.env.NODE_ENV' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();if(typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__==="object"){__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:F,extras:{getDebugName:at}})}if(false){var gn}}).call(this,r(329),r(152))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n;function i(){if(typeof n==="undefined"){var e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var r=e[t].getAttribute("src");if(Freedo.defined(r)&&r.indexOf("FreedoX.js")!==-1){n=r.substr(0,r.indexOf("FreedoX.js"))}}}return n}t.getFreedoXPath=i},function(e,t,r){var n=r(3);var i=n.navigator;e.exports=i&&i.userAgent||""},function(e,t,r){"use strict";var n=r(3);var i=r(10);var a=r(57);var o=r(88);var s=r(20);var u=r(49);var l=r(4);var c=r(51);var f=r(34);var d=r(8);var h=r(183);var v=r(53).f;var p=r(9).f;var _=r(131);var y=r(68);var m="ArrayBuffer";var g="DataView";var F="prototype";var w="Wrong length!";var b="Wrong index!";var C=n[m];var P=n[g];var x=n.Math;var M=n.RangeError;var S=n.Infinity;var T=C;var E=x.abs;var D=x.pow;var A=x.floor;var O=x.log;var k=x.LN2;var L="buffer";var I="byteLength";var R="byteOffset";var N=i?"_b":L;var B=i?"_l":I;var j=i?"_o":R;function G(e,t,r){var n=new Array(r);var i=r*8-t-1;var a=(1<<i)-1;var o=a>>1;var s=t===23?D(2,-24)-D(2,-77):0;var u=0;var l=e<0||e===0&&1/e<0?1:0;var c,f,d;e=E(e);if(e!=e||e===S){f=e!=e?1:0;c=a}else{c=A(O(e)/k);if(e*(d=D(2,-c))<1){c--;d*=2}if(c+o>=1){e+=s/d}else{e+=s*D(2,1-o)}if(e*d>=2){c++;d/=2}if(c+o>=a){f=0;c=a}else if(c+o>=1){f=(e*d-1)*D(2,t);c=c+o}else{f=e*D(2,o-1)*D(2,t);c=0}}for(;t>=8;n[u++]=f&255,f/=256,t-=8);c=c<<t|f;i+=t;for(;i>0;n[u++]=c&255,c/=256,i-=8);n[--u]|=l*128;return n}function H(e,t,r){var n=r*8-t-1;var i=(1<<n)-1;var a=i>>1;var o=n-7;var s=r-1;var u=e[s--];var l=u&127;var c;u>>=7;for(;o>0;l=l*256+e[s],s--,o-=8);c=l&(1<<-o)-1;l>>=-o;o+=t;for(;o>0;c=c*256+e[s],s--,o-=8);if(l===0){l=1-a}else if(l===i){return c?NaN:u?-S:S}else{c=c+D(2,t);l=l-a}return(u?-1:1)*c*D(2,l-t)}function V(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function X(e){return[e&255]}function Y(e){return[e&255,e>>8&255]}function z(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}function Z(e){return G(e,52,8)}function U(e){return G(e,23,4)}function W(e,t,r){p(e[F],t,{get:function(){return this[r]}})}function q(e,t,r,n){var i=+r;var a=h(i);if(a+t>e[B])throw M(b);var o=e[N]._b;var s=a+e[j];var u=o.slice(s,s+t);return n?u:u.reverse()}function Q(e,t,r,n,i,a){var o=+r;var s=h(o);if(s+t>e[B])throw M(b);var u=e[N]._b;var l=s+e[j];var c=n(+i);for(var f=0;f<t;f++)u[l+f]=c[a?f:t-f-1]}if(!o.ABV){C=function e(t){c(this,C,m);var r=h(t);this._b=_.call(new Array(r),0);this[B]=r};P=function e(t,r,n){c(this,P,g);c(t,C,g);var i=t[B];var a=f(r);if(a<0||a>i)throw M("Wrong offset!");n=n===undefined?i-a:d(n);if(a+n>i)throw M(w);this[N]=t;this[j]=a;this[B]=n};if(i){W(C,I,"_l");W(P,L,"_b");W(P,I,"_l");W(P,R,"_o")}u(P[F],{getInt8:function e(t){return q(this,1,t)[0]<<24>>24},getUint8:function e(t){return q(this,1,t)[0]},getInt16:function e(t){var r=q(this,2,t,arguments[1]);return(r[1]<<8|r[0])<<16>>16},getUint16:function e(t){var r=q(this,2,t,arguments[1]);return r[1]<<8|r[0]},getInt32:function e(t){return V(q(this,4,t,arguments[1]))},getUint32:function e(t){return V(q(this,4,t,arguments[1]))>>>0},getFloat32:function e(t){return H(q(this,4,t,arguments[1]),23,4)},getFloat64:function e(t){return H(q(this,8,t,arguments[1]),52,8)},setInt8:function e(t,r){Q(this,1,t,X,r)},setUint8:function e(t,r){Q(this,1,t,X,r)},setInt16:function e(t,r){Q(this,2,t,Y,r,arguments[2])},setUint16:function e(t,r){Q(this,2,t,Y,r,arguments[2])},setInt32:function e(t,r){Q(this,4,t,z,r,arguments[2])},setUint32:function e(t,r){Q(this,4,t,z,r,arguments[2])},setFloat32:function e(t,r){Q(this,4,t,U,r,arguments[2])},setFloat64:function e(t,r){Q(this,8,t,Z,r,arguments[2])}})}else{if(!l(function(){C(1)})||!l(function(){new C(-1)})||l(function(){new C;new C(1.5);new C(NaN);return C.name!=m})){C=function e(t){c(this,C);return new T(h(t))};var K=C[F]=T[F];for(var J=v(T),$=0,ee;J.length>$;){if(!((ee=J[$++])in C))s(C,ee,T[ee])}if(!a)K.constructor=C}var te=new P(new C(2));var re=P[F].setInt8;te.setInt8(0,2147483648);te.setInt8(1,2147483649);if(te.getInt8(0)||!te.getInt8(1))u(P[F],{setInt8:function e(t,r){re.call(this,t,r<<24>>24)},setUint8:function e(t,r){re.call(this,t,r<<24>>24)}},true)}y(C,m);y(P,g);s(P[F],o.VIEW,true);t[m]=C;t[g]=P},function(e,t,r){"use strict";var n=r(15);function i(e){var t,r;this.promise=new e(function(e,n){if(t!==undefined||r!==undefined)throw TypeError("Bad Promise constructor");t=e;r=n});this.resolve=n(t);this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t,r){var n=r(3);var i=r(129).set;var a=n.MutationObserver||n.WebKitMutationObserver;var o=n.process;var s=n.Promise;var u=r(27)(o)=="process";e.exports=function(){var e,t,r;var l=function(){var n,i;if(u&&(n=o.domain))n.exit();while(e){i=e.fn;e=e.next;try{i()}catch(n){if(e)r();else t=undefined;throw n}}t=undefined;if(n)n.enter()};if(u){r=function(){o.nextTick(l)}}else if(a&&!(n.navigator&&n.navigator.standalone)){var c=true;var f=document.createTextNode("");new a(l).observe(f,{characterData:true});r=function(){f.data=c=!c}}else if(s&&s.resolve){var d=s.resolve();r=function(){d.then(l)}}else{r=function(){i.call(n,l)}}return function(n){var i={fn:n,next:undefined};if(t)t.next=i;if(!e){e=i;r()}t=i}}},function(e,t,r){var n=r(28);var i=r(202);var a=r(147);var o=r(151);var s=r(3);var u=s.process;var l=s.setImmediate;var c=s.clearImmediate;var f=s.MessageChannel;var d=s.Dispatch;var h=0;var v={};var p="onreadystatechange";var _,y,m;var g=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e];t()}};var F=function(e){g.call(e.data)};if(!l||!c){l=function e(t){var r=[];var n=1;while(arguments.length>n)r.push(arguments[n++]);v[++h]=function(){i(typeof t=="function"?t:Function(t),r)};_(h);return h};c=function e(t){delete v[t]};if(r(27)(u)=="process"){_=function(e){u.nextTick(n(g,e,1))}}else if(d&&d.now){_=function(e){d.now(n(g,e,1))}}else if(f){y=new f;m=y.port2;y.port1.onmessage=F;_=n(m.postMessage,m,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){_=function(e){s.postMessage(e+"","*")};s.addEventListener("message",F,false)}else if(p in o("script")){_=function(e){a.appendChild(o("script"))[p]=function(){a.removeChild(this);g.call(e)}}}else{_=function(e){setTimeout(n(g,e,1),0)}}}e.exports={set:l,clear:c}},function(e,t,r){"use strict";var n=r(45);var i=r(192);var a=r(66);var o=r(23);e.exports=r(139)(Array,"Array",function(e,t){this._t=o(e);this._i=0;this._k=t},function(){var e=this._t;var t=this._k;var r=this._i++;if(!e||r>=e.length){this._t=undefined;return i(1)}if(t=="keys")return i(0,r);if(t=="values")return i(0,e[r]);return i(0,[r,e[r]])},"values");a.Arguments=a.Array;n("keys");n("values");n("entries")},function(e,t,r){"use strict";var n=r(12);var i=r(55);var a=r(8);e.exports=function e(t){var r=n(this);var o=a(r.length);var s=arguments.length;var u=i(s>1?arguments[1]:undefined,o);var l=s>2?arguments[2]:undefined;var c=l===undefined?o:i(l,o);while(c>u)r[u++]=t;return r}},function(e,t,r){var n=r(444);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(74);var i=r(7)("iterator");var a=r(66);e.exports=r(37).getIteratorMethod=function(e){if(e!=undefined)return e[i]||e["@@iterator"]||a[n(e)]}},function(e,t,r){"use strict";var n=r(9);var i=r(59);e.exports=function(e,t,r){if(t in e)n.f(e,t,i(0,r));else e[t]=r}},function(e,t,r){var n=r(66);var i=r(7)("iterator");var a=Array.prototype;e.exports=function(e){return e!==undefined&&(n.Array===e||a[i]===e)}},function(e,t,r){var n=r(7)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{t[n]=false;return!"/./"[e](t)}catch(e){}}return true}},function(e,t,r){var n=r(94);var i=r(35);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},function(e,t,r){"use strict";var n=r(54);var i=r(59);var a=r(68);var o={};r(20)(o,r(7)("iterator"),function(){return this});e.exports=function(e,t,r){e.prototype=n(o,{next:i(1,r)});a(e,t+" Iterator")}},function(e,t,r){"use strict";var n=r(57);var i=r(0);var a=r(19);var o=r(20);var s=r(66);var u=r(138);var l=r(68);var c=r(21);var f=r(7)("iterator");var d=!([].keys&&"next"in[].keys());var h="@@iterator";var v="keys";var p="values";var _=function(){return this};e.exports=function(e,t,r,y,m,g,F){u(r,t,y);var w=function(e){if(!d&&e in x)return x[e];switch(e){case v:return function t(){return new r(this,e)};case p:return function t(){return new r(this,e)}}return function t(){return new r(this,e)}};var b=t+" Iterator";var C=m==p;var P=false;var x=e.prototype;var M=x[f]||x[h]||m&&x[m];var S=M||w(m);var T=m?!C?S:w("entries"):undefined;var E=t=="Array"?x.entries||M:M;var D,A,O;if(E){O=c(E.call(new e));if(O!==Object.prototype&&O.next){l(O,b,true);if(!n&&typeof O[f]!="function")o(O,f,_)}}if(C&&M&&M.name!==p){P=true;S=function e(){return M.call(this)}}if((!n||F)&&(d||P||!x[f])){o(x,f,S)}s[t]=S;s[b]=_;if(m){D={values:C?S:w(p),keys:g?S:w(v),entries:T};if(F)for(A in D){if(!(A in x))a(x,A,D[A])}else i(i.P+i.F*(d||P),t,D)}return D}},function(e,t,r){var n=r(34);var i=r(35);e.exports=function(e){return function(t,r){var a=String(i(t));var o=n(r);var s=a.length;var u,l;if(o<0||o>=s)return e?"":undefined;u=a.charCodeAt(o);return u<55296||u>56319||o+1===s||(l=a.charCodeAt(o+1))<56320||l>57343?e?a.charAt(o):u:e?a.slice(o,o+2):(u-55296<<10)+(l-56320)+65536}}},function(e,t){var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||r(-2e-17)!=-2e-17?function e(t){return(t=+t)==0?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(e,t){e.exports=Math.sign||function e(t){return(t=+t)==0||t!=t?t:t<0?-1:1}},function(e,t,r){"use strict";var n=r(34);var i=r(35);e.exports=function e(t){var r=String(i(this));var a="";var o=n(t);if(o<0||o==Infinity)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(r+=r))if(o&1)a+=r;return a}},function(e,t,r){var n=r(5);var i=r(146).set;e.exports=function(e,t,r){var a=t.constructor;var o;if(a!==r&&typeof a=="function"&&(o=a.prototype)!==r.prototype&&n(o)&&i){i(e,o)}return e}},function(e,t){e.exports="\t\n\v\f\r   ᠎    "+"         　\u2028\u2029\ufeff"},function(e,t,r){var n=r(5);var i=r(2);var a=function(e,t){i(e);if(!n(t)&&t!==null)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=r(28)(Function.call,r(22).f(Object.prototype,"__proto__").set,2);n(e,[]);t=!(e instanceof Array)}catch(e){t=true}return function e(r,i){a(r,i);if(t)r.__proto__=i;else n(r,i);return r}}({},false):undefined),check:a}},function(e,t,r){var n=r(3).document;e.exports=n&&n.documentElement},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(98)("keys");var i=r(58);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(3);var i=r(37);var a=r(57);var o=r(208);var s=r(9).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:n.Symbol||{});if(e.charAt(0)!="_"&&!(e in t))s(t,e,{value:o.f(e)})}},function(e,t,r){var n=r(5);var i=r(3).document;var a=n(i)&&n(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t,r){var n=r(40);var i=r(30);var a=r(99);e.exports=function(e,t){n(e);if(i(t)&&t.constructor===e)return t;var r=a.f(e);var o=r.resolve;o(t);return r.promise}},function(e,t){e.exports=function(e){try{return{e:false,v:e()}}catch(e){return{e:true,v:e}}}},function(e,t,r){var n=r(48);var i=r(223);var a=r(168);var o=r(121);var s=r(16);var u=s.process;var l=s.setImmediate;var c=s.clearImmediate;var f=s.MessageChannel;var d=s.Dispatch;var h=0;var v={};var p="onreadystatechange";var _,y,m;var g=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e];t()}};var F=function(e){g.call(e.data)};if(!l||!c){l=function e(t){var r=[];var n=1;while(arguments.length>n)r.push(arguments[n++]);v[++h]=function(){i(typeof t=="function"?t:Function(t),r)};_(h);return h};c=function e(t){delete v[t]};if(r(71)(u)=="process"){_=function(e){u.nextTick(n(g,e,1))}}else if(d&&d.now){_=function(e){d.now(n(g,e,1))}}else if(f){y=new f;m=y.port2;y.port1.onmessage=F;_=n(m.postMessage,m,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){_=function(e){s.postMessage(e+"","*")};s.addEventListener("message",F,false)}else if(p in o("script")){_=function(e){a.appendChild(o("script"))[p]=function(){a.removeChild(this);g.call(e)}}}else{_=function(e){setTimeout(n(g,e,1),0)}}}e.exports={set:l,clear:c}},function(e,t,r){var n=r(40);var i=r(73);var a=r(13)("species");e.exports=function(e,t){var r=n(e).constructor;var o;return r===undefined||(o=n(r)[a])==undefined?t:i(o)}},function(e,t,r){var n=r(169);var i=r(110).concat("length","prototype");t.f=Object.getOwnPropertyNames||function e(t){return n(t,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdEraseGroundManager=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._scene=this._viewer.scene;this._egs=[];this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._options={}}(0,o.default)(e,[{key:"eraseGroudByPointsArray",value:function e(t,r){this._options["id_"+this._egs.length]={points:t,color:Freedo.clone(r,true)};var n=new Freedo.GroundErasePrimitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolygonGeometry({polygonHierarchy:new Freedo.PolygonHierarchy(t)}),attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(r[0],r[1],r[2],1))}}),classificationType:Freedo.ClassificationType.TERRAIN,debugShowShadowVolume:false});var i=this._scene.groundPrimitives.add(n);this._egs.push(i);this._event.raiseEvent("dataAdded",{points:t,color:r,erasePrimitive:n});this._scene.requestRender()}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){for(var t in this._egs){this._scene.groundPrimitives.remove(this._egs[t])}this._options={};this._event.raiseEvent("dataRemoved",{});this._scene.requestRender()}},{key:"dispose",value:function e(){this.reset();this._eventHelper.removeAll()}},{key:"eraseGroudOptions",get:function e(){return this._options}}]);return e}();t.FdEraseGroundManager=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdGeologySimulationManager=undefined;var n=r(104);var i=f(n);var a=r(1);var o=f(a);var s=r(6);var u=f(s);var l=r(272);var c=r(270);function f(e){return e&&e.__esModule?e:{default:e}}var d=new Freedo.Cartesian2(100,50);var h=new Freedo.Cartesian3;var v=new Freedo.Cartesian3;var p=new Freedo.Cartesian3;var _=new Freedo.Cartographic;var y=new Uint16Array([0,1,2,2,1,3]);var m=function(){function e(t,r,n){(0,o.default)(this,e);this._drillDataArray=[];this._layerTextureMap=new i.default;this._bottomName="bottom";this._debugPointEntities=undefined;this._groundErasers=[];this._geologyPrimitives=[];this._scene=t;this._lastHeightPrimitive=undefined;this._drillOptions={};if(!Freedo.defined(n)){n="../../sampleData/GeologySimulation/GeoTexture/"}var a=r.Geology.Drill;for(var s=a.length-1;s>=0;s--){this._drillDataArray.push(new l.DrillData(a[s]));var u=a[s].layer;for(var c=u.length-1;c>=0;c--){var f=u[c];if(!this._layerTextureMap.has(f.name)){this._layerTextureMap.set(f.name,n+f.texture)}}}this._layerTextureMap.set(this._bottomName,n+"bottom.jpg");var d=[];for(var s=this._drillDataArray.length-1;s>=0;s--){d.push(this._drillDataArray[s].cartesianOnZeroHeight)}this._extent=Freedo.BoundingSphere.fromPoints(d);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper}(0,u.default)(e,[{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"interpolateCartographics",value:function e(t,r){var n=this._scene.terrainProvider;var i=[];for(var a=1;a<t.length;a++){var o=(0,c.interpolate)(t[a-1],t[a],r);if(a===1){i.push(t[a-1])}for(var s=0;s<o.length;s++){i.push(o[s])}i.push(t[a])}if(!Freedo.defined(n)){return Freedo.when.resolve(i)}return Freedo.sampleTerrainMostDetailed(n,i)}},{key:"addDebugPoints",value:function e(t){if(!this._debugPointEntities){this._debugPointEntities=[];for(var r=this._drillDataArray.length-1;r>=0;r--){var n=t.entities.add({position:this._drillDataArray[r].cartesian,point:{pixelSize:5,color:Freedo.Color.WHITE,outlineColor:Freedo.Color.BLACK,outlineWidth:2,heightReference:Freedo.HeightReference.CLAMP_TO_GROUND}});this._debugPointEntities.push(n)}}}},{key:"addGeologyPrimitives",value:function e(t,r,n,i,a,o){var s=this._scene.primitives;var u=[];var l=[];var f=0;var m=0;for(var g=0;g<t.length-1;++g){var F=t[g];var w=t[g+1];var b=Freedo.Cartesian3.fromRadians(F.pos.longitude,F.pos.latitude,F.pos.height);var C=Freedo.Cartesian3.fromRadians(w.pos.longitude,w.pos.latitude,w.pos.height);var P=Freedo.Cartesian3.distance(b,C);A(F,w,m,P,r,n,i);m+=P;_.longitude+=F.pos.longitude;_.latitude+=F.pos.latitude}_.longitude+=t[g].pos.longitude;_.latitude+=t[g].pos.latitude;_.longitude/=t.length;_.latitude/=t.length;var x=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(_);var M;if(i){var S=new Freedo.Cartesian3;Freedo.Cartesian3.multiplyByScalar(x,f,S);M=Freedo.Matrix4.fromTranslation(S)}else{M=Freedo.Matrix4.IDENTITY}if(a){I()}for(var g=0;g<l.length;g++){var T=l[g];var E=this._layerTextureMap.get(T.name);L(E,T,o)}D(t);return u;function D(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r].waterDepth;var i=e[r].pos;t.push(Freedo.Cartesian3.fromRadians(i.longitude,i.latitude,i.height-n))}var a=new Freedo.PolylineGeometry({positions:t,width:3,vertexFormat:Freedo.VertexFormat.POSITION_ONLY,followSurface:false});var o=s.add(new Freedo.Primitive({asynchronous:false,geometryInstances:[new Freedo.GeometryInstance({geometry:a,modelMatrix:M,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(.3,.3,1,1))}})],appearance:new Freedo.PolylineColorAppearance({translucent:false})}));u.push(o)}function A(e,t,r,n,i,a){var o=1;var s,u;var l=0;var c=0;var f,d;var h,v;for(s=0;s<e.layers.length;++s){f=e.layers[s];d=f.name;for(u=0;u<t.layers.length;++u){h=t.layers[u];if(!h.allocated){h.allocated=true;v=h.name;if(v===d){k(o++,d,e.pos,l,l+f.thickness,t.pos,c,c+h.thickness,r,n,i,a);l+=f.thickness;c+=h.thickness;break}else{k(o++,v,e.pos,l,l,t.pos,c,c+h.thickness,r,n,i,a);c+=h.thickness}}}if(u===t.layers.length){k(o++,d,e.pos,l,l+f.thickness,t.pos,c,c,r,n,i,a);l+=f.thickness}}for(;u<t.layers.length;++u){h=t.layers[u];if(!h.allocated){h.allocated=true;v=h.name;k(o++,v,e.pos,l,l,t.pos,c,c+h.thickness,r,n,i,a);c+=h.thickness}}}function O(e,t,r){Freedo.Cartesian3.subtract(t,e,h);Freedo.Cartesian3.subtract(r,t,v);Freedo.Cartesian3.cross(h,v,p);return Freedo.Cartesian3.normalize(p,p)}function k(e,t,r,n,i,a,o,s,u,h,v,p){var _=undefined;var m=Math.max(i,s);if(f<m){f=m}for(var g=0;g<l.length;g++){if(!l[g].closed&&l[g].name===t&&Freedo.Math.equalsEpsilon(l[g].depth0,n,Freedo.Math.EPSILON5)&&Freedo.Math.equalsEpsilon(l[g].depth1,i,Freedo.Math.EPSILON5)){_=l[g];break}}if(!Freedo.defined(_)){_=[];_.closed=false;_.name=t;l.push(_)}_.depth0=o;_.depth1=s;if(o===s){_.closed=true}var F=Freedo.Cartesian3.fromRadians(r.longitude,r.latitude,r.height);var w=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(r);var b=Freedo.Cartesian3.fromRadians(a.longitude,a.latitude,a.height);var C=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(a);var P=(0,c.getOffsetPoint)(F,w,-n);var x=(0,c.getOffsetPoint)(b,C,-o);var M=(0,c.getOffsetPoint)(F,w,-i);var S=(0,c.getOffsetPoint)(b,C,-s);var T=new Float64Array(4*3);T[0]=P.x;T[1]=P.y;T[2]=P.z;T[3]=M.x;T[4]=M.y;T[5]=M.z;T[6]=x.x;T[7]=x.y;T[8]=x.z;T[9]=S.x;T[10]=S.y;T[11]=S.z;var E=new Float32Array(4*2);E[0]=u/v/d.x;E[1]=n/p/d.y;E[2]=u/v/d.x;E[3]=i/p/d.y;E[4]=(u+h)/v/d.x;E[5]=o/p/d.y;E[6]=(u+h)/v/d.x;E[7]=s/p/d.y;var D=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:T}),st:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})},indices:y,primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(T)});D.layerName=t;D.layerIndex=e;D.depth=(Math.abs(i-n)+Math.abs(s-o))/2;_.push(D)}function L(e,t,r){var n=[];var i;var a=0;for(var o=0;o<t.length;++o){n.push(new Freedo.GeometryInstance({geometry:t[o],modelMatrix:M}));i=t[o].layerName;a+=t[o].depth}a/=t.length;var l=s.add(new Freedo.Primitive({asynchronous:false,geometryInstances:n,appearance:new Freedo.MaterialAppearance({materialSupport:Freedo.MaterialAppearance.MaterialSupport.TEXTURED,material:new Freedo.Material({fabric:{materials:{first:{type:"DiffuseMap",uniforms:{image:e,repeat:d}}},uniforms:{value:[0,0,0,1]},components:{diffuse:"vec3(value[0][0], value[0][1], value[1][0]) + first.diffuse",alpha:"value[1][1]"}}})})}));l.layerName=i;l.drillsInfo=r;l.depth=a;l.offsetMatrix=M;u.push(l)}function I(){var e=[];e.closed=false;e.name="bottom";l.push(e);var r=[];var n=new Freedo.Cartesian3;for(var i=0;i<t.length;++i){var a=t[i];var o=a.layers[a.layers.length-1].depth;var s=Freedo.Cartesian3.fromRadians(a.pos.longitude,a.pos.latitude,a.pos.height);var u=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(a.pos);var f=(0,c.getOffsetPoint)(s,u,-o);r.push(f);Freedo.Cartesian3.add(n,f,n)}Freedo.Cartesian3.multiplyByScalar(n,1/r.length,n);var h=r.length+1;var v=new Float64Array(h*3);var p=new Float32Array(h*2);var _=Number.POSITIVE_INFINITY;var y=Number.POSITIVE_INFINITY;v[0]=n.x;v[1]=n.y;v[2]=n.z;p[0]=0;p[1]=0;for(var i=0;i<h-1;i++){v[3+i*3+0]=r[i].x;v[3+i*3+1]=r[i].y;v[3+i*3+2]=r[i].z;p[2+i*2+0]=(r[i].x-n.x)/d.x;if(p[2+i*2+0]<_){_=p[2+i*2+0]}p[2+i*2+1]=(r[i].y-n.y)/d.y;if(p[2+i*2+1]<y){y=p[2+i*2+1]}}for(var i=0;i<h;i++){p[i*2+0]-=_;p[i*2+1]-=y}var m=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v}),st:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:p})},primitiveType:Freedo.PrimitiveType.TRIANGLE_FAN,boundingSphere:Freedo.BoundingSphere.fromVertices(v)});m.layerName="bottom";e.push(m)}}},{key:"getSimulateDrills",value:function e(t,r){var n=[];if(this._drillDataArray.length>0){var i=this;for(var a=0,o=t.length;a<o;a++){var s=(0,c.getSimulateDrill)(i,t[a],r);if(Freedo.defined(s)){n.push({pos:t[a],waterDepth:s.waterDepth,drillInfo:s.drillsInfo,layers:s.layers})}}}return n}},{key:"getRelativeDrillsInfo",value:function e(t,r){var n=[];for(var i=0;i<r.length-1;i++){var a=r[i];var o=-1,s=Number.MAX_VALUE;for(var u=0;u<t.length;u++){var l=a.longitude-t[u].pos.longitude;var c=a.latitude-t[u].pos.latitude;var f=l*l+c*c;if(s>f){o=u;s=f}}var d={drillsInfo:t[o].drillInfo,pos:t[o].pos};n.push(d)}return n}},{key:"addGeologySimulation",value:function e(t,r,n,i,a,o){if(t.length<2){throw new Freedo.RuntimeError("The input points array is invalid !")}r=Freedo.defaultValue(r,1);n=Freedo.defaultValue(n,5);i=Freedo.defaultValue(i,5);a=Freedo.defaultValue(a,false);o=Freedo.defaultValue(o,true);if(t.length>2){var s=t[0];t.push(s)}this._drillOptions["Drill"+(new Date).getTime()]={points:t,maxStep:r,tileS:n,tileT:i,flipUp:a,buildBottom:o};var u=this._scene;u.globe.depthTestAgainstTerrain=true;u.screenSpaceCameraController.enableCollisionDetection=false;var l=u.terrainProvider;var c=this;this.interpolateCartographics(t,r,l).then(function(e){var r=[];for(var s=0;s<e.length-1;s++){r.push(Freedo.Cartesian3.fromRadians(e[s].longitude,e[s].latitude,e[s].height))}var l={pints:t};if(!a){var f=new Freedo.GroundErasePrimitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolygonGeometry({polygonHierarchy:new Freedo.PolygonHierarchy(r)}),attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(0,0,0,1))}}),classificationType:Freedo.ClassificationType.CESIUM_3D_TILE});l.erasePritive=f;c._groundErasers.push(u.primitives.add(f))}var d=c.getSimulateDrills(e,100);if(d.length>0){var h=c.getRelativeDrillsInfo(d,t);var v=c.addGeologyPrimitives(d,n,i,a,o,h);c._geologyPrimitives=c._geologyPrimitives.concat(v);l.geologyPrimitives=v}c._event.raiseEvent("dataAdded",l);c._scene.requestRender()},function(e){throw new Freedo.RuntimeError("TerrainProvider maybe invalidate. Check if there is a terrain in scene !")})}},{key:"pickGeologySimulations",value:function e(t){if(Freedo.defined(this._lastHeightPrimitive)){this._lastHeightPrimitive.appearance.material.uniforms.value=[0,0,0,1];this._lastHeightPrimitive=undefined}var r=this._scene.globe.depthTestAgainstTerrain;this._scene.globe.depthTestAgainstTerrain=true;var n=scene.pick(t);var i=undefined;if(Freedo.defined(n)&&Freedo.defined(n.primitive)){n.primitive.appearance.material.uniforms.value=[.8,.6,.6,.9];this._lastHeightPrimitive=n.primitive;i={layerName:n.primitive.layerName,depth:n.primitive.depth,primitive:n.primitive,drillsInfo:n.primitive.drillsInfo,offsetMatrix:n.primitive.offsetMatrix}}this._scene.globe.depthTestAgainstTerrain=r;this._scene.requestRender();return i}},{key:"removeAllGeologySimulations",value:function e(){this._lastHeightPrimitive=undefined;var t=this._scene;for(var r=this._groundErasers.length-1;r>=0;r--){t.primitives.remove(this._groundErasers[r])}this._groundErasers.splice(0);for(var r=this._geologyPrimitives.length-1;r>=0;r--){t.primitives.remove(this._geologyPrimitives[r])}this._geologyPrimitives.splice(0);this._event.raiseEvent("dataRemoved",{});t.requestRender()}},{key:"dispose",value:function e(){removeAllGeologySimulations();this._layerTextureMap.clear();this._drillDataArray=[];this._eventHelper.removeAll()}},{key:"drillOptions",get:function e(){return this._drillOptions}}]);return e}();t.FdGeologySimulationManager=m},function(e,t,r){"use strict";var n=r(17);var i=r(73);var a=r(48);var o=r(69);e.exports=function(e){n(n.S,e,{from:function e(t){var r=arguments[1];var n,s,u,l;i(this);n=r!==undefined;if(n)i(r);if(t==undefined)return new this;s=[];if(n){u=0;l=a(r,arguments[2],2);o(t,false,function(e){s.push(l(e,u++))})}else{o(t,false,s.push,s)}return new this(s)}})}},function(e,t,r){"use strict";var n=r(17);e.exports=function(e){n(n.S,e,{of:function e(){var t=arguments.length;var r=new Array(t);while(t--)r[t]=arguments[t];return new this(r)}})}},function(e,t,r){var n=r(79);var i=r(281);e.exports=function(e){return function t(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(71);e.exports=Array.isArray||function e(t){return n(t)=="Array"}},function(e,t,r){"use strict";var n=r(16);var i=r(17);var a=r(106);var o=r(64);var s=r(44);var u=r(108);var l=r(69);var c=r(107);var f=r(30);var d=r(70);var h=r(31).f;var v=r(285)(0);var p=r(29);e.exports=function(e,t,r,_,y,m){var g=n[e];var F=g;var w=y?"set":"add";var b=F&&F.prototype;var C={};if(!p||typeof F!="function"||!(m||b.forEach&&!o(function(){(new F).entries().next()}))){F=_.getConstructor(t,e,y,w);u(F.prototype,r);a.NEED=true}else{F=t(function(t,r){c(t,F,e,"_c");t._c=new g;if(r!=undefined)l(r,y,t[w],t)});v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t=e=="add"||e=="set";if(e in b&&!(m&&e=="clear"))s(F.prototype,e,function(r,n){c(this,F,e);if(!t&&m&&!f(r))return e=="get"?undefined:false;var i=this._c[e](r===0?0:r,n);return t?this:i})});m||h(F.prototype,"size",{get:function(){return this._c.size}})}d(F,e);C[e]=F;i(i.G+i.W+i.F,C);if(!m)_.setStrong(F,e,y);return F}},function(e,t,r){"use strict";var n=r(16);var i=r(14);var a=r(31);var o=r(29);var s=r(13)("species");e.exports=function(e){var t=typeof i[e]=="function"?i[e]:n[e];if(o&&t&&!t[s])a.f(t,s,{configurable:true,get:function(){return this}})}},function(e,t,r){"use strict";var n=r(31).f;var i=r(115);var a=r(108);var o=r(48);var s=r(107);var u=r(69);var l=r(116);var c=r(171);var f=r(165);var d=r(29);var h=r(106).fastKey;var v=r(105);var p=d?"_s":"size";var _=function(e,t){var r=h(t);var n;if(r!=="F")return e._i[r];for(n=e._f;n;n=n.n){if(n.k==t)return n}};e.exports={getConstructor:function(e,t,r,l){var c=e(function(e,n){s(e,c,t,"_i");e._t=t;e._i=i(null);e._f=undefined;e._l=undefined;e[p]=0;if(n!=undefined)u(n,r,e[l],e)});a(c.prototype,{clear:function e(){for(var r=v(this,t),n=r._i,i=r._f;i;i=i.n){i.r=true;if(i.p)i.p=i.p.n=undefined;delete n[i.i]}r._f=r._l=undefined;r[p]=0},delete:function(e){var r=v(this,t);var n=_(r,e);if(n){var i=n.n;var a=n.p;delete r._i[n.i];n.r=true;if(a)a.n=i;if(i)i.p=a;if(r._f==n)r._f=i;if(r._l==n)r._l=a;r[p]--}return!!n},forEach:function e(r){v(this,t);var n=o(r,arguments.length>1?arguments[1]:undefined,3);var i;while(i=i?i.n:this._f){n(i.v,i.k,this);while(i&&i.r)i=i.p}},has:function e(r){return!!_(v(this,t),r)}});if(d)n(c.prototype,"size",{get:function(){return v(this,t)[p]}});return c},def:function(e,t,r){var n=_(e,t);var i,a;if(n){n.v=r}else{e._l=n={i:a=h(t,true),k:t,v:r,p:i=e._l,n:undefined,r:false};if(!e._f)e._f=n;if(i)i.n=n;e[p]++;if(a!=="F")e._i[a]=n}return e},getEntry:_,setStrong:function(e,t,r){l(e,t,function(e,r){this._t=v(e,t);this._k=r;this._l=undefined},function(){var e=this;var t=e._k;var r=e._l;while(r&&r.r)r=r.p;if(!e._t||!(e._l=r=r?r.n:e._t._f)){e._t=undefined;return c(1)}if(t=="keys")return c(0,r.k);if(t=="values")return c(0,r.v);return c(0,[r.k,r.v])},r?"entries":"values",!r,true);f(t)}}},function(e,t,r){var n=r(79);var i=r(13)("iterator");var a=r(62);e.exports=r(14).getIteratorMethod=function(e){if(e!=undefined)return e[i]||e["@@iterator"]||a[n(e)]}},function(e,t,r){var n=r(16).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(47);var i=r(61);var a=r(295)(false);var o=r(112)("IE_PROTO");e.exports=function(e,t){var r=i(e);var s=0;var u=[];var l;for(l in r)if(l!=o)n(r,l)&&u.push(l);while(t.length>s)if(n(r,l=t[s++])){~a(u,l)||u.push(l)}return u}},function(e,t,r){e.exports=r(44)},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTransformHelper=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(308);var u=r(11);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._bInTransform=false;this._transType="MOVE";this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._sceneSphere={};this._basePt=undefined;this._t12={TMoveX:0,TMoveY:0,TMoveZ:0,DMoveX:0,DMoveY:0,DMoveZ:0,THeading:0,TPitch:0,TRoll:0,TScaleX:1,TScaleY:1,TScaleZ:1,TBaseX:0,TBaseY:0,TBaseZ:0};this._aPModelSet=[];this._mani=new s.FdTransformManipulator(t);this._maniCallBack=undefined;this._mouseDown12Arg={};this._mouseDownMM=FreeDo.Matrix4.IDENTITY;this._selectedAxis="";this._centerDis={};this._inMoveTo=false;this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3};this._axisZoom=1}(0,o.default)(e,[{key:"tranOptions",get:function e(){var t=[];for(var r in this._aPModelSet){var n=this._aPModelSet[r];t=n.modelMatrix}return{modelMatrix:t}},set:function e(t){if(!Freedo.defined(t)){return}for(var r in this._aPModelSet){var n=this._aPModelSet[r];n.modelMatrix=Freedo.clone(t.modelMatrix,true)}}}]);return e}();c.prototype.setData=function(e){this._aPModelSet=e};c.prototype.hideAxis=function(){this._transType=""};c.prototype.setAxisSize=function(e){this._mani.setAxisSize(e)};c.prototype.setArg=function(e,t){switch(e){case"basePtX":this._t12.TBaseX=t;break;case"basePtY":this._t12.TBaseY=t;break;case"basePtZ":this._t12.TBaseZ=t;break;case"translateX":this._t12.DMoveX=t;break;case"translateY":this._t12.DMoveY=t;break;case"translateZ":this._t12.DMoveZ=t;break;case"rotateX":this._t12.THeading=t;break;case"rotateY":this._t12.TPitch=t;break;case"rotateZ":this._t12.TRoll=t;break;case"scaleX":this._t12.TScaleX=t;break;case"scaleY":this._t12.TScaleY=t;break;case"scaleZ":this._t12.TScaleZ=t;break}this._t12.TMoveX=this._t12.TBaseX+this._t12.DMoveX;this._t12.TMoveY=this._t12.TBaseY+this._t12.DMoveY;this._t12.TMoveZ=this._t12.TBaseZ+this._t12.DMoveZ;var r=Freedo.Math.toRadians;var n=Freedo.Math.toDegrees;var i=this.getMatrix(r(this._t12.DMoveX),r(this._t12.DMoveY),this._t12.DMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,this._t12.TScaleX,this._t12.TScaleY,this._t12.TScaleZ,Freedo.Math.toRadians(this._t12.TBaseX),Freedo.Math.toRadians(this._t12.TBaseY),this._t12.TBaseZ);var a=Freedo.Cartesian3.fromDegrees(this._t12.TBaseX,this._t12.TBaseY,this._t12.TBaseZ);var o=Freedo.Matrix4.multiplyByPoint(i,a,new Freedo.Cartesian3);var s=Freedo.Cartographic.fromCartesian(o);this._t12.TMoveX=n(s.longitude);this._t12.TMoveY=n(s.latitude);this._t12.TMoveZ=s.height;this._mani.updatePosition(this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ);this._mani.updateBasePt(this._t12.TBaseX,this._t12.TBaseY,this._t12.TBaseZ);this._sceneSphere.center=Freedo.Cartesian3.fromDegrees(this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ)};c.prototype.getMatrix=function(e,t,r,n,i,a,o,s,u,l,c,f){var d=Freedo.Cartesian3.fromRadians(l,c,f);var h=Freedo.Cartesian3.fromRadians(l+e,c+t,f+r);n=Freedo.Math.toRadians(n);i=Freedo.Math.toRadians(i);a=Freedo.Math.toRadians(a);var v=Freedo.Quaternion.fromHeadingPitchRoll(new Freedo.HeadingPitchRoll(n,i,a));var p=new Freedo.Cartesian3(o,s,u);var _=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,v,p);var y=Freedo.Transforms.eastNorthUpToFixedFrame(d);var m=Freedo.Matrix4.inverse(y,new Freedo.Matrix4);var g=Freedo.Transforms.eastNorthUpToFixedFrame(h);var F=Freedo.Matrix4.multiply(_,m,new Freedo.Matrix4);var w=Freedo.Matrix4.multiply(g,F,new Freedo.Matrix4);return Freedo.clone(w,true)};c.prototype.getMatrixOfTileset=function(e,t,r,n,i,a,o,s,u,l,c,f,d){if(e===undefined)return undefined;if(c===undefined){var h=this.getTilesetBasePt(e);c=h.longitude;f=h.latitude;d=h.height}var v=Freedo.Cartesian3.fromRadians(c,f,d);var p=Freedo.Cartesian3.fromRadians(c+t,f+r,d+n);i=Freedo.Math.toRadians(i);a=Freedo.Math.toRadians(a);o=Freedo.Math.toRadians(o);var _=Freedo.Quaternion.fromHeadingPitchRoll(new Freedo.HeadingPitchRoll(i,a,o));var y=new Freedo.Cartesian3(s,u,l);var m=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,_,y);var g=Freedo.Transforms.eastNorthUpToFixedFrame(v);var F=Freedo.Matrix4.inverse(g,new Freedo.Matrix4);var w=Freedo.Transforms.eastNorthUpToFixedFrame(p);var b=Freedo.Matrix4.multiply(m,F,new Freedo.Matrix4);var C=Freedo.Matrix4.multiply(w,b,new Freedo.Matrix4);return Freedo.clone(C,true)};c.prototype.startTransform=function(e,t){this._bInTransform=true;this._transType=e;if(this._aPModelSet.length>0){if(this.checkConflict())return;this._basePt=undefined;this.calcSceneBS();for(var r in this._aPModelSet){var n=this._aPModelSet[r];this._mouseDownMat=FreeDo.clone(n.modelMatrix,true)}}var i=this;this._maniCallBack=this._mani.on(function(e,t){if(e=="Transform"){i.onTransform()}if(e=="Transformed"){i.onTransformed()}if(e=="GotoPoint"){i.onGotoPoint(t)}if(e=="Transforming"){i.onTransforming(t)}});if(this._transType.indexOf("MOVETO")>=0)this._inMoveTo=true;this._mani.startTransform(this._transType);this._event.raiseEvent("Start",{});if(this._aPModelSet.length>0){this._mani.updateSceneSphere(this._sceneSphere);this._mani.updatePosition(this._basePt.longitude,this._basePt.latitude,this._basePt.height);this._mani.updateBasePt(this._basePt.longitude,this._basePt.latitude,this._basePt.height)}};c.prototype.start=function(e,t){this.startTransform(e,t)};c.prototype.getData=function(){var e=[];for(var t in this._aPModelSet){var r=this._aPModelSet[t];e.push({modelMatrix:FreeDo.clone(r.modelMatrix,true),tileset:r})}return e};c.prototype.checkConflict=function(){var e=0;var t=0;for(var r in this._aPModelSet){var n=this._aPModelSet[r];var i=this._aPModelSet[r]["transformTime"];if(t==0){if(i===undefined)e=undefined;else e=Freedo.clone(i,true)}else{if(i!==e){alert("编辑状态存在冲突无法继续！");this.cancelTransform();return true}}t++}return false};c.prototype.initTransform=function(){var e=0;var t=0;for(var r in this._aPModelSet){var n=this._aPModelSet[r];var i=this._aPModelSet[r]["transformTime"];if(t==0){if(i===undefined)e=undefined;else e=Freedo.clone(i,true)}else{if(i!==e){console.log("部分模型存在变换，部分没有，请注意")}}t++}for(var r in this._aPModelSet){var n=this._aPModelSet[r];var e=this._aPModelSet[r]["transformTime"];if(e==undefined||e==0){this.resetTransform()}var i=this._aPModelSet[r]["transformMatrix"];if(i!==undefined){this._t12=FreeDo.clone(i,true)}this._event.raiseEvent("InitTransform",FreeDo.clone(this._t12,true))}};c.prototype.updateBasePt=function(){this._basePt={longitude:Freedo.Math.toRadians(this._t12.TMoveX),latitude:Freedo.Math.toRadians(this._t12.TMoveY),height:this._t12.TMoveZ}};c.prototype.getModelBS=function(e){var t=Freedo.Matrix4.getTranslation(e.modelMatrix,new Freedo.Cartesian3);var r=e.boundingSphere;var n=new Freedo.BoundingSphere(t,r.radius);return n};c.prototype.calcSceneBS=function(){var e=[];for(var t in this._aPModelSet){var r=this._aPModelSet[t];if(r===undefined)console.log("FdTransform：无效数据");var n=r.boundingSphere;if(r instanceof Freedo.Model){n=this.getModelBS(r)}else if(r.point){n=new Freedo.BoundingSphere(r.position.getValue(),10)}e.push(n)}this._sceneSphere=FreeDo.BoundingSphere.fromBoundingSpheres(e,new FreeDo.BoundingSphere);if(this._basePt===undefined){this._basePt=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);this._basePt.longitude=Freedo.Math.toDegrees(this._basePt.longitude);this._basePt.latitude=Freedo.Math.toDegrees(this._basePt.latitude)}};c.prototype.calcXYZDist=function(e,t,r,n,i,a){return[n-e,i-t,a-r];var o=new Freedo.EllipsoidGeodesic(new FreeDo.Cartographic(e,t,r),new FreeDo.Cartographic(n,t,r)).surfaceDistance;if(n<e)o*=-1;var s=new Freedo.EllipsoidGeodesic(new FreeDo.Cartographic(e,t,r),new FreeDo.Cartographic(e,i,r)).surfaceDistance;if(i<t)s*=-1;var u=a-r;return[o,s,u]};c.prototype.calcAxisZoom=function(){if(this._bInClip===false){this._axisZoom=1;return}var e=this._sceneSphere.center;var t=this._viewer.camera.positionWC;var r=1,n=1;r=Freedo.Cartesian3.distance(e,t)/6;n=this._viewer.camera.getPixelSize(this._sceneSphere,10,10);this._axisZoom=r;if(this._viewer.scene._mode===Freedo.SceneMode.COLUMBUS_VIEW)this._axisZoom=this._viewer.camera.positionWC.x/6;if(this._axisZoom>4e5)this._axisZoom=4e5;if(this._axisZoom<1)this._axisZoom=1};c.prototype.onTransforming=function(e){var t=e.MouseDownPos;var r=e.MouseMovePos;var n=e.SelectedAxis;var i=e.FixedAxis;this._selectedAxis=n;var a=[0,0,0];var o=1,s=1,u=1,l=0,c=0,f=0;this.calcAxisZoom();var d=undefined;if(Freedo.defined(t))d=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,t.height);var h=undefined;if(Freedo.defined(r))h=Freedo.Cartesian3.fromRadians(r.longitude,r.latitude,r.height);var v=0;var p=0;if(d)v=Freedo.Cartesian3.distance(d,this._sceneSphere.center);if(h)p=Freedo.Cartesian3.distance(h,this._sceneSphere.center);var _=Freedo.clone(this._mouseDown12Arg,true);if(this._aPModelSet.length>0){this.calcSceneBS()}if(n==="XY"){a=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,r.latitude,t.height)}if(n==="YZ"){a=this.calcXYZDist(t.longitude,t.latitude,t.height,t.longitude,r.latitude,r.height)}if(n==="XZ"){a=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,t.latitude,r.height)}if(i==="X"){a=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,t.latitude,t.height)}if(i==="Y"){a=this.calcXYZDist(t.longitude,t.latitude,t.height,t.longitude,r.latitude,t.height)}if(i==="Z"){a[0]=0;a[1]=0;a[2]=-1*(e.MouseMoveXY.y-e.MouseDownXY.y)*this._axisZoom/100}if(this._transType.indexOf("SCALE")>=0&&n==="XY_QCIRCLE"){var y=p/v;o=y;s=y;u=y}var m={};if(this._transType.indexOf("ROTATE")>=0&&n==="XY_CIRCLE"){m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);var g=FreeDo.Cartesian3.fromRadians(m.longitude+.01,m.latitude,m.height);var F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.subtract(h,this._sceneSphere.center,new FreeDo.Cartesian3);var C=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(b,F));var P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));if(t.latitude<m.latitude)P=360-P;if(r.latitude<m.latitude)C=360-C;l=P-C}if(this._transType.indexOf("ROTATE")>=0&&n==="XZ_CIRCLE"){if(!Freedo.defined(d))return;m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);var g=FreeDo.Cartesian3.fromRadians(m.longitude+.01,m.latitude,m.height);var F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.subtract(h,this._sceneSphere.center,new FreeDo.Cartesian3);var C=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(b,F));var P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));if(t.height<m.height)P=360-P;if(r.height<m.height)C=360-C;c=C-P}if(this._transType.indexOf("ROTATE")>=0&&n==="YZ_CIRCLE"){if(!Freedo.defined(d))return;m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);var g=FreeDo.Cartesian3.fromRadians(m.longitude,m.latitude+.01,m.height);var F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.subtract(h,this._sceneSphere.center,new FreeDo.Cartesian3);var C=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(b,F));var P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));if(t.height<m.height)P=360-P;if(r.height<m.height)C=360-C;f=C-P}var x={TMoveX:a[0],TMoveY:a[1],TMoveZ:a[2],THeading:l,TPitch:c,TRoll:f,TScaleX:o,TScaleY:s,TScaleZ:u};_.DMoveX+=Freedo.Math.toDegrees(x.TMoveX);_.DMoveY+=Freedo.Math.toDegrees(x.TMoveY);_.DMoveZ+=x.TMoveZ;_.THeading+=x.THeading;_.TPitch+=x.TPitch;_.TRoll+=x.TRoll;_.TScaleX*=x.TScaleX;_.TScaleY*=x.TScaleY;_.TScaleZ*=x.TScaleZ;this._t12.DMoveX=_.DMoveX;this._t12.DMoveY=_.DMoveY;this._t12.DMoveZ=_.DMoveZ;this._t12.THeading=_.THeading;this._t12.TPitch=_.TPitch;this._t12.TRoll=_.TRoll;this._t12.TScaleX=_.TScaleX;this._t12.TScaleY=_.TScaleY;this._t12.TScaleZ=_.TScaleZ;this.refineArgs();this._event.raiseEvent("Transforming",FreeDo.clone(this._t12,true));if(this._aPModelSet.length>0){for(var M in this._aPModelSet){m=this.getTilesetBasePt(this._aPModelSet[M]);var S=this._aPModelSet[M];this.applyTransformToTileset(this._aPModelSet[M],Freedo.Math.toRadians(_.DMoveX),Freedo.Math.toRadians(_.DMoveY),_.DMoveZ,_.THeading,_.TPitch,_.TRoll,_.TScaleX,_.TScaleY,_.TScaleZ,Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height);this._event.raiseEvent("DataChanged",FreeDo.clone(this._aPModelSet[M].modelMatrix,true))}this._t12.TMoveX=Freedo.Math.toDegrees(m.longitude)+_.DMoveX;this._t12.TMoveY=Freedo.Math.toDegrees(m.latitude)+_.DMoveY;this._t12.TMoveZ=m.height+_.DMoveZ;this.calcSceneBS();this._mani.updateSceneSphere(this._sceneSphere)}};c.prototype.refineArgs=function(){for(var e in this._aPModelSet){var t=this._aPModelSet[e];var r=FreeDo.Matrix4.getScale(t.modelMatrix,new FreeDo.Cartesian3);if(this._t12.THeading>360)this._t12.THeading-=360;if(this._t12.THeading<-360)this._t12.THeading+=360;if(this._t12.TPitch>360)this._t12.TPitch-=360;if(this._t12.TPitch<-360)this._t12.TPitch+=360;if(this._t12.TRoll>360)this._t12.TRoll-=360;if(this._t12.TRoll<-360)this._t12.TRoll+=360;this._t12.TMoveX=Freedo.FdMisc.FdMath.round(this._t12.TMoveX,8);this._t12.TMoveY=Freedo.FdMisc.FdMath.round(this._t12.TMoveY,8);this._t12.TMoveZ=Freedo.FdMisc.FdMath.round(this._t12.TMoveZ,6);this._t12.THeading=Freedo.FdMisc.FdMath.round(this._t12.THeading,4);this._t12.TPitch=Freedo.FdMisc.FdMath.round(this._t12.TPitch,4);this._t12.TRoll=Freedo.FdMisc.FdMath.round(this._t12.TRoll,4);this._t12.TScaleX=1;this._t12.TScaleY=1;this._t12.TScaleZ=1}};c.prototype.onGotoPoint=function(e){if(e.type!=this.PositionType.NONE&&this._inMoveTo){var t=Freedo.Cartographic.fromCartesian(e.position);if(t!==undefined){var r=FreeDo.clone(this._t12,true);r.TMoveX=t.longitude;r.TMoveY=t.latitude;for(var n in this._aPModelSet){var i=this.getTilesetBasePt(this._aPModelSet[n]);var a=r.TMoveX-i.longitude;var o=r.TMoveY-i.latitude;var s=r.TMoveZ-i.height;this.applyTransformToTileset(this._aPModelSet[n],parseFloat(a),parseFloat(o),parseFloat(s),parseFloat(r.THeading),parseFloat(r.TPitch),parseFloat(r.TRoll),parseFloat(r.TScaleX),parseFloat(r.TScaleY),parseFloat(r.TScaleZ),Freedo.Math.toRadians(this._t12.TBaseX),Freedo.Math.toRadians(this._t12.TBaseY),this._t12.TBaseZ)}r.TMoveX=Freedo.Math.toDegrees(r.TMoveX);r.TMoveY=Freedo.Math.toDegrees(r.TMoveY);r.TMoveZ=r.TMoveZ;this._t12=FreeDo.clone(r,true);this.refineArgs();if(this._transType!==""){this.calcSceneBS();this._mani.updateSceneSphere(this._sceneSphere)}this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,true))}this._inMoveTo=false}};c.prototype.onTransform=function(e){this._event.raiseEvent("Transform",{});this.reset12Args();this._mouseDown12Arg=Freedo.clone(this._t12,true);for(var t in this._aPModelSet){var r=this._aPModelSet[t];this._mouseDownMM=Freedo.clone(r.modelMatrix,true);break}};c.prototype.onTransformed=function(e){this.refineArgs();this._mouseDownMM=FreeDo.Matrix4.IDENTITY;this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,true))};c.prototype.getTilesetBasePt=function(e){if(e===undefined)return undefined;var t=false;var r;if(e._root&&e._root.transform)r=Freedo.clone(e._root.transform,true);else if(e instanceof Freedo.Model)r=Freedo.clone(e.modelMatrix,true);else{r=Freedo.clone(e.modelMatrix,true);t=true}var n=FreeDo.Matrix4.getTranslation(r,new FreeDo.Cartesian3);var i=Freedo.Cartographic.fromCartesian(n);if(t){i=Freedo.Cartographic.fromCartesian(e.boundingSphere.center)}return i};c.prototype.applyTransformToTileset=function(e,t,r,n,i,a,o,s,u,l,c,f,d){var h=this.getMatrixOfTileset(e,t,r,n,i,a,o,s,u,l,c,f,d);if(e instanceof Freedo.Model){var v=Freedo.Matrix4.multiply(h,this._mouseDownMM,new Freedo.Matrix4);e.modelMatrix=v}else{var v=Freedo.Matrix4.multiply(h,this._mouseDownMM,new Freedo.Matrix4);e.modelMatrix=v}};c.prototype.applyTransform=function(e,t,r,n,i,a,o,s,u){if(this.checkConflict())return;this.calcSceneBS();try{e=parseFloat(e);t=parseFloat(t);r=parseFloat(r);n=parseFloat(n);i=parseFloat(i);a=parseFloat(a);o=parseFloat(o);s=parseFloat(s);u=parseFloat(u)}catch(e){return}if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(a)||isNaN(o)||isNaN(s)||isNaN(u))return;for(var l in this._aPModelSet){var c=this.getTilesetBasePt(this._aPModelSet[l]);var f=Freedo.Math.toRadians(e)-c.longitude;var d=Freedo.Math.toRadians(t)-c.latitude;var h=r-c.height;this.applyTransformToTileset(this._aPModelSet[l],parseFloat(f),parseFloat(d),parseFloat(h),parseFloat(n),parseFloat(i),parseFloat(a),parseFloat(o),parseFloat(s),parseFloat(u),Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height)}this._t12.TMoveX=e;this._t12.TMoveY=t;this._t12.TMoveZ=r;this._t12.THeading=n;this._t12.TPitch=i;this._t12.TRoll=a;this._t12.TScaleX=o;this._t12.TScaleY=s;this._t12.TScaleZ=u;this.refineArgs();if(this._transType!==""){this.calcSceneBS();if(this._mani)this._mani.updateSceneSphere(this._sceneSphere)}this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,true))};c.prototype.applyTransformDelta=function(e,t,r,n,i,a,o,s,u){if(this.checkConflict())return;this.calcSceneBS();try{e=parseFloat(e);t=parseFloat(t);r=parseFloat(r);n=parseFloat(n);i=parseFloat(i);a=parseFloat(a);o=parseFloat(o);s=parseFloat(s);u=parseFloat(u)}catch(e){return}if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(a)||isNaN(o)||isNaN(s)||isNaN(u))return;for(var l in this._aPModelSet){var c=this.getTilesetBasePt(this._aPModelSet[l]);this.applyTransformToTileset(this._aPModelSet[l],e,t,r,parseFloat(n),parseFloat(i),parseFloat(a),parseFloat(o),parseFloat(s),parseFloat(u),Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height)}this._t12.DMoveX=e;this._t12.DMoveY=t;this._t12.DMoveZ=r;this._t12.TMoveX=e+this._basePt.longitude;this._t12.TMoveY=t+this._basePt.latitude;this._t12.TMoveZ=r+this._basePt.height;this._t12.THeading=n;this._t12.TPitch=i;this._t12.TRoll=a;this._t12.TScaleX=o;this._t12.TScaleY=s;this._t12.TScaleZ=u;this.refineArgs();if(this._transType!==""){this.calcSceneBS();this._mani.updateSceneSphere(this._sceneSphere)}this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,true))};c.prototype.reset12Args=function(){if(this.checkConflict())return;var e=undefined;for(var t in this._aPModelSet){var e=this.getTilesetBasePt(this._aPModelSet[t]);break}if(e==undefined){return}this._t12.DMoveX=0;this._t12.DMoveY=0;this._t12.DMoveZ=0;this._t12.TMoveX=Freedo.Math.toDegrees(e.longitude);this._t12.TMoveY=Freedo.Math.toDegrees(e.latitude);this._t12.TMoveZ=e.height;this._t12.THeading=0;this._t12.TPitch=0;this._t12.TRoll=0;this._t12.TScaleX=1;this._t12.TScaleY=1;this._t12.TScaleZ=1;this.refineArgs();this._basePt=undefined};c.prototype.resetTransform=function(){this.reset12Args();for(var e in this._aPModelSet){var t=this._aPModelSet[e];if(t instanceof Freedo.Model){t.modelMatrix=FreeDo.clone(t.initModelMatrix,true)}else t.modelMatrix=FreeDo.clone(FreeDo.Matrix4.IDENTITY,true);this._event.raiseEvent("DataChanged",FreeDo.clone(t.modelMatrix,true))}this.calcSceneBS();if(this._bInTransform){this._mani.updateSceneSphere(this._sceneSphere)}this._event.raiseEvent("resetTransform",FreeDo.clone(this._t12,true))};c.prototype.saveTransform=function(){var e=Date.parse(new Date);for(var t in this._aPModelSet){var r=this._sceneMgr._pModelMap[this._aPModelSet[t]]}};c.prototype.cancelTransform=function(){this.reset()};c.prototype.cancel=function(){this.reset()};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.reset=function(){this._bInTransform=false;this._mani.reset();this._transType="";if(this._maniCallBack)this._maniCallBack();this._event.raiseEvent("Cancel",{})};c.prototype.dispose=function(){this.reset()};t.FdTransformHelper=c},function(e,t,r){e.exports={default:r(317),__esModule:true}},function(e,t,r){e.exports=!r(29)&&!r(64)(function(){return Object.defineProperty(r(121)("div"),"a",{get:function(){return 7}}).a!=7})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdMath=undefined;var n=r(1);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(){(0,i.default)(this,e)};o.isNumber=function(e){return typeof e==="number"&&isFinite(e)};o.round=function(e,t){if(e>=0){var r=parseInt(e*Math.pow(10,t)+.5)/Math.pow(10,t);return r}else{var n=-e;var r=parseInt(n*Math.pow(10,t)+.5)/Math.pow(10,t);return-r}};t.FdMath=o},function(e,t){e.exports=Math.scale||function e(t,r,n,i,a){if(arguments.length===0||t!=t||r!=r||n!=n||i!=i||a!=a)return NaN;if(t===Infinity||t===-Infinity)return t;return(t-r)*(a-i)/(n-r)+i}},function(e,t,r){var n=r(50);e.exports=function(e,t){var r=[];n(e,false,r.push,r,t);return r}},function(e,t,r){var n=r(74);var i=r(177);e.exports=function(e){return function t(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(56);var i=r(23);var a=r(75).f;e.exports=function(e){return function(t){var r=i(t);var o=n(r);var s=o.length;var u=0;var l=[];var c;while(s>u)if(a.call(r,c=o[u++])){l.push(e?[c,r[c]]:r[c])}return l}}},function(e,t,r){var n=r(8);var i=r(143);var a=r(35);e.exports=function(e,t,r,o){var s=String(a(e));var u=s.length;var l=r===undefined?" ":String(r);var c=n(t);if(c<=u||l=="")return s;var f=c-u;var d=i.call(l,Math.ceil(f/l.length));if(d.length>f)d=d.slice(0,f);return o?d+s:s+d}},function(e,t,r){"use strict";var n=r(95);var i=r(5);var a=r(8);var o=r(28);var s=r(7)("isConcatSpreadable");function u(e,t,r,l,c,f,d,h){var v=c;var p=0;var _=d?o(d,h,3):false;var y,m;while(p<l){if(p in r){y=_?_(r[p],p,t):r[p];m=false;if(i(y)){m=y[s];m=m!==undefined?!!m:n(y)}if(m&&f>0){v=u(e,t,y,a(y.length),v,f-1)-1}else{if(v>=9007199254740991)throw TypeError();e[v]=y}v++}p++}return v}e.exports=u},function(e,t,r){var n=r(53);var i=r(96);var a=r(2);var o=r(3).Reflect;e.exports=o&&o.ownKeys||function e(t){var r=n.f(a(t));var o=i.f;return o?r.concat(o(t)):r}},function(e,t,r){var n=r(34);var i=r(8);e.exports=function(e){if(e===undefined)return 0;var t=n(e);var r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},function(e,t,r){"use strict";var n=r(49);var i=r(46).getWeak;var a=r(2);var o=r(5);var s=r(51);var u=r(50);var l=r(32);var c=r(24);var f=r(65);var d=l(5);var h=l(6);var v=0;var p=function(e){return e._l||(e._l=new _)};var _=function(){this.a=[]};var y=function(e,t){return d(e.a,function(e){return e[0]===t})};_.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var r=y(this,e);if(r)r[1]=t;else this.a.push([e,t])},delete:function(e){var t=h(this.a,function(t){return t[0]===e});if(~t)this.a.splice(t,1);return!!~t}};e.exports={getConstructor:function(e,t,r,a){var l=e(function(e,n){s(e,l,t,"_i");e._t=t;e._i=v++;e._l=undefined;if(n!=undefined)u(n,r,e[a],e)});n(l.prototype,{delete:function(e){if(!o(e))return false;var r=i(e);if(r===true)return p(f(this,t))["delete"](e);return r&&c(r,this._i)&&delete r[this._i]},has:function e(r){if(!o(r))return false;var n=i(r);if(n===true)return p(f(this,t)).has(r);return n&&c(n,this._i)}});return l},def:function(e,t,r){var n=i(a(t),true);if(n===true)p(e).set(t,r);else n[e._i]=r;return e},ufstore:p}},function(e,t,r){"use strict";var n=r(32)(0);var i=r(19);var a=r(46);var o=r(204);var s=r(184);var u=r(5);var l=r(4);var c=r(65);var f="WeakMap";var d=a.getWeak;var h=Object.isExtensible;var v=s.ufstore;var p={};var _;var y=function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}};var m={get:function e(t){if(u(t)){var r=d(t);if(r===true)return v(c(this,f)).get(t);return r?r[this._i]:undefined}},set:function e(t,r){return s.def(c(this,f),t,r)}};var g=e.exports=r(89)(f,y,m,s,true,true);if(l(function(){return(new g).set((Object.freeze||Object)(p),7).get(p)!=7})){_=s.getConstructor(y,f);o(_.prototype,m);a.NEED=true;n(["delete","has","get","set"],function(e){var t=g.prototype;var r=t[e];i(t,e,function(t,n){if(u(t)&&!h(t)){if(!this._f)this._f=new _;var i=this._f[e](t,n);return e=="set"?this:i}return r.call(this,t,n)})})}},function(e,t,r){"use strict";var n=r(187);var i=r(65);var a="Set";e.exports=r(89)(a,function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(i(this,a),t=t===0?0:t,t)}},n)},function(e,t,r){"use strict";var n=r(9).f;var i=r(54);var a=r(49);var o=r(28);var s=r(51);var u=r(50);var l=r(139);var c=r(192);var f=r(52);var d=r(10);var h=r(46).fastKey;var v=r(65);var p=d?"_s":"size";var _=function(e,t){var r=h(t);var n;if(r!=="F")return e._i[r];for(n=e._f;n;n=n.n){if(n.k==t)return n}};e.exports={getConstructor:function(e,t,r,l){var c=e(function(e,n){s(e,c,t,"_i");e._t=t;e._i=i(null);e._f=undefined;e._l=undefined;e[p]=0;if(n!=undefined)u(n,r,e[l],e)});a(c.prototype,{clear:function e(){for(var r=v(this,t),n=r._i,i=r._f;i;i=i.n){i.r=true;if(i.p)i.p=i.p.n=undefined;delete n[i.i]}r._f=r._l=undefined;r[p]=0},delete:function(e){var r=v(this,t);var n=_(r,e);if(n){var i=n.n;var a=n.p;delete r._i[n.i];n.r=true;if(a)a.n=i;if(i)i.p=a;if(r._f==n)r._f=i;if(r._l==n)r._l=a;r[p]--}return!!n},forEach:function e(r){v(this,t);var n=o(r,arguments.length>1?arguments[1]:undefined,3);var i;while(i=i?i.n:this._f){n(i.v,i.k,this);while(i&&i.r)i=i.p}},has:function e(r){return!!_(v(this,t),r)}});if(d)n(c.prototype,"size",{get:function(){return v(this,t)[p]}});return c},def:function(e,t,r){var n=_(e,t);var i,a;if(n){n.v=r}else{e._l=n={i:a=h(t,true),k:t,v:r,p:i=e._l,n:undefined,r:false};if(!e._f)e._f=n;if(i)i.n=n;e[p]++;if(a!=="F")e._i[a]=n}return e},getEntry:_,setStrong:function(e,t,r){l(e,t,function(e,r){this._t=v(e,t);this._k=r;this._l=undefined},function(){var e=this;var t=e._k;var r=e._l;while(r&&r.r)r=r.p;if(!e._t||!(e._l=r=r?r.n:e._t._f)){e._t=undefined;return c(1)}if(t=="keys")return c(0,r.k);if(t=="values")return c(0,r.v);return c(0,[r.k,r.v])},r?"entries":"values",!r,true);f(t)}}},function(e,t,r){"use strict";var n=r(187);var i=r(65);var a="Map";e.exports=r(89)(a,function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{get:function e(t){var r=n.getEntry(i(this,a),t);return r&&r.v},set:function e(t,r){return n.def(i(this,a),t===0?0:t,r)}},n,true)},function(e,t,r){var n=r(2);var i=r(5);var a=r(127);e.exports=function(e,t){n(e);if(i(t)&&t.constructor===e)return t;var r=a.f(e);var o=r.resolve;o(t);return r.promise}},function(e,t){e.exports=function(e){try{return{e:false,v:e()}}catch(e){return{e:true,v:e}}}},function(e,t,r){if(r(10)&&/./g.flags!="g")r(9).f(RegExp.prototype,"flags",{configurable:true,get:r(92)})},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(12);var i=r(55);var a=r(8);e.exports=[].copyWithin||function e(t,r){var o=n(this);var s=a(o.length);var u=i(t,s);var l=i(r,s);var c=arguments.length>2?arguments[2]:undefined;var f=Math.min((c===undefined?s:i(c,s))-l,s-u);var d=1;if(l<u&&u<l+f){d=-1;l+=f-1;u+=f-1}while(f-- >0){if(l in o)o[u]=o[l];else delete o[u];u+=d;l+=d}return o}},function(e,t,r){var n=r(15);var i=r(12);var a=r(76);var o=r(8);e.exports=function(e,t,r,s,u){n(t);var l=i(e);var c=a(l);var f=o(l.length);var d=u?f-1:0;var h=u?-1:1;if(r<2)for(;;){if(d in c){s=c[d];d+=h;break}d+=h;if(u?d<0:f<=d){throw TypeError("Reduce of empty array with no initial value")}}for(;u?d>=0:f>d;d+=h)if(d in c){s=t(s,c[d],d,l)}return s}},function(e,t,r){var n=r(2);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var a=e["return"];if(a!==undefined)n(a.call(e));throw t}}},function(e,t,r){var n=r(142);var i=Math.pow;var a=i(2,-52);var o=i(2,-23);var s=i(2,127)*(2-o);var u=i(2,-126);var l=function(e){return e+1/a-1/a};e.exports=Math.fround||function e(t){var r=Math.abs(t);var i=n(t);var c,f;if(r<u)return i*l(r/u/o)*u*o;c=(1+o/a)*r;f=c-(c-r);if(f>s||f!=f)return i*Infinity;return i*f}},function(e,t){e.exports=Math.log1p||function e(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(e,t,r){var n=r(5);var i=Math.floor;e.exports=function e(t){return!n(t)&&isFinite(t)&&i(t)===t}},function(e,t,r){var n=r(27);e.exports=function(e,t){if(typeof e!="number"&&n(e)!="Number")throw TypeError(t);return+e}},function(e,t,r){var n=r(3).parseFloat;var i=r(67).trim;e.exports=1/n(r(145)+"-0")!==-Infinity?function e(t){var r=i(String(t),3);var a=n(r);return a===0&&r.charAt(0)=="-"?-0:a}:n},function(e,t,r){var n=r(3).parseInt;var i=r(67).trim;var a=r(145);var o=/^[-+]?0[xX]/;e.exports=n(a+"08")!==8||n(a+"0x16")!==22?function e(t,r){var a=i(String(t),3);return n(a,r>>>0||(o.test(a)?16:10))}:n},function(e,t){e.exports=function(e,t,r){var n=r===undefined;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n=r(15);var i=r(5);var a=r(202);var o=[].slice;var s={};var u=function(e,t,r){if(!(t in s)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,r)};e.exports=Function.bind||function e(t){var r=n(this);var s=o.call(arguments,1);var l=function(){var e=s.concat(o.call(arguments));return this instanceof l?u(r,e.length,e):a(r,e,t)};if(i(r.prototype))l.prototype=r.prototype;return l}},function(e,t,r){"use strict";var n=r(56);var i=r(96);var a=r(75);var o=r(12);var s=r(76);var u=Object.assign;e.exports=!u||r(4)(function(){var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return u({},e)[r]!=7||Object.keys(u({},t)).join("")!=n})?function e(t,r){var u=o(t);var l=arguments.length;var c=1;var f=i.f;var d=a.f;while(l>c){var h=s(arguments[c++]);var v=f?n(h).concat(f(h)):n(h);var p=v.length;var _=0;var y;while(p>_)if(d.call(h,y=v[_++]))u[y]=h[y]}return u}:u},function(e,t,r){var n=r(23);var i=r(53).f;var a={}.toString;var o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function e(t){return o&&a.call(t)=="[object Window]"?s(t):i(n(t))}},function(e,t,r){var n=r(9);var i=r(2);var a=r(56);e.exports=r(10)?Object.defineProperties:function e(t,r){i(t);var o=a(r);var s=o.length;var u=0;var l;while(s>u)n.f(t,l=o[u++],r[l]);return t}},function(e,t,r){var n=r(24);var i=r(23);var a=r(97)(false);var o=r(149)("IE_PROTO");e.exports=function(e,t){var r=i(e);var s=0;var u=[];var l;for(l in r)if(l!=o)n(r,l)&&u.push(l);while(t.length>s)if(n(r,l=t[s++])){~a(u,l)||u.push(l)}return u}},function(e,t,r){t.f=r(7)},function(e,t,r){e.exports=!r(10)&&!r(4)(function(){return Object.defineProperty(r(151)("div"),"a",{get:function(){return 7}}).a!=7})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdModelServer=undefined;var n=r(100);var i=d(n);var a=r(39);var o=d(a);var s=r(38);var u=d(s);var l=r(1);var c=d(l);var f=r(43);function d(e){return e&&e.__esModule?e:{default:e}}var h=function e(){(0,c.default)(this,e);throw new Error("FdModelServer should not be instantiated!")};h.getResourceFinishCount=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/finish/count?token="+n;s=[];t.prev=2;t.next=5;return f.FdCommon.ajaxJson({url:a,type:"POST"});case 5:s=t.sent;t.next=11;break;case 8:t.prev=8;t.t0=t["catch"](2);console.error("获取失败",t.t0);case 11:i(s);case 12:case"end":return t.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getFinishResource=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/finish/get?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.deleteModel=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/delete/"+t+"?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getResourceErrorCount=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/error/count?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getResourceErrorList=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/error/get?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getResourceExecutingCount=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/execute/count?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getResourceExecutingList=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/execute/get?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getOneResourceInfo=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/getone/"+t.mid+"?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({url:a,type:"GET"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getOneResourceCount=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/count?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.getOneResourceList=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i){var a,s;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:a=r+"/cloudlink/freeserver-one/services/one/resource/get?token="+n;s=[];o.prev=2;o.next=5;return f.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:s=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:i(s);case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();h.oneStepFreedo=function(){var e=(0,u.default)(o.default.mark(function e(t,r,n,i,a){var s,u;return o.default.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:s=r+"/cloudlink/zuul/freeserver-one/services/one/import?token="+n;u=[];o.prev=2;o.next=5;return v({url:s,data:t,uploadCB:i});case 5:u=o.sent;o.next=11;break;case 8:o.prev=8;o.t0=o["catch"](2);console.error("获取失败",o.t0);case 11:a(JSON.parse(u));case 12:case"end":return o.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i,a){return e.apply(this,arguments)}}();var v=function(){var e=(0,u.default)(o.default.mark(function e(t){return o.default.wrap(function e(r){while(1){switch(r.prev=r.next){case 0:return r.abrupt("return",new i.default(function(e,r){var n=new XMLHttpRequest;n.withCredentials=true;function i(e){t.uploadCB(e,n)}n.upload.addEventListener("progress",i,false);n.addEventListener("readystatechange",function(){if(this.readyState===4){if(n.status>=200&&n.status<300){e(n.responseText)}else{r(n.responseText)}}});n.open("POST",t.url);n.send(t.data)}));case 1:case"end":return r.stop()}}},e,this)}));return function t(r){return e.apply(this,arguments)}}();t.FdModelServer=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPMTSParser=undefined;var n=r(39);var i=f(n);var a=r(38);var o=f(a);var s=r(1);var u=f(s);var l=function(){var e=(0,o.default)(i.default.mark(function e(t,r){var n;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:i.prev=0;i.next=3;return c.FdCommon.ajaxJson({url:t,type:"GET"});case 3:n=i.sent;r(n);i.next=10;break;case 7:i.prev=7;i.t0=i["catch"](0);r(undefined,i.t0);case 10:case"end":return i.stop()}}},e,this,[[0,7]])}));return function t(r,n){return e.apply(this,arguments)}}();var c=r(43);function f(e){return e&&e.__esModule?e:{default:e}}var d=function e(){(0,u.default)(this,e);throw new Error("FdPMTSParser should not be instantiated!")};var h=function e(t,r,n){if(t.resourceurl){return t.resourceurl.find(function(e){return e.type===n}).template}if(r.resourceurl){return r.resourceurl.find(function(e){return e.type===n}).template}};function v(e,t,r,n,i){var a=t.identifier;var o=r.identifier;var s=h(e,t,"uid");s=s.replace(/{matrixset}/g,a);s=s.replace(/{matrix}/g,o);s=s.replace(/{uid}/g,n);if(typeof i!=="undefined"){s=s+("?token="+i)}return s}function p(e,t,r,n,i,a){var o=t.identifier;var s=r.identifier;var u=h(e,t,"cid");if(!t.propstoragetype||t.propstoragetype===1){u=u.replace(/{matrixset}/g,o);u=u.replace(/{matrix}/g,s);u=u.replace(/{cid}/g,i)}if(t.propstoragetype===2){u=u.replace(/{tileno}/g,n);u=u.replace(/{pguid}/g,i)}if(typeof a!=="undefined"){u=u+("?token="+a)}return u}function _(e,t,r,n,i){var a=t.identifier;var o=r.identifier;var s=h(e,t,"prop");if(!t.propstoragetype||t.propstoragetype===1){s=s.replace(/{matrixset}/g,a);s=s.replace(/{matrix}/g,o);s=s.replace(/{comid}/g,n)}if(t.propstoragetype===2){s=s.replace(/{guid}/g,n)}if(typeof i!=="undefined"){s=s+("?token="+i)}return s}function y(e,t,r,n,i){var a=t.identifier;var o=r.identifier;var s=h(e,t,"tag");s=s.replace(/{matrixset}/g,a);s=s.replace(/{matrix}/g,o);s=s.replace(/{tag}/g,n);if(typeof i!=="undefined"){s=s+("?token="+i)}return s}d.getLayerFromID=function(e,t){return e.contents.layers.find(function(e){return e.identifier===t})};d.getMatrixSetFromID=function(e,t){return e.contents.matrixsets.find(function(e){return e.identifier===t})};d.getMatrixFromID=function(e,t){return matrixsets.find(function(e){return e.identifier===t})};d.getMatrixSets=function(e,t){var r=[];t.matrixsetlink.forEach(function(t){var n=d.getMatrixSetFromID(e,t);if(typeof n==="undefined"){throw new Error("")}r.push(n)});return r};d.getPModelURL=function(e,t,r,n){var i=t.identifier;var a=r.identifier;var o=h(e,t,"file");o=o.replace(/{matrixset}/g,i);o=o.replace(/{matrix}/g,a);o=o.replace(/{filepath}/g,a);if(typeof n!=="undefined"){o=o+("?token="+n)}return o};function m(e,t){var r=[];e.contents.layers.forEach(function(n){var i=Freedo.FdServer.FdPMTSParser.getMatrixSets(e,n);i.forEach(function(e){e.matrix.forEach(function(i){var a=Freedo.FdServer.FdPMTSParser.getPModelURL(n,e,i,t);r.push({pModelURL:a,matrix:i,matrixSet:e,layer:n})})})});return r}d.getPModelURLArray=function(){var e=(0,o.default)(i.default.mark(function e(t,r){var n,a;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:n=t.split("?")[1];a=Freedo.queryToObject(n);if(a.accesskey){Freedo.FdServer.FdShareServer.getLayerAccesskeyResource(t,"json",function(e,t){if(t){console.error("FdServer.FdShareServer.getLayerAccesskeyResource got error: "+t);return}var n=m(e);r(n)})}else if(a.token){Freedo.FdServer.FdPMTSServer.getResource(t.split("?")[0],a.token,function(e,t){if(t){console.error("FdPMTSServer.getJson got error: "+t);return}var n=m(e,a.token);r(n)})}else{r([])}case 3:case"end":return i.stop()}}},e,this)}));return function(t,r){return e.apply(this,arguments)}}();d.getUidJson=function(e,t,r,n,i,a){var o=v(e,t,r,n,i);l(o,function(e,t){a(e,t)})};d.getCidJson=function(e,t,r,n,i,a,o){var s=p(e,t,r,n,i,a);l(s,function(e,t){o(e,t)})};d.getPropJson=function(e,t,r,n,i,a){var o=_(e,t,r,n,i);l(o,function(e,t){a(e,t)})};d.getTagJson=function(e,t,r,n,i,a){var o=y(e,t,r,n,i);l(o,function(e,t){a(e,t)})};function g(e){var t=e.split(",");var r=[];r=t.map(function(e){return+e});return r}function F(e,t,r,n){var i=new Freedo.Cartesian3(e[0],e[1],e[2]);var a=new Freedo.Cartesian3(t[0],t[1],t[2]);var o=new Freedo.Cartesian3.fromDegrees(r[0],r[1],r[2]);if(Freedo.Cartesian3.magnitudeSquared(o)>6378137*6378137*1e-5){var s=FreeDo.Transforms.eastNorthUpToFixedFrame(o);var u=a.y;a.y=-a.z;a.z=u;u=i.y;i.y=-i.z;i.z=u;Freedo.Matrix4.multiplyByPoint(s,a,a);Freedo.Matrix4.multiplyByPoint(s,i,i)}else{Freedo.Cartesian3.add(o,a,a);Freedo.Cartesian3.add(o,i,i)}if(n){Freedo.Matrix4.multiplyByPoint(n,a,a);Freedo.Matrix4.multiplyByPoint(n,i,i)}var l=FreeDo.BoundingSphere.fromCornerPoints(a,i);return l}d.getMatrixBoundingSphere=function(e,t){var r=g(e.metadata.localbounds.min);var n=g(e.metadata.localbounds.max);var i=g(e.metadata.position);var a=i[0];i[0]=i[1];i[1]=a;var o=F(r,n,i,t);return o};d.getLayerBoundingSphere=function(e,t,r){var n=Freedo.FdServer.FdPMTSParser.getMatrixSets(e,t);n.forEach(function(e){return getMatrixBoundingSphere(matrix,r)})};d.getUidBoundingSphere=function(e,t,r,n,i,a,o){if(r.uid===n){var s=d.getMatrixBoundingSphere(r,a);o(s)}else{d.getUidJson(e,t,r,n,i,function(e,t){if(typeof t!=="undefined"){o(undefined,t);return}if(e&&e.BoundsMin&&e.BoundsMax){var n=g(e.BoundsMin);var i=g(e.BoundsMax);var s=g(r.metadata.position);var u=s[0];s[0]=s[1];s[1]=u;var l=F(n,i,s,a);o(l)}else{o(undefined,"getUidBoundingSphere got error!")}})}};t.FdPMTSParser=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTerrainServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};function d(e){var t=e;var r=t.documentElement;var n=r.getElementsByTagName("Contents");var i=n[0].getElementsByTagName("ResourceURL");var a=i.length;var o=i[0].getAttribute("template");var s=o.replace("{TileMatrix}/{TileCol}/{TileRow}.bil","");return s}f.getTerrains=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t+("/cloudlink/freeserver-admin/admin/layer/get?token="+r);o=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:a,data:{servicetype:"WETS"},type:"POST",dataType:"json"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("无法正常获取列表");case 11:n(o);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.getTerrain=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=[];o=t+"?token="+r;i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,type:"GET",dataType:"XML"});case 5:s=i.sent;a=d(s);i.next=12;break;case 9:i.prev=9;i.t0=i["catch"](2);console.log("添加错误");case 12:n(a);case 13:case"end":return i.stop()}}},e,this,[[2,9]])}));return function(t,r,n){return e.apply(this,arguments)}}();t.FdTerrainServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdImagerylayersServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};function d(e,t){var r={};var n=e;var i=n.documentElement;var a=i.getElementsByTagName("Contents");var o=a[0].getElementsByTagName("ResourceURL");var s=a[0].getElementsByTagName("Format")[0].innerHTML;var u=a[0].getElementsByTagName("ows:Title")[0].innerHTML;r.name=u;r.format=s;var l=a[0].getElementsByTagName("ows:SupportedCRS")[0].innerHTML;var c=void 0;if(l.includes("4326")){c="Geographic"}else if(l.includes("3857")){c="WebMercator"}r.tilingScheme=c;var f=o.length;var d=[];var h=void 0;for(var v=0;v<f;v++){var p=o[0].getAttribute("template");d.push(p)}for(var _=0;_<f;_++){if(d[_].includes("{TileMatrix}/{TileCol}/{TileRow}")){var y=d[_];var m=y.replace("{TileMatrix}","{z}");var g=m.replace("{TileCol}","{x}");var F=g.replace("{TileRow}","{y}");h=F;break}}r.imgUrl=h+"?token="+t;return r}f.getImagerylayers=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t+("/cloudlink/freeserver-admin/admin/layer/get?token="+r);o=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:a,data:{servicetype:"WMTS"},type:"POST",dataType:"json"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("获取列表失败");case 11:n(o);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.getImagerylayer=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o,s,u;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a={};o=t+"?token="+r;i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,type:"GET",dataType:"XML"});case 5:s=i.sent;u=d(s,r);a={name:u.name,type:"UrlTemplate",iconUrl:"//res.gbim360.com/lib/freedo/rel/1.5.7/Freedo/Widgets/Images/ImageryProviders/blackMarble.png",layerOption:{show:true,alpha:1},providerOptions:{url:u.imgUrl,maximumLevel:20,tilingScheme:u.tilingScheme}};i.next=13;break;case 10:i.prev=10;i.t0=i["catch"](2);console.log("获取错误");case 13:n(a);case 14:case"end":return i.stop()}}},e,this,[[2,10]])}));return function(t,r,n){return e.apply(this,arguments)}}();t.FdImagerylayersServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdShareServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};f.getShareObjectID=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/cloudlink-core-framework/app/dataresource/queryList?token="+n+"&appId=0154981b-11c5-49ad-839d-a3420af507d8&dataId="+t.id+"&dataName="+t.name;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log(i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.addShareObjectID=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s,u,c;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/cloudlink-core-framework/app/dataresource/add?token="+n;s=(new Date).getTime();u=[];c={appId:"0154981b-11c5-49ad-839d-a3420af507d8",resourceCode:"freedo_data_lid_"+s,resourceName:"freedo_data_lname_"+s,parentId:"610be183-1dda-43ed-8737-49fa2a55cc80",dataId:t.id,dataName:t.name};i.prev=4;i.next=7;return l.FdCommon.ajaxJson({url:o,data:c,type:"POST"});case 7:u=i.sent;i.next=13;break;case 10:i.prev=10;i.t0=i["catch"](4);console.log(i.t0);case 13:a(u);case 14:case"end":return i.stop()}}},e,this,[[4,10]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getUserList=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t+"/cloudlink/cloudlink-core-framework/user/getListByApp?token="+r+"&appId=0154981b-11c5-49ad-839d-a3420af507d8";o=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:a,type:"GET"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log(i.t0);case 11:n(o);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.addShareScene=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s,u;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/cloudlink-core-framework/app/dataresource/share/add?token="+n;s=[];u={shareType:t.shareType,dataresourceId:t.objectId,accessKeyList:t.accessKeyList,status:1,dataType:t.dataType,effectiveTime:t.effectiveTime,expireTime:t.expireTime,remark:t.remark};i.prev=3;i.next=6;return l.FdCommon.ajaxJson({url:o,data:u,type:"POST"});case 6:s=i.sent;i.next=12;break;case 9:i.prev=9;i.t0=i["catch"](3);console.log(i.t0);case 12:a(s);case 13:case"end":return i.stop()}}},e,this,[[3,9]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.share=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:f.getShareObjectID({id:t.lid,name:t.name},r,n,function(e){var i=undefined;if(e.rows.length){i=e.rows[0].objectId;f.addShareScene({shareType:t.shareType,objectId:i,accessKeyList:t.accessKeyList,effectiveTime:t.effectiveTime,expireTime:t.expireTime,dataType:t.dataType,remark:t.remark},r,n,function(e){a(e)})}else{Freedo.FdServer.FdShareServer.addShareObjectID({id:t.lid,name:t.name},r,n,function(e){i=e.rows[0].objectId;f.addShareScene({shareType:t.shareType,objectId:i,accessKeyList:t.accessKeyList,effectiveTime:t.effectiveTime,expireTime:t.expireTime,dataType:t.dataType,remark:t.remark},r,n,function(e){a(e)})})}});case 1:case"end":return i.stop()}}},e,this)}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getSceneAccesskeyURL=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-ocelot/scene/getcapaurl?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log(i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getLayerAccesskeyURL=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-admin/admin/layer/getcapaurl?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log(i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.createOneImportLayer=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-admin/admin/layer/importlayer?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log(i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getLayerAccesskeyResource=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:i.prev=0;i.next=3;return l.FdCommon.ajaxJson({url:t,type:"GET",dataType:r});case 3:a=i.sent;n(a);i.next=10;break;case 7:i.prev=7;i.t0=i["catch"](0);n(undefined,i.t0);case 10:case"end":return i.stop()}}},e,this,[[0,7]])}));return function(t,r,n){return e.apply(this,arguments)}}();t.FdShareServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdSceneServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};f.getUserSceneCount=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink//freeserver-ocelot/scene/count?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({data:t,url:o,type:"POST"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.error("获取用户场景失败",i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getUserScenes=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-ocelot/scene/getall?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({data:t,url:o,type:"POST"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.error("获取用户场景失败",i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getUserShareScenes=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t+"/cloudlink/cloudlink-core-framework/app/dataresource/share/queryMyShareList?token="+r+"&status=1&dataType=scene";o=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:a,type:"GET"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("获取用户分享场景失败",i.t0);case 11:n(o);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.getUserSharedScenes=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t+"/cloudlink/cloudlink-core-framework/app/dataresource/share/queryBeSharedList?token="+r+"&status=1&dataType=scene";o=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:a,type:"GET"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("获取用户被分享列表失败",i.t0);case 11:n(o);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.getUserSharedSceneInfo=function(){var e=(0,o.default)(i.default.mark(function e(t,r){var n;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:n=[];i.prev=1;i.next=4;return l.FdCommon.ajaxJson({url:t,type:"GET"});case 4:n=i.sent;i.next=10;break;case 7:i.prev=7;i.t0=i["catch"](1);console.log("获取分享场景信息失败",i.t0);case 10:r(n);case 11:case"end":return i.stop()}}},e,this,[[1,7]])}));return function(t,r){return e.apply(this,arguments)}}();f.getUserSceneInfo=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-ocelot/scene/getone/"+t+"?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("获取项目信息失败",i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.saveUserScene=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-ocelot/scene/upsert?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:s=i.sent;i.next=10;break;case 8:i.prev=8;i.t0=i["catch"](2);case 10:a(s);case 11:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.deleteUserScene=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-ocelot/scene/remove/"+t+"?token="+n;s=[];i.prev=2;i.next=5;return l.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](2);console.log("删除场景失败",i.t0);case 11:a(s);case 12:case"end":return i.stop()}}},e,this,[[2,8]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.deleteShareScene=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s,u;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/cloudlink-core-framework/app/dataresource/share/delete?token="+n;s={markId:t};u=[];i.prev=3;i.next=6;return l.FdCommon.ajaxJson({url:o,data:s,type:"POST"});case 6:u=i.sent;i.next=12;break;case 9:i.prev=9;i.t0=i["catch"](3);console.log("删除分享场景失败",i.t0);case 12:a(u);case 13:case"end":return i.stop()}}},e,this,[[3,9]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();t.FdSceneServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdUserServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};f.getVerificationCode=function(){var e=(0,o.default)(i.default.mark(function e(t,r){var n,a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:n={sendMode:"1",sendNum:t.toString(),signName:"飞渡科技",useCategory:"regist"};i.prev=1;a=r+"/cloudlink/cloudlink-core-framework/verfy/getVerifyCode";i.next=5;return l.FdCommon.ajaxJson({url:a,data:n,type:"POST"});case 5:o=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](1);console.error(i.t0);case 11:case"end":return i.stop()}}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}();f.registerUser=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=[];i.prev=1;o=r+"/cloudlink/freeserver-admin/auth/regist";i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:a=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](1);console.error(i.t0);case 11:n(a);case 12:case"end":return i.stop()}}},e,this,[[1,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.changePassword=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=[];i.prev=1;o=r+"/cloudlink/cloudlink-core-framework/login/resetPassword";i.next=5;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 5:a=i.sent;i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](1);console.error(i.t0);case 11:n(a);case 12:case"end":return i.stop()}}},e,this,[[1,8]])}));return function(t,r,n){return e.apply(this,arguments)}}();f.userLogin=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=[];i.prev=1;t.appId="0154981b-11c5-49ad-839d-a3420af507d8";o=r+"/cloudlink/cloudlink-core-framework/login/login";i.next=6;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 6:a=i.sent;i.next=12;break;case 9:i.prev=9;i.t0=i["catch"](1);console.error(i.t0);case 12:n(a);case 13:case"end":return i.stop()}}},e,this,[[1,9]])}));return function(t,r,n){return e.apply(this,arguments)}}();t.FdUserServer=f},function(e,t,r){var n=r(14);var i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function e(t){return i.stringify.apply(i,arguments)}},function(e,t,r){e.exports={default:r(217),__esModule:true}},function(e,t,r){"use strict";var n=r(17);var i=r(99);var a=r(154);n(n.S,"Promise",{try:function(e){var t=i.f(this);var r=a(e);(r.e?t.reject:t.resolve)(r.v);return t.promise}})},function(e,t,r){"use strict";var n=r(17);var i=r(14);var a=r(16);var o=r(156);var s=r(153);n(n.P+n.R,"Promise",{finally:function(e){var t=o(this,i.Promise||a.Promise);var r=typeof e=="function";return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){var n=r(13)("iterator");var i=false;try{var a=[7][n]();a["return"]=function(){i=true};Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return false;var r=false;try{var a=[7];var o=a[n]();o.next=function(){return{done:r=true}};a[n]=function(){return o};e(a)}catch(e){}return r}},function(e,t,r){var n=r(16);var i=r(155).set;var a=n.MutationObserver||n.WebKitMutationObserver;var o=n.process;var s=n.Promise;var u=r(71)(o)=="process";e.exports=function(){var e,t,r;var l=function(){var n,i;if(u&&(n=o.domain))n.exit();while(e){i=e.fn;e=e.next;try{i()}catch(n){if(e)r();else t=undefined;throw n}}t=undefined;if(n)n.enter()};if(u){r=function(){o.nextTick(l)}}else if(a&&!(n.navigator&&n.navigator.standalone)){var c=true;var f=document.createTextNode("");new a(l).observe(f,{characterData:true});r=function(){f.data=c=!c}}else if(s&&s.resolve){var d=s.resolve();r=function(){d.then(l)}}else{r=function(){i.call(n,l)}}return function(n){var i={fn:n,next:undefined};if(t)t.next=i;if(!e){e=i;r()}t=i}}},function(e,t){e.exports=function(e,t,r){var n=r===undefined;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n=r(82);var i=r(16);var a=r(48);var o=r(79);var s=r(17);var u=r(30);var l=r(73);var c=r(107);var f=r(69);var d=r(156);var h=r(155).set;var v=r(222)();var p=r(99);var _=r(154);var y=r(153);var m="Promise";var g=i.TypeError;var F=i.process;var w=i[m];var b=o(F)=="process";var C=function(){};var P,x,M,S;var T=x=p.f;var E=!!function(){try{var e=w.resolve(1);var t=(e.constructor={})[r(13)("species")]=function(e){e(C,C)};return(b||typeof PromiseRejectionEvent=="function")&&e.then(C)instanceof t}catch(e){}}();var D=function(e){var t;return u(e)&&typeof(t=e.then)=="function"?t:false};var A=function(e,t){if(e._n)return;e._n=true;var r=e._c;v(function(){var n=e._v;var i=e._s==1;var a=0;var o=function(t){var r=i?t.ok:t.fail;var a=t.resolve;var o=t.reject;var s=t.domain;var u,l,c;try{if(r){if(!i){if(e._h==2)L(e);e._h=1}if(r===true)u=n;else{if(s)s.enter();u=r(n);if(s){s.exit();c=true}}if(u===t.promise){o(g("Promise-chain cycle"))}else if(l=D(u)){l.call(u,a,o)}else a(u)}else o(n)}catch(e){if(s&&!c)s.exit();o(e)}};while(r.length>a)o(r[a++]);e._c=[];e._n=false;if(t&&!e._h)O(e)})};var O=function(e){h.call(i,function(){var t=e._v;var r=k(e);var n,a,o;if(r){n=_(function(){if(b){F.emit("unhandledRejection",t,e)}else if(a=i.onunhandledrejection){a({promise:e,reason:t})}else if((o=i.console)&&o.error){o.error("Unhandled promise rejection",t)}});e._h=b||k(e)?2:1}e._a=undefined;if(r&&n.e)throw n.v})};var k=function(e){return e._h!==1&&(e._a||e._c).length===0};var L=function(e){h.call(i,function(){var t;if(b){F.emit("rejectionHandled",e)}else if(t=i.onrejectionhandled){t({promise:e,reason:e._v})}})};var I=function(e){var t=this;if(t._d)return;t._d=true;t=t._w||t;t._v=e;t._s=2;if(!t._a)t._a=t._c.slice();A(t,true)};var R=function(e){var t=this;var r;if(t._d)return;t._d=true;t=t._w||t;try{if(t===e)throw g("Promise can't be resolved itself");if(r=D(e)){v(function(){var n={_w:t,_d:false};try{r.call(e,a(R,n,1),a(I,n,1))}catch(e){I.call(n,e)}})}else{t._v=e;t._s=1;A(t,false)}}catch(e){I.call({_w:t,_d:false},e)}};if(!E){w=function e(t){c(this,w,m,"_h");l(t);P.call(this);try{t(a(R,this,1),a(I,this,1))}catch(e){I.call(this,e)}};P=function e(t){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false};P.prototype=r(108)(w.prototype,{then:function e(t,r){var n=T(d(this,w));n.ok=typeof t=="function"?t:true;n.fail=typeof r=="function"&&r;n.domain=b?F.domain:undefined;this._c.push(n);if(this._a)this._a.push(n);if(this._s)A(this,false);return n.promise},catch:function(e){return this.then(undefined,e)}});M=function(){var e=new P;this.promise=e;this.resolve=a(R,e,1);this.reject=a(I,e,1)};p.f=T=function(e){return e===w||e===S?new M(e):x(e)}}s(s.G+s.W+s.F*!E,{Promise:w});r(70)(w,m);r(165)(m);S=r(14)[m];s(s.S+s.F*!E,m,{reject:function e(t){var r=T(this);var n=r.reject;n(t);return r.promise}});s(s.S+s.F*(n||!E),m,{resolve:function e(t){return y(n&&this===S?w:this,t)}});s(s.S+s.F*!(E&&r(221)(function(e){w.all(e)["catch"](C)})),m,{all:function e(t){var r=this;var n=T(r);var i=n.resolve;var a=n.reject;var o=_(function(){var e=[];var n=0;var o=1;f(t,false,function(t){var s=n++;var u=false;e.push(undefined);o++;r.resolve(t).then(function(t){if(u)return;u=true;e[s]=t;--o||i(e)},a)});--o||i(e)});if(o.e)a(o.v);return n.promise},race:function e(t){var r=this;var n=T(r);var i=n.reject;var a=_(function(){f(t,false,function(e){r.resolve(e).then(n.resolve,i)})});if(a.e)i(a.v);return n.promise}})},function(e,t,r){r(78);r(60);r(63);r(224);r(220);r(219);e.exports=r(14).Promise},function(e,t){!function(t){"use strict";var r=Object.prototype;var n=r.hasOwnProperty;var i;var a=typeof Symbol==="function"?Symbol:{};var o=a.iterator||"@@iterator";var s=a.asyncIterator||"@@asyncIterator";var u=a.toStringTag||"@@toStringTag";var l=typeof e==="object";var c=t.regeneratorRuntime;if(c){if(l){e.exports=c}return}c=t.regeneratorRuntime=l?e.exports:{};function f(e,t,r,n){var i=t&&t.prototype instanceof m?t:m;var a=Object.create(i.prototype);var o=new A(n||[]);a._invoke=S(e,r,o);return a}c.wrap=f;function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var h="suspendedStart";var v="suspendedYield";var p="executing";var _="completed";var y={};function m(){}function g(){}function F(){}var w={};w[o]=function(){return this};var b=Object.getPrototypeOf;var C=b&&b(b(O([])));if(C&&C!==r&&n.call(C,o)){w=C}var P=F.prototype=m.prototype=Object.create(w);g.prototype=P.constructor=F;F.constructor=g;F[u]=g.displayName="GeneratorFunction";function x(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}c.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===g||(t.displayName||t.name)==="GeneratorFunction":false};c.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,F)}else{e.__proto__=F;if(!(u in e)){e[u]="GeneratorFunction"}}e.prototype=Object.create(P);return e};c.awrap=function(e){return{__await:e}};function M(e){function t(r,i,a,o){var s=d(e[r],e,i);if(s.type==="throw"){o(s.arg)}else{var u=s.arg;var l=u.value;if(l&&typeof l==="object"&&n.call(l,"__await")){return Promise.resolve(l.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)})}return Promise.resolve(l).then(function(e){u.value=e;a(u)},o)}}var r;function i(e,n){function i(){return new Promise(function(r,i){t(e,n,r,i)})}return r=r?r.then(i,i):i()}this._invoke=i}x(M.prototype);M.prototype[s]=function(){return this};c.AsyncIterator=M;c.async=function(e,t,r,n){var i=new M(f(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function S(e,t,r){var n=h;return function i(a,o){if(n===p){throw new Error("Generator is already running")}if(n===_){if(a==="throw"){throw o}return k()}r.method=a;r.arg=o;while(true){var s=r.delegate;if(s){var u=T(s,r);if(u){if(u===y)continue;return u}}if(r.method==="next"){r.sent=r._sent=r.arg}else if(r.method==="throw"){if(n===h){n=_;throw r.arg}r.dispatchException(r.arg)}else if(r.method==="return"){r.abrupt("return",r.arg)}n=p;var l=d(e,t,r);if(l.type==="normal"){n=r.done?_:v;if(l.arg===y){continue}return{value:l.arg,done:r.done}}else if(l.type==="throw"){n=_;r.method="throw";r.arg=l.arg}}}}function T(e,t){var r=e.iterator[t.method];if(r===i){t.delegate=null;if(t.method==="throw"){if(e.iterator.return){t.method="return";t.arg=i;T(e,t);if(t.method==="throw"){return y}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var n=d(r,e.iterator,t.arg);if(n.type==="throw"){t.method="throw";t.arg=n.arg;t.delegate=null;return y}var a=n.arg;if(!a){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return y}if(a.done){t[e.resultName]=a.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=i}}else{return a}t.delegate=null;return y}x(P);P[u]="Generator";P[o]=function(){return this};P.toString=function(){return"[object Generator]"};function E(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(E,this);this.reset(true)}c.keys=function(e){var t=[];for(var r in e){t.push(r)}t.reverse();return function r(){while(t.length){var n=t.pop();if(n in e){r.value=n;r.done=false;return r}}r.done=true;return r}};function O(e){if(e){var t=e[o];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var r=-1,a=function t(){while(++r<e.length){if(n.call(e,r)){t.value=e[r];t.done=false;return t}}t.value=i;t.done=true;return t};return a.next=a}}return{next:k}}c.values=O;function k(){return{value:i,done:true}}A.prototype={constructor:A,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=i;this.done=false;this.delegate=null;this.method="next";this.arg=i;this.tryEntries.forEach(D);if(!e){for(var t in this){if(t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))){this[t]=i}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(e){if(this.done){throw e}var t=this;function r(r,n){s.type="throw";s.arg=e;t.next=r;if(n){t.method="next";t.arg=i}return!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];var s=o.completion;if(o.tryLoc==="root"){return r("end")}if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc");var l=n.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}else if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else if(u){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}}else if(l){if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}if(a&&(e==="break"||e==="continue")&&a.tryLoc<=t&&t<=a.finallyLoc){a=null}var o=a?a.completion:{};o.type=e;o.arg=t;if(a){this.method="next";this.next=a.finallyLoc;return y}return this.complete(o)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);D(r);return y}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var i=n.arg;D(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:O(e),resultName:t,nextLoc:r};if(this.method==="next"){this.arg=i}return y}}}(function(){return this}()||Function("return this")())},function(e,t,r){var n=function(){return this}()||Function("return this")();var i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0;var a=i&&n.regeneratorRuntime;n.regeneratorRuntime=undefined;e.exports=r(226);if(i){n.regeneratorRuntime=a}else{try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=undefined}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPMTSServer=undefined;var n=r(39);var i=c(n);var a=r(38);var o=c(a);var s=r(1);var u=c(s);var l=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(){(0,u.default)(this,e)};f.getResourceCount=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s,u;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-admin/admin/layer/count?token="+n;s=[];u=void 0;if(!t){t={};t.servicetype="PMTS"}i.prev=4;i.next=7;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 7:s=i.sent;i.next=14;break;case 10:i.prev=10;i.t0=i["catch"](4);u=i.t0;console.log("获取列表失败");case 14:a(s,u);case 15:case"end":return i.stop()}}},e,this,[[4,10]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getResourceList=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n,a){var o,s,u;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:o=r+"/cloudlink/freeserver-admin/admin/layer/get?token="+n;s=[];u=void 0;if(!t){t={};t.servicetype="PMTS"}i.prev=4;i.next=7;return l.FdCommon.ajaxJson({url:o,data:t,type:"POST"});case 7:s=i.sent;i.next=14;break;case 10:i.prev=10;i.t0=i["catch"](4);u=i.t0;console.log("获取列表失败");case 14:a(s,u);case 15:case"end":return i.stop()}}},e,this,[[4,10]])}));return function(t,r,n,i){return e.apply(this,arguments)}}();f.getResource=function(){var e=(0,o.default)(i.default.mark(function e(t,r,n){var a,o;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:a=t;o=undefined;if(r){a=t+"?token="+r}i.prev=3;i.next=6;return l.FdCommon.ajaxJson({url:a,type:"GET"});case 6:o=i.sent;i.next=12;break;case 9:i.prev=9;i.t0=i["catch"](3);console.error("错误");case 12:n(o);case 13:case"end":return i.stop()}}},e,this,[[3,9]])}));return function(t,r,n){return e.apply(this,arguments)}}();t.FdPMTSServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdServer=undefined;var n=r(1);var i=h(n);var a=r(228);var o=r(216);var s=r(215);var u=r(214);var l=r(213);var c=r(212);var f=r(211);var d=r(210);function h(e){return e&&e.__esModule?e:{default:e}}var v=function e(){(0,i.default)(this,e)};v.FdPMTSServer=a.FdPMTSServer;v.FdUserServer=o.FdUserServer;v.FdSceneServer=s.FdSceneServer;v.FdShareServer=u.FdShareServer;v.FdImagerylayersServer=l.FdImagerylayersServer;v.FdTerrainServer=c.FdTerrainServer;v.FdPMTSParser=f.FdPMTSParser;v.FdModelServer=d.FdModelServer;t.FdServer=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdUserLogining=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u='\n    <div class="FD-login-con">\n            <div class="FD-login-title">\n                <span>用户登录</span>\n            </div>\n            <div class="FD-input-area">\n                <input type="text" id="lg_tel" placeholder="请输入用户手机号">\n                <span id="lg_tel_error"></span>\n                <input type="password" id="lg_pw" placeholder="输入密码">\n                <span id="lg_pw_error"></span>\n            </div>\n            <button id="FD-user-logining-btn">登录</button>\n    </div>\n';var l=function(){function e(t,r){(0,i.default)(this,e);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._token=undefined;this._viewer=t;this._container=r;r.innerHTML=u;var n="//"+window.location.host;var a=this;function o(){var e=document.getElementById("lg_tel");var t=document.getElementById("lg_pw");var i=document.getElementById("lg_tel_error");var o=document.getElementById("lg_pw_error");i.innerHTML="";o.innerHTML="";if(!e.value){i.innerHTML="用户名不能为空";return false}if(!t.value){o.innerHTML="密码不能为空";return false}var s={loginNum:e.value,password:t.value};this._token=undefined;Freedo.FdServer.FdUserServer.userLogin(s,n,function(e){if(e.code==="PU03000"){o.innerHTML=e.msg;return false}if(e.code==="PU03010"){i.innerHTML=e.msg;return false}console.log("token: "+e.token);a._token=e.token;r.style.display="none";a._event.raiseEvent("TokenChanged",e.token)})}var s=document.getElementById("FD-user-logining-btn");s.onclick=o;function l(){}}(0,o.default)(e,[{key:"getToken",value:function e(){return this._token}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"dispose",value:function e(){this._container.innerHTML="";this._viewer=undefined;this._container=undefined;this._eventHelper.removeAll();this._eventHelper=undefined;this._event=undefined}}]);return e}();t.FdUserLogining=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdCompass=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u="\n<svg id='compass' viewBox='-299 379 12 36' preserveAspectRatio='xMidYMid meet' focusable='false' style='display: block; width: 100%; height: 100%;'>\n    <g viewBox='-299 379 12 36'>\n        <style>\n            .st0 {\n                fill: #eb2a1c\n            }\n\n            .st1 {\n                fill-opacity: .15\n            }\n\n            .st2 {\n                fill: #fff\n            }\n\n            .st3 {\n                fill-opacity: 7.000000e-02\n            }\n\n            .st4 {\n                fill: #424242\n            }\n        </style>\n        <path class='st0' d='M-293 379l6 18h-12z'></path>\n        <path class='st1' d='M-293 379l6 18h-6z'></path>\n        <path class='st2' d='M-293 415l6-18h-12z'></path>\n        <path class='st3' d='M-293 415v-18h-6z'></path>\n        <circle id='Oval-3' class='st4' cx='-293' cy='397' r='2'>\n        </circle>\n    </g>\n</svg>\n";var l=function(){function e(t,r){(0,i.default)(this,e);this._viewer=t;this._compassContainer=r;r.innerHTML=u;var n=r.firstElementChild;this._compass=n;function a(e){var r=Freedo.Math.toDegrees(t.camera.heading);var i=-r;var a="rotate("+i+"deg)";n.style.webkitTransform=a;n.style.MozTransform=a;n.style.msTransform=a;n.style.OTransform=a;n.style.transform=a}a(t.camera.heading);this._removeListener=t.camera.changed.addEventListener(function(){a(t.camera.heading)});this._compass.onclick=function(){console.log("svg clicked!")}}(0,o.default)(e,[{key:"dispose",value:function e(){this._removeListener();this._removeListener=undefined;this._compassContainer.innerHTML="";this._viewer=undefined;this._compass=undefined}}]);return e}();t.FdCompass=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdWidgets=undefined;var n=r(1);var i=s(n);var a=r(231);var o=r(230);function s(e){return e&&e.__esModule?e:{default:e}}var u=function e(){(0,i.default)(this,e)};u.FdCompass=a.FdCompass;u.FdUserLogining=o.FdUserLogining;t.FdWidgets=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTextBox2D=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(11);var u=r(25);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){(0,i.default)(this,e);this._viewer=t;this._id=r;this._data=n;this._basePtCo=t.scene.primitives.add(new Freedo.PointPrimitiveCollection);this._basePt=undefined;this._canvas=undefined;this._ple=new u.FdPolylineEditor(t);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this.create()}(0,o.default)(e,[{key:"option",get:function e(){return Freedo.clone(this.getData(),true)}}]);return e}();c.prototype.create=function(){if(!Freedo.defined(this._data)){console.error("FdTextBox2D.prototype.create：参数无效");return}if(!Freedo.defined(this._id)){this._id=Freedo.createGuid()}if(!Freedo.defined(this._data.paddingLeft)){this._data.paddingLeft=50}if(!Freedo.defined(this._data.moveTop)){this._data.moveTop=50}if(!this._data.position){this._ple.run();this.addLsnr()}else{this.build()}};c.prototype.refresh=function(){this._viewer.scene.requestRender()};c.prototype.update=function(){var e=this._basePt.computeScreenSpacePosition(viewer.scene,new Freedo.Cartesian2);if(!Freedo.defined(e))return false;this._canvas.style.left=e.x+0+"px";this._canvas.style.top=e.y-this._data.moveTop+"px";var t=this._canvas.getContext("2d");t.clearRect(0,0,this._canvas.width,this._canvas.height);t.lineWidth=2;t.strokeStyle="white";t.shadowColor="rgba(0, 0, 0, 0.8)";t.shadowOffsetX=1;t.shadowOffsetY=1;t.shadowBlur=10;var r=this._data.paddingLeft;var n=1;var i=10;var a=this._data.width-r;var o=this._data.height-n;t.beginPath();t.moveTo(r,n+i*2);t.lineTo(2,this._data.moveTop-n);t.moveTo(r+i,n);t.lineTo(r+a-i,n);t.arcTo(r+a,n,r+a,n+i,i);t.lineTo(r+a,n+o-i);t.arcTo(r+a,n+o,r+a-i,n+o,i);t.lineTo(r+i,n+o);t.arcTo(r,n+o,r,n+o-i,i);t.lineTo(r,n+i);t.arcTo(r,n,r+i,n,i);t.closePath();t.stroke();t.font="16px 雅黑";t.lineWidth=1;t.fillStyle="white";t.textAlign="left";var s=this._data.text.split("|");for(var u=0;u<s.length;u++){t.fillText(s[u],r+10,n+20*(u+1))}};c.prototype.build=function(){var e=this._data;var t=e.position;var r=e.width;var n=e.height;if(!Freedo.defined(r)||!Freedo.defined(n)){console.error("FdTextBox2D.prototype.build：width或height参数无效");return}var i=s.FdMisc.FdGeometric.tc(t);var a=Freedo.Cartographic.fromCartesian(i);var o=s.FdMisc.FdGeometric.getLongAndLatRatio(a);this._data.positionC=Freedo.clone(i,true);var u=2e7;this._basePt=this._basePtCo.add({position:i,pixelSize:10,show:true,color:Freedo.Color.YELLOW,disableDepthTestDistance:Number.POSITIVE_INFINITY});if(this._canvas){document.body.removeChild(this._canvas);this._canvas=undefined}this._canvas=document.createElement("canvas");this._canvas.id=this._id;this._canvas.style.position="absolute";this._canvas.style.display="block";this._canvas.style.zIndex="999";this._canvas.width=e.width+10;this._canvas.height=e.height+10;this._canvas.style.pointerEvents="none";this._canvas.addEventListener("click",function(e){console.log("click")},false);this._canvas.ondrag=function(e){console.log("ondrag")};document.body.appendChild(this._canvas);this.update();this._viewer.scene.requestRender()};c.prototype.addLsnr=function(){if(this._lsner)this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){console.log(t);if(t=="cancel"){this.cancel()}if(t=="PointAdded"){e._data.position=Freedo.clone(r.position,true);e._ple.cancel();e._lsner();e.build()}if(t=="Transformed"){var n=r.positionG;var i=Freedo.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);e._data.position=Freedo.FdMisc.FdGeometric.tg(i);e.clear();e.build()}})};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.startEdit=function(){console.info("开始编辑");this.addLsnr();this._ple.startEdit([this._data.positionC])};c.prototype.endEdit=function(){this._ple.endEdit()};c.prototype.clear=function(){this._basePtCo.remove(this._basePt);if(this._canvas){document.body.removeChild(this._canvas);this._canvas=undefined}this._viewer.scene.requestRender()};c.prototype.remove=function(){this.clear();this._data=undefined;this._viewer.scene.requestRender()};c.prototype.show=function(){};c.prototype.hide=function(){};c.prototype.setText=function(e){this.clear();this._data.text=e;this.build()};c.prototype.getData=function(){if(!this._data)return undefined;var e=Freedo.clone(this._data,true);return{id:this._id,type:"TextBox2D",option:e}};c.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel()};c.prototype.dispose=function(){this.reset();this.remove()};t.FdTextBox2D=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdLoft=undefined;var n=r(1);var i=c(n);var a=r(6);var o=c(a);var s=r(72);var u=r(11);var l=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r,n){(0,i.default)(this,e);this._viewer=t;this._lsner=undefined;this._ple=new l.FdPolylineEditor(t);this._ple.setAutoLoop(false);this._ple.setAutoDelLines(true);this._handler=undefined;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._id=r;this._data=n;this._entities=[];this._coreLine=undefined;this._smoothRate=5;this._nearRate=4;this.create()}(0,o.default)(e,[{key:"option",get:function e(){return Freedo.clone(this.getData(),true)}}]);return e}();f.prototype.create=function(){if(!Freedo.defined(this._data)){console.error("FdLoft.prototype.create：参数无效");return}if(!Freedo.defined(this._id)){this._id=Freedo.createGuid()}if(!this._data.pts){if(Freedo.defined(this._data.heightOffset))this._ple.setHeightOffset(this._data.heightOffset);this._ple.run();this.addLsnr()}else{this.build()}};f.prototype.build=function(){var e=this._data;var t;var r=[];for(var n in e.pts){var i={position:e.pts[n]};r.push(i)}if(e.smoothRate==0)t=e.pts;else t=this.smoothPolyline(r);this._data.smoothPts=t;if(e.showBaseLine){this._coreLine=this.addCoreLine(e.pts)}this.buildLoft();this._ple.cancel();this._event.raiseEvent("EntityAdded",{});this._viewer.scene.requestRender()};f.prototype.buildLoft=function(){var e=this._data;var t=e.pts;t=e.smoothPts;var r=e.img;var n=undefined;if(r){n=new Freedo.ImageMaterialProperty({image:r,repeat:e.repeat})}else n=Freedo.Color.CHOCOLATE;var i={polylineVolume:{positions:t,shape:e.shape,material:n}};var a=this._viewer.entities.add(i);this._entities.push(a)};f.prototype.calcAngle=function(e,t,r){var n=FreeDo.Cartesian3.subtract(e,t,new FreeDo.Cartesian3);var i=FreeDo.Cartesian3.subtract(r,t,new FreeDo.Cartesian3);var a=Freedo.Cartesian3.angleBetween(n,i);return a};f.prototype.createAreaPrimitive=function(e,t,r){var n;var i=new Freedo.Cartesian3;var a=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(a,o,new Freedo.Cartesian3);n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3);var s=Freedo.Cartesian3.angleBetween(n,Freedo.Cartesian3.UNIT_Z);var u=Freedo.Cartesian3.cross(n,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3);var l=Freedo.Quaternion.fromAxisAngle(u,s,new Freedo.Quaternion);var c=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,l,new Freedo.Cartesian3(1,1,1));var f=Freedo.Matrix4.multiplyByPointAsVector(c,n,new Freedo.Cartesian3);var d=[];for(var h in e){var v=Freedo.Matrix4.multiplyByPointAsVector(c,e[h],new Freedo.Cartesian3);d.push(v)}for(var h in r){var v=Freedo.Matrix4.multiplyByPointAsVector(c,r[h],new Freedo.Cartesian3);d.push(v)}var p;if(false){}else{var _=[];for(var y=0;y<e.length;y++){_.push(e[y].x*1);_.push(e[y].y*1);_.push(e[y].z*1)}var m=[];if(r){for(var y=0;y<r.length;y++){_.push(r[y].x*1);_.push(r[y].y*1);_.push(r[y].z*1)}m.push(e.length)}var g=Freedo.PolygonPipeline.triangulate(d,m);var F=new Float64Array(_);p=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})},indices:new Uint16Array(g),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(F)})}if(!t)t=new Freedo.Color(1,1,0,.8);return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:p,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:true,translucent:true}),asynchronous:false})};f.prototype.addLsnr=function(){if(this._lsner){this._lsner();this._lsner=undefined}var e=this;this._lsner=this._ple.on(function(t,r){if(t=="PLAdd"){e.onPolylineAdded(r)}if(t=="EditEnd"){e._data.pts=Freedo.clone(r.pts);e.reDraw()}})};f.prototype.onPolylineAdded=function(e){this._data.pts=Freedo.clone(e.polyline.pts);this.build();this._ple.cancel()};f.prototype.calcCP=function(e,t,r){var n,i,a;n=e.position;i=t.position;a=r.position;var o=[];var s=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3);var u=FreeDo.Cartesian3.subtract(a,i,new FreeDo.Cartesian3);var l=FreeDo.Cartesian3.cross(s,u,new FreeDo.Cartesian3);var c=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3);var f=FreeDo.Cartesian3.normalize(u,new FreeDo.Cartesian3);var d=FreeDo.Cartesian3.add(c,f,new FreeDo.Cartesian3);var h=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var v=Freedo.Quaternion.fromAxisAngle(l,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var p=Freedo.Matrix3.fromQuaternion(h,new Freedo.Matrix3);var _=Freedo.Matrix3.fromQuaternion(v,new Freedo.Matrix3);var y=Freedo.Matrix3.multiplyByVector(p,d,new Freedo.Cartesian3);var m=Freedo.Matrix3.multiplyByVector(_,d,new Freedo.Cartesian3);var g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var F=FreeDo.Cartesian3.normalize(m,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.distance(n,i);var b=FreeDo.Cartesian3.distance(a,i);var C=1;if(w<b){C=w/this._nearRate}else C=b/this._nearRate;g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);F=FreeDo.Cartesian3.multiplyByScalar(F,C,new FreeDo.Cartesian3);var P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);var x=FreeDo.Cartesian3.add(i,F,new FreeDo.Cartesian3);var M=FreeDo.Cartesian3.distance(n,P);var S=FreeDo.Cartesian3.distance(n,x);if(M<S)return[P,x];else return[x,P]};f.prototype.setNearRate=function(e){this._nearRate=e;this.reDraw()};f.prototype.smoothPolyline=function(e){var t=[];if(e.length<3){for(var r=0;r<e.length;r++){t.push(e[r].position)}}else{for(var r=0;r<=e.length-2;r++){var n={},i={},a={},o={};if(r==0){n=e[0];i.position=this.calcCP(e[0],e[1],e[2])[0];a=e[0];o=e[1]}else if(r==e.length-2){n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i=e[r+1];a=e[r];o=e[r+1]}else{n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i.position=this.calcCP(e[r],e[r+1],e[r+2])[0];a=e[r];o=e[r+1]}var u=new s.FdBezierCurveAlgorithm(a,o,n,i);var l=u.getVertexForCurve(this._smoothRate);t=t.concat(l)}}var c=[];for(var r=0;r<t.length;r++){var f={};f=t[r];if(c.length>0){var d=FreeDo.Cartesian3.distance(c[c.length-1],f);if(d>1e-4)c.push(f)}else c.push(f)}return c};f.prototype.showBaseLine=function(e){this._data.showBaseLine=e};f.prototype.addCoreLine=function(e){var t=this._viewer.scene.primitives.add(this.createLinePrimitive(e));return t};f.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.setSmoothRate=function(e){this._smoothRate=e;this.reDraw()};f.prototype.clearEntities=function(e){for(var t in this._entities){var r=this._entities[t];this._viewer.entities.remove(r)}this._viewer.scene.primitives.remove(this._coreLine);this._entities=[];this._tempLines=[];this._viewer.scene.requestRender()};f.prototype.getData=function(){var e=Freedo.clone(this._data,true);return{id:this._id,type:"Loft",option:e}};f.prototype.startEdit=function(){this.addLsnr();this._ple.startEdit(this._data.pts)};f.prototype.editPre=function(){this._ple.editPre()};f.prototype.editNext=function(){this._ple.editNext()};f.prototype.endEdit=function(){this._ple.endEdit();this._lsner()};f.prototype.remove=function(){this.clearEntities();this._data=[]};f.prototype.reDraw=function(e){this.clearEntities();this.build()};f.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel()};f.prototype.dispose=function(){this.reset();this.remove()};t.FdLoft=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdCylinder=undefined;var n=r(1);var i=c(n);var a=r(6);var o=c(a);var s=r(72);var u=r(11);var l=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r,n){(0,i.default)(this,e);this._viewer=t;this._lsner=undefined;this._ple=new l.FdPolylineEditor(t);this._ple.setAutoLoop(false);this._ple.setAutoDelLines(true);this._handler=undefined;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._id=r;this._data=n;this._tempEntities=[];this._tempLines=[];this._entities=[];this._coreLine=undefined;this._offsetCylinder=new Freedo.Cartesian2(0,0);this.create()}(0,o.default)(e,[{key:"option",get:function e(){return Freedo.clone(this.getData(),true)}}]);return e}();f.prototype.create=function(){if(!Freedo.defined(this._data)){console.error("FdCylinder.prototype.create：参数无效");return}if(!Freedo.defined(this._id)){this._id=Freedo.createGuid()}if(!this._data.pts){this._ple.run();this.addLsnr()}else{this.build()}};f.prototype.updateM=function(){if(this._offsetCylinder.x<0){this._offsetCylinder.x=1}this._offsetCylinder.x-=.1;viewer.scene.requestRender()};f.prototype.build=function(){var e=this._data;var t;var r=[];for(var n in e.pts){var i={position:e.pts[n]};r.push(i)}if(e.smoothRate==0)t=points;else t=this.smoothPolyline(r);if(e.showBaseLine){this._coreLine=this.addCoreLine(e.pts)}if(e.innerRadius){this._entities=this.buildTube()}else{this._entities=this.buildCylinder()}this._event.raiseEvent("EntityAdded",{});this._viewer.scene.requestRender();this._inter=setInterval(this.updateM.bind(this),150)};f.prototype.buildCylinder=function(){var e=this._data;var t=e.pts;var r=this.buildSkeleton(t,e.radius);var n=[];for(var i=0;i<r.length;i++){var a=Freedo.clone(r[i].startPts,true);var o=Freedo.clone(r[i].endPts,true);var s=new Freedo.Color(1,0,0,.8);var u=this._viewer.scene.primitives.add(this.createAreaPrimitive(a,s));n.push(u);u=this._viewer.scene.primitives.add(this.createAreaPrimitive(o,s));n.push(u);a.push(a[0]);o.push(o[0]);var l=0;for(var c=0;c<a.length-1;c++){var f=FreeDo.Cartesian3.distance(a[c],a[c+1]);l+=f}for(var c=0;c<a.length-1;c++){var d=[];d.push(a[c]);d.push(a[c+1]);d.push(o[c+1]);d.push(o[c]);var h=FreeDo.Cartesian3.distance(a[c],a[c+1]);var v=1;var p=c/a.length*v;var _=(c+1)/a.length*v-1e-4;if(e.enableMaterial)u=this._viewer.scene.primitives.add(this.createRectPrimitive(d,undefined,undefined,p,_,l/v));else u=this._viewer.scene.primitives.add(this.createAreaPrimitive(d));n.push(u)}}return n};f.prototype.buildTube=function(){var e=this._data;var t=this.buildSkeleton(e.pts,e.radius);var r=this.buildSkeleton(e.pts,e.innerRadius);var n=[];for(var i=0;i<t.length;i++){var a=Freedo.clone(t[i].startPts,true);var o=Freedo.clone(t[i].endPts,true);var s=Freedo.clone(r[i].startPts,true);var u=Freedo.clone(r[i].endPts,true);var l=new Freedo.Color(1,0,0,.8);var c=this._viewer.scene.primitives.add(this.createAreaPrimitive(a,l,s));n.push(c);c=this._viewer.scene.primitives.add(this.createAreaPrimitive(o,l,u));n.push(c);l=new Freedo.Color(1,1,0,.8);a.push(a[0]);o.push(o[0]);for(var f=0;f<a.length-1;f++){var d=[];d.push(a[f]);d.push(a[f+1]);d.push(o[f+1]);d.push(o[f]);c=this._viewer.scene.primitives.add(this.createAreaPrimitive(d));n.push(c)}l=new Freedo.Color(1,0,0,.8);s.push(s[0]);u.push(u[0]);for(var f=0;f<s.length-1;f++){var d=[];d.push(s[f]);d.push(s[f+1]);d.push(u[f+1]);d.push(u[f]);c=this._viewer.scene.primitives.add(this.createAreaPrimitive(d));n.push(c)}}return n};f.prototype.buildSkeleton=function(e,t){var r={radius:t};var n=undefined;var i=5;var a=10;var o=20;var s=false;var u=[];for(var l=0;l<e.length-1;l++){var c=[];var f=[];if(l==0){var d,h,v;d=e[l];if(l+1==e.length-1){h=e[l+1];var p=Freedo.Cartesian3.subtract(h,d,new Freedo.Cartesian3);var _=new Freedo.Cartesian3(h.x,h.y,h.z+1);var y=Freedo.Cartesian3.subtract(_,d,new Freedo.Cartesian3);var m=Freedo.Cartesian3.cross(p,y,new Freedo.Cartesian3);var g=Freedo.Cartesian3.normalize(m,new Freedo.Cartesian3);var F=Freedo.Cartesian3.multiplyByScalar(g,r.radius,new Freedo.Cartesian3);var w=Freedo.Cartesian3.multiplyByScalar(g,r.radius*1,new Freedo.Cartesian3);for(var b=0;b<360;b=b+i){var C=Freedo.Quaternion.fromAxisAngle(p,Freedo.Math.toRadians(b),new Freedo.Quaternion);var P=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,C,new Freedo.Cartesian3(1,1,1));var x=Freedo.Matrix4.multiplyByPointAsVector(P,F,new Freedo.Cartesian3);var M=Freedo.Matrix4.multiplyByPointAsVector(P,w,new Freedo.Cartesian3);var S=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1);var T=new Freedo.Cartesian3(d.x+x.x,d.y+x.y,d.z+x.z);n=this._viewer.entities.add({position:T,point:{color:S,show:s,pixelSize:a}});this._tempEntities.push(n);var E=new Freedo.Cartesian3(h.x+M.x,h.y+M.y,h.z+M.z);n=this._viewer.entities.add({position:E,point:{color:S,show:s,pixelSize:o}});this._tempEntities.push(n);c.push(T);f.push(E)}}if(l+1<e.length-1){h=e[l+1];v=e[l+2];var p=FreeDo.Cartesian3.subtract(d,h,new FreeDo.Cartesian3);var D=FreeDo.Cartesian3.subtract(h,d,new FreeDo.Cartesian3);var y=FreeDo.Cartesian3.subtract(v,h,new FreeDo.Cartesian3);var A=Freedo.Cartesian3.angleBetween(p,y);var O=FreeDo.Cartesian3.normalize(p,new FreeDo.Cartesian3);var k=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var L=FreeDo.Cartesian3.add(O,k,new FreeDo.Cartesian3);var m=Freedo.Cartesian3.cross(p,y,new Freedo.Cartesian3);var g=Freedo.Cartesian3.normalize(m,new Freedo.Cartesian3);var F=Freedo.Cartesian3.multiplyByScalar(g,r.radius,new Freedo.Cartesian3);var w=Freedo.Cartesian3.multiplyByScalar(g,r.radius*1,new Freedo.Cartesian3);for(var b=0;b<360;b=b+i){var C=Freedo.Quaternion.fromAxisAngle(D,Freedo.Math.toRadians(b),new Freedo.Quaternion);var P=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,C,new Freedo.Cartesian3(1,1,1));var x=Freedo.Matrix4.multiplyByPointAsVector(P,F,new Freedo.Cartesian3);var S=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1);var T=new Freedo.Cartesian3(d.x+x.x,d.y+x.y,d.z+x.z);n=this._viewer.entities.add({position:T,point:{color:S,show:s,pixelSize:a}});this._tempEntities.push(n);var I=Freedo.Cartesian3.cross(m,L,new Freedo.Cartesian3);var R=Freedo.Quaternion.fromAxisAngle(I,Freedo.Math.toRadians(b),new Freedo.Quaternion);var N=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,R,new Freedo.Cartesian3(1,1,1));var M=Freedo.Matrix4.multiplyByPointAsVector(N,w,new Freedo.Cartesian3);var E=new Freedo.Cartesian3(h.x+M.x,h.y+M.y,h.z+M.z);n=this._viewer.entities.add({position:E,point:{color:S,show:s,pixelSize:o}});this._tempEntities.push(n);c.push(T);f.push(E)}}}if(l!=0){if(l+1==e.length-1){var d,h,v;d=e[l-1];h=e[l];v=e[l+1];var p=Freedo.Cartesian3.subtract(d,h,new Freedo.Cartesian3);var y=Freedo.Cartesian3.subtract(v,h,new Freedo.Cartesian3);var A=Freedo.Cartesian3.angleBetween(p,y);var O=FreeDo.Cartesian3.normalize(p,new FreeDo.Cartesian3);var k=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var L=FreeDo.Cartesian3.add(O,k,new FreeDo.Cartesian3);var m=Freedo.Cartesian3.cross(p,y,new Freedo.Cartesian3);var g=Freedo.Cartesian3.normalize(m,new Freedo.Cartesian3);var F=Freedo.Cartesian3.multiplyByScalar(g,r.radius,new Freedo.Cartesian3);var w=Freedo.Cartesian3.multiplyByScalar(g,r.radius,new Freedo.Cartesian3);for(var b=0;b<360;b=b+i){var D=Freedo.Cartesian3.cross(m,L,new Freedo.Cartesian3);var B=Freedo.Quaternion.fromAxisAngle(D,Freedo.Math.toRadians(b),new Freedo.Quaternion);var j=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,B,new Freedo.Cartesian3(1,1,1));var G=Freedo.Matrix4.multiplyByPointAsVector(j,F,new Freedo.Cartesian3);var S=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1);var T=new Freedo.Cartesian3(h.x+G.x,h.y+G.y,h.z+G.z);n=this._viewer.entities.add({position:T,point:{color:S,show:s,pixelSize:a}});this._tempEntities.push(n);var R=Freedo.Quaternion.fromAxisAngle(y,Freedo.Math.toRadians(b),new Freedo.Quaternion);var N=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,R,new Freedo.Cartesian3(1,1,1));var M=Freedo.Matrix4.multiplyByPointAsVector(N,w,new Freedo.Cartesian3);var E=new Freedo.Cartesian3(v.x+M.x,v.y+M.y,v.z+M.z);n=this._viewer.entities.add({position:E,point:{color:S,show:s,pixelSize:o}});this._tempEntities.push(n);c.push(T);f.push(E)}}if(l+1<e.length-1){var d,h,v,H;d=e[l-1];h=e[l];v=e[l+1];H=e[l+2];var p=Freedo.Cartesian3.subtract(d,h,new Freedo.Cartesian3);var y=Freedo.Cartesian3.subtract(v,h,new Freedo.Cartesian3);var V=Freedo.Cartesian3.subtract(h,v,new Freedo.Cartesian3);var X=Freedo.Cartesian3.subtract(H,v,new Freedo.Cartesian3);var A=Freedo.Cartesian3.angleBetween(p,y);var Y=Freedo.Cartesian3.angleBetween(V,X);var O=FreeDo.Cartesian3.normalize(p,new FreeDo.Cartesian3);var k=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var z=FreeDo.Cartesian3.normalize(V,new FreeDo.Cartesian3);var Z=FreeDo.Cartesian3.normalize(X,new FreeDo.Cartesian3);var L=FreeDo.Cartesian3.add(O,k,new FreeDo.Cartesian3);var U=FreeDo.Cartesian3.add(z,Z,new FreeDo.Cartesian3);var A=Freedo.Math.toDegrees(Freedo.Cartesian3.angleBetween(L,U));var m=Freedo.Cartesian3.cross(p,y,new Freedo.Cartesian3);var g=Freedo.Cartesian3.normalize(m,new Freedo.Cartesian3);var W=Freedo.Cartesian3.cross(V,X,new Freedo.Cartesian3);var q=Freedo.Cartesian3.normalize(W,new Freedo.Cartesian3);var F=Freedo.Cartesian3.multiplyByScalar(g,r.radius,new Freedo.Cartesian3);var w=Freedo.Cartesian3.multiplyByScalar(q,r.radius*1,new Freedo.Cartesian3);for(var b=0;b<360;b=b+i){var D=Freedo.Cartesian3.cross(m,L,new Freedo.Cartesian3);var B=Freedo.Quaternion.fromAxisAngle(D,Freedo.Math.toRadians(b),new Freedo.Quaternion);var j=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,B,new Freedo.Cartesian3(1,1,1));var G=Freedo.Matrix4.multiplyByPointAsVector(j,F,new Freedo.Cartesian3);var S=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1);var T=new Freedo.Cartesian3(h.x+G.x,h.y+G.y,h.z+G.z);n=this._viewer.entities.add({position:T,point:{color:S,show:s,pixelSize:a}});this._tempEntities.push(n);var I=Freedo.Cartesian3.cross(W,U,new Freedo.Cartesian3);var Q=b;if(A>90)Q=b+180;var R=Freedo.Quaternion.fromAxisAngle(I,Freedo.Math.toRadians(Q),new Freedo.Quaternion);var N=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,R,new Freedo.Cartesian3(1,1,1));var M=Freedo.Matrix4.multiplyByPointAsVector(N,w,new Freedo.Cartesian3);var E=new Freedo.Cartesian3(v.x+M.x,v.y+M.y,v.z+M.z);n=this._viewer.entities.add({position:E,point:{color:S,show:s,pixelSize:o}});this._tempEntities.push(n);c.push(T);f.push(E)}}}u.push({startPts:c,endPts:f})}return u};f.prototype.calcAngle=function(e,t,r){var n=FreeDo.Cartesian3.subtract(e,t,new FreeDo.Cartesian3);var i=FreeDo.Cartesian3.subtract(r,t,new FreeDo.Cartesian3);var a=Freedo.Cartesian3.angleBetween(n,i);return a};f.prototype.createAreaPrimitive=function(e,t,r){var n;var i=new Freedo.Cartesian3;var a=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(a,o,new Freedo.Cartesian3);n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3);var s=Freedo.Cartesian3.angleBetween(n,Freedo.Cartesian3.UNIT_Z);var u=Freedo.Cartesian3.cross(n,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3);var l=Freedo.Quaternion.fromAxisAngle(u,s,new Freedo.Quaternion);var c=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,l,new Freedo.Cartesian3(1,1,1));var f=Freedo.Matrix4.multiplyByPointAsVector(c,n,new Freedo.Cartesian3);var d=[];for(var h in e){var v=Freedo.Matrix4.multiplyByPointAsVector(c,e[h],new Freedo.Cartesian3);d.push(v)}for(var h in r){var v=Freedo.Matrix4.multiplyByPointAsVector(c,r[h],new Freedo.Cartesian3);d.push(v)}var p;if(false){}else{var _=[];for(var y=0;y<e.length;y++){_.push(e[y].x*1);_.push(e[y].y*1);_.push(e[y].z*1)}var m=[];if(r){for(var y=0;y<r.length;y++){_.push(r[y].x*1);_.push(r[y].y*1);_.push(r[y].z*1)}m.push(e.length)}var g=Freedo.PolygonPipeline.triangulate(d,m);var F=new Float64Array(_);p=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})},indices:new Uint16Array(g),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(F)})}if(!t)t=new Freedo.Color(1,1,0,.8);return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:p,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:true,translucent:true}),asynchronous:false})};f.prototype.createRectPrimitive=function(e,t,r,n,i,a){var o;var s=new Freedo.Cartesian3;var u=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var l=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);o=Freedo.Cartesian3.cross(u,l,new Freedo.Cartesian3);o=Freedo.Cartesian3.normalize(o,new Freedo.Cartesian3);var c=Freedo.Cartesian3.angleBetween(o,Freedo.Cartesian3.UNIT_Z);var f=Freedo.Cartesian3.cross(o,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3);var d=Freedo.Quaternion.fromAxisAngle(f,c,new Freedo.Quaternion);var h=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,d,new Freedo.Cartesian3(1,1,1));var v=Freedo.Matrix4.multiplyByPointAsVector(h,o,new Freedo.Cartesian3);var p=[];for(var _ in e){var y=Freedo.Matrix4.multiplyByPointAsVector(h,e[_],new Freedo.Cartesian3);p.push(y)}for(var _ in r){var y=Freedo.Matrix4.multiplyByPointAsVector(h,r[_],new Freedo.Cartesian3);p.push(y)}var m;if(false){}else{var g=[];for(var F=0;F<e.length;F++){g.push(e[F].x*1);g.push(e[F].y*1);g.push(e[F].z*1)}var w=[];var b=FreeDo.Cartesian3.distance(e[0],e[1]);var C=FreeDo.Cartesian3.distance(e[1],e[2]);var P=C/a;w.push(0,n);w.push(0,i);w.push(P,i);w.push(P,n);var x=[];if(r){for(var F=0;F<r.length;F++){g.push(r[F].x*1);g.push(r[F].y*1);g.push(r[F].z*1)}x.push(e.length)}var M=Freedo.PolygonPipeline.triangulate(p,x);var S=new Float64Array(g);m=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:S}),st:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:w})},indices:new Uint16Array(M),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(S)})}if(!t)t=new Freedo.Color(1,1,0,.8);var T=Freedo.FdApp.getFreedoXPath()+"Assets/Textures/ori/redtube.jpg";return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:m,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.MaterialAppearance({materialSupport:Freedo.MaterialAppearance.MaterialSupport.TEXTURED,material:new Freedo.Material({fabric:{type:"DiffuseMap",uniforms:{image:T,repeat:4,offset:this._offsetCylinder},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st+offset)).channels"}}})}),asynchronous:false})};f.prototype.addLsnr=function(){if(this._lsner){this._lsner();this._lsner=undefined}var e=this;this._lsner=this._ple.on(function(t,r){if(t=="PLAdd"){e.onPolylineAdded(r)}if(t=="EditEnd"){e._data.pts=Freedo.clone(r.pts);e.reDraw()}})};f.prototype.onPolylineAdded=function(e){this._data.pts=Freedo.clone(e.polyline.pts);this.build();this._ple.cancel()};f.prototype.calcCP=function(e,t,r){var n,i,a;n=e.position;i=t.position;a=r.position;var o=[];var s=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3);var u=FreeDo.Cartesian3.subtract(a,i,new FreeDo.Cartesian3);var l=FreeDo.Cartesian3.cross(s,u,new FreeDo.Cartesian3);var c=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3);var f=FreeDo.Cartesian3.normalize(u,new FreeDo.Cartesian3);var d=FreeDo.Cartesian3.add(c,f,new FreeDo.Cartesian3);var h=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var v=Freedo.Quaternion.fromAxisAngle(l,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var p=Freedo.Matrix3.fromQuaternion(h,new Freedo.Matrix3);var _=Freedo.Matrix3.fromQuaternion(v,new Freedo.Matrix3);var y=Freedo.Matrix3.multiplyByVector(p,d,new Freedo.Cartesian3);var m=Freedo.Matrix3.multiplyByVector(_,d,new Freedo.Cartesian3);var g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var F=FreeDo.Cartesian3.normalize(m,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.distance(n,i);var b=FreeDo.Cartesian3.distance(a,i);var C=1;if(w<b){C=w/this._nearRate}else C=b/this._nearRate;g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);F=FreeDo.Cartesian3.multiplyByScalar(F,C,new FreeDo.Cartesian3);var P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);var x=FreeDo.Cartesian3.add(i,F,new FreeDo.Cartesian3);var M=FreeDo.Cartesian3.distance(n,P);var S=FreeDo.Cartesian3.distance(n,x);if(M<S)return[P,x];else return[x,P]};f.prototype.setNearRate=function(e){this._nearRate=e;this.reDraw()};f.prototype.smoothPolyline=function(e){var t=[];if(e.length<3){for(var r=0;r<e.length;r++){t.push(e[r].position)}}else{for(var r=0;r<=e.length-2;r++){var n={},i={},a={},o={};if(r==0){n=e[0];i.position=this.calcCP(e[0],e[1],e[2])[0];a=e[0];o=e[1]}else if(r==e.length-2){n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i=e[r+1];a=e[r];o=e[r+1]}else{n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i.position=this.calcCP(e[r],e[r+1],e[r+2])[0];a=e[r];o=e[r+1]}var u=new s.FdBezierCurveAlgorithm(a,o,n,i);var l=u.getVertexForCurve(this._smoothRate);t=t.concat(l)}}var c=[];for(var r=0;r<t.length;r++){var f={};f=t[r];if(c.length>0){var d=FreeDo.Cartesian3.distance(c[c.length-1],f);if(d>1e-4)c.push(f)}else c.push(f)}return c};f.prototype.showBaseLine=function(e){this._data.showBaseLine=e};f.prototype.addCoreLine=function(e){var t=this._viewer.scene.primitives.add(this.createLinePrimitive(e));return t};f.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.setSmoothRate=function(e){this._smoothRate=e;this.reDraw()};f.prototype.clear=function(e){for(var t in this._entities){var r=this._entities[t];this._viewer.scene.primitives.remove(r)}this._viewer.scene.primitives.remove(this._coreLine);for(var t in this._tempEntities){this._viewer.entities.remove(this._tempEntities[t])}for(var t in this._tempLines){this._viewer.scene.primitives.remove(this._tempLines[t])}this._entities=[];this._tempLines=[];this._viewer.scene.requestRender()};f.prototype.getData=function(){if(!this._data)return this._data;var e=Freedo.clone(this._data,true);return{id:this._id,type:"Cylinder",option:e}};f.prototype.startEdit=function(){this.addLsnr();this._ple.startEdit(this._data.pts)};f.prototype.editPre=function(){this._ple.editPre()};f.prototype.editNext=function(){this._ple.editNext()};f.prototype.endEdit=function(){this._ple.endEdit();this._lsner()};f.prototype.remove=function(){this.clear();this._data=undefined};f.prototype.reDraw=function(e){this.clear();this.build()};f.prototype.setHeightOffset=function(e){this._ple.setHeightOffset(e)};f.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel();clearInterval(this._inter)};f.prototype.dispose=function(){this.reset();this.remove()};t.FdCylinder=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdBillboard=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(11);var u=r(25);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){(0,i.default)(this,e);this._viewer=t;this._id=r;this._data=n;this._board=undefined;this._arrow=undefined;this._canvas=undefined;this._ple=new u.FdPolylineEditor(t);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this.create()}(0,o.default)(e,[{key:"option",get:function e(){return Freedo.clone(this.getData(),true)}}]);return e}();c.prototype.create=function(){if(!Freedo.defined(this._data)){console.error("FdBillboard.prototype.create：参数无效");return}if(!Freedo.defined(this._id)){this._id=Freedo.createGuid()}if(!Freedo.defined(this._data.rotate)){this._data.rotate=0}if(!this._data.position){this._ple.run();this.addLsnr()}else{this.build()}};c.prototype.createAreaPrimitive=function(e,t){t=t||{};var r;var n=new Freedo.Cartesian3;var i=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var a=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);r=Freedo.Cartesian3.cross(i,a,new Freedo.Cartesian3);r=Freedo.Cartesian3.normalize(r,new Freedo.Cartesian3);var o=Freedo.Cartesian3.angleBetween(r,Freedo.Cartesian3.UNIT_Z);var s=Freedo.Cartesian3.cross(r,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3);var u=Freedo.Quaternion.fromAxisAngle(s,o,new Freedo.Quaternion);var l=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,u,new Freedo.Cartesian3(1,1,1));var c=Freedo.Matrix4.multiplyByPointAsVector(l,r,new Freedo.Cartesian3);var f=[];for(var d in e){var h=Freedo.Matrix4.multiplyByPointAsVector(l,e[d],new Freedo.Cartesian3);f.push(h)}var v;if(false){}else{var p=[];for(var _=0;_<e.length;_++){p.push(e[_].x*1);p.push(e[_].y*1);p.push(e[_].z*1)}var y=Freedo.PolygonPipeline.triangulate(f);var m=new Float64Array(p);v=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})},indices:new Uint16Array(y),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(m)})}var g;if(!t.color)g=new Freedo.Color(1,1,1,1);return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:v,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(g)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:true,translucent:true}),asynchronous:false})};c.prototype.callbackM=function(e,t){if(this._canvas)t=this._canvas;var r=Math.random();if(r>.9){this._viewer.scene.requestRender()}return t};c.prototype.refresh=function(){this._viewer.scene.requestRender()};c.prototype.update=function(){var e=this._data.divID;var t=this;html2canvas(document.getElementById(e),{backgroundColor:"#ffffff"}).then(function(e){t._canvas=e})};c.prototype.build=function(){var e=this._data;var t=e.position;var r=e.width;var n=e.height;var i=t[2];this.update();if(!Freedo.defined(r)||!Freedo.defined(n)){console.error("FdBillboard.prototype.build：width或height参数无效");return}var a=s.FdMisc.FdGeometric.tc(t);var o=Freedo.Cartographic.fromCartesian(a);var u=s.FdMisc.FdGeometric.getLongAndLatRatio(o);this._data.positionC=Freedo.clone(a,true);var l=new Freedo.CallbackProperty(this.callbackM.bind(this),false);var c=Freedo.Math.toRadians(e.rotate);this._board=viewer.entities.add({name:"boardEntity",wall:{positions:Freedo.Cartesian3.fromDegreesArrayHeights([t[0]-Freedo.Math.toDegrees(r*u[0]/2)*Math.cos(c),t[1]-Freedo.Math.toDegrees(r*u[1]/2)*Math.sin(c),n+i,t[0]+Freedo.Math.toDegrees(r*u[0]/2)*Math.cos(c),t[1]+Freedo.Math.toDegrees(r*u[1]/2)*Math.sin(c),n+i]),material:new Freedo.ImageMaterialProperty({image:l}),minimumHeights:[i+r/10,i+r/10],outline:true}});var f=[];f=Freedo.Cartesian3.fromDegreesArrayHeights([t[0],t[1],i,t[0]+Freedo.Math.toDegrees(r*u[0]/10)*Math.cos(c),t[1]+Freedo.Math.toDegrees(r*u[1]/10)*Math.sin(c),r/10+i,t[0]-Freedo.Math.toDegrees(r*u[0]/10)*Math.cos(c),t[1]-Freedo.Math.toDegrees(r*u[1]/10)*Math.sin(c),r/10+i,t[0],t[1],i]);this._arrow=viewer.scene.primitives.add(this.createAreaPrimitive(f));this._viewer.scene.requestRender()};c.prototype.addLsnr=function(){if(this._lsner)this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){console.log(t);if(t=="cancel"){this.cancel()}if(t=="PointAdded"){e._data.position=Freedo.clone(r.position,true);e._ple.cancel();e._lsner();e.build()}if(t=="Transformed"){var n=r.positionG;var i=Freedo.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);e._data.position=Freedo.FdMisc.FdGeometric.tg(i);e.clear();e.build()}})};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.startEdit=function(){console.info("开始编辑");this.addLsnr();this._ple.startEdit([this._data.positionC])};c.prototype.endEdit=function(){this._ple.endEdit()};c.prototype.clear=function(){this._viewer.entities.remove(this._board);this._viewer.scene.primitives.remove(this._arrow);this._board=undefined;this._arrow=undefined;this._viewer.scene.requestRender()};c.prototype.remove=function(){this.clear();this._data=undefined;this._viewer.scene.requestRender()};c.prototype.show=function(){if(this._board){this._board.show=true}if(this._arrow){this._arrow.show=true}};c.prototype.hide=function(){if(this._board){this._board.show=false}if(this._arrow){this._arrow.show=false}};c.prototype.getData=function(){if(!this._data)return undefined;var e=Freedo.clone(this._data,true);return{id:this._id,type:"Billboard",option:e}};c.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel()};c.prototype.dispose=function(){this.reset();this.remove()};t.FdBillboard=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdModelManager=undefined;var n=r(1);var i=l(n);var a=r(236);var o=r(235);var s=r(234);var u=r(233);function l(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){(0,i.default)(this,e);this._viewer=t;this._scene=this._viewer.scene;this._entities=[];this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper};c.prototype.addLsnr=function(){if(this._lsner)this._lsner();var e=this};c.prototype.add=function(e,t,r){if(!Freedo.defined(e)){console.error("FdModelManager.add：type参数无效")}var n=undefined;if(e=="Billboard"){n=new a.FdBillboard(this._viewer,r,t)}if(e=="Cylinder"){n=new o.FdCylinder(this._viewer,r,t)}if(e=="Loft"){n=new s.FdLoft(this._viewer,r,t)}if(e=="TextBox2D"){n=new u.FdTextBox2D(this._viewer,r,t)}if(n){n.type==e;this._entities.push(n);this._viewer.scene.requestRender();return n}};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.clearEntities=function(){for(var e in this._entities){this._entities[e].remove()}this._entities=[];this._viewer.scene.requestRender()};c.prototype.getData=function(){var e=[];for(var t in this._entities){var r=this._entities[t].getData();if(r)e.push(r)}return e};c.prototype.removeAll=function(){this.clearEntities()};c.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel()};c.prototype.dispose=function(){this.reset();this.clearEntities()};t.FdModelManager=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdModel=undefined;var n=r(1);var i=o(n);var a=r(237);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(){(0,i.default)(this,e)};s.FdModelManager=a.FdModelManager;t.FdModel=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdViewSwitcher=undefined;var n=r(1);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t){(0,i.default)(this,e);this._viewer=t;this._tempBall=null;this._spSize=0;this._oldType="";this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper};o.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};o.prototype.checkModelExist=function(){return false};o.prototype.getMode=function(){return this._oldType};o.prototype.start=function(e){var t=this;this._viewer.scene.noSphereMode=true;if(e==="MODEL_VIEW"){this._viewer.scene.skyAtmosphere.show=false;this._viewer.scene.fog.enabled=false;this._viewer.scene.globe.show=false;for(var r=0;r<this._viewer.dataSources.length;r++){var n=this._viewer.dataSources.get(r);n.show=false}}if(e==="COLUMBUS_VIEW"){this._viewer.scene.mode=Freedo.SceneMode.COLUMBUS_VIEW;if(this._oldType=="MODEL_VIEW"){this._viewer.terrainProvider=new Freedo.EllipsoidTerrainProvider}for(var r=0;r<this._viewer.dataSources.length;r++){var n=this._viewer.dataSources.get(r);n.show=true}this._viewer.scene.globe.show=true}if(e==="2D"){if(this._tempBall==null){this._viewer.entities.remove(this._tempBall);this._tempBall=null}this._viewer.scene.morphTo2D(.02);this._viewer.terrainProvider=new Freedo.EllipsoidTerrainProvider;for(var r=0;r<this._viewer.dataSources.length;r++){var n=this._viewer.dataSources.get(r);n.show=true}this._viewer.trackedEntity=undefined}if(e==="NORMAL_VIEW"){this.cancel()}this._oldType=e;this._event.raiseEvent("Start",{mode:this._oldType});this._viewer.scene.requestRender()};o.prototype.morphTo3D=function(){this._viewer.scene.mode=Freedo.SceneMode.SCENE3D};o.prototype.cancel=function(){if(this._oldType=="MODEL_VIEW"){}this._viewer.scene.globe.show=true;this._viewer.scene.skyAtmosphere.show=true;this._viewer.scene.fog.enabled=true;this._viewer.scene.noSphereMode=false;setTimeout(this.morphTo3D.bind(this),500);for(var e=0;e<this._viewer.dataSources.length;e++){var t=this._viewer.dataSources.get(e);t.show=true}if(this._tempBall!=null){this._viewer.entities.remove(this._tempBall);this._tempBall=null}this._event.raiseEvent("Cancel",{mode:this._oldType});this._oldType="NORMAL_VIEW";this._viewer.scene.requestRender()};o.prototype.reset=function(){this.cancel()};o.prototype.dispose=function(){this.reset()};t.FdViewSwitcher=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPMTSManager=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,i.default)(this,e);this._pmtsOpts=new Freedo.AssociativeArray;this._pmtsCollection=new Freedo.AssociativeArray;this._viewer=t;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper}(0,o.default)(e,[{key:"add",value:function e(t,r){if(typeof t.id==="undefined"){t.id=Freedo.createGuid()}var n=t.url;this._pmtsOpts.set(t.id,Freedo.clone(t,true));var i={};this._pmtsCollection.set(t.id,i);var a=this;Freedo.FdServer.FdPMTSServer.getResource(n,r,function(e,n){if(n){console.error("FdServer.FdShareServer.getLayerAccesskeyResource got error: "+n);return}i.pModelInfos=[];e.contents.layers.forEach(function(n){var o=Freedo.FdServer.FdPMTSParser.getMatrixSets(e,n);o.forEach(function(e){e.matrix.forEach(function(o){var s=Freedo.FdServer.FdPMTSParser.getPModelURL(n,e,o,r);var u=a._viewer.scene.primitives.add(new Freedo.FreedoPModelset({url:s}));if(typeof t.modelMatrix!=="undefined"){u.modelMatrix=Freedo.Matrix4.fromArray(t.modelMatrix)}i.pModelInfos.push({pModel:u,matrix:o,matrixSet:e,layer:n})})})});a._event.raiseEvent("PmtsLoaded",t.id)});this._event.raiseEvent("Changed");return t.id}},{key:"remove",value:function e(t){var r=this;this._pmtsOpts.remove(t);var n=this._pmtsCollection.get(t);if(typeof n!=="undefined"){n.pModelInfos.forEach(function(e){r._viewer.scene.primitives.remove(e.pModel)})}this._pmtsCollection.remove(t);this._event.raiseEvent("Changed")}},{key:"removeAll",value:function e(){this._pmtsOpts.removeAll();this._pmtsCollection.values.forEach(function(e){var t=this;if(typeof e.pModelInfos!=="undefined"){e.pModelInfos.forEach(function(e){t._viewer.scene.primitives.remove(e.pModel)})}});this._pmtsCollection.removeAll();this._event.raiseEvent("Changed")}},{key:"getPmts",value:function e(t){return this._pmtsCollection.get(t)}},{key:"setModelMatrix",value:function e(t,r){var n=Freedo.Matrix4.fromArray(r);var i=this._pmtsCollection.get(t);i.pModelInfos.forEach(function(e){e.pModel.modelMatrix=n});var a=this._pmtsOpts.get(t);a.modelMatrix=r;this._event.raiseEvent("Changed")}},{key:"getModelMatrix",value:function e(t){var r=this._pmtsOpts.get(t);var n=r.modelMatrix;return n}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){this.removeAll()}},{key:"dispose",value:function e(){this.reset();this._eventHelper.removeAll()}},{key:"data",get:function e(){return Freedo.clone({collection:this._pmtsOpts.values},true)}}]);return e}();function l(e,t){if(typeof g_pmtsServer==="undefined"){g_pmtsServer="cfgateway.gbim360.cn"}return"//"+g_pmtsServer+"/freeserver-pmts/services/share/"+e+"/pmts/1.0.0/PMTSCapabilities.json?accesskey="+t}u.getPublicSharedPmtsURL=l;t.FdPMTSManager=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdFlyToController=undefined;var n=r(1);var i=u(n);var a=r(6);var o=u(a);var s=r(122);function u(e){return e&&e.__esModule?e:{default:e}}var l=new Freedo.Matrix4;var c=function(){function e(t){(0,i.default)(this,e);this._viewpoints=null;this._camera=t;this._currentIndex=-1;this._status="Stopped";this._flyingToIndex=-1;this._loop=false;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._timeoutID=undefined}(0,o.default)(e,[{key:"startOrResume",value:function e(){switch(this._status){case"Playing":break;case"Stopped":this._play();break;case"Paused":this._play();break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"pause",value:function e(){switch(this._status){case"Playing":this._pause();break;case"Stopped":break;case"Paused":break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"stop",value:function e(){switch(this._status){case"Playing":this._stop();break;case"Stopped":break;case"Paused":this._stop();break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"reset",value:function e(){this._stop();this._viewpoints=null}},{key:"dispose",value:function e(){this._viewpoints=null}},{key:"_setViewpoints",value:function e(t){this._stop();this._viewpoints=t}},{key:"_getViewpoints",value:function e(){return this._viewpoints}},{key:"_play",value:function e(){if(this._viewpoints===null){throw new Error("FdFlyToController play error!")}this._flytoNext();this._setStatus("Playing")}},{key:"_pause",value:function e(){this._cancel();this._setStatus("Paused")}},{key:"_stop",value:function e(){this._cancel();this._setCurrentIndex(-1);this._setStatus("Stopped")}},{key:"_completeCallback",value:function e(){this._setCurrentIndex(this._flyingToIndex);if(this._currentIndex>=this._viewpoints.length){this._setCurrentIndex(-1)}this._flyingToIndex=-1;var t=this;this._timeoutID=setTimeout(function(){t._flytoNext()},1e3)}},{key:"_flytoNext",value:function e(){this._cancel();var t;if(this._currentIndex>=this._viewpoints.length-1){if(this._loop&&this._viewpoints.length!==1){this._flyingToIndex=0}else{this._stop()}}else{this._flyingToIndex=this._currentIndex+1}if(this._flyingToIndex!==-1){t=this._viewpoints[this._flyingToIndex].cameraInfo;if(typeof t!=="undefined"){var r=this;(0,s.flyToByCameraInfo)(r._camera,t,{complete:function e(){r._completeCallback()}})}}}},{key:"_cancel",value:function e(){clearTimeout(this._timeoutID);this._timeoutID=undefined;this._camera.cancelFlight();this._flyingToIndex=-1}},{key:"_goto",value:function e(t){if(t>=this._viewpoints.length){throw new Error("FdFlyToController inde error")}this._cancel();var r=this._viewpoints.list[t];var n=r.cameraInfo;if(typeof n==="undefined"){throw new Error("FdFlyToController cameraInfo error")}(0,s.goToByCameraInfo)(this._camera,n)}},{key:"_setStatus",value:function e(t){this._status=t;this._event.raiseEvent("StatusChanged",t)}},{key:"_setCurrentIndex",value:function e(t){this._currentIndex=t;this._event.raiseEvent("CurrentIndexChanged",t)}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){this._setViewpoints(null);this._stop()}},{key:"dispose",value:function e(){this.reset();this._eventHelper.removeAll()}},{key:"currentIndex",get:function e(){return this._currentIndex},set:function e(t){this._goto(t);this._setCurrentIndex(t)}},{key:"status",get:function e(){return this._status}},{key:"loop",get:function e(){return this._loop},set:function e(t){this._loop=t;this._event.raiseEvent("PropertyChanged")}}]);return e}();t.FdFlyToController=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdViewPointsManager=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(122);var u=r(241);function l(e){return e&&e.__esModule?e:{default:e}}var c=new Freedo.Matrix4;var f=function(){function e(t){(0,i.default)(this,e);this._viewpointOpts={};this._viewer=t;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._flytoControl=new u.FdFlyToController(t.scene.camera);this._currentPlayingGroupID=undefined;var r=this;this._flytoControl.on(function(e,t){r.flyToEventCallback(e,t)})}(0,o.default)(e,[{key:"flyToEventCallback",value:function e(t,r){if(t==="CurrentIndexChanged"){this._event.raiseEvent("PlayingGroupCurrentIndexChanged",r)}else if(t==="StatusChanged"){this._event.raiseEvent("PlayingGroupStatusChanged",r)}else if(t==="PropertyChanged"){this._event.raiseEvent("PlayingGroupPropertyChanged",r)}}},{key:"createGroup",value:function e(t,r){if(typeof r==="undefined"){r=Freedo.createGuid()}this._viewpointOpts[r]={name:t,list:[]};this._event.raiseEvent("GroupsChanged",r);return r}},{key:"removeGroup",value:function e(t){if(typeof this._viewpointOpts[t]==="undefined"){return false}if(this._currentPlayingGroupID===t){this._flytoControl.reset()}delete this._viewpointOpts[t];this._event.raiseEvent("GroupsChanged",t);return true}},{key:"getGroupName",value:function e(t){if(typeof this._viewpointOpts[t]==="undefined"){return""}return this._viewpointOpts[t].name}},{key:"setGroupName",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){return""}this._viewpointOpts[t].name=r}},{key:"getGroupOptions",value:function e(t){if(typeof this._viewpointOpts[t]==="undefined"){return undefined}var r=Freedo.clone(this._viewpointOpts[t],true);return r}},{key:"removeAllGroups",value:function e(){this._flytoControl.reset();for(var t in this._viewpointOpts){delete this._viewpointOpts[t]}this._currentPlayingGroupID=undefined;this._event.raiseEvent("GroupsChanged");return true}},{key:"getAllGroupIDs",value:function e(){var t=[];for(var r in this._viewpointOpts){t.push(r)}return t}},{key:"appendViewpoint",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){return false}var n=Freedo.clone(r,true);this._viewpointOpts[t].list.push(n);this._event.raiseEvent("GroupChanged",t);return true}},{key:"insertViewpoint",value:function e(t,r,n){if(typeof this._viewpointOpts[t]==="undefined"){return false}var i=Freedo.clone(r,true);this._viewpointOpts[t].list.splice(n,0,i);this._event.raiseEvent("GroupChanged",t);return true}},{key:"removeViewpoint",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){return false}if(typeof this._viewpointOpts[t].list[r]==="undefined"){return false}this._viewpointOpts[t].list.splice(r,1);this._event.raiseEvent("GroupChanged",t);return true}},{key:"getViewpointsLength",value:function e(t){if(typeof this._viewpointOpts[t]==="undefined"){throw new Error("getViewpointsLength error!")}return this._viewpointOpts[t].list.length}},{key:"setViewpoint",value:function e(t,r,n){if(typeof this._viewpointOpts[t]==="undefined"){return false}if(typeof this._viewpointOpts[t].list[r]==="undefined"){return false}var i=Freedo.clone(n,true);this._viewpointOpts[t].list[r]=i;this._event.raiseEvent("ViewPointChanged",i);return true}},{key:"getViewPoint",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){throw new Error("getViewPoint error")}if(typeof this._viewpointOpts[t].list[r]==="undefined"){return new Error("getViewPoint error")}var n=this._viewpointOpts[t].list[r];var i=Freedo.clone(n,true);return i}},{key:"flyTo",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){return false}if(typeof this._viewpointOpts[t].list[r]==="undefined"){return false}var n=this._viewpointOpts[t].list[r];var i=n.cameraInfo;if(typeof i==="undefined"){return false}var a=this._viewer.scene.camera;(0,s.flyToByCameraInfo)(a,i);return true}},{key:"goTo",value:function e(t,r){if(typeof this._viewpointOpts[t]==="undefined"){return false}if(typeof this._viewpointOpts[t].list[r]==="undefined"){return false}var n=this._viewpointOpts[t].list[r];var i=n.cameraInfo;if(typeof i==="undefined"){return false}var a=this._viewer.scene.camera;(0,s.goToByCameraInfo)(a,i);return true}},{key:"startOrResumeGroup",value:function e(t){if(typeof t==="undefined"){if(typeof this._currentPlayingGroupID!=="undefined"){t=this._currentPlayingGroupID}else{throw new Error("FdViewPointsManager startOrResume should have argument!")}}if(typeof this._currentPlayingGroupID!=="undefined"){if(t!==this._currentPlayingGroupID){this._flytoControl.stop();this._flytoControl._setViewpoints(null);this._flytoControl._setViewpoints(this._viewpointOpts[t].list);this._currentPlayingGroupID=t;this._flytoControl.startOrResume()}else{this._flytoControl.startOrResume()}}else{this._flytoControl._setViewpoints(this._viewpointOpts[t].list);this._currentPlayingGroupID=t;this._flytoControl.startOrResume()}}},{key:"pauseGroup",value:function e(){this._flytoControl.pause()}},{key:"stopGroup",value:function e(){this._flytoControl.stop()}},{key:"getGroupPlayingStatus",value:function e(){return this._flytoControl.status}},{key:"getGroupPlayingIndex",value:function e(){return this._flytoControl.currentIndex}},{key:"setGroupPlayingIndex",value:function e(t){this._flytoControl.currentIndex=t}},{key:"getGroupPlayingGroupID",value:function e(){return this._currentPlayingGroupID}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){this.removeAllGroups();this._flytoControl.reset()}},{key:"dispose",value:function e(){this.reset();this._flytoControl.dispose();this._eventHelper.removeAll()}},{key:"viewPointsOptions",get:function e(){return this._viewpointOpts}},{key:"playingLoop",get:function e(){return this._flytoControl.loop},set:function e(t){if(this._flytoControl.loop!==t){this._flytoControl.loop=t}}}]);return e}();t.FdViewPointsManager=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTerrain=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._scene=this._viewer.scene;this._terrainOption={};this._showTerrain=false;this._terrain=new Freedo.CesiumTerrainProvider({url:"//terrain.gbim360.com",requestWaterMask:false});this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._defaultTerrain=new Freedo.EllipsoidTerrainProvider}(0,o.default)(e,[{key:"setTerrain",value:function e(t,r,n){if(typeof t==="string"){if(r==="HM"){this._terrain=new Freedo.CesiumTerrainProvider({url:t,constraintRegions:n,requestWaterMask:false})}else if(r==="STK"){this._terrain=new Freedo.CesiumTerrainProvider({url:t,constraintRegions:n,requestWaterMask:false})}else if(r==="WETS"){this._terrain=new Freedo.WETSTerrainProvider({sources:[{capabilitiesUrl:t}],constraintRegions:n})}else{throw new Freedo.RuntimeError("The Terrain Type:"+r+" is not supported at present!");return}this._terrainOption.type=r;this._terrainOption.show=true;this._terrainOption.options=t;this._event.raiseEvent("TypeChanged",{type:r});this.visible=true}else{this.setWETSTerrain(t,n)}}},{key:"setWETSTerrain",value:function e(t,r){if(!(t instanceof Array)){throw new Error("The parameter of setWETSTerrain must be an Array!");return}if(t.length<1){return}if(!r instanceof Array){r=undefined}this._terrain=new Freedo.WETSTerrainProvider({sources:t,constraintRegions:r});this._terrainOption.type="WETS";this._terrainOption.show=true;this._terrainOption.options=t;this._event.raiseEvent("TypeChanged",{type:"WETS"});this.visible=true}},{key:"enableTerrainReverseSkirt",value:function e(){var t=this._terrain;if(!(t instanceof Freedo.WETSTerrainProvider)){throw new Error("The current Terrain is not The Freedo.WETSTerrainProvider Object!");return}var r=this._viewer;r.scene.screenSpaceCameraController.enableCollisionDetection=false;var n=r.camera;n.showTerrainWhenUnderGround=true;n.reverseSkirtWhenUnderGround=true;t.addReverseSkirt=true;t._hideSkirtIndexBufferWithContext=[];t._reverseSkirtIndexBufferWithContext=[];t._heightmapWidth1=65;t._heightmapHeight1=65;t.getHideSkirtIndexBuffer=function(){return function(t){var r=this._hideSkirtIndexBufferWithContext[t.id];if(!r){r=this._hideSkirtIndexBufferWithContext[t.id]=Freedo.Buffer.createIndexBuffer({context:t,typedArray:e(this._heightmapWidth1,this._heightmapHeight1),usage:Freedo.BufferUsage.STATIC_DRAW,indexDatatype:Freedo.IndexDatatype.UNSIGNED_SHORT});r.vertexArrayDestroyable=false;r.referenceCount=1}return r};function e(e,t){var r=new Uint16Array((e-1)*(t-1)*6);var n=0;var i=0;for(var a=0;a<t+1;++a){for(var o=0;o<e+1;++o){if(a>0&&a<t&&o>0&&o<e){var s=n;var u=s+e+2;var l=u+1;var c=s+1;r[i++]=s;r[i++]=u;r[i++]=c;r[i++]=c;r[i++]=u;r[i++]=l}++n}++n}return r}}();t.getReverseSkirtIndexBuffer=function(){return function(t){var r=this._reverseSkirtIndexBufferWithContext[t.id];if(!r){r=this._reverseSkirtIndexBufferWithContext[t.id]=Freedo.Buffer.createIndexBuffer({context:t,typedArray:e(this._heightmapWidth1,this._heightmapHeight1),usage:Freedo.BufferUsage.STATIC_DRAW,indexDatatype:Freedo.IndexDatatype.UNSIGNED_SHORT});r.vertexArrayDestroyable=false;r.referenceCount=1}return r};function e(e,t){var r=new Uint16Array((e+1)*(t+1)*6);var n=0;var i=0;var a=(e+2)*(t+2);for(var o=0;o<t+1;++o){for(var s=0;s<e+1;++s){var u=n;var l=u+e+2;var c=l+1;var f=u+1;if(o===0){u=a+s;f=u+1;if(s===0){l=a+(e+2)}else if(s===e){c=a+(e+2)+1}}else if(o===t){l=a+(e+2+2*t)+s;c=l+1;if(s===0){u=a+(e+2+2*(t-1))}else if(s===e){f=a+(e+2+2*(t-1))+1}}else if(s===0){u=a+(e+2)+2*(o-1)+s;l=u+2}else if(s===e){f=a+(e+2)+2*(o-1)+1;c=f+2}r[i++]=u;r[i++]=l;r[i++]=f;r[i++]=f;r[i++]=l;r[i++]=c;++n}++n}return r}}()}},{key:"setDepthTest",value:function e(t){this._viewer.scene.globe.depthTestAgainstTerrain=t;this._viewer.scene.requestRender()}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){this.visible=false}},{key:"dispose",value:function e(){this.reset();this._terrainOption={};this._terrain=null;this._eventHelper.removeAll()}},{key:"visible",get:function e(){return this._showTerrain},set:function e(t){if(this._showTerrain&&t===false){this._viewer.terrainProvider=this._defaultTerrain;this._showTerrain=false}else if(!this._showTerrain&&t===true){this._viewer.terrainProvider=this._terrain;this._showTerrain=true}else if(this._showTerrain&&t===true){this._viewer.terrainProvider=this._terrain;this._showTerrain=true}this._terrainOption.show=t;this._event.raiseEvent("StatusChanged",{status:t});this._viewer.scene.requestRender()}},{key:"terrain",get:function e(){return this._terrain}},{key:"terrainOptions",get:function e(){return this._terrainOption}}]);return e}();t.FdTerrain=u},function(e,t,r){r(101)("observable")},function(e,t,r){r(101)("asyncIterator")},function(e,t,r){var n=r(77);var i=r(83);var a=r(61);var o=r(120);var s=r(47);var u=r(174);var l=Object.getOwnPropertyDescriptor;t.f=r(29)?l:function e(t,r){t=a(t);r=o(r,true);if(u)try{return l(t,r)}catch(e){}if(s(t,r))return i(!n.f.call(t,r),t[r])}},function(e,t,r){var n=r(61);var i=r(157).f;var a={}.toString;var o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function e(t){return o&&a.call(t)=="[object Window]"?s(t):i(n(t))}},function(e,t,r){var n=r(81);var i=r(103);var a=r(77);e.exports=function(e){var t=n(e);var r=i.f;if(r){var o=r(e);var s=a.f;var u=0;var l;while(o.length>u)if(s.call(e,l=o[u++]))t.push(l)}return t}},function(e,t,r){"use strict";var n=r(16);var i=r(47);var a=r(29);var o=r(17);var s=r(170);var u=r(106).KEY;var l=r(64);var c=r(111);var f=r(70);var d=r(80);var h=r(13);var v=r(102);var p=r(101);var _=r(248);var y=r(163);var m=r(40);var g=r(30);var F=r(61);var w=r(120);var b=r(83);var C=r(115);var P=r(247);var x=r(246);var M=r(31);var S=r(81);var T=x.f;var E=M.f;var D=P.f;var A=n.Symbol;var O=n.JSON;var k=O&&O.stringify;var L="prototype";var I=h("_hidden");var R=h("toPrimitive");var N={}.propertyIsEnumerable;var B=c("symbol-registry");var j=c("symbols");var G=c("op-symbols");var H=Object[L];var V=typeof A=="function";var X=n.QObject;var Y=!X||!X[L]||!X[L].findChild;var z=a&&l(function(){return C(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=T(H,t);if(n)delete H[t];E(e,t,r);if(n&&e!==H)E(H,t,n)}:E;var Z=function(e){var t=j[e]=C(A[L]);t._k=e;return t};var U=V&&typeof A.iterator=="symbol"?function(e){return typeof e=="symbol"}:function(e){return e instanceof A};var W=function e(t,r,n){if(t===H)W(G,r,n);m(t);r=w(r,true);m(n);if(i(j,r)){if(!n.enumerable){if(!i(t,I))E(t,I,b(1,{}));t[I][r]=true}else{if(i(t,I)&&t[I][r])t[I][r]=false;n=C(n,{enumerable:b(0,false)})}return z(t,r,n)}return E(t,r,n)};var q=function e(t,r){m(t);var n=_(r=F(r));var i=0;var a=n.length;var o;while(a>i)W(t,o=n[i++],r[o]);return t};var Q=function e(t,r){return r===undefined?C(t):q(C(t),r)};var K=function e(t){var r=N.call(this,t=w(t,true));if(this===H&&i(j,t)&&!i(G,t))return false;return r||!i(this,t)||!i(j,t)||i(this,I)&&this[I][t]?r:true};var J=function e(t,r){t=F(t);r=w(r,true);if(t===H&&i(j,r)&&!i(G,r))return;var n=T(t,r);if(n&&i(j,r)&&!(i(t,I)&&t[I][r]))n.enumerable=true;return n};var $=function e(t){var r=D(F(t));var n=[];var a=0;var o;while(r.length>a){if(!i(j,o=r[a++])&&o!=I&&o!=u)n.push(o)}return n};var ee=function e(t){var r=t===H;var n=D(r?G:F(t));var a=[];var o=0;var s;while(n.length>o){if(i(j,s=n[o++])&&(r?i(H,s):true))a.push(j[s])}return a};if(!V){A=function e(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:undefined);var r=function(e){if(this===H)r.call(G,e);if(i(this,I)&&i(this[I],t))this[I][t]=false;z(this,t,b(1,e))};if(a&&Y)z(H,t,{configurable:true,set:r});return Z(t)};s(A[L],"toString",function e(){return this._k});x.f=J;M.f=W;r(157).f=P.f=$;r(77).f=K;r(103).f=ee;if(a&&!r(82)){s(H,"propertyIsEnumerable",K,true)}v.f=function(e){return Z(h(e))}}o(o.G+o.W+o.F*!V,{Symbol:A});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;te.length>re;)h(te[re++]);for(var ne=S(h.store),ie=0;ne.length>ie;)p(ne[ie++]);o(o.S+o.F*!V,"Symbol",{for:function(e){return i(B,e+="")?B[e]:B[e]=A(e)},keyFor:function e(t){if(!U(t))throw TypeError(t+" is not a symbol!");for(var r in B)if(B[r]===t)return r},useSetter:function(){Y=true},useSimple:function(){Y=false}});o(o.S+o.F*!V,"Object",{create:Q,defineProperty:W,defineProperties:q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:ee});O&&o(o.S+o.F*(!V||l(function(){var e=A();return k([e])!="[null]"||k({a:e})!="{}"||k(Object(e))!="{}"})),"JSON",{stringify:function e(t){var r=[t];var n=1;var i,a;while(arguments.length>n)r.push(arguments[n++]);a=i=r[1];if(!g(i)&&t===undefined||U(t))return;if(!y(i))i=function(e,t){if(typeof a=="function")t=a.call(this,e,t);if(!U(t))return t};r[1]=i;return k.apply(O,r)}});A[L][R]||r(44)(A[L],R,A[L].valueOf);f(A,"Symbol");f(Math,"Math",true);f(n.JSON,"JSON",true)},function(e,t,r){r(249);r(78);r(245);r(244);e.exports=r(14).Symbol},function(e,t,r){e.exports={default:r(250),__esModule:true}},function(e,t,r){r(60);r(63);e.exports=r(102).f("iterator")},function(e,t,r){e.exports={default:r(252),__esModule:true}},function(e,t,r){"use strict";t.__esModule=true;var n=r(253);var i=u(n);var a=r(251);var o=u(a);var s=typeof o.default==="function"&&typeof i.default==="symbol"?function(e){return typeof e}:function(e){return e&&typeof o.default==="function"&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e};function u(e){return e&&e.__esModule?e:{default:e}}t.default=typeof o.default==="function"&&s(i.default)==="symbol"?function(e){return typeof e==="undefined"?"undefined":s(e)}:function(e){return e&&typeof o.default==="function"&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e==="undefined"?"undefined":s(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdImageryLayersManager=undefined;var n=r(254);var i=l(n);var a=r(1);var o=l(a);var s=r(6);var u=l(s);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,o.default)(this,e);this._imageryLayersOpts=[];this._viewer=t;this._imageryLayers=t.imageryLayers;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._imageryLayers.layerAdded.addEventListener(e.prototype._rawEventCallback,this);this._imageryLayers.layerMoved.addEventListener(e.prototype._rawEventCallback,this);this._imageryLayers.layerRemoved.addEventListener(e.prototype._rawEventCallback,this);this._imageryLayers.layerShownOrHidden.addEventListener(e.prototype._rawEventCallback,this)}(0,u.default)(e,[{key:"_rawEventCallback",value:function e(){this._event.raiseEvent("Changed")}},{key:"addDefaultImageryLayer",value:function e(){var t={name:"谷歌影像",type:"UrlTemplate",iconUrl:"../../Freedo/Freedo/Widgets/Images/ImageryProviders/blackMarble.png",layerOption:{show:true,alpha:1},providerOptions:{url:"//mt0.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&y={y}&z={z}",maximumLevel:20,tilingScheme:"WebMercator"}};var r=this._imageryLayers.length;this.add(t,r)}},{key:"getLayerProperty",value:function e(t,r){var n=this._imageryLayersOpts[t];if(typeof n==="undefined"){throw new Error("FdImageryLayersManager.getLayerProperty: cannot get property!")}if(n.layerOption&&typeof n.layerOption[r]!=="undefined"){return n.layerOption[r]}else{var a=this._imageryLayers.get(t);if((0,i.default)(a[r]!=="undefined")){return a[r]}else{throw new Error("FdImageryLayersManager.getLayerProperty: cannot get property!")}}}},{key:"setLayerProperty",value:function e(t,r,n){var a=this._imageryLayersOpts[t];if(typeof a==="undefined"){throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!")}var o=this.getLayerProperty(t,r);if(_.isEqual(o,n)){return}var s=this._imageryLayers.get(t);if((0,i.default)(s[r]!=="undefined")){s[r]=n}else{throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!")}if(typeof a.layerOption==="undefined"){a.layerOption={}}a.layerOption[r]=n;this._event.raiseEvent("Changed");this._viewer.scene.requestRender()}},{key:"add",value:function e(t,r){if(this._imageryLayersOpts.length===0){this._imageryLayers.removeAll();r=0}if(typeof r==="undefined"){r=this._imageryLayersOpts.length;this._imageryLayersOpts.push(t)}else{this._imageryLayersOpts.splice(r,0,t)}var n=Freedo.clone(t.providerOptions,true);var a;switch(t.type){case"BingMaps":{if(n.mapStyle==="AERIAL"){n.mapStyle=Freedo.BingMapsStyle.AERIAL}else if(n.mapStyle==="AERIAL_WITH_LABELS"){n.mapStyle=Freedo.BingMapsStyle.AERIAL_WITH_LABELS}else if(n.mapStyle==="ROAD"){n.mapStyle=Freedo.BingMapsStyle.ROAD}a=new Freedo.BingMapsImageryProvider(n);break}case"Mapbox":{a=new Freedo.MapboxImageryProvider(n);break}case"ESRI":{a=new Freedo.ArcGisMapServerImageryProvider(n);break}case"OpenStreetMap":{a=Freedo.createOpenStreetMapImageryProvider(n);break}case"WMTS":{if(n.tilingScheme==="Geographic"){n.tilingScheme=new Freedo.GeographicTilingScheme}if(n.tileDiscardPolicy){var o=n.tileDiscardPolicy;if(o.pixelsToCheck){var s=n.tileDiscardPolicy.pixelsToCheck;var u=[];for(var l=0;l<s.length;++l){u.push(new Freedo.Cartesian2(s[l][0],s[l][1]))}o.pixelsToCheck=u}n.tileDiscardPolicy=new Freedo.DiscardMissingTileImagePolicy(o)}a=new Freedo.WebMapTileServiceImageryProvider(n);break}case"TileMapService":{if(n.tilingScheme==="WebMercator"){n.tilingScheme=new Freedo.WebMercatorTilingScheme}else if(n.tilingScheme==="Geographic"){n.tilingScheme=new Freedo.GeographicTilingScheme}a=Freedo.createTileMapServiceImageryProvider(n);break}case"UrlTemplate":{if(n.tilingScheme==="WebMercator"){n.tilingScheme=new Freedo.WebMercatorTilingScheme}else if(n.tilingScheme==="Geographic"){n.tilingScheme=new Freedo.GeographicTilingScheme}a=new Freedo.UrlTemplateImageryProvider(n);break}}this._imageryLayers.addImageryProvider(a,r);var c=this._imageryLayers.get(r);for(var f in t.layerOption){this.setLayerProperty(r,f,t.layerOption[f]);if((0,i.default)(c[f]!=="undefined")){c[f]=t.layerOption[f]}else{throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!")}}}},{key:"raise",value:function e(t){if(t>=0&&t<this.length-1){var r=this._imageryLayersOpts[t];this._imageryLayersOpts[t]=this._imageryLayersOpts[t+1];this._imageryLayersOpts[t+1]=r;var n=this._imageryLayers.get(t);this._imageryLayers.raise(n);this._viewer.scene.requestRender()}}},{key:"lower",value:function e(t){if(t>0&&t<this.length){var r=this._imageryLayersOpts[t];this._imageryLayersOpts[t]=this._imageryLayersOpts[t-1];this._imageryLayersOpts[t-1]=r;var n=this._imageryLayers.get(t);this._imageryLayers.lower(n);this._viewer.scene.requestRender()}}},{key:"remove",value:function e(t){if(t>=0&&t<this.length){this._imageryLayersOpts.splice(t,1);var r=this._imageryLayers.get(t);this._imageryLayers.remove(r)}}},{key:"removeAll",value:function e(){this._imageryLayersOpts.splice(0,this.length);this._imageryLayers.removeAll()}},{key:"getAllLayers",value:function e(){return Freedo.clone(this._imageryLayersOpts,true)}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){this.removeAll()}},{key:"dispose",value:function e(){this.reset();this._eventHelper.removeAll()}},{key:"imageryLayersOptions",get:function e(){return this._imageryLayersOpts}},{key:"length",get:function e(){return this._imageryLayersOpts.length}}]);return e}();t.FdImageryLayersManager=c},function(e,t,r){"use strict";var n=r(81);var i=r(103);var a=r(77);var o=r(109);var s=r(118);var u=Object.assign;e.exports=!u||r(64)(function(){var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return u({},e)[r]!=7||Object.keys(u({},t)).join("")!=n})?function e(t,r){var u=o(t);var l=arguments.length;var c=1;var f=i.f;var d=a.f;while(l>c){var h=s(arguments[c++]);var v=f?n(h).concat(f(h)):n(h);var p=v.length;var _=0;var y;while(p>_)if(d.call(h,y=v[_++]))u[y]=h[y]}return u}:u},function(e,t,r){var n=r(17);n(n.S+n.F,"Object",{assign:r(256)})},function(e,t,r){r(257);e.exports=r(14).Object.assign},function(e,t,r){e.exports={default:r(258),__esModule:true}},function(e,t,r){"use strict";t.__esModule=true;var n=r(173);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,r){if(t in e){(0,i.default)(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdLabelsManager=undefined;var n=r(260);var i=d(n);var a=r(259);var o=d(a);var s=r(1);var u=d(s);var l=r(6);var c=d(l);var f=r(124);function d(e){return e&&e.__esModule?e:{default:e}}var h=r(123);var v=(0,f.getFreedoXPath)()+"Assets/Textures/pin/pin.png";var p=function(){function e(t,r){(0,u.default)(this,e);this._viewer=t;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;var n=t.scene.primitives.add(new Freedo.PrimitiveCollection);var i=n.add(new Freedo.BillboardCollection);var a=n.add(new Freedo.PointPrimitiveCollection);var o=n.add(new Freedo.LabelCollection);this._collection=n;this._billboards=i;this._points=a;this._texts=o;this._setData(r)}(0,c.default)(e,[{key:"addLabel",value:function e(t){var r=t.image,n=r===undefined?"":r,i=t.position,a=t.text,o=a===undefined?"":a,s=t.show,u=s===undefined?true:s;this.data.collection.push({image:n,position:i,text:o,show:u});return this.data.collection.length-1}},{key:"removeLabel",value:function e(t){this.data.collection.splice(t,1)}},{key:"setLabel",value:function e(t,r){(0,o.default)(this.data.collection[t],r)}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"dispose",value:function e(){this._viewer.scene.primitives.remove(this._collection);this._collection=undefined;this._billboards=undefined;this._points=undefined;this._texts=undefined;this._data=undefined;this._mobxSpy();this._mobxSpy=undefined;this._event.raiseEvent("Changed");this._eventHelper.removeAll();this._eventHelper=undefined;this._event=undefined;this._viewer.scene.requestRender()}},{key:"_setData",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(typeof r.show==="undefined"){r.show=true}if(typeof r.collection==="undefined"){r.collection=[]}r.collection.forEach(function(e){if(typeof e.show==="undefined"){e.show=true}});var n=h.observable(r);n.collection.forEach(function(e){e.label=t._addLabel(e)});this._data=n;this._collection.show=r.show;var a=this;this._mobxSpy=h.spy(function(e){if(e.type==="splice"){if(e.object===a._data.collection){if(e.addedCount>0){e.added.forEach(function(e){e.label=a._addLabel(e);setTimeout(function(){a._event.raiseEvent("Changed")},0)})}if(e.removedCount>0){e.removed.forEach(function(e){var t=e.label;a._removeLabel(t);setTimeout(function(){a._event.raiseEvent("Changed")},0)})}}}if(e.type==="update"){if(e.object===a._data){if(e.key==="show"){a._collection.show=e.newValue;a._viewer.scene.requestRender();a._event.raiseEvent("Changed")}else if(e.key==="collection"){a._data.collection.forEach(function(e){a._removeLabel(e.label)});e.newValue.forEach(function(e){a._addLabel(e)});setTimeout(function(){a._event.raiseEvent("Changed")},0)}}else if(typeof e.object.label!=="undefined"){if(a._containsLabel(e.object.label)){var t=e.object.label;a._setLabel(t,(0,i.default)({},e.key,e.newValue));setTimeout(function(){a._event.raiseEvent("Changed")},0)}}}})}},{key:"_addLabel",value:function e(t){var r=t.position,n=t.text,i=n===undefined?"":n,a=t.image,o=a===undefined?"":a,s=t.show,u=s===undefined?true:s;var l=Freedo.Cartesian3.fromDegrees(r[0],r[1],r[2]);var c=2e7;if(typeof o==="undefined"||o===""){o=v}var f=this._billboards.add({position:l,image:o,show:u,pixelOffset:new Freedo.Cartesian2(0,-1),horizontalOrigin:Freedo.HorizontalOrigin.CENTER,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,width:32,height:32,id:undefined,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,c),disableDepthTestDistance:Number.POSITIVE_INFINITY});var d=this._points.add({show:false,position:l,pixelSize:3,color:Freedo.Color.YELLOW,outlineColor:Freedo.Color.BLACK,outlineWidth:1,id:undefined,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,c),disableDepthTestDistance:Number.POSITIVE_INFINITY});var h=this._texts.add({show:u,position:l,text:i,font:"16px sans-serif",fillColor:Freedo.Color.WHITE,outlineColor:Freedo.Color.BLACK,outlineWidth:1,showBackground:false,style:Freedo.LabelStyle.FILL_AND_OUTLINE,pixelOffset:new Freedo.Cartesian2(18,-16),horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.CENTER,id:undefined,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,c),disableDepthTestDistance:Number.POSITIVE_INFINITY});this._viewer.scene.requestRender();return{text:h,point:d,billboard:f}}},{key:"_setLabel",value:function e(t,r){var n=r.position,i=r.text,a=r.image,o=r.show;if(typeof n!=="undefined"){var s=Freedo.Cartesian3.fromDegrees(n[0],n[1],n[2]);t.billboard.position=s;t.point.position=s;t.text.position=s}if(typeof o!=="undefined"){t.billboard.show=o;t.text.show=o}if(typeof i!=="undefined"){t.text.text=i}if(typeof a!=="undefined"&&a){t.billboard.image=a}this._viewer.scene.requestRender()}},{key:"_removeLabel",value:function e(t){this._points.remove(t.point);this._texts.remove(t.text);this._billboards.remove(t.billboard);this._viewer.scene.requestRender()}},{key:"_containsLabel",value:function e(t){return this._points.contains(t.point)}},{key:"data",set:function e(t){throw new Error("FdLabelsManager不支持直接赋值！")},get:function e(){return this._data}}]);return e}();t.FdLabelsManager=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTools=undefined;var n=r(1);var i=p(n);var a=r(261);var o=r(255);var s=r(243);var u=r(242);var l=r(84);var c=r(158);var f=r(159);var d=r(240);var h=r(239);var v=r(238);function p(e){return e&&e.__esModule?e:{default:e}}var _=function e(){(0,i.default)(this,e);throw new Error("FdTools should not be instatiated!")};_.FdLabelsManager=a.FdLabelsManager;_.FdImageryLayersManager=o.FdImageryLayersManager;_.FdTerrain=s.FdTerrain;_.FdViewPointsManager=u.FdViewPointsManager;_.FdKeyboard=l.FdKeyboard;_.FdEraseGroundManager=c.FdEraseGroundManager;_.FdGeologySimulationManager=f.FdGeologySimulationManager;_.FdPMTSManager=d.FdPMTSManager;_.FdViewSwitcher=h.FdViewSwitcher;_.FdModel=v.FdModel;t.FdTools=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdDrawPolyline=undefined;var n=r(1);var i=c(n);var a=r(6);var o=c(a);var s=r(72);var u=r(11);var l=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._polylines=[];this._data=[];this._lsner=undefined;this._ple=new l.FdPolylineEditor(t);this._ple.setAutoLoop(false);this._ple.setAutoDelLines(true);this._handler=undefined;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._smoothRate=0;this._currentIndex=0}(0,o.default)(e,[{key:"polylinesOptions",get:function e(){return this._data},set:function e(t){if(!Freedo.defined(t)){console.error("polyline数据错误");return}this.clearPolylines();for(var r in t){this.addPolyline(t[r]["pts"])}}}]);return e}();f.prototype.start=function(){this._ple.run();this.addLsnr();this._event.raiseEvent("Start",{})};f.prototype.addLsnr=function(){if(this._lsner){this._lsner();this._lsner=undefined}var e=this;this._lsner=this._ple.on(function(t,r){if(t=="PLAdd"){e.onPLAdd(r)}if(t=="EditEnd"){e.polylinesOptions[e._currentIndex].pts=Freedo.clone(r.pts);e.reDraw()}})};f.prototype.onPLAdd=function(e){this.addPolyline(e.polyline.pts)};f.prototype.calcCP=function(e,t,r){var n,i,a;n=e.position;i=t.position;a=r.position;var o=[];var s=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3);var u=FreeDo.Cartesian3.subtract(a,i,new FreeDo.Cartesian3);var l=FreeDo.Cartesian3.cross(s,u,new FreeDo.Cartesian3);var c=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3);var f=FreeDo.Cartesian3.normalize(u,new FreeDo.Cartesian3);var d=FreeDo.Cartesian3.add(c,f,new FreeDo.Cartesian3);var h=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var v=Freedo.Quaternion.fromAxisAngle(l,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var p=Freedo.Matrix3.fromQuaternion(h,new Freedo.Matrix3);var _=Freedo.Matrix3.fromQuaternion(v,new Freedo.Matrix3);var y=Freedo.Matrix3.multiplyByVector(p,d,new Freedo.Cartesian3);var m=Freedo.Matrix3.multiplyByVector(_,d,new Freedo.Cartesian3);var g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var F=FreeDo.Cartesian3.normalize(m,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.distance(n,i);var b=FreeDo.Cartesian3.distance(a,i);var C=1;if(w<b){C=w/4}else C=b/4;g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);F=FreeDo.Cartesian3.multiplyByScalar(F,C,new FreeDo.Cartesian3);var P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);var x=FreeDo.Cartesian3.add(i,F,new FreeDo.Cartesian3);var M=FreeDo.Cartesian3.distance(n,P);var S=FreeDo.Cartesian3.distance(n,x);if(M<S)return[P,x];else return[x,P]};f.prototype.smoothPolyline=function(e){var t=[];if(e.length<3){for(var r=0;r<e.length;r++){t.push(e[r].position)}}else{for(var r=0;r<=e.length-2;r++){var n={},i={},a={},o={};if(r==0){n=e[0];i.position=this.calcCP(e[0],e[1],e[2])[0];a=e[0];o=e[1]}else if(r==e.length-2){n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i=e[r+1];a=e[r];o=e[r+1]}else{n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i.position=this.calcCP(e[r],e[r+1],e[r+2])[0];a=e[r];o=e[r+1]}var u=new s.FdBezierCurveAlgorithm(a,o,n,i);var l=u.getVertexForCurve(this._smoothRate);t=t.concat(l)}}var c=[];for(var r=0;r<t.length;r++){var f={};f=t[r];if(c.length>0){var d=FreeDo.Cartesian3.distance(c[c.length-1],f);if(d>1e-4)c.push(f)}else c.push(f)}return c};f.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})};f.prototype.addPolyline=function(e){var t={};t.pts=e;var r=[];for(var n in e){var i={position:e[n]};r.push(i)}if(this._smoothRate==0)t.smoothPts=e;else t.smoothPts=this.smoothPolyline(r);var a;a=this._viewer.scene.primitives.add(this.createLinePrimitive(t.smoothPts));t.polyline=a;this._polylines.push(t);this._data.push({pts:e});this._event.raiseEvent("PolylineAdd",e);this._event.raiseEvent("DataChanged",{pts:e});this._viewer.scene.requestRender()};f.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",width:5,uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",width:5,uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})};f.prototype.cancel=function(){this._ple.cancel();this._event.raiseEvent("Cancel",{})};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.setSmoothRate=function(e){this._smoothRate=e;this.reDraw()};f.prototype.clearPolylines=function(e){for(var t in this._polylines){this._viewer.scene.primitives.remove(this._polylines[t]["polyline"])}this._polylines=[];this._viewer.scene.requestRender()};f.prototype.getData=function(){return Freedo.clone(this._data,true)};f.prototype.startEdit=function(e){this.addLsnr();this._currentIndex=e;this._ple.startEdit(this.polylinesOptions[e].pts)};f.prototype.editPre=function(){this._ple.editPre()};f.prototype.editNext=function(){this._ple.editNext()};f.prototype.endEdit=function(){this._ple.endEdit()};f.prototype.removeAll=function(){this.clearPolylines();this._data=[]};f.prototype.reDraw=function(e){this.clearPolylines();var t=Freedo.clone(this._data,true);this._data=[];for(var r in t){this.addPolyline(t[r]["pts"])}};f.prototype.setHeightOffset=function(e){this._ple.setHeightOffset(e)};f.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this.clearPolylines();this._data=[]};f.prototype.dispose=function(){};t.FdDrawPolyline=f},function(e,t,r){var n=r(79);var i=r(13)("iterator");var a=r(62);e.exports=r(14).isIterable=function(e){var t=Object(e);return t[i]!==undefined||"@@iterator"in t||a.hasOwnProperty(n(t))}},function(e,t,r){r(63);r(60);e.exports=r(264)},function(e,t,r){e.exports={default:r(265),__esModule:true}},function(e,t,r){"use strict";t.__esModule=true;var n=r(266);var i=s(n);var a=r(119);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(){function e(e,t){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=(0,o.default)(e),u;!(n=(u=s.next()).done);n=true){r.push(u.value);if(t&&r.length===t)break}}catch(e){i=true;a=e}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t)){return t}else if((0,i.default)(Object(t))){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPickPMComponent=undefined;var n=r(119);var i=d(n);var a=r(267);var o=d(a);var s=r(104);var u=d(s);var l=r(1);var c=d(l);var f=r(11);function d(e){return e&&e.__esModule?e:{default:e}}var h=function e(t,r,n){(0,c.default)(this,e);this._viewer=t;this._bInSurvey=false;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._currentTileSet=undefined;this._baseColor=[255,255,255,1];this._highlightColor=[255,0,0,1];var i=this;this.updatePModelStyleThrottle=_.throttle(i.updatePModelStyle,100);this._mode="HIGH_LIGHT";this._clickMode=Freedo.ScreenSpaceEventType.LEFT_CLICK;this._pModelSetMap=new u.default;this._pModelInfos=r;this._token=n};h.prototype.setPModelSets=function(e){this._aPModelSet=e};h.prototype.setMode=function(e){this._mode=e};h.prototype.setClickMode=function(e){this._clickMode=e};h.prototype.start=function(){this.cancel();this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.handleLeftClick.bind(this),this._clickMode);this._bInSurvey=true};h.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};h.prototype.updatePModelStyle=function(){var e=[];var t=[];var r=true;var n=false;var a=undefined;try{for(var s=(0,i.default)(this._pModelSetMap),u;!(r=(u=s.next()).done);r=true){var l=u.value;var c=(0,o.default)(l,2);var f=c[0];var d=c[1];e.splice(0,e.length);t.splice(0,t.length);var h=d;if(typeof h!=="undefined"){for(var v in h){var p=h[v];if(typeof p.color!=="undefined"){var _=p.color;var y="rgba("+_[0]+","+_[1]+","+_[2]+","+_[3]+")";e.push(["${component} ~== '"+v+"'",y])}if(typeof p.show!=="undefined"){if(!p.show){t.push(["${component} ~== '"+v+"'","false"])}}}var m=this._baseColor;var g="rgba("+m[0]+","+m[1]+","+m[2]+","+m[3]+")";e.push(["true",g]);t.push(["true","true"]);f.style=new Freedo.FreedoPModelStyle({color:{conditions:e},show:{conditions:t}})}}}catch(e){n=true;a=e}finally{try{if(!r&&s.return){s.return()}}finally{if(n){throw a}}}this._viewer.scene.requestRender()};h.prototype.findPModel=function(e){var t=e._content._tileset;for(var r in this._aPModelSet){if(this._aPModelSet[r]===t){return r}}return undefined};h.prototype.pickComponent=function(e,t,r){var n=this._viewer.scene.pick(e);if(Freedo.defined(n)){if(Freedo.defined(n.tileset)){if(!this._pModelSetMap.has(n.tileset)){this._pModelSetMap.set(n.tileset,{})}var i=n.getPropertyNames();console.log(n.content.tile.computedTransform);console.log(n.content.tile.boundingSphere.center);var a=n.getProperty("component");if(Freedo.defined(a)){var o=undefined;if(r){o=n.getAncestors("component")}t(a,n.tileset,o);this._event.raiseEvent("DataChanged",{tilesetUrl:n.tileset.basePath,tileset:n.tileset,componentid:a});return}}}t(undefined,undefined)};h.prototype.getData=function(){var e=[];var t=true;var r=false;var n=undefined;try{for(var a=(0,i.default)(this._pModelSetMap),s;!(t=(s=a.next()).done);t=true){var u=s.value;var l=(0,o.default)(u,2);var c=l[0];var f=l[1];for(var d in f){e.push({tileset:c,tilesetURL:c.basePath,componentid:d})}}}catch(e){r=true;n=e}finally{try{if(!t&&a.return){a.return()}}finally{if(r){throw n}}}return e};h.prototype.unhighlightAllComponents=function(){var e=true;var t=false;var r=undefined;try{for(var n=(0,i.default)(this._pModelSetMap),a;!(e=(a=n.next()).done);e=true){var s=a.value;var u=(0,o.default)(s,2);var l=u[0];var c=u[1];var f=c;for(var d in f){delete f[d]["color"]}}}catch(e){t=true;r=e}finally{try{if(!e&&n.return){n.return()}}finally{if(t){throw r}}}this.updatePModelStyleThrottle()};h.prototype.showAllComponents=function(e){var t=true;var r=false;var n=undefined;try{for(var a=(0,i.default)(this._pModelSetMap),s;!(t=(s=a.next()).done);t=true){var u=s.value;var l=(0,o.default)(u,2);var c=l[0];var f=l[1];var d=f;for(var h in d){delete d[h]["show"]}}}catch(e){r=true;n=e}finally{try{if(!t&&a.return){a.return()}}finally{if(r){throw n}}}this.updatePModelStyleThrottle()};h.prototype.handleLeftClick=function(e){if(this._bInSurvey==false)return;var t=this;this.pickComponent(e.position,function(e,r){if(t._mode=="HIGH_LIGHT"){if(Freedo.defined(e)){var n=t._highlightColor[0];var i=t._highlightColor[1];var a=t._highlightColor[2];var o=t._highlightColor[3];t.highlightComponent(e,r,n,i,a,o)}else{t.unhighlightAllComponents()}}if(t._mode=="SHOW_HIDE"){if(Freedo.defined(e)){var n=Math.random()*255;var i=Math.random()*255;var a=Math.random()*255;var o=Math.random()*.5+.5;t.showComponent(e,r,false)}else{t.showAllComponents()}}if(t._mode=="HALF_ALPHA"){if(Freedo.defined(e)){var n=Math.random()*255;var i=Math.random()*255;var a=Math.random()*255;var o=Math.random()*.5+.5;t.highlightComponent(e,r,255,255,0,.1)}else{t.unhighlightAllComponents()}}},false)};h.prototype.highlightComponent=function(e,t,r,n,i,a){if(Freedo.defined(e)){if(typeof this._pModelSetMap.get(t)==="undefined"){this._pModelSetMap.set(t,{})}var o=this._pModelSetMap.get(t);if(typeof o[e]==="undefined"){o[e]={}}o[e].color=[r,n,i,a];this.updatePModelStyleThrottle();return true}else{return false}};h.prototype.setHighlightColor=function(e,t,r,n){this._highlightColor=[e,t,r,n]};h.prototype.showComponent=function(e,t,r){if(Freedo.defined(e)){if(typeof this._pModelSetMap.get(t)==="undefined"){this._pModelSetMap.set(t,{})}var n=this._pModelSetMap.get(t);if(typeof n[e]==="undefined"){n[e]={}}n[e].show=r}this.updatePModelStyleThrottle()};h.prototype.getUidBoundingSphere=function(e,t,r){var n=this._pModelInfos.find(function(t){return t.pModel===e});Freedo.FdServer.FdPMTSParser.getUidBoundingSphere(n.layer,n.matrixSet,n.matrix,t,token,undefined,function(e,t){if(typeof t!=="undefined"){console.log("getUidBoundingSphere got error!");return}r(e)})};h.prototype.cancel=function(){this.reset()};h.prototype.reset=function(){this._bInSurvey=false;this._hanlder=this._hanlder&&this._hanlder.destroy();this.unhighlightAllComponents();this.showAllComponents()};t.FdPickPMComponent=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdEraseGroundHandler=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(25);var u=r(158);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r){(0,i.default)(this,e);this._viewer=t;this._lsner=undefined;if(!Freedo.defined(r)){r=new FdTools.FdEraseGroundManager(t)}this._eraseGroundManager=r;this._ple=new s.FdPolylineEditor(t);this._ple.setAutoDelLines(true);this._data=[];this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;var n=this;this._eraseGroundManager.on(function(e,t){if(e==="dataAdded"){n._data.push(t);n._event.raiseEvent("dataChanged",t)}})}(0,o.default)(e,[{key:"getData",value:function e(){return this._data}},{key:"start",value:function e(t){t=Freedo.defaultValue(t,[0,0,0,1]);this._ple.run();if(this._lsner){this._lsner();this._lsner=undefined}var r=this;this._lsner=this._ple.on(function(e,n){if(e==="PLAdd"){r.onPLAdd(n,t)}});this._event.raiseEvent("start",{})}},{key:"onPLAdd",value:function e(t,r){if(!t.polyline)return;if(t.polyline.pts.length===2){this._ple.delResult();return}this._eraseGroundManager.eraseGroudByPointsArray(t.polyline.pts,r)}},{key:"cancel",value:function e(){this._ple.cancel();this._event.raiseEvent("cancel",{})}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"reset",value:function e(){if(this._lsner)this._lsner();this._lsner=undefined;this._data=[];this._ple.cancel();this._event.raiseEvent("Dispose",{})}},{key:"dispose",value:function e(){this.reset();this._eventHelper.removeAll()}},{key:"eraseGoundManager",get:function e(){return this._eraseGroundManager}}]);return e}();t.FdEraseGroundHandler=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getSimulateDrill=t.getOffsetPoint=t.interpolate=undefined;var n=r(104);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=new Freedo.Cartesian3;var s=new Freedo.Cartesian3;function u(e,t,r){var n=[];var i=Freedo.Cartesian3.fromRadians(e.longitude,e.latitude,e.height);var a=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,t.height);var s=Freedo.Cartesian3.distance(i,a);if(s>r){var u=s/r;for(var l=0;l<u-1;++l){Freedo.Cartesian3.lerp(i,a,(l+1)/u,o);var c=Freedo.Cartographic.fromCartesian(o);n.push(c)}}return n}function l(e,t){if(!Freedo.defined(t)){t=[]}for(var r=0;r<e.length;r++){t.push({name:e[r].name,depth:e[r].depth,thickness:e[r].thickness})}return t}function c(e,t,r){var n=new Freedo.Cartesian3;Freedo.Cartesian3.multiplyByScalar(t,r,n);Freedo.Cartesian3.add(e,n,n);return n}function f(e,t,r){var n=[];var a=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,0);var o=0;for(var s=0;s<e._drillDataArray.length;s++){var u=e._drillDataArray[s];var c=Freedo.Cartesian3.distance(u.cartesianOnZeroHeight,a);if(c<=r){n.push({name:u.name,waterDepth:u.waterDepth,layers:l(u.layers),weight:1/c,pos:u.pos});o+=1/c}}var f=n.length;if(f<1){var d=Number.MAX_VALUE;var h=-1;for(var s=0;s<e._drillDataArray.length;s++){var c=Freedo.Cartesian3.distance(e._drillDataArray[s].cartesianOnZeroHeight,a);if(c<=d){h=s}}return{waterDepth:e._drillDataArray[h].waterDepth,drillsInfo:[{drillName:e._drillDataArray[h].name,drillPos:e._drillDataArray[h].pos,layers:e._drillDataArray[h].layers}],layers:l(e._drillDataArray[h].layers)}}var v=0;var p=[];for(var s=0;s<f;s++){n[s].weight/=o;v+=n[s].waterDepth*n[s].weight;p.push({drillName:n[s].name,drillPos:n[s].pos,layers:Freedo.clone(n[s].layers)})}var _=[];while(true){var y=false;for(var s=0;s<f;s++){if(n[s].layers.length>0){y=true;break}}if(!y){break}var m=new i.default;for(var s=0;s<f;s++){if(n[s].layers.length>0){var g=n[s].layers[0].name;if(!m.has(g)){m.set(g,{weight:n[s].weight,thickness:n[s].layers[0].thickness*n[s].weight})}else{m.set(g,{weight:m.get(g).weight+n[s].weight,thickness:m.get(g).thickness+n[s].layers[0].thickness*n[s].weight})}}}var F=0;var w;var b=0;m.forEach(function(e,t){if(F<e.weight){F=e.weight;w=t;b=e.thickness}});for(var s=0;s<f;s++){if(n[s].layers.length>0&&n[s].layers[0].name===w){n[s].layers.shift()}}_.push({name:w,thickness:b,depth:b+(_.length>0?_[_.length-1].depth:0)})}return{waterDepth:v,drillsInfo:p,pos:t,layers:_}}t.interpolate=u;t.getOffsetPoint=c;t.getSimulateDrill=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LayerData=undefined;var n=r(1);var i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t){(0,i.default)(this,e);this.name=t.name;this.depth=parseFloat(t.depth)};t.LayerData=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DrillData=undefined;var n=r(1);var i=o(n);var a=r(271);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,i.default)(this,e);this.name=t.name;this.waterDepth=parseFloat(t.water_depth);var r=t.pos.split(",");this.cartographic=Freedo.Cartographic.fromDegrees(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]));this.cartesian=Freedo.Cartesian3.fromRadians(this.cartographic.longitude,this.cartographic.latitude,this.cartographic.height);this.cartesianOnZeroHeight=Freedo.Cartesian3.fromRadians(this.cartographic.longitude,this.cartographic.latitude,0);this.pos=t.pos;this.layers=[];for(var n=t.layer.length-1;n>=0;n--){this.layers.push(new a.LayerData(t.layer[n]))}this.layers.sort(function(e,t){return e.depth-t.depth});for(var n=0;n<this.layers.length;n++){this.layers[n].thickness=n>0?this.layers[n].depth-this.layers[n-1].depth:this.layers[n].depth}};t.DrillData=s},function(e,t,r){r(160)("Map")},function(e,t,r){r(161)("Map")},function(e,t,r){var n=r(17);n(n.P+n.R,"Map",{toJSON:r(162)("Map")})},function(e,t,r){"use strict";var n=r(166);var i=r(105);var a="Map";e.exports=r(164)(a,function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{get:function e(t){var r=n.getEntry(i(this,a),t);return r&&r.v},set:function e(t,r){return n.def(i(this,a),t===0?0:t,r)}},n,true)},function(e,t,r){r(78);r(60);r(63);r(276);r(275);r(274);r(273);e.exports=r(14).Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdGeologySimulationHandler=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(25);var u=r(159);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){(0,i.default)(this,e);if(!Freedo.defined(r)){throw new Freedo.DeveloperError("geologySimulationManager Is Required!")}this._viewer=t;this._scene=this._viewer.scene;this._ple=new s.FdPolylineEditor(t);this._ple.setAutoDelLines(true);if(typeof r==="string"){this._geologySimulationManager=new FdTools.FdGeologySimulationManager(t.scene,JSON.parse(r),n)}else{this._geologySimulationManager=r}this._data=[];this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;var a=this;this._geologySimulationManager.on(function(e,t){if(e==="dataAdded"){a._data.push(t);a._event.raiseEvent("dataChanged",t)}})}(0,o.default)(e,[{key:"getData",value:function e(){return this._data}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"start",value:function e(){this._ple.run();if(this._lsner){this._lsner();this._lsner=undefined}var t=this;this._lsner=this._ple.on(function(e,r){if(e==="PLAdd"){t.onPLAdd(r)}});this._event.raiseEvent("start",{})}},{key:"cancel",value:function e(){this._ple.cancel();this._event.raiseEvent("cancel",{})}},{key:"onPLAdd",value:function e(t){if(!t.polyline)return;if(t.polyline.pts.length===2){this._ple.delResult();return}var r=t.polyline.pts;var n=[];for(var i=0;i<r.length;i++){n.push(Freedo.Cartographic.fromCartesian(r[i]))}this._geologySimulationManager.addGeologySimulation(n,1,5,5,undefined,true)}},{key:"reset",value:function e(){if(this._lsner)this._lsner();this._lsner=undefined;this._data=[];this._ple.cancel()}},{key:"dispose",value:function e(){this.reset();this._event.raiseEvent("dispose",{});this._eventHelper.removeAll()}},{key:"geologySimulationManager",get:function e(){return this._geologySimulationManager}}]);return e}();t.FdGeologySimulationHandler=c},function(e,t,r){r(160)("Set")},function(e,t,r){r(161)("Set")},function(e,t,r){var n=r(69);e.exports=function(e,t){var r=[];n(e,false,r.push,r,t);return r}},function(e,t,r){var n=r(17);n(n.P+n.R,"Set",{toJSON:r(162)("Set")})},function(e,t,r){var n=r(30);var i=r(163);var a=r(13)("species");e.exports=function(e){var t;if(i(e)){t=e.constructor;if(typeof t=="function"&&(t===Array||i(t.prototype)))t=undefined;if(n(t)){t=t[a];if(t===null)t=undefined}}return t===undefined?Array:t}},function(e,t,r){var n=r(283);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(48);var i=r(118);var a=r(109);var o=r(114);var s=r(284);e.exports=function(e,t){var r=e==1;var u=e==2;var l=e==3;var c=e==4;var f=e==6;var d=e==5||f;var h=t||s;return function(t,s,v){var p=a(t);var _=i(p);var y=n(s,v,3);var m=o(_.length);var g=0;var F=r?h(t,m):u?h(t,0):undefined;var w,b;for(;m>g;g++)if(d||g in _){w=_[g];b=y(w,g,p);if(e){if(r)F[g]=b;else if(b)switch(e){case 3:return true;case 5:return w;case 6:return g;case 2:F.push(w)}else if(c)return false}}return f?-1:l||c?c:F}}},function(e,t,r){var n=r(62);var i=r(13)("iterator");var a=Array.prototype;e.exports=function(e){return e!==undefined&&(n.Array===e||a[i]===e)}},function(e,t,r){var n=r(40);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var a=e["return"];if(a!==undefined)n(a.call(e));throw t}}},function(e,t,r){"use strict";var n=r(166);var i=r(105);var a="Set";e.exports=r(164)(a,function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(i(this,a),t=t===0?0:t,t)}},n)},function(e,t,r){r(78);r(60);r(63);r(288);r(282);r(280);r(279);e.exports=r(14).Set},function(e,t,r){e.exports={default:r(289),__esModule:true}},function(e,t,r){var n=r(40);var i=r(167);e.exports=r(14).getIterator=function(e){var t=i(e);if(typeof t!="function")throw TypeError(e+" is not iterable!");return n(t.call(e))}},function(e,t,r){var n=r(113);var i=r(117);e.exports=function(e){return function(t,r){var a=String(i(t));var o=n(r);var s=a.length;var u,l;if(o<0||o>=s)return e?"":undefined;u=a.charCodeAt(o);return u<55296||u>56319||o+1===s||(l=a.charCodeAt(o+1))<56320||l>57343?e?a.charAt(o):u:e?a.slice(o,o+2):(u-55296<<10)+(l-56320)+65536}}},function(e,t,r){var n=r(47);var i=r(109);var a=r(112)("IE_PROTO");var o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){e=i(e);if(n(e,a))return e[a];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?o:null}},function(e,t,r){var n=r(113);var i=Math.max;var a=Math.min;e.exports=function(e,t){e=n(e);return e<0?i(e+t,0):a(e,t)}},function(e,t,r){var n=r(61);var i=r(114);var a=r(294);e.exports=function(e){return function(t,r,o){var s=n(t);var u=i(s.length);var l=a(o,u);var c;if(e&&r!=r)while(u>l){c=s[l++];if(c!=c)return true}else for(;u>l;l++)if(e||l in s){if(s[l]===r)return e||l||0}return!e&&-1}}},function(e,t,r){var n=r(31);var i=r(40);var a=r(81);e.exports=r(29)?Object.defineProperties:function e(t,r){i(t);var o=a(r);var s=o.length;var u=0;var l;while(s>u)n.f(t,l=o[u++],r[l]);return t}},function(e,t,r){"use strict";var n=r(115);var i=r(83);var a=r(70);var o={};r(44)(o,r(13)("iterator"),function(){return this});e.exports=function(e,t,r){e.prototype=n(o,{next:i(1,r)});a(e,t+" Iterator")}},function(e,t){e.exports=function(){}},function(e,t,r){"use strict";var n=r(298);var i=r(171);var a=r(62);var o=r(61);e.exports=r(116)(Array,"Array",function(e,t){this._t=o(e);this._i=0;this._k=t},function(){var e=this._t;var t=this._k;var r=this._i++;if(!e||r>=e.length){this._t=undefined;return i(1)}if(t=="keys")return i(0,r);if(t=="values")return i(0,e[r]);return i(0,[r,e[r]])},"values");a.Arguments=a.Array;n("keys");n("values");n("entries")},function(e,t,r){r(63);r(60);e.exports=r(291)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPickPModel=undefined;var n=r(119);var i=c(n);var a=r(290);var o=c(a);var s=r(1);var u=c(s);var l=r(11);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(t){(0,u.default)(this,e);this._viewer=t;this._bInSurvey=false;this._tss=new o.default;this._clickMode=Freedo.ScreenSpaceEventType.LEFT_CLICK;this._highlightColor=Freedo.Color.RED.withAlpha(.8);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper};f.prototype.setClickMode=function(e){this._clickMode=e};f.prototype.setHighlightColor=function(e,t,r,n){this._highlightColor=new Freedo.Color(e/255,t/255,r/255,n)};f.prototype.start=function(){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.handleLeftClick.bind(this),this._clickMode);this._bInSurvey=true};f.prototype.cancel=function(){this.reset()};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.handleLeftClick=function(e){if(this._bInSurvey==false)return;this.pickModel(e.position)};f.prototype.pickModel=function(e){var t=undefined;var r=false;var n=this._viewer.scene;var a;var o=n.drillPick(e);if(Freedo.defined(o)&&o.length>0){for(var s=0;s<o.length;s++){if(o[s].tileset.style!=undefined)continue;this._tss.add(o[s]);if(Freedo.defined(o[s].id)&&o[s].id.name=="PINICON"){console.info(o[s].id.sceneObjectID)}var u=this._highlightColor;var l=new Freedo.Cesium3DTileStyle;l.color={evaluateColor:function e(t,r,n){return Freedo.Color.clone(u,n)}};o[s].tileset.style=l;this._event.raiseEvent("DataChanged",o[s].tileset.basePath)}}else{var c=true;var f=false;var d=undefined;try{for(var h=(0,i.default)(this._tss.keys()),v;!(c=(v=h.next()).done);c=true){var p=v.value;p.tileset.style=undefined}}catch(e){f=true;d=e}finally{try{if(!c&&h.return){h.return()}}finally{if(f){throw d}}}this._tss.clear()}this._viewer.scene.requestRender()};f.prototype.getData=function(){if(Freedo.defined(this._tss)){var e=[];var t=true;var r=false;var n=undefined;try{for(var a=(0,i.default)(this._tss.keys()),o;!(t=(o=a.next()).done);t=true){var s=o.value;e.push(s.tileset.basePath)}}catch(e){r=true;n=e}finally{try{if(!t&&a.return){a.return()}}finally{if(r){throw n}}}return e}};f.prototype.reset=function(){this._bInSurvey=false;this._hanlder=this._hanlder&&this._hanlder.destroy();var e=true;var t=false;var r=undefined;try{for(var n=(0,i.default)(this._tss.keys()),a;!(e=(a=n.next()).done);e=true){var o=a.value;o.tileset.style=undefined}}catch(e){t=true;r=e}finally{try{if(!e&&n.return){n.return()}}finally{if(t){throw r}}}this._tss.clear()};t.FdPickPModel=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdClipPlaneEditor=undefined;var n=r(1);var i=o(n);var a=r(11);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t,r){(0,i.default)(this,e);this._viewer=t;this._bInTransform=false;this._transType="MOVE";this._bInRun=false;this._startPt=null;this._endPt=null;this._points2=null;this._xAxisPL=null;this._yAxisPL=null;this._zAxisPL=null;this._XYPlane=null;this._YZPlane=null;this._XZPlane=null;this._XYCircle=null;this._XZCircle=null;this._selectedAxis="";this._mouseDownPos=null;this._mouseDownXY=null;this._mouseDownStartXY=null;this._mouseDownEndXY=null;this._initSphere=null;this._useDepthPicking=true;this._pickTranslucentDepth=true;this._fixedAxis="";this._DISPERRAD=111e3;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._oldPt=null;this._started=false;this._mouseDown=false;this._lastDis=-1;this._alpha=.5;this._axisZoom=1;this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3};this._t12=undefined;this._handler=undefined;this._xzOri=1;this._yzOri=1;this._oriObj={};this._m4=undefined;this._isPlaneMode=r};s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};s.prototype.startClip=function(e){this._transType=e;if(this._bInTransform)return;this._bInTransform=true;this.addListeners();this._bInRun=true};s.prototype.show=function(e){this._initSphere=FreeDo.clone(e,true);this.calcAxisZoom();this.clearAxis();this.calcCallbackArgs();this.showAxis()};s.prototype.updateMatrix4=function(e){this._m4=Freedo.clone(e,true)};s.prototype.updateSceneSphere=function(e){this._initSphere=FreeDo.clone(e,true)};s.prototype.addListeners=function(){this._handler=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._handler.setInputAction(this.onLeftDown.bind(this),FreeDo.ScreenSpaceEventType.LEFT_DOWN);this._handler.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE);this._handler.setInputAction(this.onLeftUp.bind(this),FreeDo.ScreenSpaceEventType.LEFT_UP);this._handler.setInputAction(this.onWheel.bind(this),FreeDo.ScreenSpaceEventType.WHEEL);var e=this;window.addEventListener("keydown",this.onKeyDown.bind(this))};s.prototype.calcAxisZoom=function(){if(this._bInTransform===false){this._axisZoom=1;return}var e=this._initSphere.center;var t=this._viewer.camera.positionWC;var r=1,n=1;r=Freedo.Cartesian3.distance(e,t)/6;n=this._viewer.camera.getPixelSize(this._initSphere,100,100);this._axisZoom=r;if(this._axisZoom>4e5)this._axisZoom=4e5;if(this._axisZoom<20)this._axisZoom=20};s.prototype.onWheel=function(){if(this._bInTransform===false)return;this.calcAxisZoom()};s.prototype.onKeyDown=function(){if(this._bInTransform===false)return};s.prototype.onMouseMove=function(e){if(!this._bInTransform)return;if(this._selectedAxis!=""){this._event.raiseEvent("Transforming",{MouseDownStartXY:this._mouseDownStartXY,MouseDownEndXY:this._mouseDownEndXY,MouseDownXY:this._mouseDownXY,MouseMoveXY:e.endPosition,SelectedAxis:this._selectedAxis,Ori:this._oriObj});this.regenPts();this.calcAxisZoom()}this._viewer.scene.requestRender()};s.prototype.regenPts=function(){if(this._points2===null)this._points2=this._viewer.scene.primitives.add(new Freedo.PointPrimitiveCollection);if(this._points2.length>0){this._points2.removeAll()}var e=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f,d,h+l]);if(this._isPlaneMode){e=[new Freedo.Cartesian3(f,d,h),new Freedo.Cartesian3(f,d,h+l)]}if(this._m4!==undefined){e[0]=Freedo.Matrix4.multiplyByPoint(this._m4,e[0],new Freedo.Cartesian3);e[1]=Freedo.Matrix4.multiplyByPoint(this._m4,e[1],new Freedo.Cartesian3)}this._points2.add({position:e[0],pixelSize:10,show:false,color:Freedo.Color.YELLOW});this._points2.add({position:e[1],pixelSize:10,show:false,color:Freedo.Color.YELLOW})};s.prototype.onLeftDown=function(e){if(!this._bInTransform)return;this.regenPts();this._mouseDown=true;this._oldPt=null;this._started=false;this._lastDis=-1;var t=this._viewer.scene.pick(e.position);if(!FreeDo.defined(t)||!FreeDo.defined(t.id)||!FreeDo.defined(t.id._name)){var r=this._viewer.scene.drillPick(e.position);for(var n=0;n<r.length;n++){if(FreeDo.defined(r[n].id)&&FreeDo.defined(r[n].id._name)){t=r[n];break}}if(!FreeDo.defined(t))return}if(FreeDo.defined(t.id)&&FreeDo.defined(t.id._name)){var i=t.id._name;if((i==="X_AXIS"||i==="Y_AXIS"||i==="Z_AXIS")&&this._transType.indexOf("CLIP")>=0){t.id.polyline.material.color=new Freedo.Color(1,1,0,1)}if(i==="XY_CIRCLE"||i==="YZ_CIRCLE"||i==="XZ_CIRCLE"){t.id.polyline.material.color=new Freedo.Color(1,1,0,1)}if(i==="XY_CIRCLE"||i==="XZ_CIRCLE"||i==="YZ_CIRCLE"||i==="XY"||i==="XZ"||i==="YZ"||i==="X_AXIS"||i==="Y_AXIS"||i==="Z_AXIS"){this._selectedAxis=FreeDo.clone(i,true);this._viewer.scene.screenSpaceCameraController.enableRotate=false;this._viewer.scene.screenSpaceCameraController.enableLook=false;this._mouseDownPos=null;var a=this._viewer.camera.getPickRay(e.position);this._oriObj.rayDirection=a.direction;this._event.raiseEvent("Transform",{})}}this._mouseDownXY=e.position;var o=this._points2.get(0);var s=this._points2.get(1);this._mouseDownStartXY=o.computeScreenSpacePosition(this._viewer.scene,new Freedo.Cartesian2);this._mouseDownEndXY=s.computeScreenSpacePosition(this._viewer.scene,new Freedo.Cartesian2);this._viewer.scene.requestRender()};s.prototype.backToEnableRotate=function(e){if(this._selectedAxis===""){this._viewer.scene.screenSpaceCameraController.enableRotate=true;this._viewer.scene.screenSpaceCameraController.enableLook=true}};s.prototype.onLeftUp=function(e){setTimeout(this.backToEnableRotate.bind(this),500);if(!this._bInTransform)return;this._mouseDown=false;if(this._selectedAxis==="XY_CIRCLE"){this._XYCircle.polyline.material.color=new Freedo.Color(0,0,1,this._alpha)}if(this._selectedAxis==="XZ_CIRCLE"){this._XZCircle.polyline.material.color=new Freedo.Color(0,1,0,this._alpha)}if(this._selectedAxis==="YZ_CIRCLE"){this._YZCircle.polyline.material.color=new Freedo.Color(1,0,0,this._alpha)}if(this._selectedAxis==="X_AXIS"){this._xAxisPL.polyline.material.color=FreeDo.Color.RED}if(this._selectedAxis==="Y_AXIS"){this._yAxisPL.polyline.material.color=FreeDo.Color.GREEN}if(this._selectedAxis==="Z_AXIS"){this._zAxisPL.polyline.material.color=FreeDo.Color.BLUE}if(this._selectedAxis!==""){this._event.raiseEvent("Transformed",{})}this._selectedAxis="";this._viewer.scene.requestRender()};s.prototype.clearAxis=function(){if(this._xAxisPL!=null){this._viewer.entities.remove(this._xAxisPL);this._viewer.entities.remove(this._yAxisPL);this._viewer.entities.remove(this._zAxisPL);this._viewer.scene.primitives.remove(this._points2);this._points2=null;this._viewer.entities.remove(this._XZPlane);this._viewer.entities.remove(this._YZPlane);this._viewer.entities.remove(this._XYPlane);this._viewer.entities.remove(this._XYCircle);this._viewer.entities.remove(this._XZCircle);this._viewer.entities.remove(this._YZCircle)}this._selectedAxis=""};var u=null;var l=null;var c=null;var f=null;var d=null;var h=null;var v=[];s.prototype.calcCallbackArgs=function(){u=this._initSphere.center;l=this._initSphere.radius*4;if(l>160)l=160;c=Freedo.Cartographic.fromCartesian(u);if(this._isPlaneMode){f=u.x;d=u.y;h=u.z;v=[1,1]}else{f=Freedo.Math.toDegrees(c.longitude);d=Freedo.Math.toDegrees(c.latitude);h=c.height;v=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c)}l=this._axisZoom};s.prototype.callbackXYHalfCircle=function(e,t){this.calcCallbackArgs();var r=l*.9/this._DISPERRAD;var n=[];var i=FreeDo.Math.toDegrees(l*.9*v[0]);var a=FreeDo.Math.toDegrees(l*.9*v[1]);for(var o=0;o<=Math.PI/2;o=o+.1){var s=f+i*Math.cos(o);var u=d+a*Math.sin(o);var c=Freedo.Cartesian3.fromDegrees(s,u,h);n.push(c)}t=n;return t};s.prototype.callbackXZHalfCircle=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(l*.9*v[0]);var n=FreeDo.Math.toDegrees(l*.9*v[1]);if(this._isPlaneMode){var r=l*.9;var n=l*.9}var i=[];var a=Math.PI/2+.3;var o=Math.PI/2-.3;if(this._selectedAxis=="XZ_CIRCLE"){a=Math.PI*2;o=0}for(var s=a;s>=o;s=s-.001){var u=f+r*Math.cos(s);var c=d;var p=h+l*.9*Math.sin(s);var _;if(this._isPlaneMode){_=new Freedo.Cartesian3(u,c,p)}else _=Freedo.Cartesian3.fromDegrees(u,c,p);i.push(_)}t=i;this.reCalcPos(t);return t};s.prototype.callbackYZHalfCircle=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(l*.9*v[0]);var n=FreeDo.Math.toDegrees(l*.9*v[1]);if(this._isPlaneMode){var r=l*.9;var n=l*.9}var i=[];var a=Math.PI/2+.3;var o=Math.PI/2-.3;if(this._selectedAxis=="YZ_CIRCLE"){a=Math.PI*2;o=0}for(var s=a;s>=o;s=s-.001){var u=f;var c=d+n*Math.cos(s);var p=h+l*.9*Math.sin(s);var _;if(this._isPlaneMode){_=new Freedo.Cartesian3(u,c,p)}else _=Freedo.Cartesian3.fromDegrees(u,c,p);i.push(_)}t=i;this.reCalcPos(t);return t};s.prototype.callbackXYCCBPMin=function(e,t){this.calcCallbackArgs();if(this._mouseDown&&this._selectedAxis=="XY_CIRCLE")t=l*.75;else t=l*.5*2;return t};s.prototype.callbackXYRect=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(l*1.2*v[0]);var n=FreeDo.Math.toDegrees(l*1.2*v[1]);if(this._isPlaneMode){r=l*1.2;n=l*1.2;t=[new Freedo.Cartesian3(f+r,d+n,h),new Freedo.Cartesian3(f-r,d+n,h),new Freedo.Cartesian3(f-r,d-n,h),new Freedo.Cartesian3(f+r,d-n,h),new Freedo.Cartesian3(f+r,d+n,h)]}else{t=Freedo.Cartesian3.fromDegreesArrayHeights([f+r,d+n,h,f-r,d+n,h,f-r,d-n,h,f+r,d-n,h,f+r,d+n,h])}this.reCalcPos(t);return t};s.prototype.callbackXYShow=function(e,t){this.calcCallbackArgs();t=true;if(this._selectedAxis=="XY_CIRCLE")t=false;return t};s.prototype.callbackXYH=function(e,t){return h+.1};s.prototype.callbackXZ=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(l*1*v[0]);var n=FreeDo.Math.toDegrees(l*1*v[1]);t=Freedo.Cartesian3.fromDegreesArrayHeights([f+r,d,h-l,f+r,d,h+l,f-r,d,h+l,f-r,d,h-l,f+r,d,h-l]);return t};s.prototype.callbackXZMinimumHeights=function(e,t){this.calcCallbackArgs();t=[h,h];return t};s.prototype.callbackXZMaximumHeights=function(e,t){this.calcCallbackArgs();t=[h+l*.5,h+l*.5];return t};s.prototype.callbackYZ=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(l*1*v[0]);var n=FreeDo.Math.toDegrees(l*1*v[1]);t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d+n,h-l,f,d+n,h+l,f,d-n,h+l,f,d-n,h-l,f,d+n,h-l]);return t};s.prototype.callbackXYCCBP=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegrees(f,d);return t};s.prototype.callbackX=function(e,t){this.calcCallbackArgs();var r=0;if(this._isPlaneMode){r=l;t=[new Freedo.Cartesian3(f,d,h),new Freedo.Cartesian3(f+r,d,h)]}else{r=FreeDo.Math.toDegrees(l*v[0]);t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f+r,d,h])}if(this._m4!==undefined){t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3);t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)}this._oriObj.xAxis=t;return t};s.prototype.callbackY=function(e,t){this.calcCallbackArgs();var r=0;if(this._isPlaneMode){r=l;t=[new Freedo.Cartesian3(f,d,h),new Freedo.Cartesian3(f,d+r,h)]}else{r=l/this._DISPERRAD;t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f,d+r,h])}if(this._m4!==undefined){t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3);t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)}this._oriObj.yAxis=t;return t};s.prototype.callbackZ=function(e,t){this.calcCallbackArgs();if(this._isPlaneMode){t=[new Freedo.Cartesian3(f,d,h),new Freedo.Cartesian3(f,d,h+l)]}else{t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f,d,h+l])}if(this._m4!==undefined){t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3);t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)}return t};s.prototype.callbackStart=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h]);if(this._m4!==undefined){t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3)}return t};s.prototype.callbackH=function(e,t){this.calcCallbackArgs();t=h;return t};s.prototype.reCalcPos=function(e){if(this._m4!==undefined){for(var t in e){e[t]=Freedo.Matrix4.multiplyByPoint(this._m4,e[t],new Freedo.Cartesian3)}}};s.prototype.showAxis=function(){var e=new Freedo.CallbackProperty(this.callbackXYRect.bind(this),false);var t=new Freedo.CallbackProperty(this.callbackXYHalfCircle.bind(this),false);var r=new Freedo.CallbackProperty(this.callbackXZHalfCircle.bind(this),false);var n=new Freedo.CallbackProperty(this.callbackYZHalfCircle.bind(this),false);var i=new Freedo.CallbackProperty(this.callbackXYCCBPMin.bind(this),false);var a=new Freedo.CallbackProperty(this.callbackXZ.bind(this),false);var o=new Freedo.CallbackProperty(this.callbackYZ.bind(this),false);var s=new Freedo.CallbackProperty(this.callbackXYCCBP.bind(this),false);var u=new Freedo.CallbackProperty(this.callbackX.bind(this),false);var l=new Freedo.CallbackProperty(this.callbackY.bind(this),false);var c=new Freedo.CallbackProperty(this.callbackZ.bind(this),false);var f=new Freedo.CallbackProperty(this.callbackH.bind(this),false);this._xAxisPL=this._viewer.entities.add({name:"X_AXIS",polyline:{positions:u,width:0,show:true,followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.RED)}});this._yAxisPL=this._viewer.entities.add({name:"Y_AXIS",polyline:{positions:l,width:0,show:true,followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.GREEN)}});this._zAxisPL=this._viewer.entities.add({name:"Z_AXIS",polyline:{positions:c,width:8,show:this._transType=="CLIPXY",followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.BLUE)}});if(this._transType.indexOf("CLIP")>=0){this._YZPlane=this._viewer.entities.add({name:"YZ",polyline:{positions:o,width:2,show:this._transType=="CLIPYZ",followSurface:false,material:new Freedo.Color(1,0,0,this._alpha)}})}if(this._transType.indexOf("CLIP")>=0){this._XYPlane=this._viewer.entities.add({name:"XY_RECT",polyline:{positions:e,width:.8,show:true,followSurface:false,material:new Freedo.Color(0,0,1,this._alpha)}})}if(this._transType.indexOf("CLIP")>=0){this._XZPlane=this._viewer.entities.add({name:"XZ",polyline:{positions:a,width:2,show:false,followSurface:false,material:new Freedo.Color(0,1,0,this._alpha)}})}this._XYCircle=this._viewer.entities.add({name:"XY_NONE_CIRCLE",position:s,ellipse:{semiMinorAxis:i,semiMajorAxis:i,height:f,show:false,material:new Freedo.Color(1,1,0,.2)}});if(this._transType.indexOf("ROTATE")>=0||this._transType.indexOf("SCALE")>=0){this._XYCircle=this._viewer.entities.add({name:"XY_CIRCLE",polyline:{positions:t,width:4,show:true,material:new Freedo.Color(0,0,1,this._alpha)}})}if(this._transType.indexOf("CLIPXY")>=0){this._XZCircle=this._viewer.entities.add({name:"XZ_CIRCLE",polyline:{positions:r,width:4,show:true,material:new Freedo.Color(0,1,0,this._alpha)}});this._YZCircle=this._viewer.entities.add({name:"YZ_CIRCLE",polyline:{positions:n,width:4,show:true,material:new Freedo.Color(1,0,0,this._alpha)}})}this.regenPts();this._viewer.scene.requestRender()};s.prototype.reset=function(){this._handler=this._handler&&this._handler.destroy();this._bInTransform=false;this.clearAxis();this._mouseDownPos=null;this._initSphere=null;this._fixedAxis=""};s.prototype.dispose=function(){this.reset()};t.FdClipPlaneEditor=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdClipPlane=undefined;var n=r(1);var i=l(n);var a=r(6);var o=l(a);var s=r(302);var u=r(11);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){(0,i.default)(this,e);this._viewer=t;this._tileset=r;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._mani=new s.FdClipPlaneEditor(t,n);this._selectedAxis="";this._transType="CLIP";this._mouseDown12Arg={};this._axisZoom=1;this._isPlaneMode=n;this._t12={TMoveX:0,TMoveY:0,TMoveZ:0,THeading:0,TPitch:0,TRoll:0,TScaleX:1,TScaleY:1,TScaleZ:1,TBaseX:0,TBaseY:0,TBaseZ:0};this._q4=new Freedo.Quaternion(0,0,0,1);this._lsner=undefined}(0,o.default)(e,[{key:"clipOptions",get:function e(){return{type:"CLIPXY",Q4:this._q4,TMoveX:this._t12.TMoveX,TMoveY:this._t12.TMoveY,TMoveZ:this._t12.TMoveZ,TPitch:this._t12.TPitch,TRoll:this._t12.TRoll}},set:function e(t){if(!Freedo.defined(t)){return}if(Freedo.defined(t.type)){this.start(t.type,t)}}}]);return e}();c.prototype.setSceneObjectIDs=function(e){this._aSceneObjectId=FreeDo.clone(e,true)};c.prototype.calcSceneBS=function(){var e=[];for(var t in this._tileset){var r=this._tileset[t];var n=r.boundingSphere;e.push(n)}this._sceneSphere=FreeDo.BoundingSphere.fromBoundingSpheres(e,new FreeDo.BoundingSphere)};c.prototype.getType=function(){return this._transType};c.prototype.start=function(e,t){if(!e)e="CLIPXY";this.startClip(e,t)};c.prototype.startClip=function(e,t){this._transType=e;this._bInClip=true;this.calcSceneBS();var r=this;if(this._lsner){this._lsner();this._lsner=undefined;this._q4=new Freedo.Quaternion(0,0,0,1)}this._lsner=this._mani.on(function(e,t){if(e=="Transform"){r.onTransformStart()}if(e=="Transformed"){r.onTransformEnd()}if(e=="Transforming"){r.onTransforming(t)}});this._mani.startClip("CLIPXY");if(e=="CLIPXY"||e=="CLIPXYNEG"||e=="CLIPYZ"||e=="CLIPXZ")this._selectedAxis="Z_AXIS";else{console.warn("不支持此种类型："+e)}if(!Freedo.defined(t))this.reset12Args();else{this._t12.TMoveX=t.TMoveX;this._t12.TMoveY=t.TMoveY;this._t12.TMoveZ=t.TMoveZ;this._q4=Freedo.clone(t.Q4)}if(e=="CLIPYZ"){this._t12.TPitch=90}if(e=="CLIPXZ"){this._t12.TRoll=90}if(e=="CLIPXYNEG"){this._t12.TPitch=180}this.onTransformStart();var n=Freedo.clone(this._mouseDown12Arg,true);this.updatePlane(n);if(e=="CLIPYZ"||e=="CLIPXZ"||e=="CLIPXYNEG"){var i,a,o;var s=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);if(s){i=s.longitude;a=s.latitude;o=s.height}if(this._isPlaneMode){i=this._sceneSphere.center.x;a=this._sceneSphere.center.y;o=this._sceneSphere.center.z}if(e=="CLIPXYNEG"||e=="CLIPYZ")this._selectedAxis="XZ_CIRCLE";if(e=="CLIPXZ")this._selectedAxis="YZ_CIRCLE";var u=new Freedo.Matrix3;var l=new Freedo.Quaternion;var c=this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,i,a,o,u,l);Freedo.Quaternion.multiply(this._q4,l,this._q4)}if(e=="CLIPYZ"){this._t12.TPitch=0}if(e=="CLIPXZ"){this._t12.TRoll=0}if(e=="CLIPXYNEG"){this._t12.TPitch=0}this._mani.show(this._sceneSphere);this._event.raiseEvent("Start",{})};c.prototype.getMatrix=function(e,t,r,n,i,a,o,s,u,l,c,f){var d=Freedo.Cartesian3.fromRadians(s,u,l);var h=Freedo.Cartesian3.fromRadians(s+t,u+r,l+n);if(this._isPlaneMode){d=new Freedo.Cartesian3(s,u,l);h=new Freedo.Cartesian3(s+t,u+r,l+n)}var v=Freedo.clone(e,true);a=Freedo.Math.toRadians(a);o=Freedo.Math.toRadians(o);var p;var _;var y;if(this._selectedAxis=="XZ_CIRCLE"){var m=Freedo.Quaternion.fromAxisAngle(new FreeDo.Cartesian3(1,0,0),o,new Freedo.Quaternion);p=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,m,new Freedo.Cartesian3(1,1,1));var g=Freedo.Matrix4.getRotation(p,new Freedo.Matrix3);var F=Freedo.Matrix3.multiplyByVector(g,new FreeDo.Cartesian3(0,-1,0),new Freedo.Cartesian3);F=new FreeDo.Cartesian3(0,-1,0);y=Freedo.Quaternion.fromAxisAngle(F,a,new Freedo.Quaternion)}else{var m=Freedo.Quaternion.fromAxisAngle(new FreeDo.Cartesian3(0,-1,0),a,new Freedo.Quaternion);p=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,m,new Freedo.Cartesian3(1,1,1));var g=Freedo.Matrix4.getRotation(p,new Freedo.Matrix3);var F=Freedo.Matrix3.multiplyByVector(g,new FreeDo.Cartesian3(1,0,0),new Freedo.Cartesian3);F=new FreeDo.Cartesian3(1,0,0);y=Freedo.Quaternion.fromAxisAngle(F,o,new Freedo.Quaternion)}Freedo.Quaternion.multiply(v,y,v);for(var w in y){if(f)f[w]=y[w]}_=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3(0,0,0),v,new Freedo.Cartesian3(1,1,1));var b=Freedo.Transforms.eastNorthUpToFixedFrame(d);if(this._isPlaneMode){b=Freedo.Matrix4.fromTranslation(d)}var C=Freedo.Matrix4.inverse(b,new Freedo.Matrix4);var P=Freedo.Transforms.eastNorthUpToFixedFrame(h);if(this._isPlaneMode){P=Freedo.Matrix4.fromTranslation(h)}var x=Freedo.Matrix4.multiply(p,C,new Freedo.Matrix4);var M=Freedo.Matrix4.multiply(_,x,new Freedo.Matrix4);var S=Freedo.Matrix4.multiply(P,M,new Freedo.Matrix4);var T=Freedo.Matrix4.getRotation(S,new Freedo.Matrix3);for(var w in T){if(c)c[w]=T[w]}return S};c.prototype.calcAxisZoom=function(){if(this._bInClip===false){this._axisZoom=1;return}var e=this._sceneSphere.center;var t=this._viewer.camera.positionWC;var r=1,n=1;r=Freedo.Cartesian3.distance(e,t)/6;n=this._viewer.camera.getPixelSize(this._sceneSphere,100,100);this._axisZoom=r;if(this._axisZoom>4e5)this._axisZoom=4e5;if(this._axisZoom<20)this._axisZoom=20};c.prototype.onTransforming=function(e){var t=e.SelectedAxis;this._selectedAxis=t;var r=[0,0,0];var n=1,i=1,a=1,o=0,s=0,u=0;this.calcAxisZoom();var l=Freedo.clone(this._mouseDown12Arg,true);var c=Freedo.FdMisc.FdGeometric.calcAngle(e.MouseDownStartXY,e.MouseDownXY,e.MouseDownStartXY,e.MouseMoveXY);if(t==="Z_AXIS"){var f=Math.sqrt(Math.pow(e.MouseDownXY.y-e.MouseMoveXY.y,2)+Math.pow(e.MouseDownXY.x-e.MouseMoveXY.x,2))*this._axisZoom/200;if(f==0)return;var d=[e.MouseDownEndXY.x-e.MouseDownStartXY.x,e.MouseDownEndXY.y-e.MouseDownStartXY.y];var h=[e.MouseMoveXY.x-e.MouseDownXY.x,e.MouseMoveXY.y-e.MouseDownXY.y];var v=(d[0]*h[0]+d[1]*h[1])/(Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2))*Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)));var p=Math.acos(v);var _,y,m;if(this._isPlaneMode){_={};_.longitude=this._sceneSphere.center.x;_.latitude=this._sceneSphere.center.y;_.height=this._sceneSphere.center.z;y=new FreeDo.Cartesian3(this._sceneSphere.center.x,this._sceneSphere.center.y,this._sceneSphere.center.z+1);m=FreeDo.Cartesian3.subtract(y,this._sceneSphere.center,new FreeDo.Cartesian3)}else{_=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);y=FreeDo.Cartesian3.fromRadians(_.longitude,_.latitude,_.height+1);m=FreeDo.Cartesian3.subtract(y,this._sceneSphere.center,new FreeDo.Cartesian3)}var g=new Freedo.Matrix3;this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,_.longitude,_.latitude,_.height,g);var F=Freedo.Matrix3.multiplyByVector(g,m,new Freedo.Cartesian3);var w=Freedo.Transforms.eastNorthUpToFixedFrame(this._sceneSphere.center);if(this._isPlaneMode){w=Freedo.Matrix4.fromTranslation(this._sceneSphere.center)}var b=Freedo.Matrix4.inverse(w,new Freedo.Matrix4);g=Freedo.Matrix4.getRotation(b,new Freedo.Matrix3);var C=Freedo.Matrix3.multiplyByVector(g,F,new Freedo.Cartesian3);var P=[1,1];if(this._isPlaneMode){P=[1,1]}else{P=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(_)}r[0]=P[1]*f*C.x*Math.cos(p);r[1]=P[0]*f*C.y*Math.cos(p);r[2]=f*C.z*Math.cos(p)}if(t==="XZ_CIRCLE"){var x=FreeDo.Cartesian3.subtract(e.Ori.yAxis[1],e.Ori.yAxis[0],new FreeDo.Cartesian3);var M=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(x,e.Ori.rayDirection));if(M>90)s=c;else s=-1*c}if(t==="YZ_CIRCLE"){var S=FreeDo.Cartesian3.subtract(e.Ori.xAxis[1],e.Ori.xAxis[0],new FreeDo.Cartesian3);var M=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(S,e.Ori.rayDirection));if(M>90)u=-1*c;else u=c}var T={TMoveX:r[0],TMoveY:r[1],TMoveZ:r[2],THeading:0,TPitch:s,TRoll:u,TScaleX:1,TScaleY:1,TScaleZ:1};l.TMoveX+=T.TMoveX;l.TMoveY+=T.TMoveY;l.TMoveZ+=T.TMoveZ;l.TRoll=T.TRoll;l.TPitch=T.TPitch;this._t12.TMoveX=l.TMoveX;this._t12.TMoveY=l.TMoveY;this._t12.TMoveZ=l.TMoveZ;this._t12.TPitch=l.TPitch;this._t12.TRoll=l.TRoll;this.refineArgs();this._event.raiseEvent("Cliping",this.clipOptions);this._event.raiseEvent("DataChanged",this.clipOptions);this.updatePlane(this._t12);this._viewer.scene.requestRender()};c.prototype.getNewPlane=function(e){var t=new Freedo.Plane(new Freedo.Cartesian3(0,0,1),0);var r=Freedo.Transforms.eastNorthUpToFixedFrame(this._sceneSphere.center);if(this._isPlaneMode){var r=Freedo.Matrix4.fromTranslation(this._sceneSphere.center)}Freedo.Matrix4.multiply(e,r,r);Freedo.Plane.transform(t,r,t);return t};c.prototype.updatePlane=function(e){var t,r,n;var i=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);if(i){t=i.longitude;r=i.latitude;n=i.height}if(this._isPlaneMode){t=this._sceneSphere.center.x;r=this._sceneSphere.center.y;n=this._sceneSphere.center.z}var a=undefined;var o=undefined;var s=new Freedo.Matrix3;var u=new Freedo.Matrix4;if(this._selectedAxis==="Z_AXIS"||this._selectedAxis==="XZ_CIRCLE"||this._selectedAxis==="YZ_CIRCLE"){var l,c;if(this._isPlaneMode){l=Freedo.clone(this._sceneSphere.center,true);l.z-=1;var c=Freedo.clone(l,true)}else{l=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);l.height-=1;var c=Freedo.Cartesian3.fromRadians(l.longitude,l.latitude,l.height)}var f=FreeDo.Cartesian3.subtract(c,this._sceneSphere.center,new FreeDo.Cartesian3);u=this.getMatrix(this._q4,e.TMoveX,e.TMoveY,e.TMoveZ,e.THeading,e.TPitch,e.TRoll,t,r,n,s);var d=Freedo.Matrix3.multiplyByVector(s,f,new Freedo.Cartesian3);if(isNaN(d.x)){console.warn("出现异常v2");return}a=Freedo.Cartesian3.normalize(d,new Freedo.Cartesian3)}if(a!==undefined){var o=this.getNewPlane(u);var h=[o];for(var v in this._tileset){var p=this._tileset[v];p.clippingPlanes=new Freedo.ClippingPlaneCollection({planes:h,edgeWidth:1,useGltfModelMatrix:false})}}this._mani.updateMatrix4(u)};c.prototype.refineArgs=function(){this._t12.TMoveX=Freedo.FdMisc.FdMath.round(this._t12.TMoveX,8);this._t12.TMoveY=Freedo.FdMisc.FdMath.round(this._t12.TMoveY,8);this._t12.TMoveZ=Freedo.FdMisc.FdMath.round(this._t12.TMoveZ,6);this._t12.TPitch=Freedo.FdMisc.FdMath.round(this._t12.TPitch,4);this._t12.TRoll=Freedo.FdMisc.FdMath.round(this._t12.TRoll,4)};c.prototype.getData=function(){return{type:this._transType,TMoveX:this._t12.TMoveX,TMoveY:this._t12.TMoveY,TMoveZ:this._t12.TMoveZ,TPitch:this._t12.TPitch,TRoll:this._t12.TRoll}};c.prototype.setData=function(e){this._tileset=e};c.prototype.reset12Args=function(){this._t12.TMoveX=0;this._t12.TMoveY=0;this._t12.TMoveZ=0;this._t12.TPitch=0;this._t12.TRoll=0};c.prototype.onTransformStart=function(e){this._event.raiseEvent("ClipStart",{});this.refineArgs();this._mouseDown12Arg=Freedo.clone(this._t12,true)};c.prototype.onTransformEnd=function(e){var t,r,n;if(this._isPlaneMode){t=this._sceneSphere.center.x;r=this._sceneSphere.center.y;n=this._sceneSphere.center.z}else{var i=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);t=i.longitude;r=i.latitude;n=i.height}var a=new Freedo.Quaternion;var o=this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,t,r,n,new Freedo.Matrix3,a);Freedo.Quaternion.multiply(this._q4,a,this._q4);this.refineArgs();this._event.raiseEvent("ClipEnd",FreeDo.clone(this._t12,true))};c.prototype.backToOriginPlane=function(){this.start(this._transType);this._event.raiseEvent("ClipReset",FreeDo.clone(this._t12,true))};c.prototype.cancelClip=function(){this.reset();this._event.raiseEvent("Cancel",{})};c.prototype.cancel=function(){this.cancelClip()};c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};c.prototype.reset=function(){this._bInClip=false;this._sceneSphere=null;this.reset12Args();this._mani.reset();if(this._lsner)this._lsner();this._lsner=undefined;this._q4=new Freedo.Quaternion(0,0,0,1)};c.prototype.dispose=function(){this.reset()};t.FdClipPlane=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPathAnimator=undefined;var n=r(1);var i=u(n);var a=r(72);var o=r(84);var s=r(11);function u(e){return e&&e.__esModule?e:{default:e}}var l=function e(t){(0,i.default)(this,e);this._viewer=t;this._points={};this._ptsSmoothed=[];this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._kb=new o.FdKeyboard(t);this._kbCallback=undefined;this._bKBActive=false;this._lines=[];this._bStop=true;this._bPause=true;this._bPauseMannul=0;this._bRun=false;this._dPitch=15;this._dOffsetH=0;this._dHeight=100;this._dSpeed=1e3;this._bLock=1;this._lastTS=0;this._timeUsed=0;this._totalLen=0;this._passedLen=0;this._dHeading=0;this._pathPL=undefined;this._smoothRate=2;this._nearRate=4;this.addKBLsnr();this._showPath=false;this._loop=false;this._pathViewMode=false;this._aTmpPoint=[];this._centerPt=undefined};l.prototype.start=function(){if(!this._bRun){var e=this;this._bRun=true;this._viewer.scene.preRender.addEventListener(function(){e.tick()})}if(!this._bStop&&this._bPauseMannul!=1)return;if(this._bStop){this._bStop=false;this._bPause=false;this._bPauseMannul=2;this._startTime=0;this._timeUsed=0}if(this._bPauseMannul==1){this._bPauseMannul=2;console.log(this._bPauseMannul)}this._event.raiseEvent("StatusChanged",{status:"play"});this._kb.setFocus()};l.prototype.enable=function(){this._bKBActive=true;this._kb.enable()};l.prototype.disable=function(){this._bKBActive=false;this._kb.disable()};l.prototype.getKeyboardStatus=function(){return this._bKBActive};l.prototype.addKBLsnr=function(){var e=this;this._kbCallback=this._kb.on(function(t,r){if(t==="timer"){e.onKeyboard(r.metaData);return;if(!e._bRun&&(r.metaData[38]||r.metaData[40])){e.start();e._bPauseMannul=1}}})};l.prototype.onKeyboard=function(e){if(!this._bKBActive)return;if(this._points.length==0)return;if(e[33]){this._bPauseMannul=1;var t=33.3/1e3*this._dSpeed;this.kbtick(t)}if(e[34]){this._bPauseMannul=1;var t=-33.3/1e3*this._dSpeed;this.kbtick(t)}};l.prototype.stop=function(){if(this._bStop)return;this._bStop=true;this._event.raiseEvent("StatusChanged",{status:"stop"});this._kb.setFocus();if(this._centerPt){this._viewer.entities.remove(this._centerPt);this._centerPt=undefined}this._viewer.scene.requestRender();this._viewer.camera.lookAtTransform(Freedo.Matrix4.IDENTITY)};l.prototype.pause=function(){if(this._bStop)return;this._bPauseMannul=1;this._event.raiseEvent("StatusChanged",{status:"pause"});this._kb.setFocus()};l.prototype.getSpeed=function(){return this._dSpeed};l.prototype.setSpeed=function(e){this._dSpeed=e};l.prototype.setNearRate=function(e){this._nearRate=e};l.prototype.getPitch=function(){return this._dPitch};l.prototype.setPitch=function(e){this._dPitch=e*-1};l.prototype.setOffsetH=function(e){this._dOffsetH=e;this.smoothPath()};l.prototype.setPathViewMode=function(e){this._pathViewMode=e};l.prototype.setSmoothRate=function(e){this._smoothRate=e;this.smoothPath()};l.prototype.getHeight=function(){return this._dHeight};l.prototype.setHeight=function(e){this._dHeight=e};l.prototype.setHeading=function(e){this._dHeading=e};l.prototype.setPathShow=function(e){if(this._showPath!==e){this._event.raiseEvent("PathStatusChanged",{status:this._showPath})}this._showPath=e;this.showPath()};l.prototype.getStatus=function(){if(this._bStop)return"stop";else if(this._bPauseMannul==1)return"pause";else return"play";this._kb.setFocus()};l.prototype.showPath=function(){if(this._showPath){if(this._pathPL!==undefined){this._viewer.entities.remove(this._pathPL);this._pathPL=undefined}for(var e in this._aTmpPoint){this._viewer.entities.remove(this._aTmpPoint[e])}this._aTmpPoint=[];for(var t=0;t<this._points.length;t++){var r=Freedo.Cartesian3.fromDegrees(this._points[t][0],this._points[t][1],this._points[t][2]+this._dOffsetH);var n=this._viewer.entities.add({position:r,point:{color:Freedo.Color.RED,pixelSize:10,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:true}});this._aTmpPoint.push(n)}this._pathPL=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:this._ptsSmoothed,width:3,material:Freedo.Color.YELLOW,depthFailMaterial:Freedo.Color.YELLOW}})}else{this._viewer.entities.remove(this._pathPL);this._pathPL=undefined;for(var e in this._aTmpPoint){this._viewer.entities.remove(this._aTmpPoint[e])}}this._kb.setFocus();this._viewer.scene.requestRender()};l.prototype.calVectorOri=function(e,t){var r=FreeDo.Cartographic.fromCartesian(e);var n=FreeDo.Cartographic.fromCartesian(t);if(n.longitude>r.longitude&&n.latitude>r.latitude)return 1;if(n.longitude>r.longitude&&n.latitude<r.latitude)return 2;if(n.longitude<r.longitude&&n.latitude<r.latitude)return 3;if(n.longitude<r.longitude&&n.latitude>r.latitude)return 4};l.prototype.calVectorHeading=function(e,t){var r=FreeDo.Cartographic.fromCartesian(e);var n=FreeDo.Cartographic.fromCartesian(t);return Math.atan((n.longitude-r.longitude)/(n.latitude-r.latitude))};l.prototype.calcCP=function(e,t,r){var n,i,a;n=e.position;i=t.position;a=r.position;var o=[];var s=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3);var u=FreeDo.Cartesian3.subtract(a,i,new FreeDo.Cartesian3);var l=FreeDo.Cartesian3.cross(s,u,new FreeDo.Cartesian3);var c=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3);var f=FreeDo.Cartesian3.normalize(u,new FreeDo.Cartesian3);var d=FreeDo.Cartesian3.add(c,f,new FreeDo.Cartesian3);var h=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var v=Freedo.Quaternion.fromAxisAngle(l,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var p=Freedo.Matrix3.fromQuaternion(h,new Freedo.Matrix3);var _=Freedo.Matrix3.fromQuaternion(v,new Freedo.Matrix3);var y=Freedo.Matrix3.multiplyByVector(p,d,new Freedo.Cartesian3);var m=Freedo.Matrix3.multiplyByVector(_,d,new Freedo.Cartesian3);var g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var F=FreeDo.Cartesian3.normalize(m,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.distance(n,i);var b=FreeDo.Cartesian3.distance(a,i);var C=1;if(w<b){C=w/this._nearRate}else C=b/this._nearRate;g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);F=FreeDo.Cartesian3.multiplyByScalar(F,C,new FreeDo.Cartesian3);var P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);var x=FreeDo.Cartesian3.add(i,F,new FreeDo.Cartesian3);var M=FreeDo.Cartesian3.distance(n,P);var S=FreeDo.Cartesian3.distance(n,x);if(M<S)return[P,x];else return[x,P]};l.prototype.smoothPolyline=function(e){var t=[];if(e.length<3){for(var r=0;r<e.length;r++){t.push(e[r].position)}}else{for(var r=0;r<=e.length-2;r++){var n={},i={},o={},s={};if(r==0){n=e[0];i.position=this.calcCP(e[0],e[1],e[2])[0];o=e[0];s=e[1]}else if(r==e.length-2){n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i=e[r+1];o=e[r];s=e[r+1]}else{n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i.position=this.calcCP(e[r],e[r+1],e[r+2])[0];o=e[r];s=e[r+1]}var u=new a.FdBezierCurveAlgorithm(o,s,n,i);var l=u.getVertexForCurve(this._smoothRate);t=t.concat(l)}}var c=[];for(var r=0;r<t.length;r++){var f={};f=t[r];if(c.length>0){var d=FreeDo.Cartesian3.distance(c[c.length-1],f);if(d>1e-4)c.push(f)}else c.push(f)}return c};l.prototype.calcHeading=function(e){var t=this.calVectorHeading(this._ptsSmoothed[e],this._ptsSmoothed[e+1]);var r=this.calVectorOri(this._ptsSmoothed[e],this._ptsSmoothed[e+1]);t=Freedo.Math.toDegrees(t);if(r==1)t=t+0;if(r==2)t=t+180;if(r==3)t=t+180;if(r==4)t=t+360;return t};l.prototype.smoothPath=function(){if(!this._points)return;var e=[];for(var t=0;t<this._points.length;t++){var r=Freedo.Cartesian3.fromDegrees(this._points[t][0],this._points[t][1],this._points[t][2]+this._dOffsetH);e.push({position:r})}this._ptsSmoothed=this.smoothPolyline(e);this.showPath();this._totalLen=Freedo.FdMisc.FdGeometric.calculateLength(this._ptsSmoothed);this._kb.setFocus()};l.prototype.getTotalLength=function(){return this._totalLen};l.prototype.setPoints=function(e){this._points=e;this.smoothPath()};l.prototype.setLoop=function(e){this._loop=e};l.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};l.prototype.callbackCenter=function(e,t){t=this._center;return t};l.prototype.gotoSubByLength=function(e,t,r){var n=0;var i=0;var a=0;var o=0;n=this.calcHeading(e);if(e==this._ptsSmoothed.length-2)i=n;else i=this.calcHeading(e+1);var a=n+t/r*(i-n);if(n+180<i){var s=360-i+n;if(t/r<n/s){a=n-t/r/(n/s)*n;if(a<0)a+=360}else{a=360-(t/r-n/s)/((360-i)/s)*(360-i)}}if(n-180>i){var s=360-n+i;if(t/r<(360-n)/s){a=n+t/r/((360-n)/s)*(360-n);if(a>360)a-=360}else{a=(t/r-(360-n)/s)/(i/s)*i}}var u={};u.x=this._ptsSmoothed[e].x+t/r*(this._ptsSmoothed[e+1].x-this._ptsSmoothed[e].x);u.y=this._ptsSmoothed[e].y+t/r*(this._ptsSmoothed[e+1].y-this._ptsSmoothed[e].y);u.z=this._ptsSmoothed[e].z+t/r*(this._ptsSmoothed[e+1].z-this._ptsSmoothed[e].z);var l=FreeDo.Cartographic.fromCartesian(u);var c=FreeDo.Math.toDegrees(l.longitude);var f=FreeDo.Math.toDegrees(l.latitude);var d=Freedo.Cartesian3.fromDegrees(c,f,l.height);this._center=d;if(!this._centerPt){var h=new Freedo.CallbackProperty(this.callbackCenter.bind(this),false);this._centerPt=this._viewer.entities.add({position:h,point:{color:Freedo.Color.GREEN,pixelSize:10,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:false}})}a=Freedo.Math.toRadians(a+this._dHeading);o=Freedo.Math.toRadians(this._dPitch);if(this._dHeight<1)this._dHeight=100;this._viewer.camera.lookAt(d,new Freedo.HeadingPitchRange(a,o,this._dHeight));this._viewer.scene.requestRender()};l.prototype.gotoSubByLengthUsePathViewMode=function(e,t,r){var n={};n.x=this._ptsSmoothed[e].x+t/r*(this._ptsSmoothed[e+1].x-this._ptsSmoothed[e].x);n.y=this._ptsSmoothed[e].y+t/r*(this._ptsSmoothed[e+1].y-this._ptsSmoothed[e].y);n.z=this._ptsSmoothed[e].z+t/r*(this._ptsSmoothed[e+1].z-this._ptsSmoothed[e].z);var i=FreeDo.Cartographic.fromCartesian(n);var a=FreeDo.Math.toDegrees(i.longitude);var o=FreeDo.Math.toDegrees(i.latitude);var s=Freedo.Cartesian3.fromDegrees(a,o,i.height+this._dHeight);var u=FreeDo.Cartesian3.subtract(this._ptsSmoothed[e+1],this._ptsSmoothed[e],new FreeDo.Cartesian3);var l=Freedo.Cartesian3.normalize(u,new Freedo.Cartesian3);var c=Freedo.Cartesian3.normalize(s,new Freedo.Cartesian3);this._viewer.camera.setView({destination:s,orientation:{direction:l,up:c}});s=null;u=null;c=null};l.prototype.gotoByLength=function(e){var t=0;var r=0;for(var n=0;n<this._ptsSmoothed.length-1;n++){r=FreeDo.Cartesian3.distance(this._ptsSmoothed[n],this._ptsSmoothed[n+1]);if(e>t&&e<t+r){if(this._pathViewMode)this.gotoSubByLengthUsePathViewMode(n,e-t,r);else this.gotoSubByLength(n,e-t,r);break}t+=r}};l.prototype.tick=function(){var e=(new Date).getTime();if(this._bStop){this._lastTS=0;this._timeUsed=0;return}if(!this._bStop&&!this._bPause&&Freedo.defined(e)&&(this._bPauseMannul==0||this._bPauseMannul==2)){if(this._lastTS==0){this._lastTS=e}else{this._timeUsed+=e-this._lastTS;this._passedLen=this._timeUsed/1e3*this._dSpeed;if(this._passedLen<this._totalLen){this.gotoByLength(this._passedLen)}else{this.stop();this._event.raiseEvent("Finished",{status:"Finished"});if(this._loop)this.start()}}}this._lastTS=e};l.prototype.kbtick=function(e){this._timeUsed+=33*e/Math.abs(e);this._passedLen+=e;if(this._passedLen<=0){this._passedLen=0;this._timeUsed=0;console.log("重新播放:"+this._passedLen)}if(this._passedLen<this._totalLen)this.gotoByLength(this._passedLen);else{this._passedLen=0;this._timeUsed=0}};l.prototype.clear=function(){for(var e in this._lines){this._viewer.entities.remove(this._lines[e])}if(this._pathPL){this._viewer.entities.remove(this._pathPL);this._pathPL=undefined}for(var e in this._aTmpPoint){this._viewer.entities.remove(this._aTmpPoint[e])}this._aTmpPoint=[];if(this._centerPt){this._viewer.entities.remove(this._centerPt);this._centerPt=undefined}this._viewer.scene.requestRender()};l.prototype.reset=function(){this.clear();this._bStop=true;this._points=undefined};l.prototype.dispose=function(){this.reset()};t.FdPathAnimator=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdPathsManager=undefined;var n=r(1);var i=c(n);var a=r(6);var o=c(a);var s=r(304);var u=r(11);var l=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r){var n=this;(0,i.default)(this,e);this._pathsOpts=r;this._pa=new s.FdPathAnimator(t);this._pa.on(function(e,t){n.pathAnimatorEventCallback(e,t)});this._ple=new l.FdPolylineEditor(t);this._ple.setAutoLoop(false);this._ple.setAutoDelLines(true);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._currentPlayingGroupID=undefined;this._currentGroupID=undefined;var a=this;this._lsner=this._ple.on(function(e,t){if(e=="PointAdded"){a.appendPathPoint(a._currentGroupID,t)}if(e=="PLAdd"){a._ple.cancel();a.reloadPA();a._event.raiseEvent("DataChanged",a._pathsOpts[a._currentGroupID])}if(e=="EditEnd"){var r=a._pathsOpts[a._currentGroupID].list;for(var n in t.pts){var i=u.FdMisc.FdGeometric.tg(t.pts[n]);r[n].position=i}a.reloadPA(a._currentGroupID);a._event.raiseEvent("DataChanged",a._pathsOpts[a._currentGroupID])}})}(0,o.default)(e,[{key:"pathsOptions",get:function e(){return this._pathsOpts},set:function e(t){if(!Freedo.defined(t)){return}this._pathsOpts=t}}]);return e}();f.prototype.pathAnimatorEventCallback=function(e,t){this._event.raiseEvent(e,t)};f.prototype.createGroup=function(e,t){if(typeof t==="undefined"){t=Freedo.createGuid()}this._pathsOpts[t]={name:e,smooth:5,list:[]};this._currentGroupID=t;return t};f.prototype.removeGroup=function(e){if(typeof this._pathsOpts[e]=="undefined"){return false}if(this._currentGroupID===e){this._pa.reset();this._currentGroupID=undefined}if(this._currentPlayingGroupID===e){}delete this._pathsOpts[e];this._event.raiseEvent("GroupsChanged");return true};f.prototype.getGroupName=function(e){if(typeof this._pathsOpts[e]=="undefined"){return""}return this._pathsOpts[e].name};f.prototype.setGroupName=function(e,t){if(typeof this._pathsOpts[e]=="undefined"){return""}this._pathsOpts[e].name=t};f.prototype.getGroupSmooth=function(e){if(typeof this._pathsOpts[e]=="undefined"){return-1}if(!this._pathsOpts[e].smooth)return 5;return this._pathsOpts[e].smooth};f.prototype.setGroupSmooth=function(e,t){if(typeof this._pathsOpts[e]=="undefined"){return false}this._pathsOpts[e].smooth=t;this._pa.setSmoothRate(t);return true};f.prototype.getGroupOptions=function(e){if(typeof this._pathsOpts[e]=="undefined"){return undefined}var t=Freedo.clone(this._pathsOpts[e],true);return t};f.prototype.removeAllGroups=function(){for(var e in this._pathsOpts){delete this._pathsOpts[e]}this._currentPlayingGroupID=undefined;this._event.raiseEvent("GroupsChanged");return true};f.prototype.getAllGroupIDs=function(){var e=[];for(var t in this._pathsOpts){e.push(t)}return e};f.prototype.preAppendPathPoint=function(){if(!Freedo.defined(this._currentGroupID)||this._currentGroupID.length==0)return;var e=this._pathsOpts[this._currentGroupID].list;if(e&&e.length>=1){var t=e[e.length-1];this._ple.setStartPt(Freedo.FdMisc.FdGeometric.tc(t.position))}this._ple.run()};f.prototype.endAppendPathPoint=function(){this._ple.cancel();if(this._lsner){this._lsner();this._lsner=undefined}};f.prototype.appendPathPoint=function(e,t){if(typeof this._pathsOpts[e]=="undefined"){return false}var r=Freedo.clone(t,true);r.name="路径点_"+(new Date).getTime();this._pathsOpts[e].list.push(r);this._event.raiseEvent("GroupChanged",e);return true};f.prototype.insertPathPoint=function(e,t,r){if(typeof this._pathsOpts[e]=="undefined"){return false}var n=Freedo.clone(t,true);this._pathsOpts[e].list.splice(r,0,n);this._event.raiseEvent("GroupChanged",e);return true};f.prototype.removePathPoint=function(e,t){if(typeof this._pathsOpts[e]==="undefined"){return false}if(typeof this._pathsOpts[e].list[t]==="undefined"){return false}this._pathsOpts[e].list.splice(t,1);this._event.raiseEvent("GroupChanged",e);this.reloadPA(e);return true};f.prototype.getPathsLength=function(e){if(typeof this._pathsOpts[e]==="undefined"){throw new Error("getPathsLength error!")}return this._pathsOpts[e].list.length};f.prototype.setPathPoint=function(e,t,r){if(typeof this._pathsOpts[e]==="undefined"){return false}if(typeof this._pathsOpts[e].list[t]==="undefined"){return false}var n=Freedo.clone(r,true);this._pathsOpts[e].list[t]=n;return true};f.prototype.getPathPoint=function(e,t){if(typeof this._pathsOpts[e]==="undefined"){throw new Error("getPath error")}if(typeof this._pathsOpts[e].list[t]==="undefined"){return new Error("getPath error")}var r=this._pathsOpts[e].list[t];var n=Freedo.clone(r,true);return n};f.prototype.flyTo=function(e,t){if(typeof this._pathsOpts[e]==="undefined"){return false}if(typeof this._pathsOpts[e].list[t]==="undefined"){return false}var r=this._pathsOpts[e].list[t];var n=this._pa.getTotalLength();var i=new Freedo.BoundingSphere(Freedo.FdMisc.FdGeometric.tc(r.position),n/400);return true};f.prototype.goto=function(e,t){if(typeof this._pathsOpts[e]==="undefined"){return false}if(typeof this._pathsOpts[e].list[t]==="undefined"){return false}var r=this._pathsOpts[e].list[t];var n=r.cameraInfo;if(typeof n==="undefined"){return false}return true};f.prototype.start=function(){this._pa.start()};f.prototype.pause=function(){this._pa.pause()};f.prototype.stop=function(){this._pa.stop()};f.prototype.getGroupPlayingStatus=function(){};f.prototype.getGroupPlayingGroupID=function(){return this._currentPlayingGroupID};f.prototype.setCurrentGroupID=function(e){this._currentGroupID=e;this.reloadPA(e)};f.prototype.startEdit=function(e){this._currentGroupID=e;var t=this._pathsOpts[this._currentGroupID].list;var r=[];for(var n in t){var i=u.FdMisc.FdGeometric.tc(t[n].position);r.push(i)}this._ple.startEdit(r)};f.prototype.editPre=function(){this._ple.editPre()};f.prototype.editNext=function(){this._ple.editNext()};f.prototype.endEdit=function(){this._ple.endEdit()};f.prototype.reloadPA=function(e){if(!e)e=this._currentGroupID;var t=this._pathsOpts[e];if(typeof t==="undefined"){throw new Error("getPath error")}if(typeof t.list==="undefined"){return new Error("getPath error")}var r=[];for(var n in t.list){r.push(t.list[n].position)}this._pa.setPoints(r)};f.prototype.setPathShow=function(e){this._pa.setPathShow(e)};f.prototype.setLoop=function(e){this._pa.setLoop(e)};f.prototype.setKBStatus=function(e){if(e)this._pa.enable();else this._pa.disable()};f.prototype.getPitch=function(){return this._pa.getPitch()};f.prototype.setPitch=function(e){this._pa.setPitch(e)};f.prototype.setPathViewMode=function(e){this._pa.setPathViewMode(e)};f.prototype.getSpeed=function(){this._pa.getSpeed()};f.prototype.setSpeed=function(e){this._pa.setSpeed(e)};f.prototype.setSmoothRate=function(e){this._pa.setSmoothRate(e)};f.prototype.getHeight=function(){return this._pa.getHeight()};f.prototype.setHeight=function(e){this._pa.setHeight(e)};f.prototype.setHeading=function(e){this._pa.setHeading(e)};f.prototype.setNearRate=function(e){this._pa.setNearRate(e)};f.prototype.setOffsetH=function(e){this._pa.setOffsetH(e)};f.prototype.getData=function(){return Freedo.clone(this._pathsOpts,true)};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.reset=function(){this.removeAllGroups();this._pa.reset();if(this._lsner){this._lsner();this._lsner=undefined}};f.prototype.dispose=function(){this.reset();this._eventHelper.removeAll()};t.FdPathsManager=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdDrawRoad=undefined;var n=r(1);var i=c(n);var a=r(6);var o=c(a);var s=r(72);var u=r(11);var l=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._scene=this._viewer.scene;this._roads=[];this._centerLines=[];this._roadsOptions=[];this._lsner=undefined;this._ple=new l.FdPolylineEditor(t);this._ple.setAutoLoop(false);this._ple.setAutoDelLines(true);this._handler=undefined;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._level=undefined;this._smoothRate=5;this._nearRate=4;this._hideCenterLine=true;this._currentId=undefined}(0,o.default)(e,[{key:"roadsOptions",get:function e(){return this._roadsOptions},set:function e(t){if(!Freedo.defined(t)){return}this.clearRoads();for(var r in t){this.addRoad(t[r]["id"],t[r]["pts"],t[r]["level"],t[r]["width"])}}}]);return e}();f.prototype.start=function(e){if(!Freedo.defined(e)){console.error("start：参数level无效");return}this._ple.run();this._level=e;this.addLsnr();this._event.raiseEvent("Start",{})};f.prototype.addLsnr=function(){if(this._lsner)this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){if(t=="PLAdd"){e.onPLAdd(r)}if(t=="EditEnd"){for(var n in e._roadsOptions){if(e._currentId==e._roadsOptions[n].id){e._roadsOptions[n].pts=Freedo.clone(r.pts)}}e.reDraw()}})};f.prototype.onPLAdd=function(e){this.addRoad(undefined,e.polyline.pts,this._level,5)};f.prototype.addRoad=function(e,t,r,n){if(!Freedo.defined(e))e=Freedo.createGuid();var i=this.getRoadUrlByLevel(r);var a=[];var o=Freedo.Math.toDegrees;for(var s=0;s<t.length;s++){var u=Freedo.Cartographic.fromCartesian(t[s]);a.push({lon:o(u.longitude),lat:o(u.latitude),height:u.height+3})}var l=this.drawRoad(a,n,i);if(!this._hideCenterLine){var c=this._viewer.scene.primitives.add(this.createLinePrimitive(t));this._centerLines.push(c)}this._viewer.scene.requestRender();this._roads.push(l);var f={id:e,pts:t,level:r,width:n};this._roadsOptions.push(f);this._event.raiseEvent("RoadAdd",{});this._event.raiseEvent("DataChanged",f)};f.prototype.TransfPointToCartesian3=function(e){var t=[];for(var r=0;r<e.length;r++){t[r]=FreeDo.Cartesian3.fromDegrees(e[r].lon,e[r].lat,e[r].height)}return t};var d=new FreeDo.Cartesian3;f.prototype.TransfCartesian3ToSelf=function(e){var t=[];for(var r=0;r<e.length;r++){t[r]=new Freedo.Cartesian3(e[r].x-d.x,e[r].y-d.y,e[r].z-d.z)}return t};f.prototype.getPointArray=function(e,t,r){var n=new FreeDo.Cartesian3;var i=new FreeDo.Cartesian3;var a=new FreeDo.Cartesian3;var o=new FreeDo.Cartesian3;var s=new FreeDo.Cartesian3;var u=new FreeDo.Cartesian3;var l=new FreeDo.Cartesian3;var c=new FreeDo.Cartesian3;var f=new FreeDo.Cartesian3;var d=new FreeDo.Cartesian3;var h=null;var v=null;var p=[];switch(t.length){case 0:break;case 1:break;case 2:FreeDo.Cartesian3.subtract(t[1],t[0],n);FreeDo.Cartesian3.cross(e[0],n,a);FreeDo.Cartesian3.cross(n,e[0],o);FreeDo.Cartesian3.normalize(a,s);FreeDo.Cartesian3.normalize(o,u);s.x=s.x*r;s.y=s.y*r;s.z=s.z*r;u.x=u.x*r;u.y=u.y*r;u.z=u.z*r;FreeDo.Cartesian3.add(t[0],s,f);FreeDo.Cartesian3.add(t[0],u,d);p.push(new FreeDo.Cartesian3(f.x,f.y,f.z));p.push(new FreeDo.Cartesian3(d.x,d.y,d.z));FreeDo.Cartesian3.add(t[1],s,f);FreeDo.Cartesian3.add(t[1],u,d);p.push(new FreeDo.Cartesian3(f.x,f.y,f.z));p.push(new FreeDo.Cartesian3(d.x,d.y,d.z));break;default:for(var _=1;_<t.length-1;_++){FreeDo.Cartesian3.subtract(t[_],t[_-1],n);FreeDo.Cartesian3.subtract(t[_+1],t[_],i);if(FreeDo.Cartesian3.angleBetween(n,i)==0){t.splice(_--,1)}}for(var y=0;y<t.length;y++){if(y==0){FreeDo.Cartesian3.subtract(t[y+1],t[y],n);FreeDo.Cartesian3.cross(e[y],n,a);FreeDo.Cartesian3.cross(n,e[y],o);FreeDo.Cartesian3.normalize(a,s);FreeDo.Cartesian3.normalize(o,u);s.x=s.x*r;s.y=s.y*r;s.z=s.z*r;u.x=u.x*r;u.y=u.y*r;u.z=u.z*r;FreeDo.Cartesian3.add(t[y],s,f);FreeDo.Cartesian3.add(t[y],u,d);p.push(new FreeDo.Cartesian3(f.x,f.y,f.z));p.push(new FreeDo.Cartesian3(d.x,d.y,d.z))}else if(y==t.length-1){FreeDo.Cartesian3.subtract(t[y],t[y-1],n);FreeDo.Cartesian3.cross(e[y],n,a);FreeDo.Cartesian3.cross(n,e[y],o);FreeDo.Cartesian3.normalize(a,s);FreeDo.Cartesian3.normalize(o,u);s.x=s.x*r;s.y=s.y*r;s.z=s.z*r;u.x=u.x*r;u.y=u.y*r;u.z=u.z*r;FreeDo.Cartesian3.add(t[y],s,f);FreeDo.Cartesian3.add(t[y],u,d);p.push(new FreeDo.Cartesian3(f.x,f.y,f.z));p.push(new FreeDo.Cartesian3(d.x,d.y,d.z))}else{FreeDo.Cartesian3.subtract(t[y-1],t[y],n);FreeDo.Cartesian3.subtract(t[y+1],t[y],i);v=FreeDo.Cartesian3.angleBetween(n,i)/2;h=r/Math.sin(v);FreeDo.Cartesian3.subtract(t[y+1],t[y],n);FreeDo.Cartesian3.subtract(t[y],t[y-1],i);FreeDo.Cartesian3.normalize(n,n);FreeDo.Cartesian3.normalize(i,i);FreeDo.Cartesian3.add(n,i,l);FreeDo.Cartesian3.cross(e[y],l,a);FreeDo.Cartesian3.normalize(a,s);s.x=s.x*h;s.y=s.y*h;s.z=s.z*h;FreeDo.Cartesian3.add(t[y],s,f);FreeDo.Cartesian3.cross(l,e[y],o);FreeDo.Cartesian3.normalize(o,u);u.x=u.x*h;u.y=u.y*h;u.z=u.z*h;FreeDo.Cartesian3.add(t[y],u,d);p.push(new FreeDo.Cartesian3(f.x,f.y,f.z));p.push(new FreeDo.Cartesian3(d.x,d.y,d.z))}}}return p};f.prototype.getRoadUrlByLevel=function(e){var t=null;if(e=="一级"){t=Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road1.jpg"}else if(e=="二级"){t=Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road2.jpg"}else if(e=="三级"){t=Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road3.jpg"}else{t=null}return t};f.prototype.calcCP=function(e,t,r){var n,i,a;n=e.position;i=t.position;a=r.position;var o=[];var s=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3);var u=FreeDo.Cartesian3.subtract(a,i,new FreeDo.Cartesian3);var l=FreeDo.Cartesian3.cross(s,u,new FreeDo.Cartesian3);var c=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3);var f=FreeDo.Cartesian3.normalize(u,new FreeDo.Cartesian3);var d=FreeDo.Cartesian3.add(c,f,new FreeDo.Cartesian3);var h=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var v=Freedo.Quaternion.fromAxisAngle(l,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion);var p=Freedo.Matrix3.fromQuaternion(h,new Freedo.Matrix3);var _=Freedo.Matrix3.fromQuaternion(v,new Freedo.Matrix3);var y=Freedo.Matrix3.multiplyByVector(p,d,new Freedo.Cartesian3);var m=Freedo.Matrix3.multiplyByVector(_,d,new Freedo.Cartesian3);var g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3);var F=FreeDo.Cartesian3.normalize(m,new FreeDo.Cartesian3);var w=FreeDo.Cartesian3.distance(n,i);var b=FreeDo.Cartesian3.distance(a,i);var C=1;if(w<b){C=w/this._nearRate}else C=b/this._nearRate;g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);F=FreeDo.Cartesian3.multiplyByScalar(F,C,new FreeDo.Cartesian3);var P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);var x=FreeDo.Cartesian3.add(i,F,new FreeDo.Cartesian3);var M=FreeDo.Cartesian3.distance(n,P);var S=FreeDo.Cartesian3.distance(n,x);if(M<S)return[P,x];else return[x,P]};f.prototype.smoothPolyline=function(e){var t=[];if(e.length<3){for(var r=0;r<e.length;r++){t.push(e[r].position)}}else{for(var r=0;r<=e.length-2;r++){var n={},i={},a={},o={};if(r==0){n=e[0];i.position=this.calcCP(e[0],e[1],e[2])[0];a=e[0];o=e[1]}else if(r==e.length-2){n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i=e[r+1];a=e[r];o=e[r+1]}else{n.position=this.calcCP(e[r-1],e[r],e[r+1])[1];i.position=this.calcCP(e[r],e[r+1],e[r+2])[0];a=e[r];o=e[r+1]}var u=new s.FdBezierCurveAlgorithm(a,o,n,i);var l=u.getVertexForCurve(this._smoothRate);t=t.concat(l)}}var c=[];for(var r=0;r<t.length;r++){var f={};f=t[r];if(c.length>0){var d=FreeDo.Cartesian3.distance(c[c.length-1],f);if(d>1e-4)c.push(f)}else c.push(f)}return c};f.prototype.drawRoad=function(e,t,r){var n=this.TransfPointToCartesian3(e);var i=[];for(var a=0;a<n.length;a++){i[a]={position:n[a]}}n=this.smoothPolyline(i);d.x=n[0].x;d.y=n[0].y;d.z=n[0].z;var o=this.TransfCartesian3ToSelf(n);var s=this.getPointArray(n,o,t);var u=s;var l=[];for(var c=0;c<e.length;c++){l[c]={lon:e[c].lon,lat:e[c].lat,height:e[c].height-3}}var f=t+4;var h=this.TransfPointToCartesian3(l);i=[];for(var v=0;v<h.length;v++){i[v]={position:h[v]}}h=this.smoothPolyline(i);var p=this.TransfCartesian3ToSelf(h);var _=this.getPointArray(h,p,f);var y=_;var m=[];for(var g=0;g<y.length;g++){if(g%2==0){m.push(y[g].x);m.push(y[g].y);m.push(y[g].z);m.push(u[g].x);m.push(u[g].y);m.push(u[g].z)}else{m.push(u[g].x);m.push(u[g].y);m.push(u[g].z);m.push(y[g].x);m.push(y[g].y);m.push(y[g].z)}}var F=new Float64Array(m);var w=[];var b=null;var C=null;var P=null;var x=0;w.push(x,0);w.push(x,.1);w.push(x,.9);w.push(x,.99);var M=s.length/2-1;var S=t*2+Math.sqrt(4*4+3*3)*2;for(var T=0;T<M;T++){b=FreeDo.Cartesian3.distance(u[2*T+2],u[2*T])/S;C=FreeDo.Cartesian3.distance(u[2*T+3],u[2*T+1])/S;P=(b+C)/2;x=x+P;w.push(x,0);w.push(x,.1);w.push(x,.9);w.push(x,.99)}var E=new Float32Array(w);var D=[];var A=(s.length/2-2)*4+2;for(var O=0;O<=A;O++){if((O-3)%4!=0){D.push(O+0);D.push(O+4);D.push(O+5);D.push(O+5);D.push(O+1);D.push(O+0)}}var k=new Uint16Array(D);var L=[];for(var I=0;I<n.length;I++){L.push(n[I].x);L.push(n[I].y);L.push(n[I].z)}var R=FreeDo.BoundingSphere.fromVertices(L);var N=new FreeDo.Geometry({attributes:{position:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F}),st:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})},indices:k,primitiveType:FreeDo.PrimitiveType.TRIANGLES,boundingSphere:FreeDo.BoundingSphere.fromVertices(F)});var B=new FreeDo.GeometryInstance({geometry:N,modelMatrix:new FreeDo.Matrix4(1,0,0,d.x,0,1,0,d.y,0,0,1,d.z,0,0,0,1),attributes:{color:FreeDo.ColorGeometryInstanceAttribute.fromColor(FreeDo.Color.RED)},id:"trangle"});var j=this._viewer.scene.primitives.add(new FreeDo.Primitive({geometryInstances:B,appearance:new FreeDo.MaterialAppearance({material:new FreeDo.Material({fabric:{type:"Image",uniforms:{image:r}}})})}));return{primitive:j,boundingsphere:R}};f.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})};f.prototype.cancel=function(){this.reset();this._event.raiseEvent("Cancel",{})};f.prototype.setSmoothRate=function(e){this._smoothRate=e;this.reDraw()};f.prototype.setNearRate=function(e){this._nearRate=e;this.reDraw()};f.prototype.setCenterLineHide=function(e){this._hideCenterLine=e;this.reDraw()};f.prototype.reDraw=function(){var e=Freedo.clone(this.roadsOptions,true);this.clearRoads();this._data=[];for(var t in e){this.addRoad(e[t]["id"],e[t]["pts"],e[t]["level"],e[t]["width"])}};f.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};f.prototype.startEdit=function(e){this.addLsnr();for(var t in this._roadsOptions){if(this._roadsOptions[t].id==e){this._currentId=e;this._ple.startEdit(this._roadsOptions[t].pts)}}};f.prototype.editPre=function(){this._ple.editPre()};f.prototype.editNext=function(){this._ple.editNext()};f.prototype.endEdit=function(){this._ple.endEdit()};f.prototype.clearRoads=function(){for(var e in this._roads){this._viewer.scene.primitives.remove(this._roads[e].primitive)}for(var e in this._centerLines){this._viewer.scene.primitives.remove(this._centerLines[e])}this._viewer.scene.requestRender();this._roads=[];this._roadsOptions=[];this._centerLines=[]};f.prototype.getData=function(){return Freedo.clone(this._roadsOptions,true)};f.prototype.removeAll=function(){this.clearRoads()};f.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel()};f.prototype.dispose=function(){this.reset();this.clearRoads()};t.FdDrawRoad=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdAnalysisHeight=undefined;var n=r(1);var i=o(n);var a=r(11);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,i.default)(this,e);this._viewer=t;this._data=[];this._points=[];this._labels=[];this._vLines=[];this._bInSurvey=false;this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._tmpPoint=undefined;this._tmpPosition=undefined;this._tmpLabel=undefined;this._tmpVLine=undefined};s.prototype.addPoint=function(e){var t=Freedo.FdMisc.FdGeometric.tc(e);if(!Freedo.defined(this._viewer.scene.globe))t={x:e[0],y:e[1],z:e[2]};var r=this._viewer.entities.add({position:t,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:true}});var n=Freedo.FdMisc.FdMath.round;var i;if(this._viewer.scene.globe)i=this.createLabel(t,"高度："+n(e[2],4));else i=this.createLabel(t,"X："+n(e[0],8)+"\n"+"Y："+n(e[1],8)+"\n"+"Z："+n(e[2],4));if(this._viewer.scene.globe){var a=Freedo.FdMisc.FdGeometric.tc([e[0],e[1],0]);var o=this._viewer.scene.primitives.add(this.createLinePrimitive([t,a]));this._vLines.push(o)}this._labels.push(i);this._points.push(r);var s={};s.pointG=[n(e[0],8),n(e[1],8),n(e[2],8)];s.pointC=t;this._data.push(s);this._event.raiseEvent("HeightPoint",{point:e});this._event.raiseEvent("DataChanged",s);this._viewer.scene.requestRender()};s.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,0,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.5,.5,.5)}}})})})};s.prototype.callbackPosition=function(){this._viewer.scene.requestRender();return Freedo.FdMisc.FdGeometric.tc(this._tmpPosition)};s.prototype.callbackPositionHalf=function(){this._viewer.scene.requestRender();return Freedo.FdMisc.FdGeometric.tc(this._tmpPosition)};s.prototype.callbackVLine=function(){this._viewer.scene.requestRender();var e=Freedo.clone(this._tmpPosition,true);e[2]=0;return[Freedo.FdMisc.FdGeometric.tc(this._tmpPosition),Freedo.FdMisc.FdGeometric.tc(e)]};s.prototype.callbackVLineText=function(){this._viewer.scene.requestRender();var e=Freedo.FdMisc.FdMath.round;return"高程："+e(this._tmpPosition[2],2)};s.prototype.updateTmpPoint=function(){if(this._tmpPoint==undefined){var e=new Freedo.CallbackProperty(this.callbackPosition.bind(this),false);this._tmpPoint=this._viewer.entities.add({position:e,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:true}})}if(this._tmpLabel==undefined){var t=new Freedo.CallbackProperty(this.callbackPositionHalf.bind(this),false);var r=new Freedo.CallbackProperty(this.callbackVLineText.bind(this),false);this._tmpLabel=this._viewer.entities.add({position:t,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:r,show:true,showBackground:true,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(10,-10),disableDepthTestDistance:Number.POSITIVE_INFINITY}})}if(this._tmpVLine==undefined){var e=new Freedo.CallbackProperty(this.callbackVLine.bind(this),false);this._tmpVLine=this._viewer.entities.add({polyline:{positions:e,width:2,material:Freedo.Color.RED,depthFailMaterial:Freedo.Color.RED}})}this._viewer.scene.requestRender()};s.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:true,showBackground:true,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})};s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};s.prototype.handleLeftClick=function(e){if(this._bInSurvey==false)return;if(this._tmpPosition){this.addPoint(this._tmpPosition)}};s.prototype.handleMouseMove=function(e){if(this._bInSurvey==false)return;var t=e.endPosition;t.x-=0;t.x-=0;var r=Freedo.FdMisc.FdGeometric.pickPositionG(this._viewer,t);if(r)this._tmpPosition=r;this.updateTmpPoint()};s.prototype.getData=function(){return{height:Freedo.clone(this._data,true)}};s.prototype.setData=function(e){for(var t in e){this.addPoint(e[t].pointG)}};s.prototype.run=function(e){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK);this._hanlder.setInputAction(this.handleMouseMove.bind(this),Freedo.ScreenSpaceEventType.MOUSE_MOVE);this._bInSurvey=true};s.prototype.delTmpEntities=function(){this._viewer.entities.remove(this._tmpLabel);this._viewer.entities.remove(this._tmpPoint);this._viewer.entities.remove(this._tmpVLine);this._tmpPoint=undefined;this._tmpPosition=undefined;this._tmpLabel=undefined;this._tmpVLine=undefined;this._viewer.scene.requestRender()};s.prototype.reset=function(){this._bInSurvey=false;this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK);this.delTmpEntities()};s.prototype.removeAll=function(){for(var e in this._points){this._viewer.entities.remove(this._points[e])}for(var e in this._labels){this._viewer.entities.remove(this._labels[e])}for(var e in this._vLines){this._viewer.scene.primitives.remove(this._vLines[e])}this._points=[];this._data=[];this.delTmpEntities()};s.prototype.dispose=function(){this.reset();this.removeAll()};t.FdAnalysisHeight=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTransformManipulator=undefined;var n=r(1);var i=o(n);var a=r(11);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,i.default)(this,e);this._viewer=t;this._bInTransform=false;this._transType="MOVE";this._bInRun=false;this._xAxisPL=undefined;this._yAxisPL=undefined;this._zAxisPL=undefined;this._XYPlane=undefined;this._YZPlane=undefined;this._XZPlane=undefined;this._XYCircle=undefined;this._XZCircle=undefined;this._YZCircle=undefined;this._basePt=undefined;this._basePtOriPosition=undefined;this._basePtOri=undefined;this._selectedAxis="";this._mouseDownPos=undefined;this._initSphere=undefined;this._useDepthPicking=true;this._pickTranslucentDepth=true;this._fixedAxis="";this._DISPERRAD=111e3;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._oldPt=undefined;this._started=false;this._mouseDown=false;this._lastDis=-1;this._alpha=.5;this._axisZoom=1;this._axisSize=4;this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3};this._handler=undefined;this._mouseDownXY=undefined;this._xPts=undefined};s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};s.prototype.startTransform=function(e){this._transType=e;if(this._bInTransform)return;this._bInTransform=true;this.addListeners();this._bInRun=true};s.prototype.start=function(e){this.startTransform(e)};s.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:6,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-100,units:-100},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",width:1,uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})};s.prototype.redraw=function(){this.calcAxisZoom()};s.prototype.updateSceneSphere=function(e){this._initSphere=FreeDo.clone(e,true);if(this._xAxisPL===undefined)this.showAxis()};s.prototype.updatePosition=function(e,t,r){var n=Freedo.Cartesian3.fromDegrees(e,t,r);this._initSphere={center:n};if(this._xAxisPL===undefined)this.showAxis()};s.prototype.updateBasePt=function(e,t,r){this._basePtOriPosition=Freedo.Cartesian3.fromDegrees(e,t,r)};s.prototype.cancelTransform=function(){this.reset()};s.prototype.cancel=function(){this.reset()};s.prototype.addListeners=function(){this._handler=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._handler.setInputAction(this.onLeftDown.bind(this),FreeDo.ScreenSpaceEventType.LEFT_DOWN);this._handler.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE);this._handler.setInputAction(this.onLeftUp.bind(this),FreeDo.ScreenSpaceEventType.LEFT_UP);this._handler.setInputAction(this.onWheel.bind(this),FreeDo.ScreenSpaceEventType.WHEEL);this._handler.setInputAction(this.onClick.bind(this),FreeDo.ScreenSpaceEventType.LEFT_CLICK);var e=this;this._viewer.scene.camera.changed.addEventListener(s.prototype.onWheel,this);window.addEventListener("keydown",this.onKeyDown.bind(this))};s.prototype.calcFixedAxis=function(){if(this._selectedAxis==="X_AXIS"){this._fixedAxis="X";return}if(this._selectedAxis==="Y_AXIS"){this._fixedAxis="Y";return}if(this._selectedAxis==="Z_AXIS"){this._fixedAxis="Z";return}};s.prototype.calcAxisZoom=function(){if(this._bInTransform===false){this._axisZoom=1;return}if(!this._initSphere)return;var e=this._initSphere.center;var t=this._viewer.camera.positionWC;var r=1;r=Freedo.Cartesian3.distance(e,t)/this._axisSize;this._axisZoom=r;if(this._viewer.scene._mode===Freedo.SceneMode.COLUMBUS_VIEW)this._axisZoom=this._viewer.camera.positionWC.x/3;if(this._axisZoom>4e5)this._axisZoom=4e5};s.prototype.setAxisSize=function(e){this._axisSize=e};s.prototype.onWheel=function(){if(this._bInTransform===false)return;this.calcAxisZoom()};s.prototype.onKeyDown=function(){if(this._bInTransform===false)return;if(window.event.keyCode===27){if(this._selectedAxis!==""){this._event.raiseEvent("OnKeyDown",{keyCode:window.event.keyCode});this._selectedAxis="";this.onLeftUp()}}};s.prototype.onMouseMove=function(e){if(this._selectedAxis!=""){var t=undefined;if(this._selectedAxis==="XY_QCIRCLE"||this._selectedAxis==="XY_CIRCLE"||this._selectedAxis==="X_AXIS"||this._selectedAxis==="Y_AXIS"||this._selectedAxis==="Z_AXIS")t=this.pickPositionOnEllipsoid(e.endPosition);if(this._selectedAxis==="YZ"||this._selectedAxis==="YZ_CIRCLE")t=this.pickPositionOnPlane(e.endPosition,"YZ");if(this._selectedAxis==="XZ"||this._selectedAxis==="XZ_CIRCLE")t=this.pickPositionOnPlane(e.endPosition,"XZ");this._event.raiseEvent("Transforming",{MouseDownPos:this._mouseDownPos,MouseMovePos:t,MouseDownXY:this._mouseDownXY,MouseMoveXY:e.endPosition,SelectedAxis:this._selectedAxis,FixedAxis:this._fixedAxis});return}};s.prototype.onClick=function(e){var t=this.pickPosition(e.position);this._event.raiseEvent("GotoPoint",t)};s.prototype.onLeftDown=function(e){if(!this._bInTransform)return;this._mouseDown=true;this._oldPt=undefined;this._started=false;this._lastDis=-1;var t=this._viewer.scene.pick(e.position);if(!FreeDo.defined(t)){return}if(FreeDo.defined(t.id)&&FreeDo.defined(t.id._name)){var r=t.id._name;if((r==="X_AXIS"||r==="Y_AXIS"||r==="Z_AXIS")&&this._transType.indexOf("MOVE")>=0){t.id.polyline.material.color=new Freedo.Color(1,1,0,1)}if(r==="YZ"||r==="XZ"){t.id.wall.material.color=new Freedo.Color(1,0,0,.2)}if(r==="XY_QCIRCLE"){t.id.polygon.material.color=new Freedo.Color(1,1,0,1)}if(r==="XY_CIRCLE"||r==="YZ_CIRCLE"||r==="XZ_CIRCLE"){t.id.polyline.material.color=new Freedo.Color(1,1,0,1)}if(r==="XY_CIRCLE"||r==="XZ_CIRCLE"||r==="YZ_CIRCLE"||r==="XY_QCIRCLE"||r==="XZ"||r==="YZ"||r==="X_AXIS"||r==="Y_AXIS"||r==="Z_AXIS"){this._selectedAxis=FreeDo.clone(r,true);this._viewer.scene.screenSpaceCameraController.enableRotate=false;this._viewer.scene.screenSpaceCameraController.enableLook=false;this._mouseDownPos=undefined;this._event.raiseEvent("Transform",{})}}if(this._selectedAxis==="XY_QCIRCLE"||this._selectedAxis==="XY_CIRCLE"||this._selectedAxis==="X_AXIS"||this._selectedAxis==="Y_AXIS"){this._mouseDownPos=this.pickPositionOnEllipsoid(e.position);if(this._transType.indexOf("MOVE")>=0)this.calcFixedAxis()}if(this._selectedAxis==="YZ"||this._selectedAxis==="YZ_CIRCLE"){this._mouseDownPos=this.pickPositionOnPlane(e.position,"YZ");if(this._transType.indexOf("MOVE")>=0)this.calcFixedAxis()}if(this._selectedAxis==="XZ"||this._selectedAxis==="Z_AXIS"||this._selectedAxis==="XZ_CIRCLE"){this._mouseDownPos=this.pickPositionOnPlane(e.position,"XZ");if(this._transType.indexOf("MOVE")>=0)this.calcFixedAxis()}if(this._fixedAxis==="X"){this._xAxisPL.polyline.material.color=FreeDo.Color.YELLOW}if(this._fixedAxis==="Y"){this._yAxisPL.polyline.material.color=FreeDo.Color.YELLOW}if(this._fixedAxis==="Z"){this._zAxisPL.polyline.material.color=FreeDo.Color.YELLOW}this._mouseDownXY=e.position};s.prototype.backToEnableRotate=function(e){if(this._selectedAxis===""){this._viewer.scene.screenSpaceCameraController.enableRotate=true;this._viewer.scene.screenSpaceCameraController.enableLook=true}};s.prototype.onLeftUp=function(e){setTimeout(this.backToEnableRotate.bind(this),500);this._mouseDownPos=undefined;this._mouseDown=false;if(this._selectedAxis==="XY_QCIRCLE"){this._XYPlane.polygon.material.color=new Freedo.Color(0,0,1,this._alpha)}if(this._selectedAxis==="XZ"){this._XZPlane.wall.material.color=new Freedo.Color(1,0,1,this._alpha)}if(this._selectedAxis==="YZ"){this._YZPlane.wall.material.color=new Freedo.Color(0,1,1,this._alpha)}if(this._selectedAxis==="XY_CIRCLE"){this._XYCircle.polyline.material.color=new Freedo.Color(0,0,1,this._alpha)}if(this._selectedAxis==="XZ_CIRCLE"){this._XZCircle.polyline.material.color=new Freedo.Color(0,1,0,this._alpha)}if(this._selectedAxis==="YZ_CIRCLE"){this._YZCircle.polyline.material.color=new Freedo.Color(1,0,0,this._alpha)}if(this._fixedAxis==="X"){this._xAxisPL.polyline.material.color=FreeDo.Color.RED}if(this._fixedAxis==="Y"){this._yAxisPL.polyline.material.color=FreeDo.Color.GREEN}if(this._fixedAxis==="Z"){this._zAxisPL.polyline.material.color=FreeDo.Color.BLUE}if(this._selectedAxis!==""){this._event.raiseEvent("Transformed",{})}this.calcAxisZoom();this._selectedAxis="";this._fixedAxis=""};s.prototype.clearAxis2=function(){if(this._xAxisPL!=undefined){this._viewer.entities.remove(this._basePt);this._viewer.entities.remove(this._basePtOri);this._viewer.scene.primitives.remove(this._xAxisPL);this._viewer.scene.primitives.remove(this._yAxisPL);this._viewer.scene.primitives.remove(this._zAxisPL);this._viewer.entities.remove(this._XZPlane);this._viewer.entities.remove(this._YZPlane);this._viewer.entities.remove(this._XYPlane);this._viewer.entities.remove(this._XYCircle);this._viewer.entities.remove(this._XZCircle);this._viewer.entities.remove(this._YZCircle)}this._basePt=undefined;this._basePtOri=undefined;this._xAxisPL=undefined;this._yAxisPL=undefined;this._zAxisPL=undefined;this._XZPlane=undefined;this._YZPlane=undefined;this._XYPlane=undefined;this._XYCircle=undefined;this._XZCircle=undefined;this._YZCircle=undefined;this._selectedAxis=""};s.prototype.clearAxis=function(){if(this._xAxisPL!=undefined){this._viewer.entities.remove(this._basePt);this._viewer.entities.remove(this._basePtOri);this._viewer.entities.remove(this._xAxisPL);this._viewer.entities.remove(this._yAxisPL);this._viewer.entities.remove(this._zAxisPL);this._viewer.entities.remove(this._XZPlane);this._viewer.entities.remove(this._YZPlane);this._viewer.entities.remove(this._XYPlane);this._viewer.entities.remove(this._XYCircle);this._viewer.entities.remove(this._XZCircle);this._viewer.entities.remove(this._YZCircle)}this._basePt=undefined;this._basePtOri=undefined;this._xAxisPL=undefined;this._yAxisPL=undefined;this._zAxisPL=undefined;this._XZPlane=undefined;this._YZPlane=undefined;this._XYPlane=undefined;this._XYCircle=undefined;this._XZCircle=undefined;this._YZCircle=undefined;this._selectedAxis=""};var u=undefined;var l=undefined;var c=undefined;var f=undefined;var d=undefined;var h=undefined;s.prototype.calcCallbackArgs=function(){u=this._initSphere.center;c=Freedo.Cartographic.fromCartesian(u);f=Freedo.Math.toDegrees(c.longitude);d=Freedo.Math.toDegrees(c.latitude);h=c.height;l=this._axisZoom;this._viewer.scene.requestRender()};s.prototype.pickPositionOnEllipsoid=function(e){var t=Freedo.Cartographic.fromCartesian(this._initSphere.center);var r=Freedo.clone(Freedo.Ellipsoid.WGS84,true);r.radii.x+=t.height;r.radii.y+=t.height;r.radii.z+=t.height;var n=new Freedo.Ellipsoid(r.radii.x,r.radii.y,r.radii.z);var i=this._viewer.camera.pickEllipsoid(e,n,new Freedo.Cartesian3);if(i===undefined)return undefined;var a=Freedo.Cartographic.fromCartesian(i);return a};s.prototype.pickPositionOnPlane=function(e,t){this.calcCallbackArgs();var r=this._axisZoom*1e-5;var n=Freedo.Cartesian3.fromRadians(c.longitude-r,c.latitude,-2e3);var i=Freedo.Cartesian3.fromRadians(c.longitude,c.latitude,c.height+l*.95+1e3);var a=Freedo.Cartesian3.fromRadians(c.longitude+r,c.latitude,-2e3);if(t==="YZ"){n=Freedo.Cartesian3.fromRadians(c.longitude,c.latitude-r,-2e3);i=Freedo.Cartesian3.fromRadians(c.longitude,c.latitude,c.height+l*.95+1e3);a=Freedo.Cartesian3.fromRadians(c.longitude,c.latitude+r,-2e3)}var o=this._viewer.camera.getPickRay(e);var s=0;var u=0;var f=0;var d=Freedo.Cartographic.fromCartesian(this._initSphere.center);s=Math.cos(d.longitude);u=Math.sin(d.longitude);var h=new Freedo.Plane.fromPointNormal(new Freedo.Cartesian3(0,0,0),new Freedo.Cartesian3(s,u,f));var v={};v.x=o.origin.x+o.direction.x*1e6;v.y=o.origin.y+o.direction.y*1e6;v.z=o.origin.z+o.direction.z*1e6;if(0){var p}var _=Freedo.IntersectionTests.lineSegmentTriangle(o.origin,v,n,i,a);if(_===undefined)return undefined;if(0){}var y=Freedo.Cartographic.fromCartesian(_);return y};s.prototype.pickPosition=function(e){var t,r=this.PositionType.NONE;var n,i;if(this._viewer.scene.pickPositionSupported){var n=this._viewer.scene.drillPick(e);if(Freedo.defined(n)&&n.length>0){for(var a=0;a<n.length;++a){if(n[a]instanceof Freedo.FreedoPModelFeature){t=this._viewer.scene.pickPosition(e);if(Freedo.defined(t)){r=this.PositionType.ON_MODEL;break}}}}}if(r===this.PositionType.NONE){this._useDepthPicking=FreeDo.clone(this._viewer.scene.useDepthPicking,true);this._pickTranslucentDepth=FreeDo.clone(this._viewer.scene.pickTranslucentDepth,true);if(this._viewer.scene.pickPositionSupported){t=this._viewer.scene.pickPosition(e,new Freedo.Cartesian3);var o=Freedo.Cartographic.fromCartesian(t);if(Freedo.defined(t))r=this.PositionType.ON_TERRAIN}this._viewer.scene.useDepthPicking=FreeDo.clone(this._useDepthPicking,true);this._viewer.scene.pickTranslucentDepth=FreeDo.clone(this._pickTranslucentDepth,true)}if(r===this.PositionType.NONE){t=this._viewer.camera.pickEllipsoid(e,this._viewer.scene.globe.ellipsoid);if(Freedo.defined(t))r=this.PositionType.ON_ELLIPSOID}return{type:r,position:t}};s.prototype.callbackXY=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var n=FreeDo.Math.toDegrees(l*.5*r[0]);var i=FreeDo.Math.toDegrees(l*.5*r[1]);t=Freedo.Cartesian3.fromDegreesArray([f,d,f+n,d,f+n,d+i,f,d+i,f,d]);return t};s.prototype.callbackQXY=function(e,t){this.calcCallbackArgs();var r=[];var n=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var i=FreeDo.Math.toDegrees(l*.55*n[0]);var a=FreeDo.Math.toDegrees(l*.55*n[1]);r.push(Freedo.Cartesian3.fromRadians(c.longitude,c.latitude,c.height));for(var o=0;o<=Math.PI/2;o=o+.001){var s=f+i*Math.cos(o);var u=d+a*Math.sin(o);var v=Freedo.Cartesian3.fromDegrees(s,u,h);r.push(v)}t=r;return t};s.prototype.callbackXYHalfCircle=function(e,t){this.calcCallbackArgs();var r=[];var n=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var i=FreeDo.Math.toDegrees(l*.65*n[0]);var a=FreeDo.Math.toDegrees(l*.65*n[1]);for(var o=0;o<=Math.PI/2;o=o+.001){var s=f+i*Math.cos(o);var u=d+a*Math.sin(o);var v=Freedo.Cartesian3.fromDegrees(s,u,h);r.push(v)}t=r;return t};s.prototype.callbackXZHalfCircle=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var n=FreeDo.Math.toDegrees(l*.65*r[0]);var i=FreeDo.Math.toDegrees(l*.65*r[1]);var a=[];for(var o=Math.PI/2;o>=0;o=o-.001){var s=f+n*Math.cos(o);var u=d;var v=h+l*.65*Math.sin(o);var p=Freedo.Cartesian3.fromDegrees(s,u,v);a.push(p)}t=a;return t};s.prototype.callbackYZHalfCircle=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var n=FreeDo.Math.toDegrees(l*.65*r[0]);var i=FreeDo.Math.toDegrees(l*.65*r[1]);var a=[];for(var o=Math.PI/2;o>=0;o=o-.001){var s=f;var u=d+i*Math.cos(o);var v=h+l*.65*Math.sin(o);var p=Freedo.Cartesian3.fromDegrees(s,u,v);a.push(p)}t=a;return t};s.prototype.callbackXYShow=function(e,t){this.calcCallbackArgs();t=true;if(this._selectedAxis=="XY_CIRCLE")t=false;return t};s.prototype.callbackXYH=function(e,t){return h+.1};s.prototype.callbackXZ=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var n=FreeDo.Math.toDegrees(l*.5*r[0]);t=Freedo.Cartesian3.fromDegreesArray([f,d,f+n,d]);return t};s.prototype.callbackXZMinimumHeights=function(e,t){this.calcCallbackArgs();t=[h,h];return t};s.prototype.callbackXZMaximumHeights=function(e,t){this.calcCallbackArgs();t=[h+l*.5,h+l*.5];return t};s.prototype.callbackYZ=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegreesArray([f,d,f,d+l*.5/this._DISPERRAD]);return t};s.prototype.callbackXYCCBP=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegrees(f,d);return t};s.prototype.callbackX=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c);var n=FreeDo.Math.toDegrees(l*r[0]);t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f+n,d,h]);return t};s.prototype.callbackY=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f,d+l/this._DISPERRAD,h]);return t};s.prototype.callbackZ=function(e,t){this.calcCallbackArgs();t=Freedo.Cartesian3.fromDegreesArrayHeights([f,d,h,f,d,h+l]);return t};s.prototype.callbackH=function(e,t){this.calcCallbackArgs();t=h;return t};s.prototype.callbackBasePt=function(e,t){this.calcCallbackArgs();t=u.clone();return t};s.prototype.callbackBasePtOri=function(e,t){t=this._basePtOriPosition.clone();return t};s.prototype.showAxis=function(){this.clearAxis();this.calcAxisZoom();var e=new Freedo.CallbackProperty(this.callbackXY.bind(this),false);var t=new Freedo.CallbackProperty(this.callbackQXY.bind(this),false);var r=new Freedo.CallbackProperty(this.callbackXYHalfCircle.bind(this),false);var n=new Freedo.CallbackProperty(this.callbackXZHalfCircle.bind(this),false);var i=new Freedo.CallbackProperty(this.callbackYZHalfCircle.bind(this),false);var a=new Freedo.CallbackProperty(this.callbackXYShow.bind(this),false);var o=new Freedo.CallbackProperty(this.callbackXYH.bind(this),false);var s=new Freedo.CallbackProperty(this.callbackXZ.bind(this),false);var u=new Freedo.CallbackProperty(this.callbackXZMaximumHeights.bind(this),false);var l=new Freedo.CallbackProperty(this.callbackXZMinimumHeights.bind(this),false);var c=new Freedo.CallbackProperty(this.callbackYZ.bind(this),false);var f=new Freedo.CallbackProperty(this.callbackXYCCBP.bind(this),false);var d=new Freedo.CallbackProperty(this.callbackX.bind(this),false);var h=new Freedo.CallbackProperty(this.callbackY.bind(this),false);var v=new Freedo.CallbackProperty(this.callbackZ.bind(this),false);var p=new Freedo.CallbackProperty(this.callbackH.bind(this),false);var _=new Freedo.CallbackProperty(this.callbackBasePt.bind(this),false);var y=new Freedo.CallbackProperty(this.callbackBasePtOri.bind(this),false);this._basePt=this._viewer.entities.add({position:_,point:{pixelSize:10,color:Freedo.Color.YELLOW.withAlpha(.9)}});this._basePtOri=this._viewer.entities.add({name:"xxxx",position:y,point:{pixelSize:10,color:Freedo.Color.GREEN.withAlpha(.9)}});this._xAxisPL=this._viewer.entities.add({name:"X_AXIS",polyline:{positions:d,width:16,followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.RED)}});this._yAxisPL=this._viewer.entities.add({name:"Y_AXIS",polyline:{positions:h,width:16,followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.GREEN)}});this._zAxisPL=this._viewer.entities.add({name:"Z_AXIS",polyline:{positions:v,width:16,show:true,followSurface:false,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.BLUE)}});if(this._transType.indexOf("SCALE")>=0){this._XYPlane=this._viewer.entities.add({name:"XY_QCIRCLE",polygon:{hierarchy:t,height:p,outline:false,show:true,outlineColor:Freedo.Color.WHITE,outlineWidth:0,material:new Freedo.Color(0,0,1,this._alpha)}})}if(this._transType.indexOf("ROTATE")>=0){this._XYCircle=this._viewer.entities.add({name:"XY_CIRCLE",polyline:{positions:r,width:4,show:true,material:new Freedo.Color(0,0,1,this._alpha)}})}if(this._transType.indexOf("ROTATE")>=0){this._XZCircle=this._viewer.entities.add({name:"XZ_CIRCLE",polyline:{positions:n,width:4,show:true,material:new Freedo.Color(0,1,0,this._alpha)}});this._YZCircle=this._viewer.entities.add({name:"YZ_CIRCLE",polyline:{positions:i,width:4,show:true,material:new Freedo.Color(1,0,0,this._alpha)}})}};s.prototype.reset=function(){if(this._handler!==undefined&&!this._handler.isDestroyed())this._handler.destroy();this._viewer.scene.camera.changed.removeEventListener(s.prototype.onWheel,this);this._bInTransform=false;this.clearAxis();this._mouseDownPos=undefined;this._initSphere=undefined;this._fixedAxis=""};s.prototype.dispose=function(){this.reset()};t.FdTransformManipulator=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdAnalysisArea=undefined;var n=r(1);var i=s(n);var a=r(11);var o=r(25);function s(e){return e&&e.__esModule?e:{default:e}}var u=6371e3;var l=2*Math.PI*u/360;var c=Math.PI/180;var f=180/Math.PI;var d=function e(t){(0,i.default)(this,e);this._viewer=t;this._scene=this._viewer.scene;this._polygons=[];this._polygons3D=[];this._labels=[];this._data=[];this._lsner=undefined;this._currentType=undefined;this._ple=new o.FdPolylineEditor(t);this._ple.setAutoDelLines(false);this._ple.setHeightOffset(0);this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper;this._labelOpt={style:Freedo.LabelStyle.FILL_AND_OUTLINE,show:false,showBackground:true,backgroundColor:FreeDo.Color["BLACK"].withAlpha(.8),fillColor:FreeDo.Color["WHITE"],font:"20px 雅黑",pixelOffset:new FreeDo.Cartesian2(0,0),disableDepthTestDistance:Number.POSITIVE_INFINITY}};d.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};d.prototype.run=function(e){this._ple.run();if(this._lsner){this._lsner();this._lsner=undefined}var t=this;this._lsner=this._ple.on(function(e,r){if(e=="PLAdd"){t.onPLAdd(r)}if(e=="PointAdded"){if(Freedo.defined(r.position[3])&&r.position[3]==0){if(t._currentType==undefined){t._currentType="OnModel"}}else t._currentType="OnEarth"}});this._event.raiseEvent("Start",{})};d.prototype.createAreaPrimitive=function(e){var t;var r=new Freedo.Cartesian3;var n=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var i=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);t=Freedo.Cartesian3.cross(n,i,new Freedo.Cartesian3);t=Freedo.Cartesian3.normalize(t,new Freedo.Cartesian3);var a=Freedo.Cartesian3.angleBetween(t,Freedo.Cartesian3.UNIT_Z);var o=Freedo.Cartesian3.cross(t,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3);var s=Freedo.Quaternion.fromAxisAngle(o,a,new Freedo.Quaternion);var u=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,s,new Freedo.Cartesian3(1,1,1));var l=Freedo.Matrix4.multiplyByPointAsVector(u,t,new Freedo.Cartesian3);var c=[];for(var f in e){var d=Freedo.Matrix4.multiplyByPointAsVector(u,e[f],new Freedo.Cartesian3);c.push(d)}var h;if(false){}else{var v=[];for(var p=0;p<e.length;p++){v.push(e[p].x*1);v.push(e[p].y*1);v.push(e[p].z*1)}var _=Freedo.PolygonPipeline.triangulate(c);var y=new Float64Array(v);h=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})},indices:new Uint16Array(_),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(y)})}return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:h,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(1,1,0,1))}}),appearance:new Freedo.PerInstanceColorAppearance({flat:true,translucent:true}),asynchronous:false})};d.prototype.addArea=function(e){var t;if(this._viewer.scene.globe){if(this._currentType=="OnEarth"||this._currentType==""||this._currentType==undefined){t=this._viewer.entities.add({name:"AREAGEO",polygon:{hierarchy:new Freedo.PolygonHierarchy(e),material:Freedo.Color.ORANGE.withAlpha(.5),outline:true,outlineColor:Freedo.Color.BLACK}})}else{t=this._viewer.scene.primitives.add(this.createAreaPrimitive(e))}}else{t=this._viewer.scene.primitives.add(this.createAreaPrimitive(e))}var r=this.xyzCenter(e);var n=[];for(var i=0;i<e.length-1;i++){var a=this.toLonLat(e[i]);n.push(a)}var o=[];var s=[];var u=[];for(var i=0;i<e.length-1;i++){var a=this.toLonLat(e[i]);o.push(a.lon);s.push(a.lat);u.push([a.lon,a.lat])}var l=0;if(this._viewer.scene.globe&&this._currentType!="OnModel")l=this.calcArea3D(e);else l=this.calcArea3D(e);if(l<0)l*=-1;l=Freedo.FdMisc.FdMath.round(l,2);var c=this._viewer.entities.add({label:this._labelOpt});if(l>1e6){l=Freedo.FdMisc.FdMath.round(l/1e6,2);c.label.text=l+"平方公里"}else{c.label.text=l+"平方米"}if(this._viewer.scene.globe&&this._currentType!="OnModel")c.position=FreeDo.Cartesian3.fromDegrees(r.lon,r.lat,.1);else c.position=new FreeDo.Cartesian3(r.lon,r.lat,r.height);c.label.show=true;this._labels.push(c);if(this._viewer.scene.globe)this._polygons.push(t);else this._polygons3D.push(t);var f={pointsG:u,pointsC:e,area:l,type:this._currentType};this._data.push(f);this._event.raiseEvent("DataChanged",f);this._viewer.scene.requestRender();this._currentType=undefined};d.prototype.onPLAdd=function(e){if(!e.polyline)return;if(e.polyline.pts.length==2){this._ple.delResult();return}this.addArea(e.polyline.pts)};d.prototype.toLonLat=function(e){var t=FreeDo.Cartographic.fromCartesian(e);var r=FreeDo.Math.toDegrees(t.longitude);var n=FreeDo.Math.toDegrees(t.latitude);var i=t.height;var a={lon:r,lat:n,height:i};return a};d.prototype.getData=function(){return{area:this._data}};d.prototype.setData=function(e){for(var t in e){this._currentType=e[t].type;this.addArea(e[t].pointsC)}};d.prototype.SphericalPolygonAreaMeters=function(e){var t=0;for(var r=0;r<e.length;r++){var n=(r+1)%e.length;var i=(r+2)%e.length;t+=this.Angle(e[r],e[n],e[i])}var a=(e.length-2)*180;var o=t-a;if(o>420){o=t-a}else if(o>300&&o<420){o=Math.abs(360-o)}return o*c*u*u};d.prototype.Angle=function(e,t,r){var n=this.Bearing(t,e);var i=this.Bearing(t,r);var a=n-i;if(a<0){a+=360}return a};d.prototype.Bearing=function(e,t){var r=e.lat*c;var n=e.lon*c;var i=t.lat*c;var a=t.lon*c;var o=-Math.atan2(Math.sin(n-a)*Math.cos(i),Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n-a));if(o<0){o+=Math.PI*2}o=o*f;return o};d.prototype.xyzCenter=function(e){var t=Number.MAX_VALUE;var r=Number.MAX_VALUE;var n=Number.MAX_VALUE;var i=-Number.MAX_VALUE;var a=-Number.MAX_VALUE;var o=-Number.MAX_VALUE;if(e.length==0){console.error("只有一个点，无法计算")}else if(e.length==1){console.error("有两个点，无法计算")}else{for(var s=0;s<e.length;s++){if(e[s].x<t){t=e[s].x}if(e[s].y<r){r=e[s].y}if(e[s].z<n){n=e[s].z}if(e[s].x>i){i=e[s].x}if(e[s].y>a){a=e[s].y}if(e[s].z>o){o=e[s].z}}var u=new Freedo.Cartesian3((i+t)/2,(a+r)/2,(o+n)/2);if(this._viewer.scene.globe&&this._currentType!="OnModel"){var l=this._viewer.scene.globe.ellipsoid;var c=l.cartesianToCartographic(u);var f=FreeDo.Math.toDegrees(c.longitude);var d=FreeDo.Math.toDegrees(c.latitude);var h=c.height;return{lon:f,lat:d,height:h}}else{return{lon:u.x,lat:u.y,height:u.z}}}};d.prototype.calcArea3D=function(e){var t,r,n;t=e.length;r=Freedo.clone(e,true);r.push(e[0]);r.push(e[1]);var i=new Freedo.Cartesian3;var a=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3);var o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(a,o,new Freedo.Cartesian3);n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3);var s=0;var u,l,c,f;var d;var h,v,p;l=n.x>0?n.x:-n.x;c=n.y>0?n.y:-n.y;f=n.z>0?n.z:-n.z;d=3;if(l>c){if(l>f)d=1}else if(c>f)d=2;for(h=1,v=2,p=0;h<=t;h++,v++,p++){switch(d){case 1:s+=r[h].y*(r[v].z-r[p].z);continue;case 2:s+=r[h].x*(r[v].z-r[p].z);continue;case 3:s+=r[h].x*(r[v].y-r[p].y);continue}}u=Math.sqrt(l*l+c*c+f*f);switch(d){case 1:s*=u/(2*l);break;case 2:s*=u/(2*c);break;case 3:s*=u/(2*f)}return s};d.prototype.reset=function(){if(this._lsner)this._lsner();this._lsner=undefined;this._ple.cancel();this._event.raiseEvent("Cancel",{})};d.prototype.removeAll=function(){for(var e in this._polygons){this._viewer.entities.remove(this._polygons[e]);this._viewer.scene.primitives.remove(this._polygons[e])}for(var e in this._polygons3D){this._viewer.scene.primitives.remove(this._polygons3D[e])}for(var e in this._labels){this._viewer.entities.remove(this._labels[e])}this._polygons=[];this._polygons3D=[];this._labels=[];this._data=[];this._ple.removeAll();this._viewer.scene.requestRender()};d.prototype.dispose=function(){this.reset();this.removeAll()};t.FdAnalysisArea=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdAnalysisPoint=undefined;var n=r(1);var i=o(n);var a=r(11);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,i.default)(this,e);this._viewer=t;this._tempPoint=undefined;this._points=[];this._data=[];this._labels=[];this._bInSurvey=false;this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._tmpPoint=undefined;this._singleMode=false};s.prototype.addPoint=function(e){var t=Freedo.FdMisc.FdGeometric.tc(e);if(!Freedo.defined(this._viewer.scene.globe))t={x:e[0],y:e[1],z:e[2]};if(this._tmpPoint){}this._tmpPoint=this._viewer.entities.add({position:t,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:true}});var r=Freedo.FdMisc.FdMath.round;var n;if(this._viewer.scene.globe)n=this.createLabel(t,"经度："+r(e[0],8)+"\n"+"纬度："+r(e[1],8)+"\n"+"高度："+r(e[2],4));else n=this.createLabel(t,"X："+r(e[0],8)+"\n"+"Y："+r(e[1],8)+"\n"+"Z："+r(e[2],4));this._labels.push(n);this._points.push(this._tmpPoint);var i={};i.pointG=[r(e[0],8),r(e[1],8),r(e[2],8)];i.pointC=t;this._data.push(i);this._event.raiseEvent("Point",{point:e});this._event.raiseEvent("DataChanged",i);this._viewer.scene.requestRender()};s.prototype.pickPosition=function(e){var t=Freedo.FdMisc.FdGeometric.pickPositionG(this._viewer,e);if(t){this.addPoint(t)}};s.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:true,showBackground:true,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})};s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};s.prototype.handleLeftClick=function(e){if(this._bInSurvey==false)return;if(this._singleMode){this.removeAll()}this.pickPosition(e.position)};s.prototype.setSingleMode=function(e){this._singleMode=e};s.prototype.getData=function(){return{point:Freedo.clone(this._data,true)}};s.prototype.setData=function(e){for(var t in e){this.addPoint(e[t].pointG)}};s.prototype.run=function(e){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK);this._bInSurvey=true};s.prototype.reset=function(){this._bInSurvey=false;this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK)};s.prototype.removeAll=function(){for(var e in this._points){this._viewer.entities.remove(this._points[e])}for(var e in this._labels){this._viewer.entities.remove(this._labels[e])}this._points=[];this._data=[]};s.prototype.dispose=function(){this.reset();this.removeAll()};t.FdAnalysisPoint=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdAnalysisLineDistance=undefined;var n=r(1);var i=o(n);var a=r(11);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,i.default)(this,e);this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3};this.ResultType={StraightLine:1,HorizontalAndVertical:2};this._viewer=t;this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._data={line:[],polyline:[]};this._results=[];this._startPoint=undefined;this._tempPoint=undefined;this._polylineCollection=new Freedo.PolylineCollection;this._viewer.scene.primitives.add(this._polylineCollection);this._collection=new Freedo.PrimitiveCollection;this._viewer.scene.primitives.add(this._collection);this._tempLine;this._tempPointEntities=[null,null];this._tempSumLabelEntity=undefined;this._sumLabel=[];this._lastLabel=undefined;this._points=[];this._pointsCalced=[];this._hanlder={};this._ballSize=.5;this._lineWidth=3;this._fontSize="22px 黑体";this._bInSurvey=false;this._surveyType="";this._useDepthPicking=true;this._pickTranslucentDepth=true;this._bRmStarting=false};s.prototype.pickPosition=function(e){var t=Freedo.FdMisc.FdGeometric.pickPosition(this._viewer,e);if(t){return{type:this.PositionType.ON_TERRAIN,position:t}}else{return{type:this.PositionType.NONE,position:t}}};s.prototype.removeTmpLine=function(){if(this._tempLine){this._viewer.entities.remove(this._tempLine);this._tempLine=undefined}if(this._tempSumLabelEntity){this._viewer.entities.remove(this._tempSumLabelEntity);this._tempSumLabelEntity=undefined}for(var e=0;e<this._tempPointEntities.length;e++){if(!!this._tempPointEntities[e]){this._viewer.entities.remove(this._tempPointEntities[e]);this._tempPointEntities[e]=null}}if(this._surveyType=="LINE_DISTANCE")this._startPoint=undefined;this._bRmStarting=false;this._viewer.scene.requestRender()};s.prototype.calcLineType=function(e,t){if(!this._viewer.scene.globe)return this.ResultType.StraightLine;var r=Freedo.Cartographic.fromCartesian(e.position);var n=Freedo.Cartographic.fromCartesian(t.position);var i=Freedo.FdMisc.FdGeometric.calculateLength([e.position,t.position]);var a=Math.abs(r.height-n.height);if(a>i/10)return this.ResultType.HorizontalAndVertical;else return this.ResultType.StraightLine};s.prototype.createLinePrimitive=function(e,t){var r,n;if(this._viewer.scene.globe){n=true}else{n=false}r=new Freedo.PolylineGeometry({positions:[e,t],width:2,followSurface:n,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT});return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:r}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:true,factor:-1,units:-1},depthTest:{enabled:true,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})};s.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:true,showBackground:true,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:this._fontSize,horizontalOrigin:Freedo.HorizontalOrigin.CENTER,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})};s.prototype.addResult=function(e){var t=Freedo.FdMisc.FdGeometric;var r=this.calcLineType(this._startPoint,e);this._points.pop();this._points.push(e.position);this._points.push(e.position);this._ballSize=t.calculateLength(this._points)/1e3;if(r===this.ResultType.StraightLine){var n=[this._startPoint.position,e.position];var i=t.calculateLength(n);if(i<.01){this._points.pop();return}var a=this._viewer.scene.primitives.add(this.createLinePrimitive(this._startPoint.position,e.position));var o=t.getCenter(this._startPoint.position,e.position);var s=t.calculateLength(n);var u=this.getLengthText(s);var l=this.createLabel(o,u);var c=this._viewer.entities.add({position:this._startPoint.position,show:true,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:false,point:false}});var f=this._viewer.entities.add({position:e.position,show:true,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:false,point:false}});this._results.push({type:r,labelEntity:l,line:a,startPointEntity:c,endPointEntity:f});var d={pointsG:[t.tg(this._startPoint.position),t.tg(e.position)],pointsC:[this._startPoint.position,e.position],length:s,vLength:0,hLength:0};if(this._surveyType=="LINE_DISTANCE"){this._data.line.push(d);this._event.raiseEvent("DataChanged",d)}if(this._surveyType=="SEGMENTS_DISTANCE"){this._pointsCalced.push(d)}}else if(r===this.ResultType.HorizontalAndVertical){var h=Freedo.Cartographic.fromCartesian(this._startPoint.position);var v=Freedo.Cartographic.fromCartesian(e.position);var n=[this._startPoint.position,e.position];var i=t.calculateLength(n);if(i<.01){this._points.pop();return}var p,_,y,m;if(h.height>v.height){_=this._startPoint.position;p=e.position;y=h.height-v.height}else{_=e.position;p=this._startPoint.position;y=v.height-h.height}var g=new Freedo.Cartesian3;Freedo.Cartesian3.normalize(p,g);Freedo.Cartesian3.multiplyByScalar(g,y,g);var F=new Freedo.Cartesian3;Freedo.Cartesian3.add(p,g,F);m=Freedo.Cartesian3.distance(F,_);var a=this._viewer.scene.primitives.add(this.createLinePrimitive(_,p));var w=this._viewer.scene.primitives.add(this.createLinePrimitive(p,F));var b=this._viewer.scene.primitives.add(this.createLinePrimitive(_,F));var C=t.getCenter(_,p);var P=t.calculateLength([_,p]);var x=this.getLengthText(P);var M=this.createLabel(C,x);C=t.getCenter(F,p);x=this.getLengthText(y);var S=this.createLabel(C,x);C=t.getCenter(F,_);x=this.getLengthText(m);var T=this.createLabel(C,x);var c=this._viewer.entities.add({position:this._startPoint.position,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:false,point:false}});var f=this._viewer.entities.add({position:e.position,point:{color:Freedo.Color.YELLOW,show:false,pixelSize:5,point:false}});this._results.push({type:r,line:a,verticalLine:w,horizontalLine:b,lineLabelEntity:M,verticalLineLabelEntity:S,horizontalLineLabelEntity:T,startPointEntity:c,endPointEntity:f});var d={pointsG:[t.tg(this._startPoint.position),t.tg(e.position)],pointsC:[this._startPoint.position,e.position],length:P,vLength:y,hLength:m};if(this._surveyType=="LINE_DISTANCE"){this._data.line.push(d);this._event.raiseEvent("DataChanged",d)}if(this._surveyType=="SEGMENTS_DISTANCE"){this._pointsCalced.push(d)}}if(this._points.length>3&&this._surveyType=="SEGMENTS_DISTANCE"){if(this._lastLabel==undefined){var E=this.getLengthText(t.calculateLength(this._points));this._lastLabel=this.createLabel(e.position,E)}else{this._lastLabel.position=e.position;this._lastLabel.label.text=this.getLengthText(t.calculateLength(this._points))}}if(this._surveyType=="SEGMENTS_DISTANCE")this._startPoint=Freedo.clone(e,true);e=undefined;this._viewer.scene.requestRender()};s.prototype.clearResults=function(){this.removeTmpLine();if(this._lastLabel){this._viewer.entities.remove(this._lastLabel);this._lastLabel=undefined}for(var e=0;e<this._results.length;++e){if(this._results[e].type===this.ResultType.StraightLine){this._viewer.scene.primitives.remove(this._results[e].line);this._viewer.entities.remove(this._results[e].labelEntity);this._viewer.entities.remove(this._results[e].startPointEntity);this._viewer.entities.remove(this._results[e].endPointEntity)}else if(this._results[e].type===this.ResultType.HorizontalAndVertical){this._viewer.scene.primitives.remove(this._results[e].line);this._viewer.scene.primitives.remove(this._results[e].verticalLine);this._viewer.scene.primitives.remove(this._results[e].horizontalLine);this._viewer.entities.remove(this._results[e].lineLabelEntity);this._viewer.entities.remove(this._results[e].verticalLineLabelEntity);this._viewer.entities.remove(this._results[e].horizontalLineLabelEntity);this._viewer.entities.remove(this._results[e].startPointEntity);this._viewer.entities.remove(this._results[e].endPointEntity)}}for(var t in this._sumLabel){this._viewer.entities.remove(this._sumLabel[t])}this._viewer.scene.primitives.remove(this._polylineCollection);this._results=[];this._sumLabel=[];this._data={line:[],polyline:[]};this._points=[];this._pointsCalced=[];this._viewer.scene.requestRender()};s.prototype.pickStartPoint=function(e){this._points=[];this._pointsCalced=[];var t=this.pickPosition(e);if(t.type!==this.PositionType.NONE){this._startPoint=t;this._points.push(t.position);this._points.push(t.position);this._tempPointEntities[0]=this._viewer.entities.add({position:this._startPoint.position,show:false,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:false,point:false}})}};s.prototype.getLengthText=function(e){return e>1e3?(e/1e3).toFixed(2)+"千米":e.toFixed(2)+"米"};s.prototype.pickEndPoint=function(e){var t=this.pickPosition(e);if(t.type!==this.PositionType.NONE){this.addResult(t);this._bRmStarting=true;setTimeout(this.removeTmpLine.bind(this),100)}};s.prototype.handleLeftClick=function(e){if(this._bInSurvey==false)return;if(this._startPoint){this.pickEndPoint(e.position)}else{this.pickStartPoint(e.position)}};s.prototype.addSumInfo=function(){if(this._surveyType=="SEGMENTS_DISTANCE"){var e=Freedo.FdMisc.FdGeometric.calculateLength(this._points);if(this._points.length>=2){this._data.polyline.push({lines:Freedo.clone(this._pointsCalced,true),sumLenght:e});this._event.raiseEvent("DataChanged",{lines:Freedo.clone(this._pointsCalced,true),sumLenght:e})}}this._viewer.scene.requestRender()};s.prototype.handleRightClick=function(e){if(this._bInSurvey==false)return;if(!!this._startPoint){this._startPoint=undefined;this.addSumInfo()}this.removeTmpLine()};s.prototype.callbackPosition=function(){this._viewer.scene.requestRender();return[this._startPoint.position,this._tempPoint.position]};s.prototype.handleMouseMove=function(e){if(this._bInSurvey==false||this._bRmStarting)return;if(!!this._startPoint&&!Freedo.Cartesian3.equals(e.endPosition,e.startPosition)){var t=this.pickPosition(e.endPosition);if(Freedo.defined(t.position))this._tempPoint=t;else return;if(this._tempLine===undefined){var r=new Freedo.CallbackProperty(this.callbackPosition.bind(this),false);this._tempLine=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:r,width:this._lineWidth,material:Freedo.Color.RED,depthFailMaterial:Freedo.Color.GREEN}})}}};s.prototype.onKeyDown=function(){if(this._bInSurvey==false)return;if(window.event.keyCode==27){this.handleRightClick()}};s.prototype.getData=function(e){return Freedo.clone(this._data,true)};s.prototype.setData=function(e){this._surveyType="LINE_DISTANCE";for(var t in e.line){this._points=[];this._startPoint={position:e.line[t].pointsC[0]};this.addResult({position:e.line[t].pointsC[1]})}this._surveyType="SEGMENTS_DISTANCE";for(var t in e.polyline){this._points=[];var r=e.polyline[t];for(var n in r.lines){if(n=="0"){this._points.push(r.lines[n].pointsC[0]);this._points.push(r.lines[n].pointsC[0])}this._startPoint={position:r.lines[n].pointsC[0]};this.addResult({position:r.lines[n].pointsC[1]})}this.addSumInfo()}this._startPoint=undefined};s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};s.prototype.run=function(e){this._surveyType=e;this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK);this._hanlder.setInputAction(this.handleRightClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);this._hanlder.setInputAction(this.handleRightClick.bind(this),Freedo.ScreenSpaceEventType.RIGHT_CLICK);this._hanlder.setInputAction(this.handleMouseMove.bind(this),Freedo.ScreenSpaceEventType.MOUSE_MOVE);window.addEventListener("keydown",this.onKeyDown.bind(this));this._bInSurvey=true};s.prototype.reset=function(){this._bInSurvey=false;this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK);this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.RIGHT_CLICK);this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.MOUSE_MOVE);window.removeEventListener("keydown",this.onKeyDown.bind(this))};s.prototype.removeAll=function(){this.clearResults()};s.prototype.dispose=function(){this.reset();this.clearResults()};t.FdAnalysisLineDistance=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdAnalysisManager=undefined;var n=r(1);var i=f(n);var a=r(6);var o=f(a);var s=r(311);var u=r(310);var l=r(309);var c=r(307);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,i.default)(this,e);this._viewer=t;this._survey=undefined;this._depthTestAgainstTerrain=true;this._mode="";this._event=new FreeDo.Event;this._eventHelper=new FreeDo.EventHelper;this._surveyLine=new s.FdAnalysisLineDistance(this._viewer);this._surveyPoint=new u.FdAnalysisPoint(this._viewer);this._surveyArea=new l.FdAnalysisArea(this._viewer);this._surveyHeight=new c.FdAnalysisHeight(this._viewer);this._lsnr=undefined}(0,o.default)(e,[{key:"surveyOptions",get:function e(){return this.getData()},set:function e(t){if(!Freedo.defined(t)){return}this._surveyLine.setData(t);this._surveyPoint.setData(t.point);this._surveyArea.setData(t.area);this._surveyHeight.setData(t.height)}}]);return e}();d.prototype.start=function(e){this.setMode(e)};d.prototype.setMode=function(e){if(e=="CANCEL"){this.reset();return}if(e!=="LINE_DISTANCE"&&e!=="SEGMENTS_DISTANCE"&&e!=="SINGLE_POINT"&&e!=="AREA"&&e!=="HEIGHT"){console.warn("不支持此种量测模式："+e);return}this.reset();this._mode=e;if(e==="LINE_DISTANCE"||e==="SEGMENTS_DISTANCE"){this._survey=this._surveyLine}if(e==="SINGLE_POINT"){this._survey=this._surveyPoint}if(e==="AREA"){this._survey=this._surveyArea}if(e==="HEIGHT"){this._survey=this._surveyHeight}var t=this;this._lsnr=this._survey.on(function(e,r){if(e=="Point"){t._event.raiseEvent("Point",r)}if(e=="HeightPoint"){t._event.raiseEvent("Point",r)}if(e=="DataChanged"){t._event.raiseEvent(e,r)}});this._survey.run(this._mode);this._event.raiseEvent("Start",{mode:this._mode})};d.prototype.getMode=function(){return this._mode};d.prototype.setSingleMode=function(e){if(this._mode=="SINGLE_POINT"){this._survey.setSingleMode(e)}};d.prototype.getData=function(){var e=this._surveyLine.getData();var t=this._surveyPoint.getData();var r=this._surveyArea.getData();var n=this._surveyHeight.getData();return{line:e.line,polyline:e.polyline,point:t.point,area:r.area,height:n.height}};d.prototype.cancel=function(){this.reset();this._event.raiseEvent("Cancel",{mode:this._mode})};d.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)};d.prototype.reset=function(){if(this._survey)this._survey.reset();if(this._lsnr)this._lsnr()};d.prototype.removeAll=function(){this._surveyLine.removeAll();this._surveyPoint.removeAll();this._surveyArea.removeAll();this._surveyHeight.removeAll();this._event.raiseEvent("DataChanged",{});this._viewer.scene.requestRender()};d.prototype.dispose=function(){this.reset()};t.FdAnalysisManager=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdMicroApp=undefined;var n=r(1);var i=_(n);var a=r(312);var o=r(306);var s=r(305);var u=r(303);var l=r(301);var c=r(25);var f=r(278);var d=r(269);var h=r(172);var v=r(268);var p=r(263);function _(e){return e&&e.__esModule?e:{default:e}}var y=function e(){(0,i.default)(this,e)};y.FdAnalysisManager=a.FdAnalysisManager;y.FdDrawRoad=o.FdDrawRoad;y.FdPathsManager=s.FdPathsManager;y.FdClipPlane=u.FdClipPlane;y.FdPickPModel=l.FdPickPModel;y.FdGeologySimulationHandler=f.FdGeologySimulationHandler;y.FdEraseGroundHandler=d.FdEraseGroundHandler;y.FdTransformHelper=h.FdTransformHelper;y.FdPickPMComponent=v.FdPickPMComponent;y.FdDrawPolyline=p.FdDrawPolyline;y.FdPolylineEditor=c.FdPolylineEditor;t.FdMicroApp=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(){}n.getHeading=function(e){if(!Freedo.defined(e)){throw new Freedo.DeveloperError("camera is required")}return m(e.direction,e.up)};n.getPitch=function(e){if(!Freedo.defined(e)){throw new Freedo.DeveloperError("camera is required")}return g(e.direction)};n.lookAt=function(e,t,r){if(!Freedo.defined(e)){throw new Freedo.DeveloperError("camera is required")}if(!Freedo.defined(t)){throw new Freedo.DeveloperError("target is required")}if(!Freedo.defined(r)){throw new Freedo.DeveloperError("offset is required")}var n;if(Freedo.defined(r.heading)){n=l(r.heading,r.pitch,r.range)}else{n=r}Freedo.Cartesian3.add(t,n,e.position);Freedo.Cartesian3.subtract(t,e.position,F);Freedo.Cartesian3.normalize(F,e.direction);if(Freedo.Cartesian3.equalsEpsilon(e.direction,Freedo.Cartesian3.UNIT_Z,Freedo.Math.EPSILON4)){Freedo.Cartesian3.fromElements(0,-1,0,b)}else if(Freedo.Cartesian3.equalsEpsilon(e.direction,P,Freedo.Math.EPSILON4)){Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,b)}else{Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,b)}Freedo.Cartesian3.cross(F,b,w);Freedo.Cartesian3.cross(w,F,b);Freedo.Cartesian3.normalize(b,e.up);Freedo.Cartesian3.normalize(w,e.right)};n.setView=function(e,t){if(!Freedo.defined(e)){throw new Freedo.DeveloperError("camera is required")}t=Freedo.defaultValue(t,Freedo.defaultValue.EMPTY_OBJECT);var r=Freedo.defaultValue(t.orientation,Freedo.defaultValue.EMPTY_OBJECT);var n=Freedo.defaultValue(t.destination,Freedo.Cartesian3.clone(e.position,C));var i=e.direction;var a=e.up;if(Freedo.defined(r.direction)&&Freedo.defined(r.up)){i=r.direction;a=r.up}else if(Freedo.defined(r.heading)||Freedo.defined(r.pitch)){var o=Freedo.defaultValue(r.heading,0);var s=Freedo.defaultValue(r.pitch,0);var u=l(o,s,1);Freedo.Cartesian3.negate(u,F);i=Freedo.Cartesian3.normalize(F,F);if(Freedo.Cartesian3.equalsEpsilon(i,Freedo.Cartesian3.UNIT_Z,Freedo.Math.EPSILON4)){a=Freedo.Cartesian3.fromElements(0,-1,0,b)}else if(Freedo.Cartesian3.equalsEpsilon(i,P,Freedo.Math.EPSILON4)){a=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,b)}else{a=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,b)}}var c=Freedo.Cartesian3.cross(i,a,w);a=Freedo.Cartesian3.cross(c,i,b);Freedo.Cartesian3.clone(n,e.position);Freedo.Cartesian3.normalize(i,e.direction);Freedo.Cartesian3.normalize(a,e.up);Freedo.Cartesian3.normalize(c,e.right)};n.flyTo=function(e,t){t=Freedo.defaultValue(t,Freedo.defaultValue.EMPTY_OBJECT);var r=t.destination;if(!Freedo.defined(e)){throw new Freedo.DeveloperError("scene is required.")}if(!Freedo.defined(r)){throw new Freedo.DeveloperError("destination is required.")}n.cancelFlight();var i=Freedo.defaultValue(t.orientation,Freedo.defaultValue.EMPTY_OBJECT);if(Freedo.defined(i.direction)){i=D(e.camera,r,i,M.orientation)}var a;x.destination=r;x.heading=i.heading;x.pitch=i.pitch;x.roll=i.roll;x.duration=t.duration;x.complete=function(){if(a===A._currentFlight){A._currentFlight=undefined}if(Freedo.defined(t.complete)){t.complete()}};x.cancel=t.cancel;x.easingFunction=t.easingFunction;a=e.tweens.add(A.createTween(e,x));n._currentFlight=a};function i(e,t){var r=e.frustum;var n=Math.tan(r.fovy*.5);var i=r.aspectRatio*n;return Math.max(t/i,t/n)}var a=new Freedo.Cartesian3;var o=new Freedo.Quaternion;var s=new Freedo.Quaternion;var u=new Freedo.Matrix3;function l(e,t,r){t=Freedo.Math.clamp(t,-Freedo.Math.PI_OVER_TWO,Freedo.Math.PI_OVER_TWO);e=Freedo.Math.zeroToTwoPi(e)-Freedo.Math.PI_OVER_TWO;var n=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Y,-t,o);var i=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Z,-e,s);var l=Freedo.Quaternion.multiply(i,n,i);var c=Freedo.Matrix3.fromQuaternion(l,u);var f=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_X,a);Freedo.Matrix3.multiplyByVector(c,f,f);Freedo.Cartesian3.negate(f,f);Freedo.Cartesian3.multiplyByScalar(f,r,f);return f}var c=new Freedo.Matrix4;var f=new Freedo.Cartesian3;var d=new Freedo.Cartesian3;var h=new Freedo.Cartesian3;var v=new Freedo.Cartesian3;var p=new Freedo.Cartesian4;var _=new Freedo.Quaternion;var y=new Freedo.Matrix3;n.flyToBoundingSphere=function(e,t,r){if(!Freedo.defined(t)){throw new DeveloperError("boundingSphere is required.")}var a=e.camera;r=Freedo.defaultValue(r,Freedo.defaultValue.EMPTY_OBJECT);a._setTransform(Freedo.Matrix4.IDENTITY);var o=r.offset;if(!Freedo.defined(o)){o=Freedo.HeadingPitchRange.clone(Freedo.Camera.DEFAULT_OFFSET)}if(!Freedo.defined(o.range)||o.range===0){o.range=i(a,t.radius)}var s=l(o.heading,o.pitch,o.range);s=Freedo.Cartesian3.add(s,t.center,f);var u;var c;u=Freedo.Cartesian3.subtract(t.center,s,d);Freedo.Cartesian3.normalize(u,u);c=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,h);if(1-Math.abs(Freedo.Cartesian3.dot(u,c))<Freedo.Math.EPSILON6){var p=Freedo.Quaternion.fromAxisAngle(u,o.heading,_);var m=Freedo.Matrix3.fromQuaternion(p,y);c=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,h);Freedo.Matrix3.multiplyByVector(m,c,c)}var g=Freedo.Cartesian3.cross(u,c,v);Freedo.Cartesian3.cross(g,u,c);Freedo.Cartesian3.normalize(c,c);n.flyTo(e,{destination:s,orientation:{direction:u,up:c},duration:r.duration,complete:r.complete,cancel:r.cancel,endTransform:r.endTransform,maximumHeight:r.maximumHeight,easingFunction:r.easingFunction,flyOverLongitude:r.flyOverLongitude,flyOverLongitudeWeight:r.flyOverLongitudeWeight,pitchAdjustHeight:r.pitchAdjustHeight})};n.cancelFlight=function(){if(Freedo.defined(n._currentFlight)){n._currentFlight.cancelTween();n._currentFlight=undefined}};function m(e,t){var r=0;if(e.z<Freedo.Math.EPSILON5-1){r=Math.atan2(t.x,t.y)}else if(e.z>1-Freedo.Math.EPSILON5){r=Math.atan2(-t.x,-t.y)}else{r=Math.atan2(e.x,e.y)}if(isNaN(r)){throw new Freedo.DeveloperError("")}return r}function g(e){var t=0;if(e.z<Freedo.Math.EPSILON5-1){t=-Freedo.Math.PI_OVER_TWO}else if(e.z>1-Freedo.Math.EPSILON5){t=Freedo.Math.PI_OVER_TWO}else{var r=Math.sqrt(e.x*e.x+e.y*e.y);t=Math.atan(e.z/r)}if(isNaN(t)){throw new Freedo.DeveloperError("")}return t}var a=new Freedo.Cartesian3;var o=new Freedo.Quaternion;var s=new Freedo.Quaternion;var u=new Freedo.Matrix3;function l(e,t,r){t=Freedo.Math.clamp(t,-Freedo.Math.PI_OVER_TWO,Freedo.Math.PI_OVER_TWO);e=Freedo.Math.zeroToTwoPi(e);var n=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_X,t,o);var i=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Z,-e,s);var l=Freedo.Quaternion.multiply(i,n,i);var c=Freedo.Matrix3.fromQuaternion(l,u);var f=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,a);Freedo.Matrix3.multiplyByVector(c,f,f);Freedo.Cartesian3.negate(f,f);Freedo.Cartesian3.multiplyByScalar(f,r,f);return f}var F=new Freedo.Cartesian3;var w=new Freedo.Cartesian3;var b=new Freedo.Cartesian3;var C=new Freedo.Cartesian3;var P=new Freedo.Cartesian3(0,0,-1);n._currentFlight=undefined;var x={destination:undefined,heading:undefined,pitch:undefined,roll:undefined,duration:undefined,complete:undefined,cancel:undefined,easingFunction:undefined};var M={destination:undefined,orientation:{direction:undefined,up:undefined,heading:undefined,pitch:undefined,roll:undefined}};var S=new Freedo.Cartesian3;var T=new Freedo.Cartesian3;var E=new Freedo.Cartesian3;function D(e,t,r,n){var i=Freedo.Cartesian3.clone(r.direction,S);var a=Freedo.Cartesian3.clone(r.up,T);var o=Freedo.Cartesian3.cross(i,a,E);n.heading=m(i,a);n.pitch=g(i);n.roll=0;return n}var A={};function O(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function k(e,t){function r(){if(typeof t==="function"){t()}e.enableInputs=true}return r}function L(e,t){if(Freedo.Math.equalsEpsilon(e,Freedo.Math.TWO_PI,Freedo.Math.EPSILON11)){e=0}if(t>e+Math.PI){e+=Freedo.Math.TWO_PI}else if(t<e-Math.PI){e-=Freedo.Math.TWO_PI}return e}var I=new Freedo.Cartesian3;var R=new Freedo.Cartesian3;function N(e,t,r,i,a,o){var s=Freedo.Cartesian3.clone(e.position,I);var u=L(n.getHeading(e),i);var l=n.getPitch(e);function c(){return function c(f){var d=f.time/t;var h=Freedo.Cartesian3.lerp(s,r,d,R);n.setView(e,{destination:h,orientation:{heading:Freedo.Math.lerp(u,i,d),pitch:Freedo.Math.lerp(l,a,d),roll:Freedo.Math.lerp(0,o,d)}})}}return c()}A.createTween=function(e,t){var r=e.camera;var n=t.destination;var i=Freedo.defaultValue(t.easingFunction,Freedo.EasingFunction.LINEAR_NONE);var a=t.duration;if(!Freedo.defined(a)){a=Math.ceil(Freedo.Cartesian3.distance(r.position,n)/100)+2;a=Math.min(a,3)}var o=Freedo.defaultValue(t.heading,0);var s=Freedo.defaultValue(t.pitch,0);var u=Freedo.defaultValue(t.roll,0);var l=e.screenSpaceCameraController;l.enableInputs=false;var c=k(l,t.complete);var f=k(l,t.cancel);if(a<=0){var d=function e(){var t=N(r,1,n,o,s,u);t({time:1});if(typeof c==="function"){c()}};return O(d,f)}var h=N(r,a,n,o,s,u);return{duration:a,easingFunction:i,startObject:{time:0},stopObject:{time:a},update:h,complete:c,cancel:f}};t.FdPlaneViewCameraHelper=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdTrackManager=undefined;var n=r(1);var i=s(n);var a=r(6);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,i.default)(this,e);this._scene=t;this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper}(0,o.default)(e,[{key:"trackByBoundingSphere",value:function e(t){this._scene.screenSpaceCameraController.bimTrackByBoundingSphere(t);this._event.raiseEvent("beginTrack",t)}},{key:"cancelTrack",value:function e(){this._scene.screenSpaceCameraController.bimUnTrack();this._event.raiseEvent("cancelTrack")}},{key:"isTracking",value:function e(){return this._scene.screenSpaceCameraController.isTracking()}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"dispose",value:function e(){this._scene.screenSpaceCameraController.bimUnTrack();this._eventHelper.removeAll()}}]);return e}();t.FdTrackManager=u},function(e,t,r){var n=r(17);n(n.S+n.F*!r(29),"Object",{defineProperty:r(31).f})},function(e,t,r){r(316);var n=r(14).Object;e.exports=function e(t,r,i){return n.defineProperty(t,r,i)}},function(e,t,r){var n=r(17);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){r(318);e.exports=9007199254740991},function(e,t,r){e.exports={default:r(319),__esModule:true}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdCameraHistory=undefined;var n=r(320);var i=l(n);var a=r(1);var o=l(a);var s=r(6);var u=l(s);function l(e){return e&&e.__esModule?e:{default:e}}var c=r(123);var f=function(){function e(t){var r=this;(0,o.default)(this,e);this._camera=t;if(typeof t._cameraHistory!=="undefined"){throw new Error("Current camera has already create history!")}t._cameraHistory=this;this._cameraPath=[];c.extendObservable(this,{_cameraPathCurrentIndex:-1});c.autorun(function(){r._cameraPathCurrentIndex;if(typeof r._event!=="undefined"){r._event.raiseEvent("CameraPathChanged")}});this._lastHistoryOpFrameCount=0;this._delayRecordViewValid=true;function n(e,t){if(typeof t==="undefined"){t={}}t.position=e.positionWC.clone();t.heading=e.heading;t.pitch=e.pitch;t.roll=e.roll;return t}var i=this;this._delayRecordView=_.debounce(function(){var e=i._camera;if(i._delayRecordViewValid){var t=n(e);if(i._cameraPath.length>=10){i._cameraPath.splice(0,1);i._cameraPathCurrentIndex=i._cameraPathCurrentIndex-1}i._cameraPath.splice(i._cameraPathCurrentIndex+1,i._cameraPath.length-1-i._cameraPathCurrentIndex,t);i._cameraPathCurrentIndex=i._cameraPath.length-1;i._updateCameraHistoryStatus()}},1e3);this._delayRecordView();this._camera.percentageChanged=1e-4;this._cameraChangedEventListener=this._camera.changed.addEventListener(function(){var e=i._camera;if(e._scene._frameState.frameNumber<=i._lastHistoryOpFrameCount){i._delayRecordViewValid=false}else{i._delayRecordViewValid=true;i._delayRecordView()}});this._event=new Freedo.Event;this._eventHelper=new Freedo.EventHelper}(0,u.default)(e,[{key:"_updateCameraHistoryStatus",value:function e(){this._event.raiseEvent("CameraPathChanged")}},{key:"prev",value:function e(){if(this._cameraPath.length==0)return;this._camera.cancelFlight();var t={};this._lastHistoryOpFrameCount=i.default;if(this._cameraPathCurrentIndex>0){this._cameraPathCurrentIndex-=1}else{return}var r=this._cameraPath[this._cameraPathCurrentIndex];t.destination=r.position;t.orientation={heading:r.heading,pitch:r.pitch,roll:r.roll};t.duration=1;var n=this;t.complete=function(){n._lastHistoryOpFrameCount=n._camera._scene._frameState.frameNumber};t.cancel=function(){n._lastHistoryOpFrameCount=n._camera._scene._frameState.frameNumber};var a=this._camera;if(!Freedo.Matrix4.equals(a.transform,Freedo.Matrix4.IDENTITY)){t.endTransform=Freedo.Matrix4.clone(a.transform);a.lookAtTransform(Freedo.Matrix4.IDENTITY)}this._camera.flyTo(t)}},{key:"next",value:function e(){if(this._cameraPath.length==0)return;this._camera.cancelFlight();var t={};this._lastHistoryOpFrameCount=i.default;if(this._cameraPathCurrentIndex+1<this._cameraPath.length){this._cameraPathCurrentIndex=this._cameraPathCurrentIndex+1}else{return}var r=this._cameraPath[this._cameraPathCurrentIndex];t.destination=r.position;t.orientation={heading:r.heading,pitch:r.pitch,roll:r.roll};t.duration=1;var n=this;t.complete=function(){n._lastHistoryOpFrameCount=n._camera._scene._frameState.frameNumber};t.cancel=function(){n._lastHistoryOpFrameCount=n._camera._scene._frameState.frameNumber};var a=this._camera;if(!Freedo.Matrix4.equals(a.transform,Freedo.Matrix4.IDENTITY)){t.endTransform=Freedo.Matrix4.clone(a.transform);a.lookAtTransform(Freedo.Matrix4.IDENTITY)}this._camera.flyTo(t)}},{key:"on",value:function e(t,r){return this._eventHelper.add(this._event,t,r)}},{key:"dispose",value:function e(){if(typeof this._cameraChangedEventListener!=="undefined"){this._cameraChangedEventListener();this._cameraChangedEventListener=undefined}if(this._camera._cameraHistory===this){this._camera._cameraHistory=undefined}if(typeof this._delayRecordView!=="undefined"){this._delayRecordView=undefined}if(typeof this._camera!="undefined"){this._camera=undefined}this._eventHelper.removeAll();this._event=undefined;this._eventHelper=undefined}},{key:"pathLength",get:function e(){return this._cameraPath.length}},{key:"currentIndex",get:function e(){return this._cameraPathCurrentIndex}}]);return e}();t.FdCameraHistory=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setKeyboardV=t.enableKeyboard=undefined;var n=r(84);var i=undefined;var a=undefined;var o=undefined;var s=10;function u(e,t){i=e.camera;if(a){o();a=undefined}a=new n.FdKeyboard(e);o=a.on(function(e,t){if(e==="timer"){if(t.metaData[37]){Freedo.FdCamera.lookLeft(i,5)}if(t.metaData[39]){Freedo.FdCamera.lookRight(i,5)}if(t.metaData[38]){i.lookUp(5/180*Freedo.Math.PI)}if(t.metaData[40]){i.lookDown(5/180*Freedo.Math.PI)}if(t.metaData[65]){i.moveLeft(s/33)}if(t.metaData[68]){i.moveRight(s/33)}if(t.metaData[87]){i.moveForward(s/33)}if(t.metaData[83]){i.moveBackward(s/33)}}});if(t){a.enable()}else{a.disable()}}function l(e){s=e}t.enableKeyboard=u;t.setKeyboardV=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){var r=e.positionWC;var n=Freedo.Matrix4.clone(e.transform,n);e.lookAtTransform(Freedo.Matrix4.IDENTITY);e.look(r,Freedo.Math.toRadians(t));e.lookAtTransform(n)}function i(e,t){n(e,-t)}function a(e,t){n(e,t)}t.lookLeft=i;t.lookRight=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e){if(!(e instanceof Freedo.Scene)){throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.")}}function i(e){if(!Freedo.defined(e)){throw new Freedo.DeveloperError("boundingSphere is required.")}}function a(e,t,r,n){var i=new Freedo.Cartographic.fromCartesian(t.center);var a=i.height;var o=function i(){e.flyToBoundingSphere(t,{offset:new Freedo.HeadingPitchRange(r,n,t.radius*3),maximumHeight:a,duration:2})};var s=e.distanceToBoundingSphere(t);if(s>t.radius*5){e.flyToBoundingSphere(t,{duration:6,offset:new Freedo.HeadingPitchRange(e.heading,e.pitch,t.radius*5),complete:o})}else{o()}}function o(e,t){n(e);i(t);var r=e.camera;a(r,t,0,0)}function s(e,t){n(e);i(t);var r=e.camera;a(r,t,FreeDo.Math.toRadians(90),0)}function u(e,t){n(e);i(t);var r=e.camera;a(r,t,FreeDo.Math.toRadians(180),0)}function l(e,t){n(e);i(t);var r=e.camera;a(r,t,FreeDo.Math.toRadians(270),0)}function c(e,t){n(e);i(t);var r=e.camera;a(r,t,r.heading,FreeDo.Math.toRadians(-90))}t.flyToSouth=o;t.flyToWest=s;t.flyToNorth=u;t.flyToEast=l;t.flyToTop=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n;function i(e,t,r){if(!Freedo.defined(n)){n=document.createElement("canvas")}n.setAttribute("width",t);n.setAttribute("height",r);var i=e.canvas;var a=i.width;var o=i.height;var s,u,l,c;if(a>=o){s=(a-o)*.5;u=0;l=c=o}else{s=0;u=(o-a)*.5;l=c=a}var f=n.getContext("2d");f.drawImage(i,s,u,l,c,0,0,t,r);var d=n.toDataURL("image/jpeg");return d}function a(e,t,r,n){r=Freedo.defaultValue(r,128);n=Freedo.defaultValue(n,128);e.requestRender();var a=e._postRender.addEventListener(function(){var o=i(e,r,n);t(o,r,n);a()},null)}t.capture=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t,r,n,i,a){if(!(e instanceof Freedo.Scene)){throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.")}var o=e.camera;r=Freedo.defaultValue(r,80);n=Freedo.defaultValue(n,5);i=Freedo.defaultValue(i,135);a=Freedo.defaultValue(a,55);var s=Freedo.Rectangle.fromDegrees(r,n,i,a);var u=o._mode;if(u===Freedo.SceneMode.MORPHING){o._scene.completeMorph()}if(u===Freedo.SceneMode.SCENE2D){o.flyTo({destination:s,duration:t,endTransform:Freedo.Matrix4.IDENTITY})}else if(u===Freedo.SceneMode.SCENE3D){var l=o.getRectangleCameraCoordinates(s);var c=Freedo.Cartesian3.magnitude(l);c+=c*Freedo.Camera.DEFAULT_VIEW_FACTOR;Freedo.Cartesian3.normalize(l,l);Freedo.Cartesian3.multiplyByScalar(l,c,l);o.flyTo({destination:l,duration:t,endTransform:Freedo.Matrix4.IDENTITY})}else if(u===Freedo.SceneMode.COLUMBUS_VIEW){var f=o._projection.ellipsoid.maximumRadius;var d=new Freedo.Cartesian3(0,-1,1);d=Freedo.Cartesian3.multiplyByScalar(Freedo.Cartesian3.normalize(d,d),5*f,d);o.flyTo({destination:d,duration:t,orientation:{heading:0,pitch:-Freedo.Math.acos(Freedo.Cartesian3.normalize(d,pitchScratch).z),roll:0},endTransform:Freedo.Matrix4.IDENTITY,convert:false})}}t.aerialView=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=new Freedo.Matrix4;function i(e,t,r){var i=t.camera;if(!Freedo.defined(r)){r={}}var a=Freedo.defaultValue(r.duration,3);var o=Freedo.defaultValue(r.rotateAngleRange,Freedo.Math.PI*4);var s=Freedo.defaultValue(r.easingFunction,Freedo.EasingFunction.QUADRACTIC_IN_OUT);var u=Freedo.defaultValue(r.delay,0);var l=Freedo.Matrix4.clone(i.transform,n);var c=Freedo.Transforms.eastNorthUpToFixedFrame(e);i.lookAtTransform(c);var f=t.tweens.add({duration:a,easingFunction:s,startObject:{angle:0},stopObject:{angle:o},delay:u,update:function(){var e=0;return function(t){var r=t.angle-e;if(r>0){i.rotate(Freedo.Cartesian3.UNIT_Z,r)}e=t.angle}}(),complete:function e(){f.cancelTween()},cancel:function e(){i.lookAtTransform(l)}});return function(){f.cancelTween()}}t.flyAround=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdCamera=undefined;var n=r(1);var i=_(n);var a=r(327);var o=r(326);var s=r(325);var u=r(324);var l=r(122);var c=r(323);var f=r(84);var d=r(322);var h=r(321);var v=r(315);var p=r(314);function _(e){return e&&e.__esModule?e:{default:e}}var y=function e(){(0,i.default)(this,e)};y.flyAround=a.flyAround;y.aerialView=o.aerialView;y.capture=s.capture;y.flyToSouth=u.flyToSouth;y.flyToWest=u.flyToWest;y.flyToNorth=u.flyToNorth;y.flyToEast=u.flyToEast;y.flyToTop=u.flyToTop;y.getCurrentCameraInfo=l.getCurrentCameraInfo;y.flyToByCameraInfo=l.flyToByCameraInfo;y.goToByCameraInfo=l.goToByCameraInfo;y.lookLeft=c.lookLeft;y.lookRight=c.lookRight;y.enableKeyboard=d.enableKeyboard;y.setKeyboardV=d.setKeyboardV;y.FdCameraHistory=h.FdCameraHistory;y.FdTrackManager=v.FdTrackManager;y.FdPlaneViewCameraHelper=p.FdPlaneViewCameraHelper;t.FdCamera=y},function(e,t){var r=e.exports={};var n;var i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=a}}catch(e){n=a}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=o}}catch(e){i=o}})();function s(e){if(n===setTimeout){return setTimeout(e,0)}if((n===a||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function u(e){if(i===clearTimeout){return clearTimeout(e)}if((i===o||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var l=[];var c=false;var f;var d=-1;function h(){if(!c||!f){return}c=false;if(f.length){l=f.concat(l)}else{d=-1}if(l.length){v()}}function v(){if(c){return}var e=s(h);c=true;var t=l.length;while(t){f=l;l=[];while(++d<t){if(f){f[d].run()}}d=-1;t=l.length}f=null;c=false;u(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}l.push(new p(e,t));if(l.length===1&&!c){s(v)}};function p(e,t){this.fun=e;this.array=t}p.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function _(){}r.on=_;r.addListener=_;r.once=_;r.off=_;r.removeListener=_;r.removeAllListeners=_;r.emit=_;r.prependListener=_;r.prependOnceListener=_;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdGeometric=undefined;var n=r(1);var i=o(n);var a=r(175);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(){(0,i.default)(this,e)};s.calculateLength=function(e){var t=0;for(var r=1;r<e.length;++r){t+=Freedo.Cartesian3.distance(e[r-1],e[r])}return t};s.getLengthText=function(e){return e>1e3?(e/1e3).toFixed(2)+"千米":e.toFixed(2)+"米"};s.getCenter=function(e,t){var r=new Freedo.Cartesian3;Freedo.Cartesian3.add(e,t,r);Freedo.Cartesian3.multiplyByScalar(r,.5,r);return r};s.getLongAndLatRatio=function(e){var t=e.clone();t.latitude+=1e-7;var r=new FreeDo.EllipsoidGeodesic;var n=t.clone();n.longitude+=.001;r.setEndPoints(t,n);var i=.001/r.surfaceDistance;var a=new FreeDo.EllipsoidGeodesic;var o=t.clone();o.latitude+=.001;a.setEndPoints(t,o);var s=.001/a.surfaceDistance;return[i,s]};s.pickPosition=function(e,t){var r=undefined;var e=e;var n=e.scene;if(n.mode!==Freedo.SceneMode.MORPHING){var i=n.pick(t);if(n.pickPositionSupported&&Freedo.defined(i)){r=e.scene.pickPosition(t);if(r)r.type=0}else{if(e.terrainProvider instanceof Freedo.EllipsoidTerrainProvider)r=e.camera.pickEllipsoid(t,n.globe.ellipsoid);else{var a=n.camera.getPickRay(t);if(n.globe)r=n.globe.pick(a,n)}if(r)r.type=1}}return r};s.pickPositionG=function(e,t){var r=undefined;var n=this.pickPosition(e,t);if(n){r=[];var i;if(e.scene.globe){i=Freedo.Cartographic.fromCartesian(n,e.scene.globe.ellipsoid);var a=Freedo.Math.toDegrees;r[0]=a(i.longitude);r[1]=a(i.latitude);r[2]=i.height}else{r[0]=n.x;r[1]=n.y;r[2]=n.z}r[3]=n.type}return r};s.tc=function(e){var t=Freedo.Math.toRadians;return Freedo.Cartesian3.fromRadians(t(e[0]),t(e[1]),e[2])};s.tg=function(e){var t=[];var r=Freedo.Cartographic.fromCartesian(e);var n=Freedo.Math.toDegrees;t[0]=n(r.longitude);t[1]=n(r.latitude);t[2]=r.height;return t};s.leftOfLine=function(e,t,r){var n=e.x;var i=e.y;var a=t.x;var o=t.y;var s=r.x;var u=r.y;var l=((n-s)*(o-u)-(i-u)*(a-s))/2;if(l>0)return 1;else return-1};s.calcAngle=function(e,t,r,n){var i=[t.x-e.x,t.y-e.y];var a=[n.x-r.x,n.y-r.y];var o=(i[0]*a[0]+i[1]*a[1])/(Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))*Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)));var u=Freedo.Math.toDegrees(Math.acos(o));return u*s.leftOfLine(e,t,n)};s.calcArea=function(e,t,r){var n=e.length;if(n>2){var i=0;if(r=="DEGREES"){var a=0;var o=0;var s=0;var u=0;var l=0;var c=0;var f=0;var d=0;var h=0;var v=0;var p=0;var _=0;var y=0;var m=0;var g=0;var F=0;var w=0;var b=0;var C=0;var P=0;var x=0;var M=0;var S=0;var T=0;var E=0;var D=0;var A=0;var O=0;var k=0;var L=0;var I=0;var R=0;var N=0;var B=6378e3;for(var j=0;j<n;j++){if(j==0){a=e[n-1]*Math.PI/180;o=t[n-1]*Math.PI/180;s=e[0]*Math.PI/180;u=t[0]*Math.PI/180;l=e[1]*Math.PI/180;c=t[1]*Math.PI/180}else if(j==n-1){a=e[n-2]*Math.PI/180;o=t[n-2]*Math.PI/180;s=e[n-1]*Math.PI/180;u=t[n-1]*Math.PI/180;l=e[0]*Math.PI/180;c=t[0]*Math.PI/180}else{a=e[j-1]*Math.PI/180;o=t[j-1]*Math.PI/180;s=e[j]*Math.PI/180;u=t[j]*Math.PI/180;l=e[j+1]*Math.PI/180;c=t[j+1]*Math.PI/180}f=Math.cos(u)*Math.cos(s);d=Math.cos(u)*Math.sin(s);h=Math.sin(u);v=Math.cos(o)*Math.cos(a);p=Math.cos(o)*Math.sin(a);_=Math.sin(o);y=Math.cos(c)*Math.cos(l);m=Math.cos(c)*Math.sin(l);g=Math.sin(c);F=(f*f+d*d+h*h)/(f*v+d*p+h*_);w=(f*f+d*d+h*h)/(f*y+d*m+h*g);b=F*v-f;C=F*p-d;P=F*_-h;x=w*y-f;M=w*m-d;S=w*g-h;O=(x*b+M*C+S*P)/(Math.sqrt(x*x+M*M+S*S)*Math.sqrt(b*b+C*C+P*P));O=Math.acos(O);T=M*P-S*C;E=0-(x*P-S*b);D=x*C-M*b;if(f!=0)A=T/f;else if(d!=0)A=E/d;else A=D/h;if(A>0){k+=O;R++}else{L+=O;I++}}if(k>L){N=k+(2*Math.PI*I-L)}else{N=2*Math.PI*R-k+L}i=(N-(n-2)*Math.PI)*B*B}else{var j,G;var H,V;var X,Y;for(j=n-1,G=0;G<n;j=G,G++){H=e[j];V=t[j];X=e[G];Y=t[G];i+=H*Y-X*V}i/=2}return i}return 0};t.FdGeometric=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){if(!(e instanceof Freedo.Scene)){throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.")}if(!Freedo.defined(t)){throw new Freedo.DeveloperError("option is required.")}var r=t.color;var n=t.imagePaths;if(!Freedo.defined(r)&&!Freedo.defined(n)){throw new Freedo.DeveloperError("color or imagePaths is required in option.")}if(Freedo.defined(r)&&Freedo.defined(n)){throw new Freedo.DeveloperError("color & imagePaths can't be set at the same time.")}e.skyAtmosphere=undefined;if(Freedo.defined(r)){e.backgroundColor=new Freedo.Color(r[0],r[1],r[2],r[3]);e.skyBox=undefined}else{if(n.length!==6){throw new Freedo.DeveloperError("imagePaths must have six valid image path.")}e.backgroundColor=new Freedo.Color(0,0,0,1);e.skyBox=new Freedo.SkyBox({sources:{positiveX:n[0],negativeX:n[1],positiveY:n[2],negativeY:n[3],positiveZ:n[4],negativeZ:n[5]}})}e.requestRender()}function i(e,t){if(!(e instanceof Freedo.Scene)){throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.")}if(!Freedo.defined(t)){throw new Freedo.DeveloperError("imagePaths is required.")}if(t.length!==6){throw new Freedo.DeveloperError("imagePaths must have six valid image path.")}e.skyAtmosphere=undefined;e.skyBox=undefined;e.backgroundColor=new Freedo.Color(0,0,0,1);e.skyBoxOnGround=new Freedo.SkyBox({sources:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}});e.requestRender()}t.setSkyBox=n;t.setSkyBoxOnGround=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Freedo;function i(e){if(!n.defined(e)){throw new DeveloperError("scene is required.")}this.enableCollisionDetection=false;this.minimumZoomDistance=1;this.maximumZoomDistance=Number.POSITIVE_INFINITY;this.maximumMovementRatio=.1;this.enableInputs=true;this.enableRotate=true;this.enablePan=true;this.enableZoom=true;this.inertiaRotate=.5;this.inertiaPan=.5;this.inertiaZoom=.5;this.defaultZoomReference=undefined;this.defaultRotateReference=undefined;this.rotateEventTypes=n.CameraEventType.LEFT_DRAG;this.panEventTypes=[n.CameraEventType.RIGHT_DRAG,n.CameraEventType.MIDDLE_DRAG];this.zoomEventTypes=[n.CameraEventType.WHEEL,n.CameraEventType.PINCH];this._scene=e;this._aggregator=new n.CameraEventAggregator(e.canvas);this._zoomFactor=5;this._rotateFactor=.01}function a(e,t){if(e<0){return 0}var r=(1-t)*25;return Math.exp(-r*e)}function o(e){return n.Cartesian2.equalsEpsilon(e.startPosition,e.endPosition,n.Math.EPSILON14)}var s=.4;function u(e,t,r,i,u,l,c){var f=l[c];if(!n.defined(f)){f=l[c]={startPosition:new n.Cartesian2,endPosition:new n.Cartesian2,motion:new n.Cartesian2,active:false}}var d=e.getButtonPressTime(t,r);var h=e.getButtonReleaseTime(t,r);var v=d&&h&&(h.getTime()-d.getTime())/1e3;var p=new Date;var _=h&&(p.getTime()-h.getTime())/1e3;if(d&&h&&v<s){var y=a(_,i);if(!f.active){var m=e.getLastMovement(t,r);if(!n.defined(m)||o(m)){return}f.motion.x=(m.endPosition.x-m.startPosition.x)*.5;f.motion.y=(m.endPosition.y-m.startPosition.y)*.5;f.startPosition=n.Cartesian2.clone(m.startPosition,f.startPosition);f.endPosition=n.Cartesian2.multiplyByScalar(f.motion,y,f.endPosition);f.endPosition=n.Cartesian2.add(f.startPosition,f.endPosition,f.endPosition);f.active=true}else{f.startPosition=n.Cartesian2.clone(f.endPosition,f.startPosition);f.endPosition=n.Cartesian2.multiplyByScalar(f.motion,y,f.endPosition);f.endPosition=n.Cartesian2.add(f.startPosition,f.endPosition,f.endPosition);f.motion=n.Cartesian2.clone(n.Cartesian2.ZERO,f.motion)}if(isNaN(f.endPosition.x)||isNaN(f.endPosition.y)||n.Cartesian2.distance(f.startPosition,f.endPosition)<.5){f.active=false;return}if(!e.isButtonDown(t,r)){var g=e.getStartMousePosition(t,r);u(l,g,f)}}else{f.active=false}}var l=[];function c(e,t,r,i,a,o){if(!n.defined(r)){return}var s=e._aggregator;if(!n.isArray(r)){l[0]=r;r=l}var c=r.length;for(var f=0;f<c;++f){var d=r[f];var h=n.defined(d.eventType)?d.eventType:d;var v=d.modifier;var p=s.isMoving(h,v)&&s.getMovement(h,v);var _=s.getStartMousePosition(h,v);if(e.enableInputs&&t){if(p){i(e,_,p)}else if(a<1){u(s,h,v,a,i,e,o)}}}}var f=new n.Cartesian2;var d=new n.Cartesian3;var h=new n.Cartesian3;var v=new n.Cartesian3;var p=new n.Cartesian3;var _=new n.Ray;var y=new n.Plane(new n.Cartesian3(0,0,1),1);var m=new n.Cartesian2;var g=new n.Cartesian3;var F=new n.Cartesian3;var w=new n.Cartesian3;var b=new n.Cartesian3;var C=new n.Cartesian2;var P=new n.Cartesian3;function x(e){var t=e.direction;var r=e.up;var i=0;if(t.z<-.99999){i=Math.atan2(r.y,r.x)}else if(t.z>.99999){i=Math.atan2(-r.y,-r.x)}else{i=Math.atan2(t.y,t.x)}if(isNaN(i)){throw new n.DeveloperError("")}return i}function M(e){var t=e.direction;var r=0;if(t.z<-.99999){r=-n.Math.PI_OVER_TWO}else if(t.z>.99999){r=n.Math.PI_OVER_TWO}else{var i=Math.sqrt(t.x*t.x+t.y*t.y);r=Math.atan(t.z/i)}if(isNaN(r)){throw new n.DeveloperError("")}return r}function S(e,t,r,i,a){r.x=Math.cos(t)*Math.cos(e);r.y=Math.cos(t)*Math.sin(e);r.z=Math.sin(t);n.Cartesian3.normalize(r,r);var o=e+n.Math.PI_OVER_TWO;i.x=Math.cos(o);i.y=Math.sin(o);i.z=0;n.Cartesian3.normalize(i,i);n.Cartesian3.cross(r,i,a);n.Cartesian3.normalize(a,a)}function T(e,t,r){var i=e._scene;var a=i.camera;var s=i.canvas;if(o(r)){return}if(!n.Cartesian2.equalsEpsilon(C,t,n.Math.EPSILON14)){n.Cartesian2.clone(t,C);var u=i.pickPosition(r.startPosition,P);if(!n.defined(u)){var l=f;l.x=s.clientWidth/2;l.y=s.clientHeight/2;u=i.pickPosition(l,P);if(!n.defined(u)){if(n.defined(e.defaultRotateReference)){n.Cartesian3.clone(e.defaultRotateReference,P)}else{n.Cartesian3.clone(n.Cartesian3.ZERO,P)}}}}var c=n.Cartesian2.subtract(r.endPosition,r.startPosition,m);var d=-c.x*e._rotateFactor;var p=-c.y*e._rotateFactor;var _=x(a);var y=M(a);var T=_+d;var E=y+p;E=n.Math.clamp(E,-n.Math.PI_OVER_TWO,n.Math.PI_OVER_TWO);var D=n.Cartesian3.subtract(a.position,P,v);var A=n.Cartesian3.magnitude(D);S(_,y,g,F,w);var O=n.Cartesian3.dot(D,g);var k=n.Cartesian3.dot(D,F);var L=n.Cartesian3.dot(D,w);S(T,E,g,F,w);n.Cartesian3.multiplyByScalar(g,O,h);n.Cartesian3.add(P,h,b);n.Cartesian3.multiplyByScalar(F,k,h);n.Cartesian3.add(h,b,b);n.Cartesian3.multiplyByScalar(w,L,h);var I=n.Cartesian3.add(h,b,b);n.Cartesian3.clone(I,a.position);n.Cartesian3.normalize(g,a.direction);n.Cartesian3.normalize(w,a.up);n.Cartesian3.cross(g,w,a.right)}function E(e,t,r){var i=e._scene;var a=i.camera;var s=i.canvas;if(o(r)){return}var u=n.Cartesian3.negate(a.direction,p);var l=i.pickPosition(r.startPosition,d);if(n.defined(l)){var c=n.Plane.fromPointNormal(l,u,y);var f=a.getPickRay(r.endPosition,_);var m=n.IntersectionTests.rayPlane(f,c,h);if(n.defined(m)){var g=n.Cartesian3.subtract(l,m,v);a.move(g,1);return}}var c=n.Plane.fromPointNormal(n.Cartesian3.ZERO,u,y);var f=a.getPickRay(r.startPosition,_);l=n.IntersectionTests.rayPlane(f,c,d);f=a.getPickRay(r.endPosition,_);m=n.IntersectionTests.rayPlane(f,c,h);if(n.defined(l)&&n.defined(m)){var g=n.Cartesian3.subtract(l,m,v);a.move(g,1);return}}function D(e,t,r){if(n.defined(r.distance)){r=r.distance}var i=e._scene;var a=i.camera;var o=i.canvas;var s=r.endPosition.y-r.startPosition.y;if(Math.abs(s)<n.Math.EPSILON14){return}var u=s/o.clientHeight;u=Math.min(u,e.maximumMovementRatio);var l=i.pickPosition(t,d);if(!n.defined(l)){var c=f;c.x=o.clientWidth/2;c.y=o.clientHeight/2;l=i.pickPosition(c,d);if(!n.defined(l)){if(n.defined(e.defaultZoomReference)){l=n.Cartesian3.clone(e.defaultZoomReference,d)}else{l=n.Cartesian3.clone(n.Cartesian3.ZERO,d)}}}var h=n.Cartesian3.subtract(l,a.position,v);var p=n.Cartesian3.magnitude(h);h=n.Cartesian3.normalize(h,v);p=p*u*e._zoomFactor;a.move(h,p)}function A(e){c(e,e.enableRotate,e.rotateEventTypes,T,e.inertiaRotate,"_lastInertiaSpinMovement");c(e,e.enablePan,e.panEventTypes,E,e.inertiaPan,"_lastInertiaPanMovement");c(e,e.enableZoom,e.zoomEventTypes,D,e.inertiaZoom,"_lastInertiaZoomMovement")}i.prototype.update=function(){var e=this._scene;var t=e.mode;if(t===n.SceneMode.SCENE3D){A(this)}this._aggregator.reset()};i.prototype.isDestroyed=function(){return false};i.prototype.destroy=function(){this._tweens.removeAll();this._aggregator=this._aggregator&&this._aggregator.destroy();return destroyObject(this)};var O=i;t.FdScreenSpaceCameraController=O},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.createDefaultViewer=undefined;var n=r(124);var i=r(332);window.mobilecheck=function(){var e=false;(function(t){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))e=true})(navigator.userAgent||navigator.vendor||window.opera);return e};var a={globe:false,skyBox:false,sun:false,scene3DOnly:true,skyAtmosphere:false};var o={imageryProvider:Freedo.createTileMapServiceImageryProvider({url:Freedo.buildModuleUrl("Assets/Textures/NaturalEarthII")}),baseLayerPicker:false,geocoder:false,timeline:false,animation:false,vrButton:false,navigationHelpButton:false,sceneModePicker:false,fullscreenButton:false,homeButton:false,selectionIndicator:false,infoBox:false,contextOptions:{webgl:{antialias:!mobilecheck()}}};function s(e,t,r){Freedo.Camera.DEFAULT_VIEW_RECTANGLE=Freedo.Rectangle.fromDegrees(80,5,135,55);Freedo.BingMapsApi.defaultKey="AsosOjY68GIcKsRMisb8KcmGD266hYjtDHD5-EC-YTJUHi1Cxj1K3zWhLcp-SPNZ";var s;var u;var l;r=Freedo.defaultValue(r,Freedo.defaultValue.EMPTY_OBJECT);var c=Freedo.defaultValue(r.planeMode,false);if(c){var f=_.assign(o,a);t=_.assign(f,t)}else{t=_.assign(o,t)}var d=new Freedo.Viewer(e,t);d._cesiumWidget._creditContainer.style.display="none";d.scene._useBD=Freedo.defaultValue(r.batchDraw,false);if(d.scene._useBD&&Freedo.defined(r.batchDrawTargetFPS)){d.scene._maxTimeToBeUsedPerRender=1e3/r.batchDrawTargetFPS}u=Freedo.defaultValue(r.hasSkyBoxOnGround,true);l=Freedo.defaultValue(r.hasProvinceBoundaries,false);var h=(0,n.getFreedoXPath)();if(l){var v=new Freedo.GeoJsonDataSource;v.load(h+"Assets/Misc/china.topojson",{stroke:Freedo.Color.YELLOW,fill:new Freedo.Color(0,0,0,0),strokeWidth:5,markerSymbol:"?"}).then(function(e){var t=e._entityCollection;var r=t.values;t.suspendEvents();for(var n=0;n<r.length;n++){var i=r[n];i.polygon.distanceDisplayCondition=new Freedo.DistanceDisplayCondition(5,2e8)}t.resumeEvents()});d.dataSources.add(v)}d.camera.percentageChanged=1e-4;if(d.scene.globe){d.scene.globe.depthTestAgainstTerrain=true}d.scene.pickTranslucentDepth=true;if(d.scene.moon){d.scene.moon.show=false}if(d.scene.sun){d.scene.sun.show=false}d.extend(Freedo.viewerFreedoPModelInspectorMixin);d.cesium3DTilesInspector.setVisibility(false);d._cesiumWidget._supportsImageRenderingPixelated=Freedo.FeatureDetection.supportsImageRenderingPixelated();d._cesiumWidget._forceResize=true;if(Freedo.FeatureDetection.supportsImageRenderingPixelated()){var p=window.devicePixelRatio;while(p>=2){p/=2}d.resolutionScale=p}d.scene.requestRenderMode=true;d.scene.maximumRenderTimeChange=Infinity;d.scene.screenSpaceCameraController.enableCollisionDetection=false;if(u&&!c){d.scene.skyboxOnGround=new Freedo.SkyBox({sources:{positiveX:h+"Assets/Textures/SkyBoxOnGround/rightav9.jpg",negativeX:h+"Assets/Textures/SkyBoxOnGround/leftav9.jpg",positiveY:h+"Assets/Textures/SkyBoxOnGround/frontav9.jpg",negativeY:h+"Assets/Textures/SkyBoxOnGround/backav9.jpg",positiveZ:h+"Assets/Textures/SkyBoxOnGround/topav9.jpg",negativeZ:h+"Assets/Textures/SkyBoxOnGround/bottomav9.jpg"}})}if(c){d.scene._screenSpaceCameraController=new i.FdScreenSpaceCameraController(d.scene)}var y=d.canvas;y.addEventListener("keydown",function(e){var t=e.keyCode?e.keyCode:e.which;if(t===187){var r=d.cesium3DTilesInspector._container.style.visibility;if(r==="hidden"){d.cesium3DTilesInspector.setVisibility(true)}else{d.cesium3DTilesInspector.setVisibility(false)}}});return d}t.createDefaultViewer=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FdApp=undefined;var n=r(1);var i=u(n);var a=r(333);var o=r(124);var s=r(331);function u(e){return e&&e.__esModule?e:{default:e}}var l=function e(){(0,i.default)(this,e)};l.createDefaultViewer=a.createDefaultViewer;l.getFreedoXPath=o.getFreedoXPath;l.setSkyBox=s.setSkyBox;l.setSkyBoxOnGround=s.setSkyBoxOnGround;t.FdApp=l},function(e,t){e.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},function(e,t,r){var n=r(0);var i=r(335)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function e(t){return i(t)}})},function(e,t,r){r(336);e.exports=r(37).RegExp.escape},function(e,t,r){(function(t){!function(t){"use strict";var r=Object.prototype;var n=r.hasOwnProperty;var i;var a=typeof Symbol==="function"?Symbol:{};var o=a.iterator||"@@iterator";var s=a.asyncIterator||"@@asyncIterator";var u=a.toStringTag||"@@toStringTag";var l=typeof e==="object";var c=t.regeneratorRuntime;if(c){if(l){e.exports=c}return}c=t.regeneratorRuntime=l?e.exports:{};function f(e,t,r,n){var i=t&&t.prototype instanceof m?t:m;var a=Object.create(i.prototype);var o=new A(n||[]);a._invoke=S(e,r,o);return a}c.wrap=f;function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var h="suspendedStart";var v="suspendedYield";var p="executing";var _="completed";var y={};function m(){}function g(){}function F(){}var w={};w[o]=function(){return this};var b=Object.getPrototypeOf;var C=b&&b(b(O([])));if(C&&C!==r&&n.call(C,o)){w=C}var P=F.prototype=m.prototype=Object.create(w);g.prototype=P.constructor=F;F.constructor=g;F[u]=g.displayName="GeneratorFunction";function x(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}c.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===g||(t.displayName||t.name)==="GeneratorFunction":false};c.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,F)}else{e.__proto__=F;if(!(u in e)){e[u]="GeneratorFunction"}}e.prototype=Object.create(P);return e};c.awrap=function(e){return{__await:e}};function M(e){function r(t,i,a,o){var s=d(e[t],e,i);if(s.type==="throw"){o(s.arg)}else{var u=s.arg;var l=u.value;if(l&&typeof l==="object"&&n.call(l,"__await")){return Promise.resolve(l.__await).then(function(e){r("next",e,a,o)},function(e){r("throw",e,a,o)})}return Promise.resolve(l).then(function(e){u.value=e;a(u)},o)}}if(typeof t.process==="object"&&t.process.domain){r=t.process.domain.bind(r)}var i;function a(e,t){function n(){return new Promise(function(n,i){r(e,t,n,i)})}return i=i?i.then(n,n):n()}this._invoke=a}x(M.prototype);M.prototype[s]=function(){return this};c.AsyncIterator=M;c.async=function(e,t,r,n){var i=new M(f(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function S(e,t,r){var n=h;return function i(a,o){if(n===p){throw new Error("Generator is already running")}if(n===_){if(a==="throw"){throw o}return k()}r.method=a;r.arg=o;while(true){var s=r.delegate;if(s){var u=T(s,r);if(u){if(u===y)continue;return u}}if(r.method==="next"){r.sent=r._sent=r.arg}else if(r.method==="throw"){if(n===h){n=_;throw r.arg}r.dispatchException(r.arg)}else if(r.method==="return"){r.abrupt("return",r.arg)}n=p;var l=d(e,t,r);if(l.type==="normal"){n=r.done?_:v;if(l.arg===y){continue}return{value:l.arg,done:r.done}}else if(l.type==="throw"){n=_;r.method="throw";r.arg=l.arg}}}}function T(e,t){var r=e.iterator[t.method];if(r===i){t.delegate=null;if(t.method==="throw"){if(e.iterator.return){t.method="return";t.arg=i;T(e,t);if(t.method==="throw"){return y}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var n=d(r,e.iterator,t.arg);if(n.type==="throw"){t.method="throw";t.arg=n.arg;t.delegate=null;return y}var a=n.arg;if(!a){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return y}if(a.done){t[e.resultName]=a.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=i}}else{return a}t.delegate=null;return y}x(P);P[u]="Generator";P[o]=function(){return this};P.toString=function(){return"[object Generator]"};function E(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(E,this);this.reset(true)}c.keys=function(e){var t=[];for(var r in e){t.push(r)}t.reverse();return function r(){while(t.length){var n=t.pop();if(n in e){r.value=n;r.done=false;return r}}r.done=true;return r}};function O(e){if(e){var t=e[o];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var r=-1,a=function t(){while(++r<e.length){if(n.call(e,r)){t.value=e[r];t.done=false;return t}}t.value=i;t.done=true;return t};return a.next=a}}return{next:k}}c.values=O;function k(){return{value:i,done:true}}A.prototype={constructor:A,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=i;this.done=false;this.delegate=null;this.method="next";this.arg=i;this.tryEntries.forEach(D);if(!e){for(var t in this){if(t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))){this[t]=i}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(e){if(this.done){throw e}var t=this;function r(r,n){s.type="throw";s.arg=e;t.next=r;if(n){t.method="next";t.arg=i}return!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];var s=o.completion;if(o.tryLoc==="root"){return r("end")}if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc");var l=n.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}else if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else if(u){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}}else if(l){if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}if(a&&(e==="break"||e==="continue")&&a.tryLoc<=t&&t<=a.finallyLoc){a=null}var o=a?a.completion:{};o.type=e;o.arg=t;if(a){this.method="next";this.next=a.finallyLoc;return y}return this.complete(o)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);D(r);return y}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var i=n.arg;D(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:O(e),resultName:t,nextLoc:r};if(this.method==="next"){this.arg=i}return y}}}(typeof t==="object"?t:typeof window==="object"?window:typeof self==="object"?self:this)}).call(this,r(152))},function(e,t,r){var n=r(130);var i=r(56);var a=r(19);var o=r(3);var s=r(20);var u=r(66);var l=r(7);var c=l("iterator");var f=l("toStringTag");var d=u.Array;var h={CSSRuleList:true,CSSStyleDeclaration:false,CSSValueList:false,ClientRectList:false,DOMRectList:false,DOMStringList:false,DOMTokenList:true,DataTransferItemList:false,FileList:false,HTMLAllCollection:false,HTMLCollection:false,HTMLFormElement:false,HTMLSelectElement:false,MediaList:true,MimeTypeArray:false,NamedNodeMap:false,NodeList:true,PaintRequestList:false,Plugin:false,PluginArray:false,SVGLengthList:false,SVGNumberList:false,SVGPathSegList:false,SVGPointList:false,SVGStringList:false,SVGTransformList:false,SourceBufferList:false,StyleSheetList:true,TextTrackCueList:false,TextTrackList:false,TouchList:false};for(var v=i(h),p=0;p<v.length;p++){var _=v[p];var y=h[_];var m=o[_];var g=m&&m.prototype;var F;if(g){if(!g[c])s(g,c,d);if(!g[f])s(g,f,_);u[_]=d;if(y)for(F in n)if(!g[F])a(g,F,n[F],true)}}},function(e,t,r){var n=r(0);var i=r(129);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,r){var n=r(3);var i=r(0);var a=r(125);var o=[].slice;var s=/MSIE .\./.test(a);var u=function(e){return function(t,r){var n=arguments.length>2;var i=n?o.call(arguments,2):false;return e(n?function(){(typeof t=="function"?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*s,{setTimeout:u(n.setTimeout),setInterval:u(n.setInterval)})},function(e,t,r){"use strict";var n=r(0);var i=r(3);var a=r(37);var o=r(128)();var s=r(7)("observable");var u=r(15);var l=r(2);var c=r(51);var f=r(49);var d=r(20);var h=r(50);var v=h.RETURN;var p=function(e){return e==null?undefined:u(e)};var _=function(e){var t=e._c;if(t){e._c=undefined;t()}};var y=function(e){return e._o===undefined};var m=function(e){if(!y(e)){e._o=undefined;_(e)}};var g=function(e,t){l(e);this._c=undefined;this._o=e;e=new F(this);try{var r=t(e);var n=r;if(r!=null){if(typeof r.unsubscribe==="function")r=function(){n.unsubscribe()};else u(r);this._c=r}}catch(t){e.error(t);return}if(y(this))_(this)};g.prototype=f({},{unsubscribe:function e(){m(this)}});var F=function(e){this._s=e};F.prototype=f({},{next:function e(t){var r=this._s;if(!y(r)){var n=r._o;try{var i=p(n.next);if(i)return i.call(n,t)}catch(e){try{m(r)}finally{throw e}}}},error:function e(t){var r=this._s;if(y(r))throw t;var n=r._o;r._o=undefined;try{var i=p(n.error);if(!i)throw t;t=i.call(n,t)}catch(e){try{_(r)}finally{throw e}}_(r);return t},complete:function e(t){var r=this._s;if(!y(r)){var n=r._o;r._o=undefined;try{var i=p(n.complete);t=i?i.call(n,t):undefined}catch(e){try{_(r)}finally{throw e}}_(r);return t}}});var w=function e(t){c(this,w,"Observable","_f")._f=u(t)};f(w.prototype,{subscribe:function e(t){return new g(t,this._f)},forEach:function e(t){var r=this;return new(a.Promise||i.Promise)(function(e,n){u(t);var i=r.subscribe({next:function(e){try{return t(e)}catch(e){n(e);i.unsubscribe()}},error:n,complete:e})})}});f(w,{from:function e(t){var r=typeof this==="function"?this:w;var n=p(l(t)[s]);if(n){var i=l(n.call(t));return i.constructor===r?i:new r(function(e){return i.subscribe(e)})}return new r(function(e){var r=false;o(function(){if(!r){try{if(h(t,false,function(t){e.next(t);if(r)return v})===v)return}catch(t){if(r)throw t;e.error(t);return}e.complete()}});return function(){r=true}})},of:function e(){for(var t=0,r=arguments.length,n=new Array(r);t<r;)n[t]=arguments[t++];return new(typeof this==="function"?this:w)(function(e){var t=false;o(function(){if(!t){for(var r=0;r<n.length;++r){e.next(n[r]);if(t)return}e.complete()}});return function(){t=true}})}});d(w.prototype,s,function(){return this});n(n.G,{Observable:w});r(52)("Observable")},function(e,t,r){var n=r(0);var i=r(128)();var a=r(3).process;var o=r(27)(a)=="process";n(n.G,{asap:function e(t){var r=o&&a.domain;i(r?r.bind(t):t)}})},function(e,t,r){var n=r(41);var i=r(2);var a=r(15);var o=n.key;var s=n.set;n.exp({metadata:function e(t,r){return function e(n,u){s(t,r,(u!==undefined?i:a)(n),o(u))}}})},function(e,t,r){var n=r(41);var i=r(2);var a=n.has;var o=n.key;n.exp({hasOwnMetadata:function e(t,r){return a(t,i(r),arguments.length<3?undefined:o(arguments[2]))}})},function(e,t,r){var n=r(41);var i=r(2);var a=r(21);var o=n.has;var s=n.key;var u=function(e,t,r){var n=o(e,t,r);if(n)return true;var i=a(t);return i!==null?u(e,i,r):false};n.exp({hasMetadata:function e(t,r){return u(t,i(r),arguments.length<3?undefined:s(arguments[2]))}})},function(e,t,r){var n=r(41);var i=r(2);var a=n.keys;var o=n.key;n.exp({getOwnMetadataKeys:function e(t){return a(i(t),arguments.length<2?undefined:o(arguments[1]))}})},function(e,t,r){var n=r(41);var i=r(2);var a=n.get;var o=n.key;n.exp({getOwnMetadata:function e(t,r){return a(t,i(r),arguments.length<3?undefined:o(arguments[2]))}})},function(e,t,r){var n=r(186);var i=r(177);var a=r(41);var o=r(2);var s=r(21);var u=a.keys;var l=a.key;var c=function(e,t){var r=u(e,t);var a=s(e);if(a===null)return r;var o=c(a,t);return o.length?r.length?i(new n(r.concat(o))):o:r};a.exp({getMetadataKeys:function e(t){return c(o(t),arguments.length<2?undefined:l(arguments[1]))}})},function(e,t,r){var n=r(41);var i=r(2);var a=r(21);var o=n.has;var s=n.get;var u=n.key;var l=function(e,t,r){var n=o(e,t,r);if(n)return s(e,t,r);var i=a(t);return i!==null?l(e,i,r):undefined};n.exp({getMetadata:function e(t,r){return l(t,i(r),arguments.length<3?undefined:u(arguments[2]))}})},function(e,t,r){var n=r(41);var i=r(2);var a=n.key;var o=n.map;var s=n.store;n.exp({deleteMetadata:function e(t,r){var n=arguments.length<3?undefined:a(arguments[2]);var u=o(i(r),n,false);if(u===undefined||!u["delete"](t))return false;if(u.size)return true;var l=s.get(r);l["delete"](n);return!!l.size||s["delete"](r)}})},function(e,t,r){var n=r(41);var i=r(2);var a=n.key;var o=n.set;n.exp({defineMetadata:function e(t,r,n,s){o(t,r,i(n),a(s))}})},function(e,t,r){"use strict";var n=r(0);var i=r(127);var a=r(190);n(n.S,"Promise",{try:function(e){var t=i.f(this);var r=a(e);(r.e?t.reject:t.resolve)(r.v);return t.promise}})},function(e,t,r){"use strict";var n=r(0);var i=r(37);var a=r(3);var o=r(90);var s=r(189);n(n.P+n.R,"Promise",{finally:function(e){var t=o(this,i.Promise||a.Promise);var r=typeof e=="function";return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{signbit:function e(t){return(t=+t)!=t?t:t==0?1/t==Infinity:t>0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{umulh:function e(t,r){var n=65535;var i=+t;var a=+r;var o=i&n;var s=a&n;var u=i>>>16;var l=a>>>16;var c=(u*s>>>0)+(o*s>>>16);return u*l+(c>>>16)+((o*l>>>0)+(c&n)>>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{scale:r(176)})},function(e,t,r){var n=r(0);var i=Math.PI/180;n(n.S,"Math",{radians:function e(t){return t*i}})},function(e,t,r){var n=r(0);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,r){var n=r(0);n(n.S,"Math",{imulh:function e(t,r){var n=65535;var i=+t;var a=+r;var o=i&n;var s=a&n;var u=i>>16;var l=a>>16;var c=(u*s>>>0)+(o*s>>>16);return u*l+(c>>16)+((o*l>>>0)+(c&n)>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{isubh:function e(t,r,n,i){var a=t>>>0;var o=r>>>0;var s=n>>>0;return o-(i>>>0)-((~a&s|~(a^s)&a-s>>>0)>>>31)|0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{iaddh:function e(t,r,n,i){var a=t>>>0;var o=r>>>0;var s=n>>>0;return o+(i>>>0)+((a&s|(a|s)&~(a+s>>>0))>>>31)|0}})},function(e,t,r){var n=r(0);var i=r(176);var a=r(196);n(n.S,"Math",{fscale:function e(t,r,n,o,s){return a(i(t,r,n,o,s))}})},function(e,t,r){var n=r(0);var i=180/Math.PI;n(n.S,"Math",{degrees:function e(t){return t*i}})},function(e,t,r){var n=r(0);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,r){var n=r(0);n(n.S,"Math",{clamp:function e(t,r,n){return Math.min(n,Math.max(r,t))}})},function(e,t,r){var n=r(0);var i=r(27);n(n.S,"Error",{isError:function e(t){return i(t)==="Error"}})},function(e,t,r){var n=r(0);n(n.S,"System",{global:r(3)})},function(e,t,r){var n=r(0);n(n.G,{global:r(3)})},function(e,t,r){r(85)("WeakSet")},function(e,t,r){r(85)("WeakMap")},function(e,t,r){r(85)("Set")},function(e,t,r){r(85)("Map")},function(e,t,r){r(86)("WeakSet")},function(e,t,r){r(86)("WeakMap")},function(e,t,r){r(86)("Set")},function(e,t,r){r(86)("Map")},function(e,t,r){var n=r(0);n(n.P+n.R,"Set",{toJSON:r(178)("Set")})},function(e,t,r){var n=r(0);n(n.P+n.R,"Map",{toJSON:r(178)("Map")})},function(e,t,r){"use strict";var n=r(0);var i=r(12);var a=r(36);var o=r(21);var s=r(22).f;r(10)&&n(n.P+r(87),"Object",{__lookupSetter__:function e(t){var r=i(this);var n=a(t,true);var u;do{if(u=s(r,n))return u.set}while(r=o(r))}})},function(e,t,r){"use strict";var n=r(0);var i=r(12);var a=r(36);var o=r(21);var s=r(22).f;r(10)&&n(n.P+r(87),"Object",{__lookupGetter__:function e(t){var r=i(this);var n=a(t,true);var u;do{if(u=s(r,n))return u.get}while(r=o(r))}})},function(e,t,r){"use strict";var n=r(0);var i=r(12);var a=r(15);var o=r(9);r(10)&&n(n.P+r(87),"Object",{__defineSetter__:function e(t,r){o.f(i(this),t,{set:a(r),enumerable:true,configurable:true})}})},function(e,t,r){"use strict";var n=r(0);var i=r(12);var a=r(15);var o=r(9);r(10)&&n(n.P+r(87),"Object",{__defineGetter__:function e(t,r){o.f(i(this),t,{get:a(r),enumerable:true,configurable:true})}})},function(e,t,r){var n=r(0);var i=r(179)(true);n(n.S,"Object",{entries:function e(t){return i(t)}})},function(e,t,r){var n=r(0);var i=r(179)(false);n(n.S,"Object",{values:function e(t){return i(t)}})},function(e,t,r){var n=r(0);var i=r(182);var a=r(23);var o=r(22);var s=r(134);n(n.S,"Object",{getOwnPropertyDescriptors:function e(t){var r=a(t);var n=o.f;var u=i(r);var l={};var c=0;var f,d;while(u.length>c){d=n(r,f=u[c++]);if(d!==undefined)s(l,f,d)}return l}})},function(e,t,r){r(150)("observable")},function(e,t,r){r(150)("asyncIterator")},function(e,t,r){"use strict";var n=r(0);var i=r(35);var a=r(8);var o=r(94);var s=r(92);var u=RegExp.prototype;var l=function(e,t){this._r=e;this._s=t};r(138)(l,"RegExp String",function e(){var t=this._r.exec(this._s);return{value:t,done:t===null}});n(n.P,"String",{matchAll:function e(t){i(this);if(!o(t))throw TypeError(t+" is not a regexp!");var r=String(this);var n="flags"in u?String(t.flags):s.call(t);var c=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);c.lastIndex=a(t.lastIndex);return new l(c,r)}})},function(e,t,r){"use strict";r(67)("trimRight",function(e){return function t(){return e(this,2)}},"trimEnd")},function(e,t,r){"use strict";r(67)("trimLeft",function(e){return function t(){return e(this,1)}},"trimStart")},function(e,t,r){"use strict";var n=r(0);var i=r(180);var a=r(125);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padEnd:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,false)}})},function(e,t,r){"use strict";var n=r(0);var i=r(180);var a=r(125);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padStart:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,true)}})},function(e,t,r){"use strict";var n=r(0);var i=r(140)(true);n(n.P,"String",{at:function e(t){return i(this,t)}})},function(e,t,r){"use strict";var n=r(0);var i=r(181);var a=r(12);var o=r(8);var s=r(34);var u=r(132);n(n.P,"Array",{flatten:function e(){var t=arguments[0];var r=a(this);var n=o(r.length);var l=u(r,0);i(l,r,r,n,0,t===undefined?1:s(t));return l}});r(45)("flatten")},function(e,t,r){"use strict";var n=r(0);var i=r(181);var a=r(12);var o=r(8);var s=r(15);var u=r(132);n(n.P,"Array",{flatMap:function e(t){var r=a(this);var n,l;s(t);n=o(r.length);l=u(r,0);i(l,r,r,n,0,1,t,arguments[1]);return l}});r(45)("flatMap")},function(e,t,r){"use strict";var n=r(0);var i=r(97)(true);n(n.P,"Array",{includes:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});r(45)("includes")},function(e,t,r){var n=r(0);var i=r(146);if(i)n(n.S,"Reflect",{setPrototypeOf:function e(t,r){i.check(t,r);try{i.set(t,r);return true}catch(e){return false}}})},function(e,t,r){var n=r(9);var i=r(22);var a=r(21);var o=r(24);var s=r(0);var u=r(59);var l=r(2);var c=r(5);function f(e,t,r){var s=arguments.length<4?e:arguments[3];var d=i.f(l(e),t);var h,v;if(!d){if(c(v=a(e))){return f(v,t,r,s)}d=u(0)}if(o(d,"value")){if(d.writable===false||!c(s))return false;if(h=i.f(s,t)){if(h.get||h.set||h.writable===false)return false;h.value=r;n.f(s,t,h)}else n.f(s,t,u(0,r));return true}return d.set===undefined?false:(d.set.call(s,r),true)}s(s.S,"Reflect",{set:f})},function(e,t,r){var n=r(0);var i=r(2);var a=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function e(t){i(t);try{if(a)a(t);return true}catch(e){return false}}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{ownKeys:r(182)})},function(e,t,r){var n=r(0);var i=r(2);var a=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function e(t){i(t);return a?a(t):true}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{has:function e(t,r){return r in t}})},function(e,t,r){var n=r(0);var i=r(21);var a=r(2);n(n.S,"Reflect",{getPrototypeOf:function e(t){return i(a(t))}})},function(e,t,r){var n=r(22);var i=r(0);var a=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function e(t,r){return n.f(a(t),r)}})},function(e,t,r){var n=r(22);var i=r(21);var a=r(24);var o=r(0);var s=r(5);var u=r(2);function l(e,t){var r=arguments.length<3?e:arguments[2];var o,c;if(u(e)===r)return e[t];if(o=n.f(e,t))return a(o,"value")?o.value:o.get!==undefined?o.get.call(r):undefined;if(s(c=i(e)))return l(c,t,r)}o(o.S,"Reflect",{get:l})},function(e,t,r){"use strict";var n=r(0);var i=r(2);var a=function(e){this._t=i(e);this._i=0;var t=this._k=[];var r;for(r in e)t.push(r)};r(138)(a,"Object",function(){var e=this;var t=e._k;var r;do{if(e._i>=t.length)return{value:undefined,done:true}}while(!((r=t[e._i++])in e._t));return{value:r,done:false}});n(n.S,"Reflect",{enumerate:function e(t){return new a(t)}})},function(e,t,r){var n=r(0);var i=r(22).f;var a=r(2);n(n.S,"Reflect",{deleteProperty:function e(t,r){var n=i(a(t),r);return n&&!n.configurable?false:delete t[r]}})},function(e,t,r){var n=r(9);var i=r(0);var a=r(2);var o=r(36);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function e(t,r,i){a(t);r=o(r,true);a(i);try{n.f(t,r,i);return true}catch(e){return false}}})},function(e,t,r){var n=r(0);var i=r(54);var a=r(15);var o=r(2);var s=r(5);var u=r(4);var l=r(203);var c=(r(3).Reflect||{}).construct;var f=u(function(){function e(){}return!(c(function(){},[],e)instanceof e)});var d=!u(function(){c(function(){})});n(n.S+n.F*(f||d),"Reflect",{construct:function e(t,r){a(t);o(r);var n=arguments.length<3?t:a(arguments[2]);if(d&&!f)return c(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var u=[null];u.push.apply(u,r);return new(l.apply(t,u))}var h=n.prototype;var v=i(s(h)?h:Object.prototype);var p=Function.apply.call(t,v,r);return s(p)?p:v}})},function(e,t,r){var n=r(0);var i=r(15);var a=r(2);var o=(r(3).Reflect||{}).apply;var s=Function.apply;n(n.S+n.F*!r(4)(function(){o(function(){})}),"Reflect",{apply:function e(t,r,n){var u=i(t);var l=a(n);return o?o(u,r,l):s.call(u,r,l)}})},function(e,t,r){r(42)("Float64",8,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Float32",4,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Uint32",4,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Int32",4,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Uint16",2,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Int16",2,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Uint8",1,function(e){return function t(r,n,i){return e(this,r,n,i)}},true)},function(e,t,r){r(42)("Uint8",1,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){r(42)("Int8",1,function(e){return function t(r,n,i){return e(this,r,n,i)}})},function(e,t,r){var n=r(0);n(n.G+n.W+n.F*!r(88).ABV,{DataView:r(126).DataView})},function(e,t,r){"use strict";var n=r(0);var i=r(88);var a=r(126);var o=r(2);var s=r(55);var u=r(8);var l=r(5);var c=r(3).ArrayBuffer;var f=r(90);var d=a.ArrayBuffer;var h=a.DataView;var v=i.ABV&&c.isView;var p=d.prototype.slice;var _=i.VIEW;var y="ArrayBuffer";n(n.G+n.W+n.F*(c!==d),{ArrayBuffer:d});n(n.S+n.F*!i.CONSTR,y,{isView:function e(t){return v&&v(t)||l(t)&&_ in t}});n(n.P+n.U+n.F*r(4)(function(){return!new d(2).slice(1,undefined).byteLength}),y,{slice:function e(t,r){if(p!==undefined&&r===undefined)return p.call(o(this),t);var n=o(this).byteLength;var i=s(t,n);var a=s(r===undefined?n:r,n);var l=new(f(this,d))(u(a-i));var c=new h(this);var v=new h(l);var _=0;while(i<a){v.setUint8(_++,c.getUint8(i++))}return l}});r(52)(y)},function(e,t,r){"use strict";var n=r(184);var i=r(65);var a="WeakSet";r(89)(a,function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(i(this,a),t,true)}},n,false,true)},function(e,t,r){"use strict";var n=r(57);var i=r(3);var a=r(28);var o=r(74);var s=r(0);var u=r(5);var l=r(15);var c=r(51);var f=r(50);var d=r(90);var h=r(129).set;var v=r(128)();var p=r(127);var _=r(190);var y=r(189);var m="Promise";var g=i.TypeError;var F=i.process;var w=i[m];var b=o(F)=="process";var C=function(){};var P,x,M,S;var T=x=p.f;var E=!!function(){try{var e=w.resolve(1);var t=(e.constructor={})[r(7)("species")]=function(e){e(C,C)};return(b||typeof PromiseRejectionEvent=="function")&&e.then(C)instanceof t}catch(e){}}();var D=function(e){var t;return u(e)&&typeof(t=e.then)=="function"?t:false};var A=function(e,t){if(e._n)return;e._n=true;var r=e._c;v(function(){var n=e._v;var i=e._s==1;var a=0;var o=function(t){var r=i?t.ok:t.fail;var a=t.resolve;var o=t.reject;var s=t.domain;var u,l,c;try{if(r){if(!i){if(e._h==2)L(e);e._h=1}if(r===true)u=n;else{if(s)s.enter();u=r(n);if(s){s.exit();c=true}}if(u===t.promise){o(g("Promise-chain cycle"))}else if(l=D(u)){l.call(u,a,o)}else a(u)}else o(n)}catch(e){if(s&&!c)s.exit();o(e)}};while(r.length>a)o(r[a++]);e._c=[];e._n=false;if(t&&!e._h)O(e)})};var O=function(e){h.call(i,function(){var t=e._v;var r=k(e);var n,a,o;if(r){n=_(function(){if(b){F.emit("unhandledRejection",t,e)}else if(a=i.onunhandledrejection){a({promise:e,reason:t})}else if((o=i.console)&&o.error){o.error("Unhandled promise rejection",t)}});e._h=b||k(e)?2:1}e._a=undefined;if(r&&n.e)throw n.v})};var k=function(e){return e._h!==1&&(e._a||e._c).length===0};var L=function(e){h.call(i,function(){var t;if(b){F.emit("rejectionHandled",e)}else if(t=i.onrejectionhandled){t({promise:e,reason:e._v})}})};var I=function(e){var t=this;if(t._d)return;t._d=true;t=t._w||t;t._v=e;t._s=2;if(!t._a)t._a=t._c.slice();A(t,true)};var R=function(e){var t=this;var r;if(t._d)return;t._d=true;t=t._w||t;try{if(t===e)throw g("Promise can't be resolved itself");if(r=D(e)){v(function(){var n={_w:t,_d:false};try{r.call(e,a(R,n,1),a(I,n,1))}catch(e){I.call(n,e)}})}else{t._v=e;t._s=1;A(t,false)}}catch(e){I.call({_w:t,_d:false},e)}};if(!E){w=function e(t){c(this,w,m,"_h");l(t);P.call(this);try{t(a(R,this,1),a(I,this,1))}catch(e){I.call(this,e)}};P=function e(t){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false};P.prototype=r(49)(w.prototype,{then:function e(t,r){var n=T(d(this,w));n.ok=typeof t=="function"?t:true;n.fail=typeof r=="function"&&r;n.domain=b?F.domain:undefined;this._c.push(n);if(this._a)this._a.push(n);if(this._s)A(this,false);return n.promise},catch:function(e){return this.then(undefined,e)}});M=function(){var e=new P;this.promise=e;this.resolve=a(R,e,1);this.reject=a(I,e,1)};p.f=T=function(e){return e===w||e===S?new M(e):x(e)}}s(s.G+s.W+s.F*!E,{Promise:w});r(68)(w,m);r(52)(m);S=r(37)[m];s(s.S+s.F*!E,m,{reject:function e(t){var r=T(this);var n=r.reject;n(t);return r.promise}});s(s.S+s.F*(n||!E),m,{resolve:function e(t){return y(n&&this===S?w:this,t)}});s(s.S+s.F*!(E&&r(93)(function(e){w.all(e)["catch"](C)})),m,{all:function e(t){var r=this;var n=T(r);var i=n.resolve;var a=n.reject;var o=_(function(){var e=[];var n=0;var o=1;f(t,false,function(t){var s=n++;var u=false;e.push(undefined);o++;r.resolve(t).then(function(t){if(u)return;u=true;e[s]=t;--o||i(e)},a)});--o||i(e)});if(o.e)a(o.v);return n.promise},race:function e(t){var r=this;var n=T(r);var i=n.reject;var a=_(function(){f(t,false,function(e){r.resolve(e).then(n.resolve,i)})});if(a.e)i(a.v);return n.promise}})},function(e,t,r){r(91)("split",2,function(e,t,n){"use strict";var i=r(94);var a=n;var o=[].push;var s="split";var u="length";var l="lastIndex";if("abbc"[s](/(b)*/)[1]=="c"||"test"[s](/(?:)/,-1)[u]!=4||"ab"[s](/(?:ab)*/)[u]!=2||"."[s](/(.?)(.?)/)[u]!=4||"."[s](/()()/)[u]>1||""[s](/.?/)[u]){var c=/()??/.exec("")[1]===undefined;n=function(e,t){var r=String(this);if(e===undefined&&t===0)return[];if(!i(e))return a.call(r,e,t);var n=[];var s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":"");var f=0;var d=t===undefined?4294967295:t>>>0;var h=new RegExp(e.source,s+"g");var v,p,_,y,m;if(!c)v=new RegExp("^"+h.source+"$(?!\\s)",s);while(p=h.exec(r)){_=p.index+p[0][u];if(_>f){n.push(r.slice(f,p.index));if(!c&&p[u]>1)p[0].replace(v,function(){for(m=1;m<arguments[u]-2;m++)if(arguments[m]===undefined)p[m]=undefined});if(p[u]>1&&p.index<r[u])o.apply(n,p.slice(1));y=p[0][u];f=_;if(n[u]>=d)break}if(h[l]===p.index)h[l]++}if(f===r[u]){if(y||!h.test(""))n.push("")}else n.push(r.slice(f));return n[u]>d?n.slice(0,d):n}}else if("0"[s](undefined,0)[u]){n=function(e,t){return e===undefined&&t===0?[]:a.call(this,e,t)}}return[function r(i,a){var o=e(this);var s=i==undefined?undefined:i[t];return s!==undefined?s.call(i,o,a):n.call(String(o),i,a)},n]})},function(e,t,r){r(91)("search",1,function(e,t,r){return[function r(n){"use strict";var i=e(this);var a=n==undefined?undefined:n[t];return a!==undefined?a.call(n,i):new RegExp(n)[t](String(i))},r]})},function(e,t,r){r(91)("replace",2,function(e,t,r){return[function n(i,a){"use strict";var o=e(this);var s=i==undefined?undefined:i[t];return s!==undefined?s.call(i,o,a):r.call(String(o),i,a)},r]})},function(e,t,r){r(91)("match",1,function(e,t,r){return[function r(n){"use strict";var i=e(this);var a=n==undefined?undefined:n[t];return a!==undefined?a.call(n,i):new RegExp(n)[t](String(i))},r]})},function(e,t,r){"use strict";r(191);var n=r(2);var i=r(92);var a=r(10);var o="toString";var s=/./[o];var u=function(e){r(19)(RegExp.prototype,o,e,true)};if(r(4)(function(){return s.call({source:"a",flags:"b"})!="/a/b"})){u(function e(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?i.call(t):undefined)})}else if(s.name!=o){u(function e(){return s.call(this)})}},function(e,t,r){var n=r(3);var i=r(144);var a=r(9).f;var o=r(53).f;var s=r(94);var u=r(92);var l=n.RegExp;var c=l;var f=l.prototype;var d=/a/g;var h=/a/g;var v=new l(d)!==d;if(r(10)&&(!v||r(4)(function(){h[r(7)("match")]=false;return l(d)!=d||l(h)==h||l(d,"i")!="/a/i"}))){l=function e(t,r){var n=this instanceof l;var a=s(t);var o=r===undefined;return!n&&a&&t.constructor===l&&o?t:i(v?new c(a&&!o?t.source:t,r):c((a=t instanceof l)?t.source:t,a&&o?u.call(t):r),n?this:f,l)};var p=function(e){e in l||a(l,e,{configurable:true,get:function(){return c[e]},set:function(t){c[e]=t}})};for(var _=o(c),y=0;_.length>y;)p(_[y++]);f.constructor=l;l.prototype=f;r(19)(n,"RegExp",l)}r(52)("RegExp")},function(e,t,r){r(52)("Array")},function(e,t,r){"use strict";var n=r(0);var i=r(32)(6);var a="findIndex";var o=true;if(a in[])Array(1)[a](function(){o=false});n(n.P+n.F*o,"Array",{findIndex:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});r(45)(a)},function(e,t,r){"use strict";var n=r(0);var i=r(32)(5);var a="find";var o=true;if(a in[])Array(1)[a](function(){o=false});n(n.P+n.F*o,"Array",{find:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});r(45)(a)},function(e,t,r){var n=r(0);n(n.P,"Array",{fill:r(131)});r(45)("fill")},function(e,t,r){var n=r(0);n(n.P,"Array",{copyWithin:r(193)});r(45)("copyWithin")},function(e,t,r){"use strict";var n=r(0);var i=r(23);var a=r(34);var o=r(8);var s=[].lastIndexOf;var u=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(u||!r(26)(s)),"Array",{lastIndexOf:function e(t){if(u)return s.apply(this,arguments)||0;var r=i(this);var n=o(r.length);var l=n-1;if(arguments.length>1)l=Math.min(l,a(arguments[1]));if(l<0)l=n+l;for(;l>=0;l--)if(l in r)if(r[l]===t)return l||0;return-1}})},function(e,t,r){"use strict";var n=r(0);var i=r(97)(false);var a=[].indexOf;var o=!!a&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!r(26)(a)),"Array",{indexOf:function e(t){return o?a.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(e,t,r){"use strict";var n=r(0);var i=r(194);n(n.P+n.F*!r(26)([].reduceRight,true),"Array",{reduceRight:function e(t){return i(this,t,arguments.length,arguments[1],true)}})},function(e,t,r){"use strict";var n=r(0);var i=r(194);n(n.P+n.F*!r(26)([].reduce,true),"Array",{reduce:function e(t){return i(this,t,arguments.length,arguments[1],false)}})},function(e,t,r){"use strict";var n=r(0);var i=r(32)(4);n(n.P+n.F*!r(26)([].every,true),"Array",{every:function e(t){return i(this,t,arguments[1])}})},function(e,t,r){"use strict";var n=r(0);var i=r(32)(3);n(n.P+n.F*!r(26)([].some,true),"Array",{some:function e(t){return i(this,t,arguments[1])}})},function(e,t,r){"use strict";var n=r(0);var i=r(32)(2);n(n.P+n.F*!r(26)([].filter,true),"Array",{filter:function e(t){return i(this,t,arguments[1])}})},function(e,t,r){"use strict";var n=r(0);var i=r(32)(1);n(n.P+n.F*!r(26)([].map,true),"Array",{map:function e(t){return i(this,t,arguments[1])}})},function(e,t,r){var n=r(5);var i=r(95);var a=r(7)("species");e.exports=function(e){var t;if(i(e)){t=e.constructor;if(typeof t=="function"&&(t===Array||i(t.prototype)))t=undefined;if(n(t)){t=t[a];if(t===null)t=undefined}}return t===undefined?Array:t}},function(e,t,r){"use strict";var n=r(0);var i=r(32)(0);var a=r(26)([].forEach,true);n(n.P+n.F*!a,"Array",{forEach:function e(t){return i(this,t,arguments[1])}})},function(e,t,r){"use strict";var n=r(0);var i=r(15);var a=r(12);var o=r(4);var s=[].sort;var u=[1,2,3];n(n.P+n.F*(o(function(){u.sort(undefined)})||!o(function(){u.sort(null)})||!r(26)(s)),"Array",{sort:function e(t){return t===undefined?s.call(a(this)):s.call(a(this),i(t))}})},function(e,t,r){"use strict";var n=r(0);var i=r(147);var a=r(27);var o=r(55);var s=r(8);var u=[].slice;n(n.P+n.F*r(4)(function(){if(i)u.call(i)}),"Array",{slice:function e(t,r){var n=s(this.length);var i=a(this);r=r===undefined?n:r;if(i=="Array")return u.call(this,t,r);var l=o(t,n);var c=o(r,n);var f=s(c-l);var d=new Array(f);var h=0;for(;h<f;h++)d[h]=i=="String"?this.charAt(l+h):this[l+h];return d}})},function(e,t,r){"use strict";var n=r(0);var i=r(23);var a=[].join;n(n.P+n.F*(r(76)!=Object||!r(26)(a)),"Array",{join:function e(t){return a.call(i(this),t===undefined?",":t)}})},function(e,t,r){"use strict";var n=r(0);var i=r(134);n(n.S+n.F*r(4)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function e(){var t=0;var r=arguments.length;var n=new(typeof this=="function"?this:Array)(r);while(r>t)i(n,t,arguments[t++]);n.length=r;return n}})},function(e,t,r){"use strict";var n=r(28);var i=r(0);var a=r(12);var o=r(195);var s=r(135);var u=r(8);var l=r(134);var c=r(133);i(i.S+i.F*!r(93)(function(e){Array.from(e)}),"Array",{from:function e(t){var r=a(t);var i=typeof this=="function"?this:Array;var f=arguments.length;var d=f>1?arguments[1]:undefined;var h=d!==undefined;var v=0;var p=c(r);var _,y,m,g;if(h)d=n(d,f>2?arguments[2]:undefined,2);if(p!=undefined&&!(i==Array&&s(p))){for(g=p.call(r),y=new i;!(m=g.next()).done;v++){l(y,v,h?o(g,d,[m.value,v],true):m.value)}}else{_=u(r.length);for(y=new i(_);_>v;v++){l(y,v,h?d(r[v],v):r[v])}}y.length=v;return y}})},function(e,t,r){var n=r(0);n(n.S,"Array",{isArray:r(95)})},function(e,t,r){"use strict";var n=r(2);var i=r(36);var a="number";e.exports=function(e){if(e!=="string"&&e!==a&&e!=="default")throw TypeError("Incorrect hint");return i(n(this),e!=a)}},function(e,t,r){var n=r(7)("toPrimitive");var i=Date.prototype;if(!(n in i))r(20)(i,n,r(452))},function(e,t,r){var n=Date.prototype;var i="Invalid Date";var a="toString";var o=n[a];var s=n.getTime;if(new Date(NaN)+""!=i){r(19)(n,a,function e(){var t=s.call(this);return t===t?o.call(this):i})}},function(e,t,r){"use strict";var n=r(4);var i=Date.prototype.getTime;var a=Date.prototype.toISOString;var o=function(e){return e>9?e:"0"+e};e.exports=n(function(){return a.call(new Date(-5e13-1))!="0385-07-25T07:06:39.999Z"})||!n(function(){a.call(new Date(NaN))})?function e(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this;var r=t.getUTCFullYear();var n=t.getUTCMilliseconds();var a=r<0?"-":r>9999?"+":"";return a+("00000"+Math.abs(r)).slice(a?-6:-4)+"-"+o(t.getUTCMonth()+1)+"-"+o(t.getUTCDate())+"T"+o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:a},function(e,t,r){var n=r(0);var i=r(455);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,r){"use strict";var n=r(0);var i=r(12);var a=r(36);n(n.P+n.F*r(4)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}),"Date",{toJSON:function e(t){var r=i(this);var n=a(r);return typeof n=="number"&&!isFinite(n)?null:r.toISOString()}})},function(e,t,r){var n=r(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,r){"use strict";r(18)("sup",function(e){return function t(){return e(this,"sup","","")}})},function(e,t,r){"use strict";r(18)("sub",function(e){return function t(){return e(this,"sub","","")}})},function(e,t,r){"use strict";r(18)("strike",function(e){return function t(){return e(this,"strike","","")}})},function(e,t,r){"use strict";r(18)("small",function(e){return function t(){return e(this,"small","","")}})},function(e,t,r){"use strict";r(18)("link",function(e){return function t(r){return e(this,"a","href",r)}})},function(e,t,r){"use strict";r(18)("italics",function(e){return function t(){return e(this,"i","","")}})},function(e,t,r){"use strict";r(18)("fontsize",function(e){return function t(r){return e(this,"font","size",r)}})},function(e,t,r){"use strict";r(18)("fontcolor",function(e){return function t(r){return e(this,"font","color",r)}})},function(e,t,r){"use strict";r(18)("fixed",function(e){return function t(){return e(this,"tt","","")}})},function(e,t,r){"use strict";r(18)("bold",function(e){return function t(){return e(this,"b","","")}})},function(e,t,r){"use strict";r(18)("blink",function(e){return function t(){return e(this,"blink","","")}})},function(e,t,r){"use strict";r(18)("big",function(e){return function t(){return e(this,"big","","")}})},function(e,t,r){"use strict";r(18)("anchor",function(e){return function t(r){return e(this,"a","name",r)}})},function(e,t,r){"use strict";var n=r(0);var i=r(8);var a=r(137);var o="startsWith";var s=""[o];n(n.P+n.F*r(136)(o),"String",{startsWith:function e(t){var r=a(this,t,o);var n=i(Math.min(arguments.length>1?arguments[1]:undefined,r.length));var u=String(t);return s?s.call(r,u,n):r.slice(n,n+u.length)===u}})},function(e,t,r){var n=r(0);n(n.P,"String",{repeat:r(143)})},function(e,t,r){"use strict";var n=r(0);var i=r(137);var a="includes";n(n.P+n.F*r(136)(a),"String",{includes:function e(t){return!!~i(this,t,a).indexOf(t,arguments.length>1?arguments[1]:undefined)}})},function(e,t,r){"use strict";var n=r(0);var i=r(8);var a=r(137);var o="endsWith";var s=""[o];n(n.P+n.F*r(136)(o),"String",{endsWith:function e(t){var r=a(this,t,o);var n=arguments.length>1?arguments[1]:undefined;var u=i(r.length);var l=n===undefined?u:Math.min(i(n),u);var c=String(t);return s?s.call(r,c,l):r.slice(l-c.length,l)===c}})},function(e,t,r){"use strict";var n=r(0);var i=r(140)(false);n(n.P,"String",{codePointAt:function e(t){return i(this,t)}})},function(e,t,r){"use strict";var n=r(140)(true);r(139)(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t;var t=this._i;var r;if(t>=e.length)return{value:undefined,done:true};r=n(e,t);this._i+=r.length;return{value:r,done:false}})},function(e,t,r){"use strict";r(67)("trim",function(e){return function t(){return e(this,3)}})},function(e,t,r){var n=r(0);var i=r(23);var a=r(8);n(n.S,"String",{raw:function e(t){var r=i(t.raw);var n=a(r.length);var o=arguments.length;var s=[];var u=0;while(n>u){s.push(String(r[u++]));if(u<o)s.push(String(arguments[u]))}return s.join("")}})},function(e,t,r){var n=r(0);var i=r(55);var a=String.fromCharCode;var o=String.fromCodePoint;n(n.S+n.F*(!!o&&o.length!=1),"String",{fromCodePoint:function e(t){var r=[];var n=arguments.length;var o=0;var s;while(n>o){s=+arguments[o++];if(i(s,1114111)!==s)throw RangeError(s+" is not a valid code point");r.push(s<65536?a(s):a(((s-=65536)>>10)+55296,s%1024+56320))}return r.join("")}})},function(e,t,r){var n=r(0);n(n.S,"Math",{trunc:function e(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(e,t,r){var n=r(0);var i=r(141);var a=Math.exp;n(n.S,"Math",{tanh:function e(t){var r=i(t=+t);var n=i(-t);return r==Infinity?1:n==Infinity?-1:(r-n)/(a(t)+a(-t))}})},function(e,t,r){var n=r(0);var i=r(141);var a=Math.exp;n(n.S+n.F*r(4)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function e(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{sign:r(142)})},function(e,t,r){var n=r(0);n(n.S,"Math",{log2:function e(t){return Math.log(t)/Math.LN2}})},function(e,t,r){var n=r(0);n(n.S,"Math",{log1p:r(197)})},function(e,t,r){var n=r(0);n(n.S,"Math",{log10:function e(t){return Math.log(t)*Math.LOG10E}})},function(e,t,r){var n=r(0);var i=Math.imul;n(n.S+n.F*r(4)(function(){return i(4294967295,5)!=-5||i.length!=2}),"Math",{imul:function e(t,r){var n=65535;var i=+t;var a=+r;var o=n&i;var s=n&a;return 0|o*s+((n&i>>>16)*s+o*(n&a>>>16)<<16>>>0)}})},function(e,t,r){var n=r(0);var i=Math.abs;n(n.S,"Math",{hypot:function e(t,r){var n=0;var a=0;var o=arguments.length;var s=0;var u,l;while(a<o){u=i(arguments[a++]);if(s<u){l=s/u;n=n*l*l+1;s=u}else if(u>0){l=u/s;n+=l*l}else n+=u}return s===Infinity?Infinity:s*Math.sqrt(n)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{fround:r(196)})},function(e,t,r){var n=r(0);var i=r(141);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,r){var n=r(0);var i=Math.exp;n(n.S,"Math",{cosh:function e(t){return(i(t=+t)+i(-t))/2}})},function(e,t,r){var n=r(0);n(n.S,"Math",{clz32:function e(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(e,t,r){var n=r(0);var i=r(142);n(n.S,"Math",{cbrt:function e(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(e,t,r){var n=r(0);var i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function e(t){return(t=+t)==0?t:Math.log((1+t)/(1-t))/2}})},function(e,t,r){var n=r(0);var i=Math.asinh;function a(e){return!isFinite(e=+e)||e==0?e:e<0?-a(-e):Math.log(e+Math.sqrt(e*e+1))}n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:a})},function(e,t,r){var n=r(0);var i=r(197);var a=Math.sqrt;var o=Math.acosh;n(n.S+n.F*!(o&&Math.floor(o(Number.MAX_VALUE))==710&&o(Infinity)==Infinity),"Math",{acosh:function e(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+a(t-1)*a(t+1))}})},function(e,t,r){var n=r(0);var i=r(201);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,r){var n=r(0);var i=r(200);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,r){var n=r(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,r){var n=r(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){var n=r(0);var i=r(198);var a=Math.abs;n(n.S,"Number",{isSafeInteger:function e(t){return i(t)&&a(t)<=9007199254740991}})},function(e,t,r){var n=r(0);n(n.S,"Number",{isNaN:function e(t){return t!=t}})},function(e,t,r){var n=r(0);n(n.S,"Number",{isInteger:r(198)})},function(e,t,r){var n=r(0);var i=r(3).isFinite;n(n.S,"Number",{isFinite:function e(t){return typeof t=="number"&&i(t)}})},function(e,t,r){var n=r(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,r){"use strict";var n=r(0);var i=r(4);var a=r(199);var o=1..toPrecision;n(n.P+n.F*(i(function(){return o.call(1,undefined)!=="1"})||!i(function(){o.call({})})),"Number",{toPrecision:function e(t){var r=a(this,"Number#toPrecision: incorrect invocation!");return t===undefined?o.call(r):o.call(r,t)}})},function(e,t,r){"use strict";var n=r(0);var i=r(34);var a=r(199);var o=r(143);var s=1..toFixed;var u=Math.floor;var l=[0,0,0,0,0,0];var c="Number.toFixed: incorrect invocation!";var f="0";var d=function(e,t){var r=-1;var n=t;while(++r<6){n+=e*l[r];l[r]=n%1e7;n=u(n/1e7)}};var h=function(e){var t=6;var r=0;while(--t>=0){r+=l[t];l[t]=u(r/e);r=r%e*1e7}};var v=function(){var e=6;var t="";while(--e>=0){if(t!==""||e===0||l[e]!==0){var r=String(l[e]);t=t===""?r:t+o.call(f,7-r.length)+r}}return t};var p=function(e,t,r){return t===0?r:t%2===1?p(e,t-1,r*e):p(e*e,t/2,r)};var _=function(e){var t=0;var r=e;while(r>=4096){t+=12;r/=4096}while(r>=2){t+=1;r/=2}return t};n(n.P+n.F*(!!s&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(0xde0b6b3a7640080).toFixed(0)!=="1000000000000000128")||!r(4)(function(){s.call({})})),"Number",{toFixed:function e(t){var r=a(this,c);var n=i(t);var s="";var u=f;var l,y,m,g;if(n<0||n>20)throw RangeError(c);if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return String(r);if(r<0){s="-";r=-r}if(r>1e-21){l=_(r*p(2,69,1))-69;y=l<0?r*p(2,-l,1):r/p(2,l,1);y*=4503599627370496;l=52-l;if(l>0){d(0,y);m=n;while(m>=7){d(1e7,0);m-=7}d(p(10,m,1),0);m=l-1;while(m>=23){h(1<<23);m-=23}h(1<<m);d(1,1);h(2);u=v()}else{d(0,y);d(1<<-l,0);u=v()+o.call(f,n)}}if(n>0){g=u.length;u=s+(g<=n?"0."+o.call(f,n-g)+u:u.slice(0,g-n)+"."+u.slice(g-n))}else{u=s+u}return u}})},function(e,t,r){"use strict";var n=r(3);var i=r(24);var a=r(27);var o=r(144);var s=r(36);var u=r(4);var l=r(53).f;var c=r(22).f;var f=r(9).f;var d=r(67).trim;var h="Number";var v=n[h];var p=v;var _=v.prototype;var y=a(r(54)(_))==h;var m="trim"in String.prototype;var g=function(e){var t=s(e,false);if(typeof t=="string"&&t.length>2){t=m?t.trim():d(t,3);var r=t.charCodeAt(0);var n,i,a;if(r===43||r===45){n=t.charCodeAt(2);if(n===88||n===120)return NaN}else if(r===48){switch(t.charCodeAt(1)){case 66:case 98:i=2;a=49;break;case 79:case 111:i=8;a=55;break;default:return+t}for(var o=t.slice(2),u=0,l=o.length,c;u<l;u++){c=o.charCodeAt(u);if(c<48||c>a)return NaN}return parseInt(o,i)}}return+t};if(!v(" 0o1")||!v("0b1")||v("+0x1")){v=function e(t){var r=arguments.length<1?0:t;var n=this;return n instanceof v&&(y?u(function(){_.valueOf.call(n)}):a(n)!=h)?o(new p(g(r)),n,v):g(r)};for(var F=r(10)?l(p):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),w=0,b;F.length>w;w++){if(i(p,b=F[w])&&!i(v,b)){f(v,b,c(p,b))}}v.prototype=_;_.constructor=v;r(19)(n,h,v)}},function(e,t,r){var n=r(0);var i=r(200);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},function(e,t,r){var n=r(0);var i=r(201);n(n.G+n.F*(parseInt!=i),{parseInt:i})},function(e,t,r){"use strict";var n=r(5);var i=r(21);var a=r(7)("hasInstance");var o=Function.prototype;if(!(a in o))r(9).f(o,a,{value:function(e){if(typeof this!="function"||!n(e))return false;if(!n(this.prototype))return e instanceof this;while(e=i(e))if(this.prototype===e)return true;return false}})},function(e,t,r){var n=r(9).f;var i=Function.prototype;var a=/^\s*function ([^ (]*)/;var o="name";o in i||r(10)&&n(i,o,{configurable:true,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},function(e,t,r){var n=r(0);n(n.P,"Function",{bind:r(203)})},function(e,t,r){"use strict";var n=r(74);var i={};i[r(7)("toStringTag")]="z";if(i+""!="[object z]"){r(19)(Object.prototype,"toString",function e(){return"[object "+n(this)+"]"},true)}},function(e,t,r){var n=r(0);n(n.S,"Object",{setPrototypeOf:r(146).set})},function(e,t){e.exports=Object.is||function e(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r}},function(e,t,r){var n=r(0);n(n.S,"Object",{is:r(517)})},function(e,t,r){var n=r(0);n(n.S+n.F,"Object",{assign:r(204)})},function(e,t,r){var n=r(5);r(33)("isExtensible",function(e){return function t(r){return n(r)?e?e(r):true:false}})},function(e,t,r){var n=r(5);r(33)("isSealed",function(e){return function t(r){return n(r)?e?e(r):false:true}})},function(e,t,r){var n=r(5);r(33)("isFrozen",function(e){return function t(r){return n(r)?e?e(r):false:true}})},function(e,t,r){var n=r(5);var i=r(46).onFreeze;r(33)("preventExtensions",function(e){return function t(r){return e&&n(r)?e(i(r)):r}})},function(e,t,r){var n=r(5);var i=r(46).onFreeze;r(33)("seal",function(e){return function t(r){return e&&n(r)?e(i(r)):r}})},function(e,t,r){var n=r(5);var i=r(46).onFreeze;r(33)("freeze",function(e){return function t(r){return e&&n(r)?e(i(r)):r}})},function(e,t,r){r(33)("getOwnPropertyNames",function(){return r(205).f})},function(e,t,r){var n=r(12);var i=r(56);r(33)("keys",function(){return function e(t){return i(n(t))}})},function(e,t,r){var n=r(12);var i=r(21);r(33)("getPrototypeOf",function(){return function e(t){return i(n(t))}})},function(e,t,r){var n=r(23);var i=r(22).f;r(33)("getOwnPropertyDescriptor",function(){return function e(t,r){return i(n(t),r)}})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperties:r(206)})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperty:r(9).f})},function(e,t,r){var n=r(0);n(n.S,"Object",{create:r(54)})},function(e,t,r){var n=r(56);var i=r(96);var a=r(75);e.exports=function(e){var t=n(e);var r=i.f;if(r){var o=r(e);var s=a.f;var u=0;var l;while(o.length>u)if(s.call(e,l=o[u++]))t.push(l)}return t}},function(e,t,r){"use strict";var n=r(3);var i=r(24);var a=r(10);var o=r(0);var s=r(19);var u=r(46).KEY;var l=r(4);var c=r(98);var f=r(68);var d=r(58);var h=r(7);var v=r(208);var p=r(150);var _=r(533);var y=r(95);var m=r(2);var g=r(5);var F=r(23);var w=r(36);var b=r(59);var C=r(54);var P=r(205);var x=r(22);var M=r(9);var S=r(56);var T=x.f;var E=M.f;var D=P.f;var A=n.Symbol;var O=n.JSON;var k=O&&O.stringify;var L="prototype";var I=h("_hidden");var R=h("toPrimitive");var N={}.propertyIsEnumerable;var B=c("symbol-registry");var j=c("symbols");var G=c("op-symbols");var H=Object[L];var V=typeof A=="function";var X=n.QObject;var Y=!X||!X[L]||!X[L].findChild;var z=a&&l(function(){return C(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=T(H,t);if(n)delete H[t];E(e,t,r);if(n&&e!==H)E(H,t,n)}:E;var Z=function(e){var t=j[e]=C(A[L]);t._k=e;return t};var U=V&&typeof A.iterator=="symbol"?function(e){return typeof e=="symbol"}:function(e){return e instanceof A};var W=function e(t,r,n){if(t===H)W(G,r,n);m(t);r=w(r,true);m(n);if(i(j,r)){if(!n.enumerable){if(!i(t,I))E(t,I,b(1,{}));t[I][r]=true}else{if(i(t,I)&&t[I][r])t[I][r]=false;n=C(n,{enumerable:b(0,false)})}return z(t,r,n)}return E(t,r,n)};var q=function e(t,r){m(t);var n=_(r=F(r));var i=0;var a=n.length;var o;while(a>i)W(t,o=n[i++],r[o]);return t};var Q=function e(t,r){return r===undefined?C(t):q(C(t),r)};var K=function e(t){var r=N.call(this,t=w(t,true));if(this===H&&i(j,t)&&!i(G,t))return false;return r||!i(this,t)||!i(j,t)||i(this,I)&&this[I][t]?r:true};var J=function e(t,r){t=F(t);r=w(r,true);if(t===H&&i(j,r)&&!i(G,r))return;var n=T(t,r);if(n&&i(j,r)&&!(i(t,I)&&t[I][r]))n.enumerable=true;return n};var $=function e(t){var r=D(F(t));var n=[];var a=0;var o;while(r.length>a){if(!i(j,o=r[a++])&&o!=I&&o!=u)n.push(o)}return n};var ee=function e(t){var r=t===H;var n=D(r?G:F(t));var a=[];var o=0;var s;while(n.length>o){if(i(j,s=n[o++])&&(r?i(H,s):true))a.push(j[s])}return a};if(!V){A=function e(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:undefined);var r=function(e){if(this===H)r.call(G,e);if(i(this,I)&&i(this[I],t))this[I][t]=false;z(this,t,b(1,e))};if(a&&Y)z(H,t,{configurable:true,set:r});return Z(t)};s(A[L],"toString",function e(){return this._k});x.f=J;M.f=W;r(53).f=P.f=$;r(75).f=K;r(96).f=ee;if(a&&!r(57)){s(H,"propertyIsEnumerable",K,true)}v.f=function(e){return Z(h(e))}}o(o.G+o.W+o.F*!V,{Symbol:A});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;te.length>re;)h(te[re++]);for(var ne=S(h.store),ie=0;ne.length>ie;)p(ne[ie++]);o(o.S+o.F*!V,"Symbol",{for:function(e){return i(B,e+="")?B[e]:B[e]=A(e)},keyFor:function e(t){if(!U(t))throw TypeError(t+" is not a symbol!");for(var r in B)if(B[r]===t)return r},useSetter:function(){Y=true},useSimple:function(){Y=false}});o(o.S+o.F*!V,"Object",{create:Q,defineProperty:W,defineProperties:q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:ee});O&&o(o.S+o.F*(!V||l(function(){var e=A();return k([e])!="[null]"||k({a:e})!="{}"||k(Object(e))!="{}"})),"JSON",{stringify:function e(t){var r=[t];var n=1;var i,a;while(arguments.length>n)r.push(arguments[n++]);a=i=r[1];if(!g(i)&&t===undefined||U(t))return;if(!y(i))i=function(e,t){if(typeof a=="function")t=a.call(this,e,t);if(!U(t))return t};r[1]=i;return k.apply(O,r)}});A[L][R]||r(20)(A[L],R,A[L].valueOf);f(A,"Symbol");f(Math,"Math",true);f(n.JSON,"JSON",true)},function(e,t,r){r(534);r(532);r(531);r(530);r(529);r(528);r(527);r(526);r(525);r(524);r(523);r(522);r(521);r(520);r(519);r(518);r(516);r(515);r(514);r(513);r(512);r(511);r(510);r(509);r(508);r(507);r(506);r(505);r(504);r(503);r(502);r(501);r(500);r(499);r(498);r(497);r(496);r(495);r(494);r(493);r(492);r(491);r(490);r(489);r(488);r(487);r(486);r(485);r(484);r(483);r(482);r(481);r(480);r(479);r(478);r(477);r(476);r(475);r(474);r(473);r(472);r(471);r(470);r(469);r(468);r(467);r(466);r(465);r(464);r(463);r(462);r(461);r(460);r(459);r(458);r(457);r(456);r(454);r(453);r(451);r(450);r(449);r(448);r(447);r(446);r(445);r(443);r(442);r(441);r(440);r(439);r(438);r(437);r(436);r(435);r(434);r(433);r(432);r(431);r(130);r(430);r(429);r(191);r(428);r(427);r(426);r(425);r(424);r(188);r(186);r(185);r(423);r(422);r(421);r(420);r(419);r(418);r(417);r(416);r(415);r(414);r(413);r(412);r(411);r(410);r(409);r(408);r(407);r(406);r(405);r(404);r(403);r(402);r(401);r(400);r(399);r(398);r(397);r(396);r(395);r(394);r(393);r(392);r(391);r(390);r(389);r(388);r(387);r(386);r(385);r(384);r(383);r(382);r(381);r(380);r(379);r(378);r(377);r(376);r(375);r(374);r(373);r(372);r(371);r(370);r(369);r(368);r(367);r(366);r(365);r(364);r(363);r(362);r(361);r(360);r(359);r(358);r(357);r(356);r(355);r(354);r(353);r(352);r(351);r(350);r(349);r(348);r(347);r(346);r(345);r(344);r(343);r(342);r(341);r(340);r(339);e.exports=r(37)},function(e,t,r){"use strict";(function(e){r(535);r(338);r(337);if(e._babelPolyfill){throw new Error("only one instance of babel-polyfill is allowed")}e._babelPolyfill=true;var t="defineProperty";function n(e,r,n){e[r]||Object[t](e,r,{writable:true,configurable:true,value:n})}n(String.prototype,"padLeft","".padStart);n(String.prototype,"padRight","".padEnd);"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&n(Array,e,Function.call.bind([][e]))})}).call(this,r(152))},function(e,t,r){"use strict";r(536);var n=r(334);var i=r(11);var a=r(328);var o=r(313);var s=r(262);var u=r(232);var l=r(229);var c=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};if(typeof c.Freedo==="undefined"){c.Freedo={};console.warn("You should include freedo.js first! 你需要首先引用freedo.js，再使用freedox.js库！")}window.FreedoX=c.Freedo;FreedoX.FdApp=n.FdApp;FreedoX.FdWidgets=u.FdWidgets;FreedoX.FdMisc=i.FdMisc;FreedoX.FdCamera=a.FdCamera;FreedoX.FdMicroApp=o.FdMicroApp;FreedoX.FdTools=s.FdTools;FreedoX.FdServer=l.FdServer}]);