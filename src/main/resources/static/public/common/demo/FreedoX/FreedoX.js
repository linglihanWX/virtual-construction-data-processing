!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=537)}([function(e,t,r){var n=r(3),i=r(37),o=r(20),a=r(19),s=r(28),c=function(e,t,r){var u,l,h,d,p=e&c.F,f=e&c.G,v=e&c.S,_=e&c.P,y=e&c.B,m=f?n:v?n[t]||(n[t]={}):(n[t]||{}).prototype,g=f?i:i[t]||(i[t]={}),F=g.prototype||(g.prototype={});for(u in f&&(r=t),r)h=((l=!p&&m&&void 0!==m[u])?m:r)[u],d=y&&l?s(h,n):_&&"function"==typeof h?s(Function.call,h):h,m&&a(m,u,h,e&c.U),g[u]!=h&&o(g,u,d),_&&F[u]!=h&&(F[u]=h)};n.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){var n=r(5);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(173),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){var n=r(98)("wks"),i=r(58),o=r(3).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){var n=r(34),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(2),i=r(209),o=r(36),a=Object.defineProperty;t.f=r(10)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){e.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdMisc=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(330),s=r(175);var c=function e(){(0,o.default)(this,e)};c.FdGeometric=a.FdGeometric,c.FdMath=s.FdMath;var u=r(123);void 0===window.mobx&&(window.mobx=u),t.FdMisc=c},function(e,t,r){var n=r(35);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(111)("wks"),i=r(80),o=r(16).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t){var r=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=r)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(16),i=r(14),o=r(48),a=r(44),s=r(47),c=function(e,t,r){var u,l,h,d=e&c.F,p=e&c.G,f=e&c.S,v=e&c.P,_=e&c.B,y=e&c.W,m=p?i:i[t]||(i[t]={}),g=m.prototype,F=p?n:f?n[t]:(n[t]||{}).prototype;for(u in p&&(r=t),r)(l=!d&&F&&void 0!==F[u])&&s(m,u)||(h=l?F[u]:r[u],m[u]=p&&"function"!=typeof F[u]?r[u]:_&&l?o(h,n):y&&F[u]==h?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):v&&"function"==typeof h?o(Function.call,h):h,v&&((m.virtual||(m.virtual={}))[u]=h,e&c.R&&g&&!g[u]&&a(g,u,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,r){var n=r(0),i=r(4),o=r(35),a=/"/g,s=function(e,t,r,n){var i=String(o(e)),s="<"+t;return""!==r&&(s+=" "+r+'="'+String(n).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(s),n(n.P+n.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)}},function(e,t,r){var n=r(3),i=r(20),o=r(24),a=r(58)("src"),s=Function.toString,c=(""+s).split("toString");r(37).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var u="function"==typeof r;u&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(u&&(o(r,a)||i(r,a,e[t]?""+e[t]:c.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,r){var n=r(9),i=r(59);e.exports=r(10)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(24),i=r(12),o=r(149)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(75),i=r(59),o=r(23),a=r(36),s=r(24),c=r(209),u=Object.getOwnPropertyDescriptor;t.f=r(10)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(76),i=r(35);e.exports=function(e){return n(i(e))}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPolylineEditor=void 0;var n=s(r(1)),i=s(r(6)),o=r(11),a=r(172);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._polylines={},this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._curGuid=void 0,this._startPoint=void 0,this._tempLine=void 0,this._tempPoint={},this._startCapture=!1,this._bKeydown=!1,this._lineWidth=2,this._autoClose=!0,this._autoDelLines=!1,this._singleLineMode=!1,this._heightOffset=0,this._hanlder=void 0,this._editPTs=[],this._editIndex=0,this._editPl=void 0,this._editPt=void 0,this._editTran=new a.FdTransformHelper(t),this._editTran.setAxisSize(5),this._editLsnr=void 0}return(0,i.default)(e,[{key:"pleOptions",get:function(){var e=[];for(var t in this._polylines)e.push({pts:this._polylines[t].pts});return e},set:function(e){for(var t in this.removeAll(),e){var r=e[t].pts;this.setStartPt(r[0]);for(var n=0;n<r.length-1;n++)this.addResult(r[n+1])}this._startPoint=void 0,this._curGuid=void 0}}]),e}();c.prototype.run=function(){this.registerHandlers(),this._startCapture=!0,this._event.raiseEvent("Start",{})},c.prototype.start=function(){this.run()},c.prototype.callbackPt=function(e,t){return this._editPts[this._editIndex]},c.prototype.startEditPt=function(){if(!this._editPt){var e=new Freedo.CallbackProperty(this.callbackPt.bind(this),!1);this._editPt=this._viewer.entities.add({position:e,point:{pixelSize:10,color:Freedo.Color.YELLOW.withAlpha(.9)}})}this._editPt.boundingSphere=new Freedo.BoundingSphere(this._editPts[this._editIndex],10),this._editPt.modelMatrix=Freedo.clone(Freedo.Matrix4.IDENTITY,!0),this._viewer.camera.viewBoundingSphere(this._editPt.boundingSphere,new Freedo.HeadingPitchRange(10,-.5,0)),this._viewer.camera.lookAtTransform(Freedo.Matrix4.IDENTITY),this._editTran.setData([this._editPt]),this._editTran.start("MOVE")},c.prototype.startEdit=function(e){this._editPts=Freedo.clone(e,!0),this._editPl=this._viewer.scene.primitives.add(this.createLinePrimitive(e)),this._editIndex=0,this.startEditPt(),this._editLsnr&&this._editLsnr();var t=this;this._editLsnr=this._editTran.on(function(e,r){if("Transforming"==e){t._editPts[t._editIndex];var n=Freedo.Cartographic.fromDegrees(r.TMoveX,r.TMoveY,r.TMoveZ);t._editPts[t._editIndex]=Freedo.Cartographic.toCartesian(n)}if("Transformed"==e){t._editPt.boundingSphere=new Freedo.BoundingSphere(t._editPts[t._editIndex],10),t._editPl&&t._viewer.scene.primitives.remove(t._editPl),t._editPl=t._viewer.scene.primitives.add(t.createLinePrimitive(t._editPts));n=Freedo.Cartographic.fromDegrees(r.TMoveX,r.TMoveY,r.TMoveZ);t._event.raiseEvent("Transformed",{positionG:n})}})},c.prototype.editPre=function(){this._editIndex-=1,this._editIndex<0&&(this._editIndex=0),this.startEditPt()},c.prototype.editNext=function(){this._editIndex+=1,this._editIndex>this._editPts.length-1&&(this._editIndex=this._editPts.length-1),this.startEditPt()},c.prototype.endEdit=function(){this._editTran.cancel(),this._viewer.entities.remove(this._editPt),this._viewer.scene.primitives.remove(this._editPl),this._event.raiseEvent("EditEnd",{pts:this._editPts})},c.prototype.setAutoLoop=function(e){this._autoClose=e},c.prototype.setAutoDelLines=function(e){this._autoDelLines=e},c.prototype.setHeightOffset=function(e){this._heightOffset=e},c.prototype.onKeyDown=function(){this._startCapture&&(this.bKeydown=!0,27==window.event.keyCode&&this.onMouseRightClick(void 0))},c.prototype.onKeyUp=function(){this._startCapture&&(this.bKeydown=!1)},c.prototype.setStartPt=function(e){this._startPoint=e,this._curGuid=Freedo.createGuid(),this._polylines[this._curGuid]={},this._polylines[this._curGuid].lines=[],this._polylines[this._curGuid].pts=[],this._polylines[this._curGuid].ptsG=[],this._polylines[this._curGuid].pts[0]=e},c.prototype.callbackX=function(){return this._viewer.scene.requestRender(),[this._startPoint,this._tempPoint]},c.prototype.updateTmpLine=function(e){var t,r=o.FdMisc.FdGeometric.pickPositionG(this._viewer,e);if(Freedo.defined(r)&&(t=this._viewer.scene.globe?o.FdMisc.FdGeometric.tc(r):new Freedo.Cartesian3(r[0],r[1],r[2]),this._tempPoint=t,void 0===this._tempLine)){var n=new Freedo.CallbackProperty(this.callbackX.bind(this),!1);this._tempLine=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:n,followSurface:!!this._viewer.scene.globe,width:this._lineWidth,show:!0,material:Freedo.Color.RED,depthFailMaterial:Freedo.Color.RED}})}},c.prototype.removeTmpLine=function(){this._tempLine&&(this._viewer.entities.remove(this._tempLine),this._tempLine=void 0)},c.prototype.createLinePrimitive=function(e){var t,r;return r=!!this._viewer.scene.globe,t=new Freedo.PolylineGeometry({positions:e,width:2,followSurface:r,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT}),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:t}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-1,units:-1},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,0,0,1)}}})})})},c.prototype.addResult=function(e){var t=[this._startPoint,e],r=this._viewer.scene.primitives.add(this.createLinePrimitive([t[0],t[1]]));if(Freedo.defined(this._polylines[this._curGuid]))if(this._polylines[this._curGuid].lines.push(r),this._polylines[this._curGuid].pts.push(e),this._viewer.scene.globe){var n=o.FdMisc.FdGeometric.tg(e);this._polylines[this._curGuid].ptsG.push(n)}else this._polylines[this._curGuid].ptsG.push(e);this._startPoint=FreeDo.clone(e,!0),this._endPoint=void 0,this._viewer.scene.requestRender()},c.prototype.pickStartPoint=function(e){var t=o.FdMisc.FdGeometric.pickPositionG(this._viewer,e);Freedo.defined(t)&&(t[2]+=this._heightOffset,this._viewer.scene.globe?(this._startPoint=o.FdMisc.FdGeometric.tc(t),this._polylines[this._curGuid].pts.push(o.FdMisc.FdGeometric.tc(t))):(this._startPoint=new Freedo.Cartesian3(t[0],t[1],t[2]),this._polylines[this._curGuid].pts.push(this._startPoint)),this._polylines[this._curGuid].ptsG.push(t),this._event.raiseEvent("PointAdded",{position:t}))},c.prototype.pickEndPoint=function(e){var t=o.FdMisc.FdGeometric.pickPositionG(this._viewer,e);Freedo.defined(t)&&(t[2]+=this._heightOffset,this._viewer.scene.globe?this.addResult(o.FdMisc.FdGeometric.tc(t)):this.addResult(new Freedo.Cartesian3(t[0],t[1],t[2])),this._event.raiseEvent("PointAdded",{position:t}))},c.prototype.onMouseLeftClick=function(e){this._startCapture&&(Freedo.defined(this._curGuid)||(this._curGuid=Freedo.createGuid(),this._polylines[this._curGuid]={},this._polylines[this._curGuid].lines=[],this._polylines[this._curGuid].pts=[],this._polylines[this._curGuid].ptsG=[]),Freedo.defined(this._polylines[this._curGuid])&&(this._startPoint?this.pickEndPoint(e.position):this.pickStartPoint(e.position)))},c.prototype.delResult=function(e){e||(e=this._curGuid);var t=this._polylines[e].lines;if(t)for(var r in t){var n=t[r];this._viewer.scene.primitives.remove(n)}delete this._polylines[e],this._viewer.scene.requestRender()},c.prototype.polylineAdded=function(){var e={id:this._curGuid,polyline:this._polylines[this._curGuid]};if(this._event.raiseEvent("PLAdd",e),this._event.raiseEvent("DataChanged",e),this._autoDelLines){var t=this._polylines[this._curGuid].lines;for(var r in t){var n=t[r];this._viewer.scene.primitives.remove(n)}delete this._polylines[this._curGuid].lines}this._viewer.scene.requestRender()},c.prototype.onMouseRightClick=function(e){if(this._startCapture){if(this._startPoint){var t=this._polylines[this._curGuid].pts[0],r=this._polylines[this._curGuid].pts[this._polylines[this._curGuid].pts.length-1];if(this._autoClose){var n=this._viewer.scene.primitives.add(this.createLinePrimitive([r,t]));this._polylines[this._curGuid].lines.push(n),this._polylines[this._curGuid].pts.push(t);var i=o.FdMisc.FdGeometric.tg(t);this._polylines[this._curGuid].ptsG.push(i),this._polylines[this._curGuid].pts.length<=3&&this.delResult(this._curGuid)}else this._polylines[this._curGuid].pts.length<=1&&this.delResult(this._curGuid);this._polylines[this._curGuid]&&this.polylineAdded(),this.removeTmpLine(),this._startPoint=void 0,this._curGuid=void 0}this._viewer.scene.requestRender()}},c.prototype.forceFinish=function(){this.onMouseRightClick()},c.prototype.onMouseMove=function(e){this._startCapture&&this._startPoint&&!FreeDo.Cartesian3.equals(e.endPosition,e.startPosition)&&this.updateTmpLine(e.endPosition)},c.prototype.registerHandlers=function(){this._hanlder=this._hanlder&&this._hanlder.destroy(),this._hanlder=new FreeDo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.onMouseLeftClick.bind(this),FreeDo.ScreenSpaceEventType.LEFT_CLICK),this._hanlder.setInputAction(this.onMouseRightClick.bind(this),FreeDo.ScreenSpaceEventType.RIGHT_CLICK),this._hanlder.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE)},c.prototype.getData=function(){return this._polylines},c.prototype.cancel=function(){this._startCapture=!1,this._hanlder=this._hanlder&&this._hanlder.destroy(),this._event.raiseEvent("Cancel",{})},c.prototype.removeAll=function(){for(var e in this._polylines){for(var t in this._polylines[e].lines){var r=this._polylines[e].lines[t];this._viewer.scene.primitives.remove(r)}delete this._polylines[e]}this.removeTmpLine(),this._startPoint=void 0,this._curGuid=void 0,this._viewer.scene.requestRender()},c.prototype.hideAll=function(){for(var e in this._polylines)for(var t in this._polylines[e].lines){this._polylines[e].lines[t].show=!1}this._viewer.scene.requestRender()},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.reset=function(){this.cancel()},c.prototype.dispose=function(){this.reset()},t.FdPolylineEditor=c},function(e,t,r){"use strict";var n=r(4);e.exports=function(e,t){return!!e&&n(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(15);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){e.exports=!r(64)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=r(40),i=r(174),o=r(120),a=Object.defineProperty;t.f=r(29)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(28),i=r(76),o=r(12),a=r(8),s=r(132);e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,h=6==e,d=5==e||h,p=t||s;return function(t,s,f){for(var v,_,y=o(t),m=i(y),g=n(s,f,3),F=a(m.length),w=0,C=r?p(t,F):c?p(t,0):void 0;F>w;w++)if((d||w in m)&&(_=g(v=m[w],w,y),e))if(r)C[w]=_;else if(_)switch(e){case 3:return!0;case 5:return v;case 6:return w;case 2:C.push(v)}else if(l)return!1;return h?-1:u||l?l:C}}},function(e,t,r){var n=r(0),i=r(37),o=r(4);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",a)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(5);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(100),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(e){return function(){var t=e.apply(this,arguments);return new o.default(function(e,r){return function n(i,a){try{var s=t[i](a),c=s.value}catch(e){return void r(e)}if(!s.done)return o.default.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}},function(e,t,r){e.exports=r(227)},function(e,t,r){var n=r(30);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n=r(188),i=r(0),o=r(98)("metadata"),a=o.store||(o.store=new(r(185))),s=function(e,t,r){var i=a.get(e);if(!i){if(!r)return;a.set(e,i=new n)}var o=i.get(t);if(!o){if(!r)return;i.set(t,o=new n)}return o};e.exports={store:a,map:s,has:function(e,t,r){var n=s(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=s(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){s(r,n,!0).set(e,t)},keys:function(e,t){var r=s(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){i(i.S,"Reflect",e)}}},function(e,t,r){"use strict";if(r(10)){var n=r(57),i=r(3),o=r(4),a=r(0),s=r(88),c=r(126),u=r(28),l=r(51),h=r(59),d=r(20),p=r(49),f=r(34),v=r(8),_=r(183),y=r(55),m=r(36),g=r(24),F=r(74),w=r(5),C=r(12),b=r(135),P=r(54),M=r(21),x=r(53).f,S=r(133),T=r(58),E=r(7),D=r(32),A=r(97),O=r(90),k=r(130),L=r(66),I=r(93),R=r(52),N=r(131),B=r(193),G=r(9),j=r(22),H=G.f,V=j.f,X=i.RangeError,Y=i.TypeError,z=i.Uint8Array,Z=Array.prototype,U=c.ArrayBuffer,W=c.DataView,q=D(0),Q=D(2),K=D(3),J=D(4),$=D(5),ee=D(6),te=A(!0),re=A(!1),ne=k.values,ie=k.keys,oe=k.entries,ae=Z.lastIndexOf,se=Z.reduce,ce=Z.reduceRight,ue=Z.join,le=Z.sort,he=Z.slice,de=Z.toString,pe=Z.toLocaleString,fe=E("iterator"),ve=E("toStringTag"),_e=T("typed_constructor"),ye=T("def_constructor"),me=s.CONSTR,ge=s.TYPED,Fe=s.VIEW,we=D(1,function(e,t){return xe(O(e,e[ye]),t)}),Ce=o(function(){return 1===new z(new Uint16Array([1]).buffer)[0]}),be=!!z&&!!z.prototype.set&&o(function(){new z(1).set({})}),Pe=function(e,t){var r=f(e);if(r<0||r%t)throw X("Wrong offset!");return r},Me=function(e){if(w(e)&&ge in e)return e;throw Y(e+" is not a typed array!")},xe=function(e,t){if(!(w(e)&&_e in e))throw Y("It is not a typed array constructor!");return new e(t)},Se=function(e,t){return Te(O(e,e[ye]),t)},Te=function(e,t){for(var r=0,n=t.length,i=xe(e,n);n>r;)i[r]=t[r++];return i},Ee=function(e,t,r){H(e,t,{get:function(){return this._d[r]}})},De=function(e){var t,r,n,i,o,a,s=C(e),c=arguments.length,l=c>1?arguments[1]:void 0,h=void 0!==l,d=S(s);if(void 0!=d&&!b(d)){for(a=d.call(s),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);s=n}for(h&&c>2&&(l=u(l,arguments[2],2)),t=0,r=v(s.length),i=xe(this,r);r>t;t++)i[t]=h?l(s[t],t):s[t];return i},Ae=function(){for(var e=0,t=arguments.length,r=xe(this,t);t>e;)r[e]=arguments[e++];return r},Oe=!!z&&o(function(){pe.call(new z(1))}),ke=function(){return pe.apply(Oe?he.call(Me(this)):Me(this),arguments)},Le={copyWithin:function(e,t){return B.call(Me(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return J(Me(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return N.apply(Me(this),arguments)},filter:function(e){return Se(this,Q(Me(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return $(Me(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Me(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){q(Me(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Me(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Me(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ue.apply(Me(this),arguments)},lastIndexOf:function(e){return ae.apply(Me(this),arguments)},map:function(e){return we(Me(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Me(this),arguments)},reduceRight:function(e){return ce.apply(Me(this),arguments)},reverse:function(){for(var e,t=Me(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return K(Me(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return le.call(Me(this),e)},subarray:function(e,t){var r=Me(this),n=r.length,i=y(e,n);return new(O(r,r[ye]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,v((void 0===t?n:y(t,n))-i))}},Ie=function(e,t){return Se(this,he.call(Me(this),e,t))},Re=function(e){Me(this);var t=Pe(arguments[1],1),r=this.length,n=C(e),i=v(n.length),o=0;if(i+t>r)throw X("Wrong length!");for(;o<i;)this[t+o]=n[o++]},Ne={entries:function(){return oe.call(Me(this))},keys:function(){return ie.call(Me(this))},values:function(){return ne.call(Me(this))}},Be=function(e,t){return w(e)&&e[ge]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Ge=function(e,t){return Be(e,t=m(t,!0))?h(2,e[t]):V(e,t)},je=function(e,t,r){return!(Be(e,t=m(t,!0))&&w(r)&&g(r,"value"))||g(r,"get")||g(r,"set")||r.configurable||g(r,"writable")&&!r.writable||g(r,"enumerable")&&!r.enumerable?H(e,t,r):(e[t]=r.value,e)};me||(j.f=Ge,G.f=je),a(a.S+a.F*!me,"Object",{getOwnPropertyDescriptor:Ge,defineProperty:je}),o(function(){de.call({})})&&(de=pe=function(){return ue.call(this)});var He=p({},Le);p(He,Ne),d(He,fe,Ne.values),p(He,{slice:Ie,set:Re,constructor:function(){},toString:de,toLocaleString:ke}),Ee(He,"buffer","b"),Ee(He,"byteOffset","o"),Ee(He,"byteLength","l"),Ee(He,"length","e"),H(He,ve,{get:function(){return this[ge]}}),e.exports=function(e,t,r,c){var u=e+((c=!!c)?"Clamped":"")+"Array",h="get"+e,p="set"+e,f=i[u],y=f||{},m=f&&M(f),g=!f||!s.ABV,C={},b=f&&f.prototype,S=function(e,r){H(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[h](r*t+n.o,Ce)}(this,r)},set:function(e){return function(e,r,n){var i=e._d;c&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[p](r*t+i.o,n,Ce)}(this,r,e)},enumerable:!0})};g?(f=r(function(e,r,n,i){l(e,f,u,"_d");var o,a,s,c,h=0,p=0;if(w(r)){if(!(r instanceof U||"ArrayBuffer"==(c=F(r))||"SharedArrayBuffer"==c))return ge in r?Te(f,r):De.call(f,r);o=r,p=Pe(n,t);var y=r.byteLength;if(void 0===i){if(y%t)throw X("Wrong length!");if((a=y-p)<0)throw X("Wrong length!")}else if((a=v(i)*t)+p>y)throw X("Wrong length!");s=a/t}else s=_(r),o=new U(a=s*t);for(d(e,"_d",{b:o,o:p,l:a,e:s,v:new W(o)});h<s;)S(e,h++)}),b=f.prototype=P(He),d(b,"constructor",f)):o(function(){f(1)})&&o(function(){new f(-1)})&&I(function(e){new f,new f(null),new f(1.5),new f(e)},!0)||(f=r(function(e,r,n,i){var o;return l(e,f,u),w(r)?r instanceof U||"ArrayBuffer"==(o=F(r))||"SharedArrayBuffer"==o?void 0!==i?new y(r,Pe(n,t),i):void 0!==n?new y(r,Pe(n,t)):new y(r):ge in r?Te(f,r):De.call(f,r):new y(_(r))}),q(m!==Function.prototype?x(y).concat(x(m)):x(y),function(e){e in f||d(f,e,y[e])}),f.prototype=b,n||(b.constructor=f));var T=b[fe],E=!!T&&("values"==T.name||void 0==T.name),D=Ne.values;d(f,_e,!0),d(b,ge,u),d(b,Fe,!0),d(b,ye,f),(c?new f(1)[ve]==u:ve in b)||H(b,ve,{get:function(){return u}}),C[u]=f,a(a.G+a.W+a.F*(f!=y),C),a(a.S,u,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o(function(){y.of.call(f,1)}),u,{from:De,of:Ae}),"BYTES_PER_ELEMENT"in b||d(b,"BYTES_PER_ELEMENT",t),a(a.P,u,Le),R(u),a(a.P+a.F*be,u,{set:Re}),a(a.P+a.F*!E,u,Ne),n||b.toString==de||(b.toString=de),a(a.P+a.F*o(function(){new f(1).slice()}),u,{slice:Ie}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!o(function(){b.toLocaleString.call([1,2])})),u,{toLocaleString:ke}),L[u]=E?T:D,n||E||d(b,fe,D)}}else e.exports=function(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdCommon=void 0;var n=c(r(39)),i=c(r(100)),o=c(r(38)),a=c(r(218)),s=c(r(1));function c(e){return e&&e.__esModule?e:{default:e}}var u,l=function e(){(0,s.default)(this,e)};l.fdAjax=function(e){(e=e||{}).type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json",e.async=e.async||!0;var t="";if(e.data&&(t=(0,a.default)(e.data)),window.XMLHttpRequest)var r=new XMLHttpRequest;else r=new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4===r.readyState){var t=r.status;t>=200&&t<300?e.success&&e.success(r.responseText,r.responseXML):e.fail&&e.fail(r.responseText,r.responseXML)}},"GET"===e.type?(r.open("GET",e.url+t,e.async),r.send(null)):"POST"===e.type&&(r.open("POST",e.url,e.async),r.setRequestHeader("Content-type","application/json; charset=utf-8"),void 0!==e.token&&r.setRequestHeader("Authorization",e.token),r.send(t))},l.ajaxJson=(u=(0,o.default)(n.default.mark(function e(t){var r;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dataType||"json",e.abrupt("return",new i.default(function(e,n){l.fdAjax({url:t.url,type:t.type||"POST",data:t.data||null,dataType:t.dataType||"json",success:function(t,i){if("json"===r)if(t){var o=JSON.parse(t);e(o)}else n(t);else e(i)},fail:function(e,t){var r=JSON.parse(e);n(r)}})}));case 2:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)}),t.FdCommon=l},function(e,t,r){var n=r(31),i=r(83);e.exports=r(29)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(7)("unscopables"),i=Array.prototype;void 0==i[n]&&r(20)(i,n,{}),e.exports=function(e){i[n][e]=!0}},function(e,t,r){var n=r(58)("meta"),i=r(5),o=r(24),a=r(9).f,s=0,c=Object.isExtensible||function(){return!0},u=!r(4)(function(){return c(Object.preventExtensions({}))}),l=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&h.NEED&&c(e)&&!o(e,n)&&l(e),e}}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(73);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(19);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(28),i=r(195),o=r(135),a=r(2),s=r(8),c=r(133),u={},l={};(t=e.exports=function(e,t,r,h,d){var p,f,v,_,y=d?function(){return e}:c(e),m=n(r,h,t?2:1),g=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(o(y)){for(p=s(e.length);p>g;g++)if((_=t?m(a(f=e[g])[0],f[1]):m(e[g]))===u||_===l)return _}else for(v=y.call(e);!(f=v.next()).done;)if((_=i(v,m,f.value,t))===u||_===l)return _}).BREAK=u,t.RETURN=l},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){"use strict";var n=r(3),i=r(9),o=r(10),a=r(7)("species");e.exports=function(e){var t=n[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(207),i=r(148).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(2),i=r(206),o=r(148),a=r(149)("IE_PROTO"),s=function(){},c=function(){var e,t=r(151)("iframe"),n=o.length;for(t.style.display="none",r(147).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[o[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=c(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(34),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t,r){var n=r(207),i=r(148);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t){e.exports=!1},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(292)(!0);r(116)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){var n=r(118),i=r(117);e.exports=function(e){return n(i(e))}},function(e,t){e.exports={}},function(e,t,r){r(299);for(var n=r(16),i=r(44),o=r(62),a=r(13)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var u=s[c],l=n[u],h=l&&l.prototype;h&&!h[a]&&i(h,a,u),o[u]=o.Array}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var n=r(5);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t){e.exports={}},function(e,t,r){var n=r(0),i=r(35),o=r(4),a=r(145),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,t,r){var i={},s=o(function(){return!!a[e]()||"​"!="​"[e]()}),c=i[e]=s?t(h):a[e];r&&(i[r]=c),n(n.P+n.F*s,"String",i)},h=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},function(e,t,r){var n=r(9).f,i=r(24),o=r(7)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(48),i=r(287),o=r(286),a=r(40),s=r(114),c=r(167),u={},l={};(t=e.exports=function(e,t,r,h,d){var p,f,v,_,y=d?function(){return e}:c(e),m=n(r,h,t?2:1),g=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(o(y)){for(p=s(e.length);p>g;g++)if((_=t?m(a(f=e[g])[0],f[1]):m(e[g]))===u||_===l)return _}else for(v=y.call(e);!(f=v.next()).done;)if((_=i(v,m,f.value,t))===u||_===l)return _}).BREAK=u,t.RETURN=l},function(e,t,r){var n=r(31).f,i=r(47),o=r(13)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdBezierCurveAlgorithm=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};var a=function e(t,r,n,i){(0,o.default)(this,e),this.mPointA=t.position,this.mPointB=r.position,this.mControlPointA=n.position,this.mControlPointB=i.position};a.prototype.coefficients=function(e,t,r,n,i){var o=1-e;return i=(n=e*e)*e,{a:(r=o*o)*o,b:r*=3*e,c:n*=3*o,d:i}},a.prototype.getPointAt=function(e,t,r,n){e<0&&(e=0),e>1&&(e=1);var i=this.coefficients(e,void 0,void 0,void 0,void 0);return{x:i.a*this.mPointA.x+i.b*this.mControlPointA.x+i.c*this.mControlPointB.x+i.d*this.mPointB.x,y:i.a*this.mPointA.y+i.b*this.mControlPointA.y+i.c*this.mControlPointB.y+i.d*this.mPointB.y,z:i.a*this.mPointA.z+i.b*this.mControlPointA.z+i.c*this.mControlPointB.z+i.d*this.mPointB.z}},a.prototype.getVertexForCurve=function(e){var t=0,r=0;switch(e){case 1:t=1,r=2;break;case 2:t=.5,r=3;break;case 3:t=.2,r=6;break;case 4:t=.1,r=11;break;case 5:t=.05,r=21;break;case 6:t=.02,r=51;break;case 7:t=.01,r=101;break;case 8:t=.005,r=201;break;case 9:t=.0025,r=401;break;case 10:t=.00125,r=801;break;case 11:t=625e-6,r=1601;break;default:t=.005,r=201}for(var n=[],i=0,o=0;o<r;++o){var a={},s=this.getPointAt(i,0,0,0);a.x=s.x,a.y=s.y,a.z=s.z,n.push(a),i+=t}return n},t.FdBezierCurveAlgorithm=a},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(27),i=r(7)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(27);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){},function(e,t,r){var n=r(71),i=r(13)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(169),i=r(110);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdKeyboard=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};var a=function e(t){(0,o.default)(this,e),this._viewer=t,this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._divID=this._viewer._container.id,this._bActive=!1,this._bRun=!1,this._windowTimer=null,this._metaData=[]};a.prototype.enable=function(){this._bActive=!0,this.setFocus(),this.addEventLsnr(),this._event.raiseEvent("StatusChanged",{status:this._bActive})},a.prototype.disable=function(){this._bActive=!1,this._event.raiseEvent("StatusChanged",{status:this._bActive})},a.prototype.getStatus=function(){return this._bActive},a.prototype.setStatus=function(e){this._bActive=e},a.prototype.setFocus=function(){var e=document.getElementById(this._divID);e.setAttribute("tabindex",1),e.focus()},a.prototype.prevent=function(e){var t=e.keyCode||e.which;38!=t&&40!=t&&37!=t&&39!=t&&87!=t&&65!=t&&83!=t&&68!=t||(e.stopPropagation(),e.preventDefault())},a.prototype.onKeyDown=function(e){if(this._bActive){(e=window.event||e).keyCode||e.which;this._metaData[e.keyCode]=!0,this.startTimer(),this.prevent(e)}},a.prototype.onKeyUp=function(e){if(this._bActive){(e=window.event||e).keyCode||e.which;this._metaData[e.keyCode]=!1,this.stopTimer(),this.prevent(e)}},a.prototype.startTimer=function(e){var t=this;null==this._windowTimer&&(this._windowTimer=window.setInterval(function(){t._event.raiseEvent("timer",{metaData:t._metaData}),t._event.raiseEvent("KeyPressed",{metaData:t._metaData})},33))},a.prototype.stopTimer=function(e){if(null!=this._windowTimer){var t=!0;for(var r in this._metaData)if(this._metaData[r]){t=!1;break}t&&(window.clearInterval(this._windowTimer),this._windowTimer=null)}},a.prototype.addEventLsnr=function(){var e=this;if(!this._bRun){this._bRun=!0;var t=this._viewer.canvas;t.addEventListener("click",function(e){e.target===t&&(this.setAttribute("tabindex",1),this.focus())}),t.onkeydown=function(r){r.target===t&&e.onKeyDown(r)},t.onkeyup=function(r){r.target===t&&e.onKeyUp(r)}}},a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.reset=function(){this._bActive=!1},a.prototype.dispose=function(){this.reset()},t.FdKeyboard=a},function(e,t,r){"use strict";var n=r(0),i=r(15),o=r(28),a=r(50);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),void 0==e?new this:(r=[],t?(n=0,s=o(c,arguments[2],2),a(e,!1,function(e){r.push(s(e,n++))})):a(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){"use strict";e.exports=r(57)||!r(4)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete r(3)[e]})},function(e,t,r){for(var n,i=r(3),o=r(20),a=r(58),s=a("typed_array"),c=a("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=i[d[h++]])?(o(n.prototype,s,!0),o(n.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},function(e,t,r){"use strict";var n=r(3),i=r(0),o=r(19),a=r(49),s=r(46),c=r(50),u=r(51),l=r(5),h=r(4),d=r(93),p=r(68),f=r(144);e.exports=function(e,t,r,v,_,y){var m=n[e],g=m,F=_?"set":"add",w=g&&g.prototype,C={},b=function(e){var t=w[e];o(w,e,"delete"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof g&&(y||w.forEach&&!h(function(){(new g).entries().next()}))){var P=new g,M=P[F](y?{}:-0,1)!=P,x=h(function(){P.has(1)}),S=d(function(e){new g(e)}),T=!y&&h(function(){for(var e=new g,t=5;t--;)e[F](t,t);return!e.has(-0)});S||((g=t(function(t,r){u(t,g,e);var n=f(new m,t,g);return void 0!=r&&c(r,_,n[F],n),n})).prototype=w,w.constructor=g),(x||T)&&(b("delete"),b("has"),_&&b("get")),(T||M)&&b(F),y&&w.clear&&delete w.clear}else g=v.getConstructor(t,e,_,F),a(g.prototype,r),s.NEED=!0;return p(g,e),C[e]=g,i(i.G+i.W+i.F*(g!=m),C),y||v.setStrong(g,e,_),g}},function(e,t,r){var n=r(2),i=r(15),o=r(7)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[o])?t:i(r)}},function(e,t,r){"use strict";var n=r(20),i=r(19),o=r(4),a=r(35),s=r(7);e.exports=function(e,t,r){var c=s(e),u=r(a,c,""[e]),l=u[0],h=u[1];o(function(){var t={};return t[c]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,l),n(RegExp.prototype,c,2==t?function(e,t){return h.call(e,this,t)}:function(e){return h.call(e,this)}))}},function(e,t,r){"use strict";var n=r(2);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,r){var n=r(7)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},function(e,t,r){var n=r(5),i=r(27),o=r(7)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,r){var n=r(27);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(23),i=r(8),o=r(55);e.exports=function(e){return function(t,r,a){var s,c=n(t),u=i(c.length),l=o(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(3),i=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,r){"use strict";var n=r(73);e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},function(e,t,r){e.exports={default:r(225),__esModule:!0}},function(e,t,r){var n=r(16),i=r(14),o=r(82),a=r(102),s=r(31).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,r){t.f=r(13)},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){e.exports={default:r(277),__esModule:!0}},function(e,t,r){var n=r(30);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){var n=r(80)("meta"),i=r(30),o=r(47),a=r(31).f,s=0,c=Object.isExtensible||function(){return!0},u=!r(64)(function(){return c(Object.preventExtensions({}))}),l=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&h.NEED&&c(e)&&!o(e,n)&&l(e),e}}},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(44);e.exports=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},function(e,t,r){var n=r(117);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(16),i=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,r){var n=r(111)("keys"),i=r(80);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(113),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(40),i=r(296),o=r(110),a=r(112)("IE_PROTO"),s=function(){},c=function(){var e,t=r(121)("iframe"),n=o.length;for(t.style.display="none",r(168).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[o[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=c(),void 0===t?r:i(r,t)}},function(e,t,r){"use strict";var n=r(82),i=r(17),o=r(170),a=r(44),s=r(62),c=r(297),u=r(70),l=r(293),h=r(13)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,r,f,v,_,y){c(r,t,f);var m,g,F,w=function(e){if(!d&&e in M)return M[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},C=t+" Iterator",b="values"==v,P=!1,M=e.prototype,x=M[h]||M["@@iterator"]||v&&M[v],S=x||w(v),T=v?b?w("entries"):S:void 0,E="Array"==t&&M.entries||x;if(E&&(F=l(E.call(new e)))!==Object.prototype&&F.next&&(u(F,C,!0),n||"function"==typeof F[h]||a(F,h,p)),b&&x&&"values"!==x.name&&(P=!0,S=function(){return x.call(this)}),n&&!y||!d&&!P&&M[h]||a(M,h,S),s[t]=S,s[C]=p,v)if(m={values:b?S:w("values"),keys:_?S:w("keys"),entries:T},y)for(g in m)g in M||o(M,g,m[g]);else i(i.P+i.F*(d||P),t,m);return m}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(71);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){e.exports={default:r(300),__esModule:!0}},function(e,t,r){var n=r(30);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(30),i=r(16).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){"use strict";function n(e){return void 0===e?void 0:Freedo.Math.toDegrees(e)}function i(e){var t=e.positionCartographic;return[n(t.longitude),n(t.latitude),t.height,n(e.heading),n(e.pitch),n(e.roll)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentCameraInfo=i,t.flyToByCameraInfo=function(e,t,r){var n=i(e);if(_.isEqual(n,t))return!1;var o,a,s=t;return Freedo.Matrix4.equals(e.transform,Freedo.Matrix4.IDENTITY)||(o=Freedo.Matrix4.clone(e.transform,o),e.lookAtTransform(Freedo.Matrix4.IDENTITY)),(a=void 0===r?{}:Freedo.clone(r,!0)).destination=Freedo.Cartesian3.fromDegrees(s[0],s[1],s[2]),a.orientation={heading:Freedo.Math.toRadians(s[3]),pitch:Freedo.Math.toRadians(s[4]),roll:Freedo.Math.toRadians(s[5])},void 0!==o&&void 0===a.endTransform&&(a.endTransform=o),e.flyTo(a),!0},t.goToByCameraInfo=function(e,t){var r=i(e);if(_.isEqual(r,t))return!1;var n,o=t;return Freedo.Matrix4.equals(e.transform,Freedo.Matrix4.IDENTITY)||(n=Freedo.Matrix4.clone(e.transform,n),e.lookAtTransform(Freedo.Matrix4.IDENTITY)),e.setView({destination:Freedo.Cartesian3.fromDegrees(o[0],o[1],o[2]),orientation:{heading:Freedo.Math.toRadians(o[3]),pitch:Freedo.Math.toRadians(o[4]),roll:Freedo.Math.toRadians(o[5])}}),void 0!==n&&e.lookAtTransform(n),!0}},function(e,t,r){"use strict";r.r(t),function(e,n){r.d(t,"Reaction",function(){return cr}),r.d(t,"untracked",function(){return nr}),r.d(t,"IDerivationState",function(){return Dt}),r.d(t,"createAtom",function(){return We}),r.d(t,"spy",function(){return m}),r.d(t,"comparer",function(){return R}),r.d(t,"isObservableObject",function(){return ae}),r.d(t,"isBoxedObservable",function(){return K}),r.d(t,"isObservableArray",function(){return ut}),r.d(t,"ObservableMap",function(){return Be}),r.d(t,"isObservableMap",function(){return He}),r.d(t,"transaction",function(){return Re}),r.d(t,"observable",function(){return Te}),r.d(t,"computed",function(){return _e}),r.d(t,"isObservable",function(){return ue}),r.d(t,"isObservableProp",function(){return le}),r.d(t,"isComputed",function(){return de}),r.d(t,"isComputedProp",function(){return pe}),r.d(t,"extendObservable",function(){return me}),r.d(t,"extendShallowObservable",function(){return ye}),r.d(t,"observe",function(){return _r}),r.d(t,"intercept",function(){return yr}),r.d(t,"autorun",function(){return N}),r.d(t,"reaction",function(){return j}),r.d(t,"when",function(){return mr}),r.d(t,"action",function(){return x}),r.d(t,"isAction",function(){return T}),r.d(t,"runInAction",function(){return S}),r.d(t,"keys",function(){return Fr}),r.d(t,"values",function(){return wr}),r.d(t,"set",function(){return Cr}),r.d(t,"remove",function(){return br}),r.d(t,"has",function(){return Pr}),r.d(t,"get",function(){return Mr}),r.d(t,"decorate",function(){return xr}),r.d(t,"configure",function(){return Sr}),r.d(t,"onBecomeObserved",function(){return ze}),r.d(t,"onBecomeUnobserved",function(){return Ze}),r.d(t,"flow",function(){return Er}),r.d(t,"toJS",function(){return Or}),r.d(t,"trace",function(){return sr}),r.d(t,"getDependencyTree",function(){return Gt}),r.d(t,"getObserverTree",function(){return Ht}),r.d(t,"_resetGlobalState",function(){return Bt}),r.d(t,"_getGlobalState",function(){return Nt}),r.d(t,"getDebugName",function(){return Ye}),r.d(t,"getAtom",function(){return Ve}),r.d(t,"_getAdministration",function(){return Xe}),r.d(t,"_allowStateChanges",function(){return w}),r.d(t,"isArrayLike",function(){return Mt}),r.d(t,"_isComputingDerivation",function(){return $t}),r.d(t,"onReactionError",function(){return ur}),r.d(t,"_interceptReads",function(){return kr});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function o(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u={},l={};function h(e){if(!0!==e.__mobxDidRunLazyInitializers){var t=e.__mobxDecorators;if(t)for(var r in Ct(e,"__mobxDidRunLazyInitializers",!0),t){var n=t[r];n.propertyCreator(e,n.prop,n.descriptor,n.decoratorTarget,n.decoratorArguments)}}}function d(e,t){return function(){var r,n,i=function(n,i,o,s){if(!0===s)return t(n,i,o,n,r),null;if(!Object.prototype.hasOwnProperty.call(n,"__mobxDecorators")){var c=n.__mobxDecorators;Ct(n,"__mobxDecorators",a({},c))}return n.__mobxDecorators[i]={prop:i,propertyCreator:t,descriptor:o,decoratorTarget:n,decoratorArguments:r},function(e,t){var r=t?u:l;return r[e]||(r[e]={configurable:!0,enumerable:t,get:function(){return h(this),this[e]},set:function(t){h(this),this[e]=t}})}(i,e)};return(2===(n=arguments).length||3===n.length)&&"string"==typeof n[1]||4===n.length&&!0===n[3]?(r=ht,i.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),i)}}function p(){return!!Lt.spyListeners.length}function f(e){if(Lt.spyListeners.length)for(var t=Lt.spyListeners,r=0,n=t.length;r<n;r++)t[r](e)}function v(e){f(a({},e,{spyReportStart:!0}))}var _={spyReportEnd:!0};function y(e){f(e?a({},e,{spyReportEnd:!0}):_)}function m(e){return Lt.spyListeners.push(e),mt(function(){Lt.spyListeners=Lt.spyListeners.filter(function(t){return t!==e})})}function g(e,t){var r=function(){return F(e,t,this,arguments)};return r.isMobxAction=!0,r}function F(e,t,r,n){var i=function(e,t,r,n){var i=p()&&!!e,o=0;if(i){o=Date.now();var a=n&&n.length||0,s=new Array(a);if(a>0)for(var c=0;c<a;c++)s[c]=n[c];v({type:"action",name:e,object:r,arguments:s})}var u=ir();Zt();var l=C(!0);return{prevDerivation:u,prevAllowStateChanges:l,notifySpy:i,startTime:o}}(e,0,r,n);try{return t.apply(r,n)}finally{!function(e){b(e.prevAllowStateChanges),Ut(),or(e.prevDerivation),e.notifySpy&&y({time:Date.now()-e.startTime})}(i)}}function w(e,t){var r,n=C(e);try{r=t()}finally{b(n)}return r}function C(e){var t=Lt.allowStateChanges;return Lt.allowStateChanges=e,t}function b(e){Lt.allowStateChanges=e}function P(){vt(!1)}function M(e){return function(t,r,n){if(n){if(n.value)return{value:g(e,n.value),enumerable:!1,configurable:!0,writable:!0};var i=n.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return g(e,i.call(this))}}}return function(e){return function(t,r,n){Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:function(){},set:function(t){bt(this,r,x(e,t))}})}}(e).apply(this,arguments)}}var x=function(e,t,r,n){return 1===arguments.length&&"function"==typeof e?g(e.name||"<unnamed action>",e):2===arguments.length&&"function"==typeof t?g(e,t):1===arguments.length&&"string"==typeof e?M(e):!0!==n?M(t).apply(null,arguments):void(e[t]=g(e.name||t,r.value))};function S(e,t){return F("string"==typeof e?e:e.name||"<unnamed action>","function"==typeof e?e:t,this,void 0)}function T(e){return"function"==typeof e&&!0===e.isMobxAction}function E(e,t,r){Ct(e,t,g(t,r.bind(e)))}x.bound=function(e,t,r,n){return!0===n?(E(e,t,r.value),null):r?{configurable:!0,enumerable:!1,get:function(){return E(this,t,r.value||r.initializer.call(this)),this[t]},set:P}:{enumerable:!1,configurable:!0,set:function(e){E(this,t,e)},get:function(){}}};var D=Object.prototype.toString;function A(e,t){return O(e,t)}function O(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&function(e,t,r,n){e=k(e),t=k(t);var i=D.call(e);if(i!==D.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var o="[object Array]"===i;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!("function"==typeof a&&a instanceof a&&"function"==typeof s&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];var c=r.length;for(;c--;)if(r[c]===e)return n[c]===t;if(r.push(e),n.push(t),o){if((c=e.length)!==t.length)return!1;for(;c--;)if(!O(e[c],t[c],r,n))return!1}else{var u,l=Object.keys(e);if(c=l.length,Object.keys(t).length!==c)return!1;for(;c--;)if(u=l[c],!L(t,u)||!O(e[u],t[u],r,n))return!1}return r.pop(),n.pop(),!0}(e,t,r,n)}function k(e){return ut(e)?e.peek():xt(e)||He(e)?St(e.entries()):e}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function I(e,t){return e===t}var R={identity:I,structural:function(e,t){return A(e,t)},default:function(e,t){return function(e,t){return"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}(e,t)||I(e,t)}};function N(e,t){void 0===t&&(t=dt);var r,n=t&&t.name||e.name||"Autorun@"+ft();if(!t.scheduler&&!t.delay)r=new cr(n,function(){this.track(a)},t.onError);else{var i=G(t),o=!1;r=new cr(n,function(){o||(o=!0,i(function(){o=!1,r.isDisposed||r.track(a)}))},t.onError)}function a(){e(r)}return r.schedule(),r.getDisposer()}var B=function(e){return e()};function G(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:B}function j(e,t,r){void 0===r&&(r=dt),"boolean"==typeof r&&(r={fireImmediately:r},yt("Using fireImmediately as argument is deprecated. Use '{ fireImmediately: true }' instead"));var n,i,o,a=r.name||"Reaction@"+ft(),s=x(a,r.onError?(n=r.onError,i=t,function(){try{return i.apply(this,arguments)}catch(e){n.call(this,e)}}):t),c=!r.scheduler&&!r.delay,u=G(r),l=!0,h=!1,d=r.compareStructural?R.structural:r.equals||R.default,p=new cr(a,function(){l||c?f():h||(h=!0,u(f))},r.onError);function f(){if(h=!1,!p.isDisposed){var t=!1;p.track(function(){var r=e(p);t=l||!d(o,r),o=r}),l&&r.fireImmediately&&s(o,p),l||!0!==t||s(o,p),l&&(l=!1)}}return p.schedule(),p.getDisposer()}var H=function(){function e(e){var t=this;if(this.dependenciesState=Dt.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Dt.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+ft(),this.value=new Qt(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=At.NONE,!e.get)return vt("missing option for computed: get");this.derivation=e.get,this.name=e.name||"ComputedValue@"+ft(),e.set&&(this.setter=g(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?R.structural:R.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,!0===e.keepAlive&&N(function(){return t.get()})}return e.prototype.onBecomeStale=function(){!function(e){if(e.lowestObserverState!==Dt.UP_TO_DATE)return;e.lowestObserverState=Dt.POSSIBLY_STALE;var t=e.observers,r=t.length;for(;r--;){var n=t[r];n.dependenciesState===Dt.UP_TO_DATE&&(n.dependenciesState=Dt.POSSIBLY_STALE,n.isTracing!==At.NONE&&qt(n,e),n.onBecomeStale())}}(this)},e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.get=function(){this.isComputing&&vt("Cycle detected in computation "+this.name+": "+this.derivation),0===Lt.inBatch?Jt(this)&&(this.warnAboutUntrackedRead(),Zt(),this.value=this.computeValue(!1),Ut()):(Wt(this),Jt(this)&&this.trackAndCompute()&&function(e){if(e.lowestObserverState===Dt.STALE)return;e.lowestObserverState=Dt.STALE;var t=e.observers,r=t.length;for(;r--;){var n=t[r];n.dependenciesState===Dt.POSSIBLY_STALE?n.dependenciesState=Dt.STALE:n.dependenciesState===Dt.UP_TO_DATE&&(e.lowestObserverState=Dt.UP_TO_DATE)}}(this));var e=this.value;if(Kt(e))throw e.cause;return e},e.prototype.peek=function(){var e=this.computeValue(!1);if(Kt(e))throw e.cause;return e},e.prototype.set=function(e){if(this.setter){_t(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else _t(!1,!1)},e.prototype.trackAndCompute=function(){p()&&f({object:this.scope,type:"compute",name:this.name});var e=this.value,t=this.dependenciesState===Dt.NOT_TRACKING,r=this.computeValue(!0),n=t||Kt(e)||Kt(r)||!this.equals(e,r);return n&&(this.value=r),n},e.prototype.computeValue=function(e){var t;if(this.isComputing=!0,Lt.computationDepth++,e)t=tr(this,this.derivation,this.scope);else if(!0===Lt.disableErrorBoundaries)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(e){t=new Qt(e)}return Lt.computationDepth--,this.isComputing=!1,t},e.prototype.suspend=function(){rr(this),this.value=void 0},e.prototype.observe=function(e,t){var r=this,n=!0,i=void 0;return N(function(){var o=r.get();if(!n||t){var a=ir();e({type:"update",object:r,newValue:o,oldValue:i}),or(a)}n=!1,i=o})},e.prototype.warnAboutUntrackedRead=function(){},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return Et(this.get())},e}();H.prototype[Tt()]=H.prototype.valueOf;var V=Pt("ComputedValue",H);function X(e){return void 0!==e.interceptors&&e.interceptors.length>0}function Y(e,t){var r=e.interceptors||(e.interceptors=[]);return r.push(t),mt(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function z(e,t){var r=ir();try{var n=e.interceptors;if(n)for(var i=0,o=n.length;i<o&&(_t(!(t=n[i](t))||t.type,"Intercept handlers should return nothing or a change object"),t);i++);return t}finally{or(r)}}function Z(e){return void 0!==e.changeListeners&&e.changeListeners.length>0}function U(e,t){var r=e.changeListeners||(e.changeListeners=[]);return r.push(t),mt(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function W(e,t){var r=ir(),n=e.changeListeners;if(n){for(var i=0,o=(n=n.slice()).length;i<o;i++)n[i](t);or(r)}}var q={};!function(){if(Ge)return;Ge=function(){function e(e){void 0===e&&(e="Atom@"+ft()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Dt.NOT_TRACKING}return e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.reportObserved=function(){return Wt(this)},e.prototype.reportChanged=function(){Zt(),function(e){if(e.lowestObserverState===Dt.STALE)return;e.lowestObserverState=Dt.STALE;var t=e.observers,r=t.length;for(;r--;){var n=t[r];n.dependenciesState===Dt.UP_TO_DATE&&(n.isTracing!==At.NONE&&qt(n,e),n.onBecomeStale()),n.dependenciesState=Dt.STALE}}(this),Ut()},e.prototype.toString=function(){return this.name},e}(),je=Pt("Atom",Ge)}();var Q=function(e){function t(t,r,n,i){void 0===n&&(n="ObservableValue@"+ft()),void 0===i&&(i=!0);var o=e.call(this,n)||this;return o.enhancer=r,o.hasUnreportedChange=!1,o.value=r(t,void 0,n),i&&p()&&f({type:"create",name:o.name,newValue:""+o.value}),o}return o(t,e),t.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.prototype.set=function(e){var t=this.value;if((e=this.prepareNewValue(e))!==q){var r=p();r&&v({type:"update",name:this.name,newValue:e,oldValue:t}),this.setNewValue(e),r&&y()}},t.prototype.prepareNewValue=function(e){if(er(this),X(this)){var t=z(this,{object:this,type:"update",newValue:e});if(!t)return q;e=t.newValue}return e=this.enhancer(e,this.value,this.name),this.value!==e?e:q},t.prototype.setNewValue=function(e){var t=this.value;this.value=e,this.reportChanged(),Z(this)&&W(this,{type:"update",object:this,newValue:e,oldValue:t})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return Y(this,e)},t.prototype.observe=function(e,t){return t&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),U(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return Et(this.get())},t}(Ge);Q.prototype[Tt()]=Q.prototype.valueOf;var K=Pt("ObservableValue",Q),J=function(){function e(e,t,r){this.target=e,this.name=t,this.defaultEnhancer=r,this.values={}}return e.prototype.read=function(e,t){if(this.target===e)return this.values[t].get();this.illegalAccess(e,t)},e.prototype.write=function(e,t,r){var n=this.target;if(n===e){var i=this.values[t];if(i instanceof H)i.set(r);else{if(X(this)){if(!(c=z(this,{type:"update",object:n,name:t,newValue:r})))return;r=c.newValue}if((r=i.prepareNewValue(r))!==q){var o=Z(this),s=p(),c=o||s?{type:"update",object:n,oldValue:i.value,name:t,newValue:r}:null;s&&v(a({},c,{name:this.name,key:t})),i.setNewValue(r),o&&W(this,c),s&&y()}}}else this.illegalAccess(e,t)},e.prototype.remove=function(e){if(this.values[e]){var t=this.target;if(X(this))if(!(o=z(this,{object:t,name:e,type:"remove"})))return;try{Zt();var r=Z(this),n=p(),i=this.values[e].get();this.keys&&this.keys.remove(e),delete this.values[e],delete this.target[e];var o=r||n?{type:"remove",object:t,oldValue:i,name:e}:null;n&&v(a({},o,{name:this.name,key:e})),r&&W(this,o),n&&y()}finally{Ut()}}},e.prototype.illegalAccess=function(e,t){return vt("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(e,t){return U(this,e)},e.prototype.intercept=function(e){return Y(this,e)},e.prototype.getKeys=function(){var e=this;return void 0===this.keys&&(this.keys=new nt(Object.keys(this.values).filter(function(t){return e.values[t]instanceof Q}),Ae,"keys("+this.name+")",!0)),this.keys.slice()},e}();function $(e,t,r){void 0===t&&(t=""),void 0===r&&(r=De);var n=e.$mobx;return n||(wt(e)||(t=(e.constructor.name||"ObservableObject")+"@"+ft()),t||(t="ObservableObject@"+ft()),bt(e,"$mobx",n=new J(e,t,r)),n)}function ee(e,t,r,n){var i=$(e);if(X(i)){var o=z(i,{object:e,name:t,type:"add",newValue:r});if(!o)return;r=o.newValue}r=(i.values[t]=new Q(r,n,i.name+"."+t,!1)).value,Object.defineProperty(e,t,function(e){return re[e]||(re[e]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}(t)),i.keys&&i.keys.push(t),function(e,t,r,n){var i=Z(e),o=p(),s=i||o?{type:"add",object:t,name:r,newValue:n}:null;o&&v(a({},s,{name:e.name,key:r}));i&&W(e,s);o&&y()}(i,e,t,r)}function te(e,t,r){var n=$(e);r.name=n.name+"."+t,r.context=e,n.values[t]=new H(r),Object.defineProperty(e,t,function(e){return ne[e]||(ne[e]={configurable:!0,enumerable:!1,get:function(){return ie(this).read(this,e)},set:function(t){ie(this).write(this,e,t)}})}(t))}var re={},ne={};function ie(e){var t=e.$mobx;return t||(h(e),e.$mobx)}var oe=Pt("ObservableObjectAdministration",J);function ae(e){return!!Ft(e)&&(h(e),oe(e.$mobx))}function se(t){var r=d(!0,function(e,r,n,i,o){ee(e,r,n?n.initializer?n.initializer.call(e):n.value:void 0,t)}),n=(void 0!==e&&e.env,r);return n.enhancer=t,n}function ce(e,t){if(null===e||void 0===e)return!1;if(void 0!==t){if(ae(e)){var r=e.$mobx;return r.values&&!!r.values[t]}return!1}return ae(e)||!!e.$mobx||je(e)||fr(e)||V(e)}function ue(e){return 1!==arguments.length&&vt(!1),ce(e)}function le(e,t){return"string"!=typeof t?vt(!1):ce(e,t)}function he(e,t){if(null===e||void 0===e)return!1;if(void 0!==t){if(!1===ae(e))return!1;if(!e.$mobx.values[t])return!1;var r=Ve(e,t);return V(r)}return V(e)}function de(e){return arguments.length>1?vt(!1):he(e)}function pe(e,t){return"string"!=typeof t?vt(!1):he(e,t)}var fe=d(!1,function(e,t,r,n,i){var o=r.get,s=r.set,c=i[0]||{};te(e,t,a({},c,{get:o,set:s}))}),ve=fe({equals:R.structural}),_e=function(e,t,r){if("string"==typeof t)return fe.apply(null,arguments);if(null!==e&&"object"==typeof e&&1===arguments.length)return fe.apply(null,arguments);var n="object"==typeof t?t:{};return n.get=e,n.set="function"==typeof t?t:n.set,n.name=n.name||e.name||"",new H(n)};function ye(e,t,r){return yt("'extendShallowObservable' is deprecated, use 'extendObservable(target, props, { deep: false })' instead"),me(e,t,r,Fe)}function me(e,t,r,n){var i=(n=we(n)).defaultDecorator||(!1===n.deep?Me:be);$(e,n.name,i.enhancer),Zt();try{for(var o in t){var a=Object.getOwnPropertyDescriptor(t,o);0;var s=(r&&o in r?r[o]:a.get?fe:i)(e,o,a,!0);s&&Object.defineProperty(e,o,s)}}finally{Ut()}return e}_e.struct=ve;var ge={deep:!0,name:void 0,defaultDecorator:void 0},Fe={deep:!1,name:void 0,defaultDecorator:void 0};function we(e){return null===e||void 0===e?ge:"string"==typeof e?{name:e,deep:!0}:e}function Ce(e){return e.defaultDecorator?e.defaultDecorator.enhancer:!1===e.deep?Ae:De}Object.freeze(ge),Object.freeze(Fe);var be=se(De),Pe=se(function(e,t,r){return void 0===e||null===e?e:ae(e)||ut(e)||He(e)?e:Array.isArray(e)?Te.array(e,{name:r,deep:!1}):wt(e)?Te.object(e,void 0,{name:r,deep:!1}):xt(e)?Te.map(e,{name:r,deep:!1}):vt(!1)}),Me=se(Ae),xe=se(function(e,t,r){0;return A(e,t)?t:e});var Se={box:function(e,t){arguments.length>2&&Ee("box");var r=we(t);return new Q(e,Ce(r),r.name)},shallowBox:function(e,t){return arguments.length>2&&Ee("shallowBox"),yt("observable.shallowBox","observable.box(value, { deep: false })"),Te.box(e,{name:t,deep:!1})},array:function(e,t){arguments.length>2&&Ee("array");var r=we(t);return new nt(e,Ce(r),r.name)},shallowArray:function(e,t){return arguments.length>2&&Ee("shallowArray"),yt("observable.shallowArray","observable.array(values, { deep: false })"),Te.array(e,{name:t,deep:!1})},map:function(e,t){arguments.length>2&&Ee("map");var r=we(t);return new Be(e,Ce(r),r.name)},shallowMap:function(e,t){return arguments.length>2&&Ee("shallowMap"),yt("observable.shallowMap","observable.map(values, { deep: false })"),Te.map(e,{name:t,deep:!1})},object:function(e,t,r){return"string"==typeof arguments[1]&&Ee("object"),me({},e,t,we(r))},shallowObject:function(e,t){return"string"==typeof arguments[1]&&Ee("shallowObject"),yt("observable.shallowObject","observable.object(values, {}, { deep: false })"),Te.object(e,{},{name:t,deep:!1})},ref:Me,shallow:Pe,deep:be,struct:xe},Te=function(e,t,r){if("string"==typeof arguments[1])return be.apply(null,arguments);if(ue(e))return e;var n=wt(e)?Te.object(e,t,r):Array.isArray(e)?Te.array(e,t):xt(e)?Te.map(e,t):e;if(n!==e)return n;vt(!1)};function Ee(e){vt("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}function De(e,t,r){return ue(e)?e:Array.isArray(e)?Te.array(e,{name:r}):wt(e)?Te.object(e,void 0,{name:r}):xt(e)?Te.map(e,{name:r}):e}function Ae(e){return e}function Oe(){return"function"==typeof Symbol&&Symbol.iterator||"@@iterator"}function ke(e,t){bt(e,Oe(),t)}function Le(e){return e[Oe()]=Ie,e}function Ie(){return this}function Re(e,t){void 0===t&&(t=void 0),Zt();try{return e.apply(t)}finally{Ut()}}Object.keys(Se).forEach(function(e){return Te[e]=Se[e]});var Ne={},Be=function(){function e(e,t,r){if(void 0===t&&(t=De),void 0===r&&(r="ObservableMap@"+ft()),this.enhancer=t,this.name=r,this.$mobx=Ne,this._keys=new nt(void 0,Ae,this.name+".keys()",!0),"function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return e.prototype._has=function(e){return this._data.has(e)},e.prototype.has=function(e){return this._hasMap.has(e)?this._hasMap.get(e).get():this._updateHasMapEntry(e,!1).get()},e.prototype.set=function(e,t){var r=this._has(e);if(X(this)){var n=z(this,{type:r?"update":"add",object:this,newValue:t,name:e});if(!n)return this;t=n.newValue}return r?this._updateValue(e,t):this._addValue(e,t),this},e.prototype.delete=function(e){var t=this;if(X(this)&&!(i=z(this,{type:"delete",object:this,name:e})))return!1;if(this._has(e)){var r=p(),n=Z(this),i=n||r?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return r&&v(a({},i,{name:this.name,key:e})),Re(function(){t._keys.remove(e),t._updateHasMapEntry(e,!1),t._data.get(e).setNewValue(void 0),t._data.delete(e)}),n&&W(this,i),r&&y(),!0}return!1},e.prototype._updateHasMapEntry=function(e,t){var r=this._hasMap.get(e);return r?r.setNewValue(t):(r=new Q(t,Ae,this.name+"."+e+"?",!1),this._hasMap.set(e,r)),r},e.prototype._updateValue=function(e,t){var r=this._data.get(e);if((t=r.prepareNewValue(t))!==q){var n=p(),i=Z(this),o=i||n?{type:"update",object:this,oldValue:r.value,name:e,newValue:t}:null;n&&v(a({},o,{name:this.name,key:e})),r.setNewValue(t),i&&W(this,o),n&&y()}},e.prototype._addValue=function(e,t){var r=this;Re(function(){var n=new Q(t,r.enhancer,r.name+"."+e,!1);r._data.set(e,n),t=n.value,r._updateHasMapEntry(e,!0),r._keys.push(e)});var n=p(),i=Z(this),o=i||n?{type:"add",object:this,name:e,newValue:t}:null;n&&v(a({},o,{name:this.name,key:e})),i&&W(this,o),n&&y()},e.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.keys=function(){return this._keys[Oe()]()},e.prototype.values=function(){var e=this,t=0;return Le({next:function(){return t<e._keys.length?{value:e.get(e._keys[t++]),done:!1}:{value:void 0,done:!0}}})},e.prototype.entries=function(){var e=this,t=0;return Le({next:function(){if(t<e._keys.length){var r=e._keys[t++];return{value:[r,e.get(r)],done:!1}}return{done:!0}}})},e.prototype.forEach=function(e,t){var r=this;this._keys.forEach(function(n){return e.call(t,r.get(n),n,r)})},e.prototype.merge=function(e){var t=this;return He(e)&&(e=e.toJS()),Re(function(){wt(e)?Object.keys(e).forEach(function(r){return t.set(r,e[r])}):Array.isArray(e)?e.forEach(function(e){var r=s(e,2),n=r[0],i=r[1];return t.set(n,i)}):xt(e)?e.forEach(function(e,r){return t.set(r,e)}):null!==e&&void 0!==e&&vt("Cannot initialize map from "+e)}),this},e.prototype.clear=function(){var e=this;Re(function(){nr(function(){e._keys.slice().forEach(function(t){return e.delete(t)})})})},e.prototype.replace=function(e){var t=this;return Re(function(){var r,n=wt(r=e)?Object.keys(r):Array.isArray(r)?r.map(function(e){return s(e,1)[0]}):xt(r)||He(r)?St(r.keys()):vt("Cannot get keys from '"+r+"'");t._keys.filter(function(e){return-1===n.indexOf(e)}).forEach(function(e){return t.delete(e)}),t.merge(e)}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var e=this,t={};return this._keys.forEach(function(r){return t[""+r]=e.get(r)}),t},e.prototype.toJS=function(){var e=this,t=new Map;return this._keys.forEach(function(r){return t.set(r,e.get(r))}),t},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var e=this;return this.name+"[{ "+this._keys.map(function(t){return t+": "+e.get(t)}).join(", ")+" }]"},e.prototype.observe=function(e,t){return U(this,e)},e.prototype.intercept=function(e){return Y(this,e)},e}();ke(Be.prototype,function(){return this.entries()}),bt(Be.prototype,"undefined"!=typeof Symbol?Symbol.toStringTag:"@@toStringTag","Map");var Ge,je,He=Pt("ObservableMap",Be);function Ve(e,t){if("object"==typeof e&&null!==e){if(ut(e))return void 0!==t&&vt(!1),e.$mobx.atom;if(He(e)){var r=e;return void 0===t?Ve(r._keys):((n=r._data.get(t)||r._hasMap.get(t))||vt(!1),n)}var n;if(h(e),t&&!e.$mobx&&e[t],ae(e))return t?((n=e.$mobx.values[t])||vt(!1),n):vt(!1);if(je(e)||V(e)||fr(e))return e}else if("function"==typeof e&&fr(e.$mobx))return e.$mobx;return vt(!1)}function Xe(e,t){return e||vt("Expecting some object"),void 0!==t?Xe(Ve(e,t)):je(e)||V(e)||fr(e)?e:He(e)?e:(h(e),e.$mobx?e.$mobx:void vt(!1))}function Ye(e,t){return(void 0!==t?Ve(e,t):ae(e)||He(e)?Xe(e):Ve(e)).name}function ze(e,t,r){return Ue("onBecomeObserved",e,t,r)}function Ze(e,t,r){return Ue("onBecomeUnobserved",e,t,r)}function Ue(e,t,r,n){var i="string"==typeof r?Ve(t,r):Ve(t),o="string"==typeof r?n:r,a=i[e];return"function"!=typeof a?vt(!1):(i[e]=function(){a.call(this),o.call(this)},function(){i[e]=a})}function We(e,t,r){void 0===t&&(t=gt),void 0===r&&(r=gt);var n=new Ge(e);return ze(n,t),Ze(n,r),n}var qe,Qe,Ke,Je,$e=(qe=!1,Qe={},Object.defineProperty(Qe,"0",{set:function(){qe=!0}}),Object.create(Qe)[0]=1,!1===qe),et=0,tt=function(){return function(){}}();Ke=tt,Je=Array.prototype,void 0!==Object.setPrototypeOf?Object.setPrototypeOf(Ke.prototype,Je):void 0!==Ke.prototype.__proto__?Ke.prototype.__proto__=Je:Ke.prototype=Je,Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(tt.prototype,e,{configurable:!0,writable:!0,value:Array.prototype[e]})});var rt=function(){function e(e,t,r,n){this.array=r,this.owned=n,this.values=[],this.lastKnownLength=0,this.atom=new Ge(e||"ObservableArray@"+ft()),this.enhancer=function(r,n){return t(r,n,e+"[..]")}}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.dehanceValues=function(e){return void 0!==this.dehancer&&this.values.length>0?e.map(this.dehancer):e},e.prototype.intercept=function(e){return Y(this,e)},e.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),U(this,e)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(e){if("number"!=typeof e||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(e>t){for(var r=new Array(e-t),n=0;n<e-t;n++)r[n]=void 0;this.spliceWithArray(t,0,r)}else this.spliceWithArray(e,t-e)},e.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t,t>0&&e+t+1>et&&st(e+t+1)},e.prototype.spliceWithArray=function(e,t,r){var n=this;er(this.atom);var i=this.values.length;if(void 0===e?e=0:e>i?e=i:e<0&&(e=Math.max(0,i+e)),t=1===arguments.length?i-e:void 0===t||null===t?0:Math.max(0,Math.min(t,i-e)),void 0===r&&(r=ht),X(this)){var o=z(this,{object:this.array,type:"splice",index:e,removedCount:t,added:r});if(!o)return ht;t=o.removedCount,r=o.added}var a=(r=0===r.length?r:r.map(function(e){return n.enhancer(e,void 0)})).length-t;this.updateArrayLength(i,a);var s=this.spliceItemsIntoValues(e,t,r);return 0===t&&0===r.length||this.notifyArraySplice(e,r,s),this.dehanceValues(s)},e.prototype.spliceItemsIntoValues=function(e,t,r){if(r.length<1e4)return(n=this.values).splice.apply(n,c([e,t],r));var n,i=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(r,this.values.slice(e+t)),i},e.prototype.notifyArrayChildUpdate=function(e,t,r){var n=!this.owned&&p(),i=Z(this),o=i||n?{object:this.array,type:"update",index:e,newValue:t,oldValue:r}:null;n&&v(a({},o,{name:this.atom.name})),this.atom.reportChanged(),i&&W(this,o),n&&y()},e.prototype.notifyArraySplice=function(e,t,r){var n=!this.owned&&p(),i=Z(this),o=i||n?{object:this.array,type:"splice",index:e,removed:r,added:t,removedCount:r.length,addedCount:t.length}:null;n&&v(a({},o,{name:this.atom.name})),this.atom.reportChanged(),i&&W(this,o),n&&y()},e}(),nt=function(e){function t(t,r,n,i){void 0===n&&(n="ObservableArray@"+ft()),void 0===i&&(i=!1);var o=e.call(this)||this,a=new rt(n,r,o,i);return bt(o,"$mobx",a),t&&t.length&&o.spliceWithArray(0,0,t),$e&&Object.defineProperty(a.array,"0",it),o}return o(t,e),t.prototype.intercept=function(e){return this.$mobx.intercept(e)},t.prototype.observe=function(e,t){return void 0===t&&(t=!1),this.$mobx.observe(e,t)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),e.map(function(e){return ut(e)?e.peek():e}))},t.prototype.replace=function(e){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,e)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(e,t,r){void 0===r&&(r=0),3===arguments.length&&yt("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return-1===n?void 0:this.get(n)},t.prototype.findIndex=function(e,t,r){void 0===r&&(r=0),3===arguments.length&&yt("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var n=this.peek(),i=n.length,o=r;o<i;o++)if(e.call(t,n[o],o,this))return o;return-1},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(e);case 2:return this.$mobx.spliceWithArray(e,t)}return this.$mobx.spliceWithArray(e,t,r)},t.prototype.spliceWithArray=function(e,t,r){return this.$mobx.spliceWithArray(e,t,r)},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.$mobx;return r.spliceWithArray(r.values.length,0,e),r.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.$mobx;return r.spliceWithArray(0,0,e),r.values.length},t.prototype.reverse=function(){var e=this.slice();return e.reverse.apply(e,arguments)},t.prototype.sort=function(e){var t=this.slice();return t.sort.apply(t,arguments)},t.prototype.remove=function(e){var t=this.$mobx.dehanceValues(this.$mobx.values).indexOf(e);return t>-1&&(this.splice(t,1),!0)},t.prototype.move=function(e,t){function r(e){if(e<0)throw new Error("[mobx.array] Index out of bounds: "+e+" is negative");var t=this.$mobx.values.length;if(e>=t)throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}if(yt("observableArray.move is deprecated, use .slice() & .replace() instead"),r.call(this,e),r.call(this,t),e!==t){var n,i=this.$mobx.values;n=e<t?c(i.slice(0,e),i.slice(e+1,t+1),[i[e]],i.slice(t+1)):c(i.slice(0,t),[i[e]],i.slice(t,e),i.slice(e+1)),this.replace(n)}},t.prototype.get=function(e){var t=this.$mobx;if(t){if(e<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},t.prototype.set=function(e,t){var r=this.$mobx,n=r.values;if(e<n.length){er(r.atom);var i=n[e];if(X(r)){var o=z(r,{type:"update",object:this,index:e,newValue:t});if(!o)return;t=o.newValue}(t=r.enhancer(t,i))!==i&&(n[e]=t,r.notifyArrayChildUpdate(e,t,i))}else{if(e!==n.length)throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+n.length);r.spliceWithArray(e,0,[t])}},t}(tt);ke(nt.prototype,function(){this.$mobx.atom.reportObserved();var e=this,t=0;return Le({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})}),Object.defineProperty(nt.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Ct(nt.prototype,"undefined"!=typeof Symbol?Symbol.toStringTag:"@@toStringTag","Array"),["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];_t("function"==typeof t,"Base function not defined on Array prototype: '"+e+"'"),Ct(nt.prototype,e,function(){return t.apply(this.peek(),arguments)})}),function(e,t){for(var r=0;r<t.length;r++)Ct(e,t[r],e[t[r]])}(nt.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var it=ot(0);function ot(e){return{enumerable:!1,configurable:!1,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function at(e){Object.defineProperty(nt.prototype,""+e,ot(e))}function st(e){for(var t=et;t<e;t++)at(t);et=e}st(1e3);var ct=Pt("ObservableArrayAdministration",rt);function ut(e){return Ft(e)&&ct(e.$mobx)}var lt="An invariant failed, however the error is obfuscated because this is an production build.",ht=[];Object.freeze(ht);var dt={};function pt(){return"undefined"!=typeof window?window:n}function ft(){return++Lt.mobxGuid}function vt(e){throw _t(!1,e),"X"}function _t(e,t){if(!e)throw new Error("[mobx] "+(t||lt))}Object.freeze(dt);function yt(e,t){return!1}function mt(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var gt=function(){};function Ft(e){return null!==e&&"object"==typeof e}function wt(e){if(null===e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function Ct(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function bt(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function Pt(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(e){return Ft(e)&&!0===e[r]}}function Mt(e){return Array.isArray(e)||ut(e)}function xt(e){return void 0!==pt().Map&&e instanceof pt().Map}function St(e){for(var t=[];;){var r=e.next();if(r.done)break;t.push(r.value)}return t}function Tt(){return"function"==typeof Symbol&&Symbol.toPrimitive||"@@toPrimitive"}function Et(e){return null===e?null:"object"==typeof e?""+e:e}var Dt,At,Ot=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","disableErrorBoundaries","runId"],kt=function(){return function(){this.version=5,this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.disableErrorBoundaries=!1}}(),Lt=new kt,It=!1,Rt=pt();function Nt(){return Lt}function Bt(){var e=new kt;for(var t in e)-1===Ot.indexOf(t)&&(Lt[t]=e[t]);Lt.allowStateChanges=!Lt.enforceActions}function Gt(e,t){return jt(Ve(e,t))}function jt(e){var t,r,n={name:e.name};return e.observing&&e.observing.length>0&&(n.dependencies=(t=e.observing,r=[],t.forEach(function(e){-1===r.indexOf(e)&&r.push(e)}),r).map(jt)),n}function Ht(e,t){return Vt(Ve(e,t))}function Vt(e){var t,r={name:e.name};return(t=e).observers&&t.observers.length>0&&(r.observers=function(e){return e.observers}(e).map(Vt)),r}function Xt(e,t){var r=e.observers.length;r&&(e.observersIndexes[t.__mapid]=r),e.observers[r]=t,e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function Yt(e,t){if(1===e.observers.length)e.observers.length=0,zt(e);else{var r=e.observers,n=e.observersIndexes,i=r.pop();if(i!==t){var o=n[t.__mapid]||0;o?n[i.__mapid]=o:delete n[i.__mapid],r[o]=i}delete n[t.__mapid]}}function zt(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,Lt.pendingUnobservations.push(e))}function Zt(){Lt.inBatch++}function Ut(){if(0==--Lt.inBatch){dr();for(var e=Lt.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,0===r.observers.length&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBecomeUnobserved()),r instanceof H&&r.suspend())}Lt.pendingUnobservations=[]}}function Wt(e){var t=Lt.trackingDerivation;return null!==t?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(0===e.observers.length&&Lt.inBatch>0&&zt(e),!1)}function qt(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===At.BREAK){var r=[];!function e(t,r,n){if(r.length>=1e3)return void r.push("(and many more)");r.push(""+new Array(n).join("\t")+t.name);t.dependencies&&t.dependencies.forEach(function(t){return e(t,r,n+1)})}(Gt(e),r,1),new Function("debugger;\n/*\nTracing '"+e.name+"'\n\nYou are entering this break point because derivation '"+e.name+"' is being traced and '"+t.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(e instanceof H?e.derivation.toString():"")+"\n\nThe dependencies for this derivation are:\n\n"+r.join("\n")+"\n*/\n    ")()}}Rt.__mobxInstanceCount?(Rt.__mobxInstanceCount++,setTimeout(function(){It||vt(!1)},1)):Rt.__mobxInstanceCount=1,function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"}(Dt||(Dt={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(At||(At={}));var Qt=function(){return function(e){this.cause=e}}();function Kt(e){return e instanceof Qt}function Jt(e){switch(e.dependenciesState){case Dt.UP_TO_DATE:return!1;case Dt.NOT_TRACKING:case Dt.STALE:return!0;case Dt.POSSIBLY_STALE:for(var t=ir(),r=e.observing,n=r.length,i=0;i<n;i++){var o=r[i];if(V(o)){if(Lt.disableErrorBoundaries)o.get();else try{o.get()}catch(e){return or(t),!0}if(e.dependenciesState===Dt.STALE)return or(t),!0}}return ar(e),or(t),!1}}function $t(){return null!==Lt.trackingDerivation}function er(e){var t=e.observers.length>0;Lt.computationDepth>0&&t&&vt(!1),Lt.allowStateChanges||!t&&"strict"!==Lt.enforceActions||vt(!1)}function tr(e,t,r){ar(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++Lt.runId;var n,i=Lt.trackingDerivation;if(Lt.trackingDerivation=e,!0===Lt.disableErrorBoundaries)n=t.call(r);else try{n=t.call(r)}catch(e){n=new Qt(e)}return Lt.trackingDerivation=i,function(e){for(var t=e.observing,r=e.observing=e.newObserving,n=Dt.UP_TO_DATE,i=0,o=e.unboundDepsCount,a=0;a<o;a++){var s=r[a];0===s.diffValue&&(s.diffValue=1,i!==a&&(r[i]=s),i++),s.dependenciesState>n&&(n=s.dependenciesState)}r.length=i,e.newObserving=null,o=t.length;for(;o--;){var s=t[o];0===s.diffValue&&Yt(s,e),s.diffValue=0}for(;i--;){var s=r[i];1===s.diffValue&&(s.diffValue=0,Xt(s,e))}n!==Dt.UP_TO_DATE&&(e.dependenciesState=n,e.onBecomeStale())}(e),n}function rr(e){var t=e.observing;e.observing=[];for(var r=t.length;r--;)Yt(t[r],e);e.dependenciesState=Dt.NOT_TRACKING}function nr(e){var t=ir(),r=e();return or(t),r}function ir(){var e=Lt.trackingDerivation;return Lt.trackingDerivation=null,e}function or(e){Lt.trackingDerivation=e}function ar(e){if(e.dependenciesState!==Dt.UP_TO_DATE){e.dependenciesState=Dt.UP_TO_DATE;for(var t=e.observing,r=t.length;r--;)t[r].lowestObserverState=Dt.UP_TO_DATE}}function sr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=!1;"boolean"==typeof e[e.length-1]&&(r=e.pop());var n=function(e){switch(e.length){case 0:return Lt.trackingDerivation;case 1:return Ve(e[0]);case 2:return Ve(e[0],e[1])}}(e);if(!n)return vt(!1);n.isTracing===At.NONE&&console.log("[mobx.trace] '"+n.name+"' tracing enabled"),n.isTracing=r?At.BREAK:At.LOG}var cr=function(){function e(e,t,r){void 0===e&&(e="Reaction@"+ft()),this.name=e,this.onInvalidate=t,this.errorHandler=r,this.observing=[],this.newObserving=[],this.dependenciesState=Dt.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+ft(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=At.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,Lt.pendingReactions.push(this),dr())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(Zt(),this._isScheduled=!1,Jt(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&p()&&f({name:this.name,type:"scheduled-reaction"})}catch(e){this.reportExceptionInDerivation(e)}}Ut()}},e.prototype.track=function(e){Zt();var t,r=p();r&&(t=Date.now(),v({name:this.name,type:"reaction"})),this._isRunning=!0;var n=tr(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&rr(this),Kt(n)&&this.reportExceptionInDerivation(n.cause),r&&y({time:Date.now()-t}),Ut()},e.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler)this.errorHandler(e,this);else{if(Lt.disableErrorBoundaries)throw e;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this;console.error(r,e),p()&&f({type:"error",name:this.name,message:r,error:""+e}),Lt.globalReactionErrorHandlers.forEach(function(r){return r(e,t)})}},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Zt(),rr(this),Ut()))},e.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e.$mobx=this,e},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(e){void 0===e&&(e=!1),sr(this,e)},e}();function ur(e){return Lt.globalReactionErrorHandlers.push(e),function(){var t=Lt.globalReactionErrorHandlers.indexOf(e);t>=0&&Lt.globalReactionErrorHandlers.splice(t,1)}}var lr=100,hr=function(e){return e()};function dr(){Lt.inBatch>0||Lt.isRunningReactions||hr(pr)}function pr(){Lt.isRunningReactions=!0;for(var e=Lt.pendingReactions,t=0;e.length>0;){++t===lr&&(console.error("Reaction doesn't converge to a stable state after "+lr+" iterations. Probably there is a cycle in the reactive function: "+e[0]),e.splice(0));for(var r=e.splice(0),n=0,i=r.length;n<i;n++)r[n].runReaction()}Lt.isRunningReactions=!1}var fr=Pt("Reaction",cr);function vr(e){var t=hr;hr=function(r){return e(function(){return t(r)})}}function _r(e,t,r,n){return"function"==typeof r?function(e,t,r,n){return Xe(e,t).observe(r,n)}(e,t,r,n):function(e,t,r){return Xe(e).observe(t,r)}(e,t,r)}function yr(e,t,r){return"function"==typeof r?function(e,t,r){return Xe(e,t).intercept(r)}(e,t,r):function(e,t){return Xe(e).intercept(t)}(e,t)}function mr(e,t,r){return 1===arguments.length||t&&"object"==typeof t?function(e,t){0;var r,n=new Promise(function(n,i){var o=gr(e,n,a({},t,{onError:i}));r=function(){o(),i("WHEN_CANCELLED")}});return n.cancel=r,n}(e,t):gr(e,t,r||{})}function gr(e,t,r){var n;"number"==typeof r.timeout&&(n=setTimeout(function(){if(!o.$mobx.isDisposed){o();var e=new Error("WHEN_TIMEOUT");if(!r.onError)throw e;r.onError(e)}},r.timeout)),r.name=r.name||"When@"+ft();var i=g(r.name+"-effect",t),o=N(function(t){e()&&(t.dispose(),n&&clearTimeout(n),i())},r);return o}function Fr(e){return ae(e)?e.$mobx.getKeys():He(e)?e._keys.slice():vt(!1)}function wr(e){return ae(e)?Fr(e).map(function(t){return e[t]}):He(e)?Fr(e).map(function(t){return e.get(t)}):ut(e)?e.slice():vt(!1)}function Cr(e,t,r){if(2!==arguments.length)if(ae(e)){var n=e.$mobx,i=n.values[t];i?i.set(r):ee(e,t,r,n.defaultEnhancer)}else if(He(e))e.set(t,r);else{if(!ut(e))return vt(!1);"number"!=typeof t&&(t=parseInt(t,10)),_t(t>=0,"Not a valid index: '"+t+"'"),Zt(),t>=e.length&&(e.length=t+1),e[t]=r,Ut()}else{Zt();var o=t;try{for(var a in o)Cr(e,a,o[a])}finally{Ut()}}}function br(e,t){if(ae(e))e.$mobx.remove(t);else if(He(e))e.delete(t);else{if(!ut(e))return vt(!1);"number"!=typeof t&&(t=parseInt(t,10)),_t(t>=0,"Not a valid index: '"+t+"'"),e.splice(t,1)}}function Pr(e,t){if(ae(e)){var r=Xe(e);return r.getKeys(),r.values[t]instanceof Q}return He(e)?e.has(t):ut(e)?t>=0&&t<e.length:vt(!1)}function Mr(e,t){if(Pr(e,t))return ae(e)?e[t]:He(e)?e.get(t):ut(e)?e[t]:vt(!1)}function xr(e,t){var r="function"==typeof e?e.prototype:e;for(var n in t){var i=t[n],o=i(r,n,Object.getOwnPropertyDescriptor(r,n));o&&Object.defineProperty(r,n,o)}return e}function Sr(e){var t=e.enforceActions,r=e.computedRequiresReaction,n=e.disableErrorBoundaries,i=e.arrayBuffer,o=e.reactionScheduler;if(void 0!==t){if("boolean"!=typeof t&&"strict"!==t)return fail("Invalid configuration for 'enforceActions': "+t);Lt.enforceActions=t,Lt.allowStateChanges=!0!==t&&"strict"!==t}void 0!==r&&(Lt.computedRequiresReaction=!!r),!0===e.isolateGlobalState&&(It=!0,pt().__mobxInstanceCount--),void 0!==n&&(!0===n&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),Lt.disableErrorBoundaries=!!n),"number"==typeof i&&st(i),o&&vr(o)}var Tr=0;function Er(e){1!==arguments.length&&vt("Flow expects one 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var r,n=arguments,i=++Tr,o=x(t+" - runid: "+i+" - init",e).apply(this,n),a=void 0,s=new Promise(function(e,n){var s=0;function c(e){var r;a=void 0;try{r=x(t+" - runid: "+i+" - yield "+s++,o.next).call(o,e)}catch(e){return n(e)}l(r)}function u(e){var r;a=void 0;try{r=x(t+" - runid: "+i+" - yield "+s++,o.throw).call(o,e)}catch(e){return n(e)}l(r)}function l(t){if(!t||"function"!=typeof t.then)return t.done?e(t.value):(a=Promise.resolve(t.value)).then(c,u);t.then(l,n)}r=n,c(void 0)});return s.cancel=x(t+" - runid: "+i+" - cancel",function(){try{a&&Dr(a);var e=o.return(),t=Promise.resolve(e.value);t.then(gt,gt),Dr(t),r(new Error("FLOW_CANCELLED"))}catch(e){r(e)}}),s}}function Dr(e){"function"==typeof e.cancel&&e.cancel()}var Ar={detectCycles:!0,exportMapsAsObjects:!0};function Or(e,t,r){void 0===r&&(r=[]),"boolean"==typeof t&&(t={detectCycles:t}),t||(t=Ar);var n=!0===t.detectCycles;function i(t){return n&&r.push([e,t]),t}if(ue(e)){if(n&&null===r&&(r=[]),n&&null!==e&&"object"==typeof e)for(var o=0,a=r.length;o<a;o++)if(r[o][0]===e)return r[o][1];if(ut(e)){var s=i([]),c=e.map(function(e){return Or(e,t,r)});s.length=c.length;for(o=0,a=c.length;o<a;o++)s[o]=c[o];return s}if(ae(e)){s=i({});for(var u in Fr(e),e)s[u]=Or(e[u],t,r);return s}if(He(e)){if(!1===t.exportMapsAsObjects){var l=i(new Map);return e.forEach(function(e,n){l.set(n,Or(e,t,r))}),l}var h=i({});return e.forEach(function(e,n){h[n]=Or(e,t,r)}),h}if(K(e))return Or(e.get(),t,r)}return e}function kr(e,t,r){var n;if(He(e)||ut(e)||K(e))n=Xe(e);else{if(!ae(e))return vt(!1);if("string"!=typeof t)return vt(!1);n=Xe(e,t)}return void 0!==n.dehancer?vt(!1):(n.dehancer="function"==typeof t?t:r,function(){n.dehancer=void 0})}"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:m,extras:{getDebugName:Ye}})}.call(this,r(329),r(152))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getFreedoXPath=function(){if(void 0===n)for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var r=e[t].getAttribute("src");Freedo.defined(r)&&-1!==r.indexOf("FreedoX.js")&&(n=r.substr(0,r.indexOf("FreedoX.js")))}return n}},function(e,t,r){var n=r(3).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){"use strict";var n=r(3),i=r(10),o=r(57),a=r(88),s=r(20),c=r(49),u=r(4),l=r(51),h=r(34),d=r(8),p=r(183),f=r(53).f,v=r(9).f,_=r(131),y=r(68),m="prototype",g="Wrong index!",F=n.ArrayBuffer,w=n.DataView,C=n.Math,b=n.RangeError,P=n.Infinity,M=F,x=C.abs,S=C.pow,T=C.floor,E=C.log,D=C.LN2,A=i?"_b":"buffer",O=i?"_l":"byteLength",k=i?"_o":"byteOffset";function L(e,t,r){var n,i,o,a=new Array(r),s=8*r-t-1,c=(1<<s)-1,u=c>>1,l=23===t?S(2,-24)-S(2,-77):0,h=0,d=e<0||0===e&&1/e<0?1:0;for((e=x(e))!=e||e===P?(i=e!=e?1:0,n=c):(n=T(E(e)/D),e*(o=S(2,-n))<1&&(n--,o*=2),(e+=n+u>=1?l/o:l*S(2,1-u))*o>=2&&(n++,o/=2),n+u>=c?(i=0,n=c):n+u>=1?(i=(e*o-1)*S(2,t),n+=u):(i=e*S(2,u-1)*S(2,t),n=0));t>=8;a[h++]=255&i,i/=256,t-=8);for(n=n<<t|i,s+=t;s>0;a[h++]=255&n,n/=256,s-=8);return a[--h]|=128*d,a}function I(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=r-1,u=e[c--],l=127&u;for(u>>=7;s>0;l=256*l+e[c],c--,s-=8);for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;n=256*n+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return n?NaN:u?-P:P;n+=S(2,t),l-=a}return(u?-1:1)*n*S(2,l-t)}function R(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function N(e){return[255&e]}function B(e){return[255&e,e>>8&255]}function G(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function j(e){return L(e,52,8)}function H(e){return L(e,23,4)}function V(e,t,r){v(e[m],t,{get:function(){return this[r]}})}function X(e,t,r,n){var i=p(+r);if(i+t>e[O])throw b(g);var o=e[A]._b,a=i+e[k],s=o.slice(a,a+t);return n?s:s.reverse()}function Y(e,t,r,n,i,o){var a=p(+r);if(a+t>e[O])throw b(g);for(var s=e[A]._b,c=a+e[k],u=n(+i),l=0;l<t;l++)s[c+l]=u[o?l:t-l-1]}if(a.ABV){if(!u(function(){F(1)})||!u(function(){new F(-1)})||u(function(){return new F,new F(1.5),new F(NaN),"ArrayBuffer"!=F.name})){for(var z,Z=(F=function(e){return l(this,F),new M(p(e))})[m]=M[m],U=f(M),W=0;U.length>W;)(z=U[W++])in F||s(F,z,M[z]);o||(Z.constructor=F)}var q=new w(new F(2)),Q=w[m].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||c(w[m],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else F=function(e){l(this,F,"ArrayBuffer");var t=p(e);this._b=_.call(new Array(t),0),this[O]=t},w=function(e,t,r){l(this,w,"DataView"),l(e,F,"DataView");var n=e[O],i=h(t);if(i<0||i>n)throw b("Wrong offset!");if(i+(r=void 0===r?n-i:d(r))>n)throw b("Wrong length!");this[A]=e,this[k]=i,this[O]=r},i&&(V(F,"byteLength","_l"),V(w,"buffer","_b"),V(w,"byteLength","_l"),V(w,"byteOffset","_o")),c(w[m],{getInt8:function(e){return X(this,1,e)[0]<<24>>24},getUint8:function(e){return X(this,1,e)[0]},getInt16:function(e){var t=X(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=X(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return R(X(this,4,e,arguments[1]))},getUint32:function(e){return R(X(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return I(X(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return I(X(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,N,t)},setUint8:function(e,t){Y(this,1,e,N,t)},setInt16:function(e,t){Y(this,2,e,B,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,B,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,G,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,G,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,H,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,j,t,arguments[2])}});y(F,"ArrayBuffer"),y(w,"DataView"),s(w[m],a.VIEW,!0),t.ArrayBuffer=F,t.DataView=w},function(e,t,r){"use strict";var n=r(15);e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},function(e,t,r){var n=r(3),i=r(129).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c="process"==r(27)(a);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve();r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var h=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),r=function(){d.data=h=!h}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){var n,i,o,a=r(28),s=r(202),c=r(147),u=r(151),l=r(3),h=l.process,d=l.setImmediate,p=l.clearImmediate,f=l.MessageChannel,v=l.Dispatch,_=0,y={},m=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},g=function(e){m.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++_]=function(){s("function"==typeof e?e:Function(e),t)},n(_),_},p=function(e){delete y[e]},"process"==r(27)(h)?n=function(e){h.nextTick(a(m,e,1))}:v&&v.now?n=function(e){v.now(a(m,e,1))}:f?(o=(i=new f).port2,i.port1.onmessage=g,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",g,!1)):n="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:d,clear:p}},function(e,t,r){"use strict";var n=r(45),i=r(192),o=r(66),a=r(23);e.exports=r(139)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t,r){"use strict";var n=r(12),i=r(55),o=r(8);e.exports=function(e){for(var t=n(this),r=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),c=a>2?arguments[2]:void 0,u=void 0===c?r:i(c,r);u>s;)t[s++]=e;return t}},function(e,t,r){var n=r(444);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(74),i=r(7)("iterator"),o=r(66);e.exports=r(37).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){"use strict";var n=r(9),i=r(59);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},function(e,t,r){var n=r(66),i=r(7)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(7)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,r){var n=r(94),i=r(35);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},function(e,t,r){"use strict";var n=r(54),i=r(59),o=r(68),a={};r(20)(a,r(7)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){"use strict";var n=r(57),i=r(0),o=r(19),a=r(20),s=r(66),c=r(138),u=r(68),l=r(21),h=r(7)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,r,f,v,_,y){c(r,t,f);var m,g,F,w=function(e){if(!d&&e in M)return M[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},C=t+" Iterator",b="values"==v,P=!1,M=e.prototype,x=M[h]||M["@@iterator"]||v&&M[v],S=x||w(v),T=v?b?w("entries"):S:void 0,E="Array"==t&&M.entries||x;if(E&&(F=l(E.call(new e)))!==Object.prototype&&F.next&&(u(F,C,!0),n||"function"==typeof F[h]||a(F,h,p)),b&&x&&"values"!==x.name&&(P=!0,S=function(){return x.call(this)}),n&&!y||!d&&!P&&M[h]||a(M,h,S),s[t]=S,s[C]=p,v)if(m={values:b?S:w("values"),keys:_?S:w("keys"),entries:T},y)for(g in m)g in M||o(M,g,m[g]);else i(i.P+i.F*(d||P),t,m);return m}},function(e,t,r){var n=r(34),i=r(35);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),c=n(r),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t){var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,r){"use strict";var n=r(34),i=r(35);e.exports=function(e){var t=String(i(this)),r="",o=n(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(r+=t);return r}},function(e,t,r){var n=r(5),i=r(146).set;e.exports=function(e,t,r){var o,a=t.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&n(o)&&i&&i(e,o),e}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,r){var n=r(5),i=r(2),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(28)(Function.call,r(22).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},function(e,t,r){var n=r(3).document;e.exports=n&&n.documentElement},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(98)("keys"),i=r(58);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(3),i=r(37),o=r(57),a=r(208),s=r(9).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(5),i=r(3).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(40),i=r(30),o=r(99);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n,i,o,a=r(48),s=r(223),c=r(168),u=r(121),l=r(16),h=l.process,d=l.setImmediate,p=l.clearImmediate,f=l.MessageChannel,v=l.Dispatch,_=0,y={},m=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},g=function(e){m.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++_]=function(){s("function"==typeof e?e:Function(e),t)},n(_),_},p=function(e){delete y[e]},"process"==r(71)(h)?n=function(e){h.nextTick(a(m,e,1))}:v&&v.now?n=function(e){v.now(a(m,e,1))}:f?(o=(i=new f).port2,i.port1.onmessage=g,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",g,!1)):n="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:d,clear:p}},function(e,t,r){var n=r(40),i=r(73),o=r(13)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[o])?t:i(r)}},function(e,t,r){var n=r(169),i=r(110).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdEraseGroundManager=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._scene=this._viewer.scene,this._egs=[],this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._options={}}return(0,i.default)(e,[{key:"eraseGroudByPointsArray",value:function(e,t){this._options["id_"+this._egs.length]={points:e,color:Freedo.clone(t,!0)};var r=new Freedo.GroundErasePrimitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolygonGeometry({polygonHierarchy:new Freedo.PolygonHierarchy(e)}),attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(t[0],t[1],t[2],1))}}),classificationType:Freedo.ClassificationType.TERRAIN,debugShowShadowVolume:!1}),n=this._scene.groundPrimitives.add(r);this._egs.push(n),this._event.raiseEvent("dataAdded",{points:e,color:t,erasePrimitive:r}),this._scene.requestRender()}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){for(var e in this._egs)this._scene.groundPrimitives.remove(this._egs[e]);this._options={},this._event.raiseEvent("dataRemoved",{}),this._scene.requestRender()}},{key:"dispose",value:function(){this.reset(),this._eventHelper.removeAll()}},{key:"eraseGroudOptions",get:function(){return this._options}}]),e}();t.FdEraseGroundManager=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdGeologySimulationManager=void 0;var n=c(r(104)),i=c(r(1)),o=c(r(6)),a=r(272),s=r(270);function c(e){return e&&e.__esModule?e:{default:e}}var u=new Freedo.Cartesian2(100,50),l=(new Freedo.Cartesian3,new Freedo.Cartesian3,new Freedo.Cartesian3,new Freedo.Cartographic),h=new Uint16Array([0,1,2,2,1,3]),d=function(){function e(t,r,o){(0,i.default)(this,e),this._drillDataArray=[],this._layerTextureMap=new n.default,this._bottomName="bottom",this._debugPointEntities=void 0,this._groundErasers=[],this._geologyPrimitives=[],this._scene=t,this._lastHeightPrimitive=void 0,this._drillOptions={},Freedo.defined(o)||(o="../../sampleData/GeologySimulation/GeoTexture/");for(var s=r.Geology.Drill,c=s.length-1;c>=0;c--){this._drillDataArray.push(new a.DrillData(s[c]));for(var u=s[c].layer,l=u.length-1;l>=0;l--){var h=u[l];this._layerTextureMap.has(h.name)||this._layerTextureMap.set(h.name,o+h.texture)}}this._layerTextureMap.set(this._bottomName,o+"bottom.jpg");var d=[];for(c=this._drillDataArray.length-1;c>=0;c--)d.push(this._drillDataArray[c].cartesianOnZeroHeight);this._extent=Freedo.BoundingSphere.fromPoints(d),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper}return(0,o.default)(e,[{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"interpolateCartographics",value:function(e,t){for(var r=this._scene.terrainProvider,n=[],i=1;i<e.length;i++){var o=(0,s.interpolate)(e[i-1],e[i],t);1===i&&n.push(e[i-1]);for(var a=0;a<o.length;a++)n.push(o[a]);n.push(e[i])}return Freedo.defined(r)?Freedo.sampleTerrainMostDetailed(r,n):Freedo.when.resolve(n)}},{key:"addDebugPoints",value:function(e){if(!this._debugPointEntities){this._debugPointEntities=[];for(var t=this._drillDataArray.length-1;t>=0;t--){var r=e.entities.add({position:this._drillDataArray[t].cartesian,point:{pixelSize:5,color:Freedo.Color.WHITE,outlineColor:Freedo.Color.BLACK,outlineWidth:2,heightReference:Freedo.HeightReference.CLAMP_TO_GROUND}});this._debugPointEntities.push(r)}}}},{key:"addGeologyPrimitives",value:function(e,t,r,n,i,o){for(var a=this._scene.primitives,c=[],d=[],p=0,f=0,v=0;v<e.length-1;++v){var _=e[v],y=e[v+1],m=Freedo.Cartesian3.fromRadians(_.pos.longitude,_.pos.latitude,_.pos.height),g=Freedo.Cartesian3.fromRadians(y.pos.longitude,y.pos.latitude,y.pos.height),F=Freedo.Cartesian3.distance(m,g);M(_,y,f,F,t,r),f+=F,l.longitude+=_.pos.longitude,l.latitude+=_.pos.latitude}l.longitude+=e[v].pos.longitude,l.latitude+=e[v].pos.latitude,l.longitude/=e.length,l.latitude/=e.length;var w,C=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(l);if(n){var b=new Freedo.Cartesian3;Freedo.Cartesian3.multiplyByScalar(C,p,b),w=Freedo.Matrix4.fromTranslation(b)}else w=Freedo.Matrix4.IDENTITY;i&&function(){var t=[];t.closed=!1,t.name="bottom",d.push(t);for(var r=[],n=new Freedo.Cartesian3,i=0;i<e.length;++i){var o=e[i],a=o.layers[o.layers.length-1].depth,c=Freedo.Cartesian3.fromRadians(o.pos.longitude,o.pos.latitude,o.pos.height),l=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(o.pos),h=(0,s.getOffsetPoint)(c,l,-a);r.push(h),Freedo.Cartesian3.add(n,h,n)}Freedo.Cartesian3.multiplyByScalar(n,1/r.length,n);var p=r.length+1,f=new Float64Array(3*p),v=new Float32Array(2*p),_=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY;f[0]=n.x,f[1]=n.y,f[2]=n.z,v[0]=0,v[1]=0;for(var i=0;i<p-1;i++)f[3+3*i+0]=r[i].x,f[3+3*i+1]=r[i].y,f[3+3*i+2]=r[i].z,v[2+2*i+0]=(r[i].x-n.x)/u.x,v[2+2*i+0]<_&&(_=v[2+2*i+0]),v[2+2*i+1]=(r[i].y-n.y)/u.y,v[2+2*i+1]<y&&(y=v[2+2*i+1]);for(var i=0;i<p;i++)v[2*i+0]-=_,v[2*i+1]-=y;var m=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:f}),st:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:v})},primitiveType:Freedo.PrimitiveType.TRIANGLE_FAN,boundingSphere:Freedo.BoundingSphere.fromVertices(f)});m.layerName="bottom",t.push(m)}();for(v=0;v<d.length;v++){var P=d[v];S(this._layerTextureMap.get(P.name),P,o)}return function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].waterDepth,i=e[r].pos;t.push(Freedo.Cartesian3.fromRadians(i.longitude,i.latitude,i.height-n))}var o=new Freedo.PolylineGeometry({positions:t,width:3,vertexFormat:Freedo.VertexFormat.POSITION_ONLY,followSurface:!1}),s=a.add(new Freedo.Primitive({asynchronous:!1,geometryInstances:[new Freedo.GeometryInstance({geometry:o,modelMatrix:w,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(.3,.3,1,1))}})],appearance:new Freedo.PolylineColorAppearance({translucent:!1})}));c.push(s)}(e),c;function M(e,t,r,n,i,o){var a,s,c,u,l,h,d=1,p=0,f=0;for(a=0;a<e.layers.length;++a){for(u=(c=e.layers[a]).name,s=0;s<t.layers.length;++s)if(!(l=t.layers[s]).allocated){if(l.allocated=!0,(h=l.name)===u){x(d++,u,e.pos,p,p+c.thickness,t.pos,f,f+l.thickness,r,n,i,o),p+=c.thickness,f+=l.thickness;break}x(d++,h,e.pos,p,p,t.pos,f,f+l.thickness,r,n,i,o),f+=l.thickness}s===t.layers.length&&(x(d++,u,e.pos,p,p+c.thickness,t.pos,f,f,r,n,i,o),p+=c.thickness)}for(;s<t.layers.length;++s)(l=t.layers[s]).allocated||(l.allocated=!0,x(d++,h=l.name,e.pos,p,p,t.pos,f,f+l.thickness,r,n,i,o),f+=l.thickness)}function x(e,t,r,n,i,o,a,c,l,f,v,_){var y=void 0,m=Math.max(i,c);p<m&&(p=m);for(var g=0;g<d.length;g++)if(!d[g].closed&&d[g].name===t&&Freedo.Math.equalsEpsilon(d[g].depth0,n,Freedo.Math.EPSILON5)&&Freedo.Math.equalsEpsilon(d[g].depth1,i,Freedo.Math.EPSILON5)){y=d[g];break}Freedo.defined(y)||((y=[]).closed=!1,y.name=t,d.push(y)),y.depth0=a,y.depth1=c,a===c&&(y.closed=!0);var F=Freedo.Cartesian3.fromRadians(r.longitude,r.latitude,r.height),w=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(r),C=Freedo.Cartesian3.fromRadians(o.longitude,o.latitude,o.height),b=Freedo.Ellipsoid.WGS84.geodeticSurfaceNormalCartographic(o),P=(0,s.getOffsetPoint)(F,w,-n),M=(0,s.getOffsetPoint)(C,b,-a),x=(0,s.getOffsetPoint)(F,w,-i),S=(0,s.getOffsetPoint)(C,b,-c),T=new Float64Array(12);T[0]=P.x,T[1]=P.y,T[2]=P.z,T[3]=x.x,T[4]=x.y,T[5]=x.z,T[6]=M.x,T[7]=M.y,T[8]=M.z,T[9]=S.x,T[10]=S.y,T[11]=S.z;var E=new Float32Array(8);E[0]=l/v/u.x,E[1]=n/_/u.y,E[2]=l/v/u.x,E[3]=i/_/u.y,E[4]=(l+f)/v/u.x,E[5]=a/_/u.y,E[6]=(l+f)/v/u.x,E[7]=c/_/u.y;var D=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:T}),st:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})},indices:h,primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(T)});D.layerName=t,D.layerIndex=e,D.depth=(Math.abs(i-n)+Math.abs(c-a))/2,y.push(D)}function S(e,t,r){for(var n,i=[],o=0,s=0;s<t.length;++s)i.push(new Freedo.GeometryInstance({geometry:t[s],modelMatrix:w})),n=t[s].layerName,o+=t[s].depth;o/=t.length;var l=a.add(new Freedo.Primitive({asynchronous:!1,geometryInstances:i,appearance:new Freedo.MaterialAppearance({materialSupport:Freedo.MaterialAppearance.MaterialSupport.TEXTURED,material:new Freedo.Material({fabric:{materials:{first:{type:"DiffuseMap",uniforms:{image:e,repeat:u}}},uniforms:{value:[0,0,0,1]},components:{diffuse:"vec3(value[0][0], value[0][1], value[1][0]) + first.diffuse",alpha:"value[1][1]"}}})})}));l.layerName=n,l.drillsInfo=r,l.depth=o,l.offsetMatrix=w,c.push(l)}}},{key:"getSimulateDrills",value:function(e,t){var r=[];if(this._drillDataArray.length>0)for(var n=0,i=e.length;n<i;n++){var o=(0,s.getSimulateDrill)(this,e[n],t);Freedo.defined(o)&&r.push({pos:e[n],waterDepth:o.waterDepth,drillInfo:o.drillsInfo,layers:o.layers})}return r}},{key:"getRelativeDrillsInfo",value:function(e,t){for(var r=[],n=0;n<t.length-1;n++){for(var i=t[n],o=-1,a=Number.MAX_VALUE,s=0;s<e.length;s++){var c=i.longitude-e[s].pos.longitude,u=i.latitude-e[s].pos.latitude,l=c*c+u*u;a>l&&(o=s,a=l)}var h={drillsInfo:e[o].drillInfo,pos:e[o].pos};r.push(h)}return r}},{key:"addGeologySimulation",value:function(e,t,r,n,i,o){if(e.length<2)throw new Freedo.RuntimeError("The input points array is invalid !");if(t=Freedo.defaultValue(t,1),r=Freedo.defaultValue(r,5),n=Freedo.defaultValue(n,5),i=Freedo.defaultValue(i,!1),o=Freedo.defaultValue(o,!0),e.length>2){var a=e[0];e.push(a)}this._drillOptions["Drill"+(new Date).getTime()]={points:e,maxStep:t,tileS:r,tileT:n,flipUp:i,buildBottom:o};var s=this._scene;s.globe.depthTestAgainstTerrain=!0,s.screenSpaceCameraController.enableCollisionDetection=!1;var c=s.terrainProvider,u=this;this.interpolateCartographics(e,t,c).then(function(t){for(var a=[],c=0;c<t.length-1;c++)a.push(Freedo.Cartesian3.fromRadians(t[c].longitude,t[c].latitude,t[c].height));var l={pints:e};if(!i){var h=new Freedo.GroundErasePrimitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolygonGeometry({polygonHierarchy:new Freedo.PolygonHierarchy(a)}),attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(0,0,0,1))}}),classificationType:Freedo.ClassificationType.CESIUM_3D_TILE});l.erasePritive=h,u._groundErasers.push(s.primitives.add(h))}var d=u.getSimulateDrills(t,100);if(d.length>0){var p=u.getRelativeDrillsInfo(d,e),f=u.addGeologyPrimitives(d,r,n,i,o,p);u._geologyPrimitives=u._geologyPrimitives.concat(f),l.geologyPrimitives=f}u._event.raiseEvent("dataAdded",l),u._scene.requestRender()},function(e){throw new Freedo.RuntimeError("TerrainProvider maybe invalidate. Check if there is a terrain in scene !")})}},{key:"pickGeologySimulations",value:function(e){Freedo.defined(this._lastHeightPrimitive)&&(this._lastHeightPrimitive.appearance.material.uniforms.value=[0,0,0,1],this._lastHeightPrimitive=void 0);var t=this._scene.globe.depthTestAgainstTerrain;this._scene.globe.depthTestAgainstTerrain=!0;var r=scene.pick(e),n=void 0;return Freedo.defined(r)&&Freedo.defined(r.primitive)&&(r.primitive.appearance.material.uniforms.value=[.8,.6,.6,.9],this._lastHeightPrimitive=r.primitive,n={layerName:r.primitive.layerName,depth:r.primitive.depth,primitive:r.primitive,drillsInfo:r.primitive.drillsInfo,offsetMatrix:r.primitive.offsetMatrix}),this._scene.globe.depthTestAgainstTerrain=t,this._scene.requestRender(),n}},{key:"removeAllGeologySimulations",value:function(){this._lastHeightPrimitive=void 0;for(var e=this._scene,t=this._groundErasers.length-1;t>=0;t--)e.primitives.remove(this._groundErasers[t]);this._groundErasers.splice(0);for(t=this._geologyPrimitives.length-1;t>=0;t--)e.primitives.remove(this._geologyPrimitives[t]);this._geologyPrimitives.splice(0),this._event.raiseEvent("dataRemoved",{}),e.requestRender()}},{key:"dispose",value:function(){removeAllGeologySimulations(),this._layerTextureMap.clear(),this._drillDataArray=[],this._eventHelper.removeAll()}},{key:"drillOptions",get:function(){return this._drillOptions}}]),e}();t.FdGeologySimulationManager=d},function(e,t,r){"use strict";var n=r(17),i=r(73),o=r(48),a=r(69);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),void 0==e?new this:(r=[],t?(n=0,s=o(c,arguments[2],2),a(e,!1,function(e){r.push(s(e,n++))})):a(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";var n=r(17);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){var n=r(79),i=r(281);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(71);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){"use strict";var n=r(16),i=r(17),o=r(106),a=r(64),s=r(44),c=r(108),u=r(69),l=r(107),h=r(30),d=r(70),p=r(31).f,f=r(285)(0),v=r(29);e.exports=function(e,t,r,_,y,m){var g=n[e],F=g,w=y?"set":"add",C=F&&F.prototype,b={};return v&&"function"==typeof F&&(m||C.forEach&&!a(function(){(new F).entries().next()}))?(F=t(function(t,r){l(t,F,e,"_c"),t._c=new g,void 0!=r&&u(r,y,t[w],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in C&&(!m||"clear"!=e)&&s(F.prototype,e,function(r,n){if(l(this,F,e),!t&&m&&!h(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i})}),m||p(F.prototype,"size",{get:function(){return this._c.size}})):(F=_.getConstructor(t,e,y,w),c(F.prototype,r),o.NEED=!0),d(F,e),b[e]=F,i(i.G+i.W+i.F,b),m||_.setStrong(F,e,y),F}},function(e,t,r){"use strict";var n=r(16),i=r(14),o=r(31),a=r(29),s=r(13)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){"use strict";var n=r(31).f,i=r(115),o=r(108),a=r(48),s=r(107),c=r(69),u=r(116),l=r(171),h=r(165),d=r(29),p=r(106).fastKey,f=r(105),v=d?"_s":"size",_=function(e,t){var r,n=p(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e(function(e,n){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=n&&c(n,r,e[u],e)});return o(l.prototype,{clear:function(){for(var e=f(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var r=f(this,t),n=_(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[v]--}return!!n},forEach:function(e){f(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!_(f(this,t),e)}}),d&&n(l.prototype,"size",{get:function(){return f(this,t)[v]}}),l},def:function(e,t,r){var n,i,o=_(e,t);return o?o.v=r:(e._l=o={i:i=p(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:_,setStrong:function(e,t,r){u(e,t,function(e,r){this._t=f(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},r?"entries":"values",!r,!0),h(t)}}},function(e,t,r){var n=r(79),i=r(13)("iterator"),o=r(62);e.exports=r(14).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(16).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(47),i=r(61),o=r(295)(!1),a=r(112)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),c=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){e.exports=r(44)},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTransformHelper=void 0;var n=a(r(1)),i=a(r(6)),o=r(308);r(11);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._bInTransform=!1,this._transType="MOVE",this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._sceneSphere={},this._basePt=void 0,this._t12={TMoveX:0,TMoveY:0,TMoveZ:0,DMoveX:0,DMoveY:0,DMoveZ:0,THeading:0,TPitch:0,TRoll:0,TScaleX:1,TScaleY:1,TScaleZ:1,TBaseX:0,TBaseY:0,TBaseZ:0},this._aPModelSet=[],this._mani=new o.FdTransformManipulator(t),this._maniCallBack=void 0,this._mouseDown12Arg={},this._mouseDownMM=FreeDo.Matrix4.IDENTITY,this._selectedAxis="",this._centerDis={},this._inMoveTo=!1,this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3},this._axisZoom=1}return(0,i.default)(e,[{key:"tranOptions",get:function(){var e=[];for(var t in this._aPModelSet){e=this._aPModelSet[t].modelMatrix}return{modelMatrix:e}},set:function(e){if(Freedo.defined(e))for(var t in this._aPModelSet){this._aPModelSet[t].modelMatrix=Freedo.clone(e.modelMatrix,!0)}}}]),e}();s.prototype.setData=function(e){this._aPModelSet=e},s.prototype.hideAxis=function(){this._transType=""},s.prototype.setAxisSize=function(e){this._mani.setAxisSize(e)},s.prototype.setArg=function(e,t){switch(e){case"basePtX":this._t12.TBaseX=t;break;case"basePtY":this._t12.TBaseY=t;break;case"basePtZ":this._t12.TBaseZ=t;break;case"translateX":this._t12.DMoveX=t;break;case"translateY":this._t12.DMoveY=t;break;case"translateZ":this._t12.DMoveZ=t;break;case"rotateX":this._t12.THeading=t;break;case"rotateY":this._t12.TPitch=t;break;case"rotateZ":this._t12.TRoll=t;break;case"scaleX":this._t12.TScaleX=t;break;case"scaleY":this._t12.TScaleY=t;break;case"scaleZ":this._t12.TScaleZ=t}this._t12.TMoveX=this._t12.TBaseX+this._t12.DMoveX,this._t12.TMoveY=this._t12.TBaseY+this._t12.DMoveY,this._t12.TMoveZ=this._t12.TBaseZ+this._t12.DMoveZ;var r=Freedo.Math.toRadians,n=Freedo.Math.toDegrees,i=this.getMatrix(r(this._t12.DMoveX),r(this._t12.DMoveY),this._t12.DMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,this._t12.TScaleX,this._t12.TScaleY,this._t12.TScaleZ,Freedo.Math.toRadians(this._t12.TBaseX),Freedo.Math.toRadians(this._t12.TBaseY),this._t12.TBaseZ),o=Freedo.Cartesian3.fromDegrees(this._t12.TBaseX,this._t12.TBaseY,this._t12.TBaseZ),a=Freedo.Matrix4.multiplyByPoint(i,o,new Freedo.Cartesian3),s=Freedo.Cartographic.fromCartesian(a);this._t12.TMoveX=n(s.longitude),this._t12.TMoveY=n(s.latitude),this._t12.TMoveZ=s.height,this._mani.updatePosition(this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ),this._mani.updateBasePt(this._t12.TBaseX,this._t12.TBaseY,this._t12.TBaseZ),this._sceneSphere.center=Freedo.Cartesian3.fromDegrees(this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ)},s.prototype.getMatrix=function(e,t,r,n,i,o,a,s,c,u,l,h){var d=Freedo.Cartesian3.fromRadians(u,l,h),p=Freedo.Cartesian3.fromRadians(u+e,l+t,h+r);n=Freedo.Math.toRadians(n),i=Freedo.Math.toRadians(i),o=Freedo.Math.toRadians(o);var f=Freedo.Quaternion.fromHeadingPitchRoll(new Freedo.HeadingPitchRoll(n,i,o)),v=new Freedo.Cartesian3(a,s,c),_=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,f,v),y=Freedo.Transforms.eastNorthUpToFixedFrame(d),m=Freedo.Matrix4.inverse(y,new Freedo.Matrix4),g=Freedo.Transforms.eastNorthUpToFixedFrame(p),F=Freedo.Matrix4.multiply(_,m,new Freedo.Matrix4),w=Freedo.Matrix4.multiply(g,F,new Freedo.Matrix4);return Freedo.clone(w,!0)},s.prototype.getMatrixOfTileset=function(e,t,r,n,i,o,a,s,c,u,l,h,d){if(void 0!==e){if(void 0===l){var p=this.getTilesetBasePt(e);l=p.longitude,h=p.latitude,d=p.height}var f=Freedo.Cartesian3.fromRadians(l,h,d),v=Freedo.Cartesian3.fromRadians(l+t,h+r,d+n);i=Freedo.Math.toRadians(i),o=Freedo.Math.toRadians(o),a=Freedo.Math.toRadians(a);var _=Freedo.Quaternion.fromHeadingPitchRoll(new Freedo.HeadingPitchRoll(i,o,a)),y=new Freedo.Cartesian3(s,c,u),m=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,_,y),g=Freedo.Transforms.eastNorthUpToFixedFrame(f),F=Freedo.Matrix4.inverse(g,new Freedo.Matrix4),w=Freedo.Transforms.eastNorthUpToFixedFrame(v),C=Freedo.Matrix4.multiply(m,F,new Freedo.Matrix4),b=Freedo.Matrix4.multiply(w,C,new Freedo.Matrix4);return Freedo.clone(b,!0)}},s.prototype.startTransform=function(e,t){if(this._bInTransform=!0,this._transType=e,this._aPModelSet.length>0){if(this.checkConflict())return;for(var r in this._basePt=void 0,this.calcSceneBS(),this._aPModelSet){var n=this._aPModelSet[r];this._mouseDownMat=FreeDo.clone(n.modelMatrix,!0)}}var i=this;this._maniCallBack=this._mani.on(function(e,t){"Transform"==e&&i.onTransform(),"Transformed"==e&&i.onTransformed(),"GotoPoint"==e&&i.onGotoPoint(t),"Transforming"==e&&i.onTransforming(t)}),this._transType.indexOf("MOVETO")>=0&&(this._inMoveTo=!0),this._mani.startTransform(this._transType),this._event.raiseEvent("Start",{}),this._aPModelSet.length>0&&(this._mani.updateSceneSphere(this._sceneSphere),this._mani.updatePosition(this._basePt.longitude,this._basePt.latitude,this._basePt.height),this._mani.updateBasePt(this._basePt.longitude,this._basePt.latitude,this._basePt.height))},s.prototype.start=function(e,t){this.startTransform(e,t)},s.prototype.getData=function(){var e=[];for(var t in this._aPModelSet){var r=this._aPModelSet[t];e.push({modelMatrix:FreeDo.clone(r.modelMatrix,!0),tileset:r})}return e},s.prototype.checkConflict=function(){var e=0,t=0;for(var r in this._aPModelSet){this._aPModelSet[r];var n=this._aPModelSet[r].transformTime;if(0==t)e=void 0===n?void 0:Freedo.clone(n,!0);else if(n!==e)return alert("编辑状态存在冲突无法继续！"),this.cancelTransform(),!0;t++}return!1},s.prototype.initTransform=function(){var e=0,t=0;for(var r in this._aPModelSet){this._aPModelSet[r];var n=this._aPModelSet[r].transformTime;0==t?e=void 0===n?void 0:Freedo.clone(n,!0):n!==e&&console.log("部分模型存在变换，部分没有，请注意"),t++}for(var r in this._aPModelSet){this._aPModelSet[r];void 0!=(e=this._aPModelSet[r].transformTime)&&0!=e||this.resetTransform(),void 0!==(n=this._aPModelSet[r].transformMatrix)&&(this._t12=FreeDo.clone(n,!0)),this._event.raiseEvent("InitTransform",FreeDo.clone(this._t12,!0))}},s.prototype.updateBasePt=function(){this._basePt={longitude:Freedo.Math.toRadians(this._t12.TMoveX),latitude:Freedo.Math.toRadians(this._t12.TMoveY),height:this._t12.TMoveZ}},s.prototype.getModelBS=function(e){var t=Freedo.Matrix4.getTranslation(e.modelMatrix,new Freedo.Cartesian3),r=e.boundingSphere;return new Freedo.BoundingSphere(t,r.radius)},s.prototype.calcSceneBS=function(){var e=[];for(var t in this._aPModelSet){var r=this._aPModelSet[t];void 0===r&&console.log("FdTransform：无效数据");var n=r.boundingSphere;r instanceof Freedo.Model?n=this.getModelBS(r):r.point&&(n=new Freedo.BoundingSphere(r.position.getValue(),10)),e.push(n)}this._sceneSphere=FreeDo.BoundingSphere.fromBoundingSpheres(e,new FreeDo.BoundingSphere),void 0===this._basePt&&(this._basePt=Freedo.Cartographic.fromCartesian(this._sceneSphere.center),this._basePt.longitude=Freedo.Math.toDegrees(this._basePt.longitude),this._basePt.latitude=Freedo.Math.toDegrees(this._basePt.latitude))},s.prototype.calcXYZDist=function(e,t,r,n,i,o){return[n-e,i-t,o-r]},s.prototype.calcAxisZoom=function(){if(!1!==this._bInClip){var e,t=this._sceneSphere.center,r=this._viewer.camera.positionWC;e=Freedo.Cartesian3.distance(t,r)/6,this._viewer.camera.getPixelSize(this._sceneSphere,10,10),this._axisZoom=e,this._viewer.scene._mode===Freedo.SceneMode.COLUMBUS_VIEW&&(this._axisZoom=this._viewer.camera.positionWC.x/6),this._axisZoom>4e5&&(this._axisZoom=4e5),this._axisZoom<1&&(this._axisZoom=1)}else this._axisZoom=1},s.prototype.onTransforming=function(e){var t=e.MouseDownPos,r=e.MouseMovePos,n=e.SelectedAxis,i=e.FixedAxis;this._selectedAxis=n;var o=[0,0,0],a=1,s=1,c=1,u=0,l=0,h=0;this.calcAxisZoom();var d=void 0;Freedo.defined(t)&&(d=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,t.height));var p=void 0;Freedo.defined(r)&&(p=Freedo.Cartesian3.fromRadians(r.longitude,r.latitude,r.height));var f=0,v=0;d&&(f=Freedo.Cartesian3.distance(d,this._sceneSphere.center)),p&&(v=Freedo.Cartesian3.distance(p,this._sceneSphere.center));var _=Freedo.clone(this._mouseDown12Arg,!0);if(this._aPModelSet.length>0&&this.calcSceneBS(),"XY"===n&&(o=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,r.latitude,t.height)),"YZ"===n&&(o=this.calcXYZDist(t.longitude,t.latitude,t.height,t.longitude,r.latitude,r.height)),"XZ"===n&&(o=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,t.latitude,r.height)),"X"===i&&(o=this.calcXYZDist(t.longitude,t.latitude,t.height,r.longitude,t.latitude,t.height)),"Y"===i&&(o=this.calcXYZDist(t.longitude,t.latitude,t.height,t.longitude,r.latitude,t.height)),"Z"===i&&(o[0]=0,o[1]=0,o[2]=-1*(e.MouseMoveXY.y-e.MouseDownXY.y)*this._axisZoom/100),this._transType.indexOf("SCALE")>=0&&"XY_QCIRCLE"===n){var y=v/f;a=y,s=y,c=y}var m={};if(this._transType.indexOf("ROTATE")>=0&&"XY_CIRCLE"===n){m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);var g=FreeDo.Cartesian3.fromRadians(m.longitude+.01,m.latitude,m.height),F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3),w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3),C=FreeDo.Cartesian3.subtract(p,this._sceneSphere.center,new FreeDo.Cartesian3),b=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(C,F)),P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));t.latitude<m.latitude&&(P=360-P),r.latitude<m.latitude&&(b=360-b),u=P-b}if(this._transType.indexOf("ROTATE")>=0&&"XZ_CIRCLE"===n){if(!Freedo.defined(d))return;m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);g=FreeDo.Cartesian3.fromRadians(m.longitude+.01,m.latitude,m.height),F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3),w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3),C=FreeDo.Cartesian3.subtract(p,this._sceneSphere.center,new FreeDo.Cartesian3),b=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(C,F)),P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));t.height<m.height&&(P=360-P),r.height<m.height&&(b=360-b),l=b-P}if(this._transType.indexOf("ROTATE")>=0&&"YZ_CIRCLE"===n){if(!Freedo.defined(d))return;m=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);g=FreeDo.Cartesian3.fromRadians(m.longitude,m.latitude+.01,m.height),F=FreeDo.Cartesian3.subtract(g,this._sceneSphere.center,new FreeDo.Cartesian3),w=FreeDo.Cartesian3.subtract(d,this._sceneSphere.center,new FreeDo.Cartesian3),C=FreeDo.Cartesian3.subtract(p,this._sceneSphere.center,new FreeDo.Cartesian3),b=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(C,F)),P=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,F));t.height<m.height&&(P=360-P),r.height<m.height&&(b=360-b),h=b-P}var M={TMoveX:o[0],TMoveY:o[1],TMoveZ:o[2],THeading:u,TPitch:l,TRoll:h,TScaleX:a,TScaleY:s,TScaleZ:c};if(_.DMoveX+=Freedo.Math.toDegrees(M.TMoveX),_.DMoveY+=Freedo.Math.toDegrees(M.TMoveY),_.DMoveZ+=M.TMoveZ,_.THeading+=M.THeading,_.TPitch+=M.TPitch,_.TRoll+=M.TRoll,_.TScaleX*=M.TScaleX,_.TScaleY*=M.TScaleY,_.TScaleZ*=M.TScaleZ,this._t12.DMoveX=_.DMoveX,this._t12.DMoveY=_.DMoveY,this._t12.DMoveZ=_.DMoveZ,this._t12.THeading=_.THeading,this._t12.TPitch=_.TPitch,this._t12.TRoll=_.TRoll,this._t12.TScaleX=_.TScaleX,this._t12.TScaleY=_.TScaleY,this._t12.TScaleZ=_.TScaleZ,this.refineArgs(),this._event.raiseEvent("Transforming",FreeDo.clone(this._t12,!0)),this._aPModelSet.length>0){for(var x in this._aPModelSet){m=this.getTilesetBasePt(this._aPModelSet[x]);this._aPModelSet[x];this.applyTransformToTileset(this._aPModelSet[x],Freedo.Math.toRadians(_.DMoveX),Freedo.Math.toRadians(_.DMoveY),_.DMoveZ,_.THeading,_.TPitch,_.TRoll,_.TScaleX,_.TScaleY,_.TScaleZ,Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height),this._event.raiseEvent("DataChanged",FreeDo.clone(this._aPModelSet[x].modelMatrix,!0))}this._t12.TMoveX=Freedo.Math.toDegrees(m.longitude)+_.DMoveX,this._t12.TMoveY=Freedo.Math.toDegrees(m.latitude)+_.DMoveY,this._t12.TMoveZ=m.height+_.DMoveZ,this.calcSceneBS(),this._mani.updateSceneSphere(this._sceneSphere)}},s.prototype.refineArgs=function(){for(var e in this._aPModelSet){var t=this._aPModelSet[e];FreeDo.Matrix4.getScale(t.modelMatrix,new FreeDo.Cartesian3);this._t12.THeading>360&&(this._t12.THeading-=360),this._t12.THeading<-360&&(this._t12.THeading+=360),this._t12.TPitch>360&&(this._t12.TPitch-=360),this._t12.TPitch<-360&&(this._t12.TPitch+=360),this._t12.TRoll>360&&(this._t12.TRoll-=360),this._t12.TRoll<-360&&(this._t12.TRoll+=360),this._t12.TMoveX=Freedo.FdMisc.FdMath.round(this._t12.TMoveX,8),this._t12.TMoveY=Freedo.FdMisc.FdMath.round(this._t12.TMoveY,8),this._t12.TMoveZ=Freedo.FdMisc.FdMath.round(this._t12.TMoveZ,6),this._t12.THeading=Freedo.FdMisc.FdMath.round(this._t12.THeading,4),this._t12.TPitch=Freedo.FdMisc.FdMath.round(this._t12.TPitch,4),this._t12.TRoll=Freedo.FdMisc.FdMath.round(this._t12.TRoll,4),this._t12.TScaleX=1,this._t12.TScaleY=1,this._t12.TScaleZ=1}},s.prototype.onGotoPoint=function(e){if(e.type!=this.PositionType.NONE&&this._inMoveTo){var t=Freedo.Cartographic.fromCartesian(e.position);if(void 0!==t){var r=FreeDo.clone(this._t12,!0);for(var n in r.TMoveX=t.longitude,r.TMoveY=t.latitude,this._aPModelSet){var i=this.getTilesetBasePt(this._aPModelSet[n]),o=r.TMoveX-i.longitude,a=r.TMoveY-i.latitude,s=r.TMoveZ-i.height;this.applyTransformToTileset(this._aPModelSet[n],parseFloat(o),parseFloat(a),parseFloat(s),parseFloat(r.THeading),parseFloat(r.TPitch),parseFloat(r.TRoll),parseFloat(r.TScaleX),parseFloat(r.TScaleY),parseFloat(r.TScaleZ),Freedo.Math.toRadians(this._t12.TBaseX),Freedo.Math.toRadians(this._t12.TBaseY),this._t12.TBaseZ)}r.TMoveX=Freedo.Math.toDegrees(r.TMoveX),r.TMoveY=Freedo.Math.toDegrees(r.TMoveY),r.TMoveZ=r.TMoveZ,this._t12=FreeDo.clone(r,!0),this.refineArgs(),""!==this._transType&&(this.calcSceneBS(),this._mani.updateSceneSphere(this._sceneSphere)),this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,!0))}this._inMoveTo=!1}},s.prototype.onTransform=function(e){for(var t in this._event.raiseEvent("Transform",{}),this.reset12Args(),this._mouseDown12Arg=Freedo.clone(this._t12,!0),this._aPModelSet){var r=this._aPModelSet[t];this._mouseDownMM=Freedo.clone(r.modelMatrix,!0);break}},s.prototype.onTransformed=function(e){this.refineArgs(),this._mouseDownMM=FreeDo.Matrix4.IDENTITY,this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,!0))},s.prototype.getTilesetBasePt=function(e){if(void 0!==e){var t,r=!1;e._root&&e._root.transform?t=Freedo.clone(e._root.transform,!0):e instanceof Freedo.Model?t=Freedo.clone(e.modelMatrix,!0):(t=Freedo.clone(e.modelMatrix,!0),r=!0);var n=FreeDo.Matrix4.getTranslation(t,new FreeDo.Cartesian3),i=Freedo.Cartographic.fromCartesian(n);return r&&(i=Freedo.Cartographic.fromCartesian(e.boundingSphere.center)),i}},s.prototype.applyTransformToTileset=function(e,t,r,n,i,o,a,s,c,u,l,h,d){var p=this.getMatrixOfTileset(e,t,r,n,i,o,a,s,c,u,l,h,d);if(e instanceof Freedo.Model){var f=Freedo.Matrix4.multiply(p,this._mouseDownMM,new Freedo.Matrix4);e.modelMatrix=f}else{f=Freedo.Matrix4.multiply(p,this._mouseDownMM,new Freedo.Matrix4);e.modelMatrix=f}},s.prototype.applyTransform=function(e,t,r,n,i,o,a,s,c){if(!this.checkConflict()){this.calcSceneBS();try{e=parseFloat(e),t=parseFloat(t),r=parseFloat(r),n=parseFloat(n),i=parseFloat(i),o=parseFloat(o),a=parseFloat(a),s=parseFloat(s),c=parseFloat(c)}catch(e){return}if(!(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(o)||isNaN(a)||isNaN(s)||isNaN(c))){for(var u in this._aPModelSet){var l=this.getTilesetBasePt(this._aPModelSet[u]),h=Freedo.Math.toRadians(e)-l.longitude,d=Freedo.Math.toRadians(t)-l.latitude,p=r-l.height;this.applyTransformToTileset(this._aPModelSet[u],parseFloat(h),parseFloat(d),parseFloat(p),parseFloat(n),parseFloat(i),parseFloat(o),parseFloat(a),parseFloat(s),parseFloat(c),Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height)}this._t12.TMoveX=e,this._t12.TMoveY=t,this._t12.TMoveZ=r,this._t12.THeading=n,this._t12.TPitch=i,this._t12.TRoll=o,this._t12.TScaleX=a,this._t12.TScaleY=s,this._t12.TScaleZ=c,this.refineArgs(),""!==this._transType&&(this.calcSceneBS(),this._mani&&this._mani.updateSceneSphere(this._sceneSphere)),this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,!0))}}},s.prototype.applyTransformDelta=function(e,t,r,n,i,o,a,s,c){if(!this.checkConflict()){this.calcSceneBS();try{e=parseFloat(e),t=parseFloat(t),r=parseFloat(r),n=parseFloat(n),i=parseFloat(i),o=parseFloat(o),a=parseFloat(a),s=parseFloat(s),c=parseFloat(c)}catch(e){return}if(!(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(o)||isNaN(a)||isNaN(s)||isNaN(c))){for(var u in this._aPModelSet){this.getTilesetBasePt(this._aPModelSet[u]);this.applyTransformToTileset(this._aPModelSet[u],e,t,r,parseFloat(n),parseFloat(i),parseFloat(o),parseFloat(a),parseFloat(s),parseFloat(c),Freedo.Math.toRadians(this._basePt.longitude),Freedo.Math.toRadians(this._basePt.latitude),this._basePt.height)}this._t12.DMoveX=e,this._t12.DMoveY=t,this._t12.DMoveZ=r,this._t12.TMoveX=e+this._basePt.longitude,this._t12.TMoveY=t+this._basePt.latitude,this._t12.TMoveZ=r+this._basePt.height,this._t12.THeading=n,this._t12.TPitch=i,this._t12.TRoll=o,this._t12.TScaleX=a,this._t12.TScaleY=s,this._t12.TScaleZ=c,this.refineArgs(),""!==this._transType&&(this.calcSceneBS(),this._mani.updateSceneSphere(this._sceneSphere)),this._event.raiseEvent("Transformed",FreeDo.clone(this._t12,!0))}}},s.prototype.reset12Args=function(){if(!this.checkConflict()){var e=void 0;for(var t in this._aPModelSet){e=this.getTilesetBasePt(this._aPModelSet[t]);break}void 0!=e&&(this._t12.DMoveX=0,this._t12.DMoveY=0,this._t12.DMoveZ=0,this._t12.TMoveX=Freedo.Math.toDegrees(e.longitude),this._t12.TMoveY=Freedo.Math.toDegrees(e.latitude),this._t12.TMoveZ=e.height,this._t12.THeading=0,this._t12.TPitch=0,this._t12.TRoll=0,this._t12.TScaleX=1,this._t12.TScaleY=1,this._t12.TScaleZ=1,this.refineArgs(),this._basePt=void 0)}},s.prototype.resetTransform=function(){for(var e in this.reset12Args(),this._aPModelSet){var t=this._aPModelSet[e];t instanceof Freedo.Model?t.modelMatrix=FreeDo.clone(t.initModelMatrix,!0):t.modelMatrix=FreeDo.clone(FreeDo.Matrix4.IDENTITY,!0),this._event.raiseEvent("DataChanged",FreeDo.clone(t.modelMatrix,!0))}this.calcSceneBS(),this._bInTransform&&this._mani.updateSceneSphere(this._sceneSphere),this._event.raiseEvent("resetTransform",FreeDo.clone(this._t12,!0))},s.prototype.saveTransform=function(){Date.parse(new Date);for(var e in this._aPModelSet)this._sceneMgr._pModelMap[this._aPModelSet[e]]},s.prototype.cancelTransform=function(){this.reset()},s.prototype.cancel=function(){this.reset()},s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},s.prototype.reset=function(){this._bInTransform=!1,this._mani.reset(),this._transType="",this._maniCallBack&&this._maniCallBack(),this._event.raiseEvent("Cancel",{})},s.prototype.dispose=function(){this.reset()},t.FdTransformHelper=s},function(e,t,r){e.exports={default:r(317),__esModule:!0}},function(e,t,r){e.exports=!r(29)&&!r(64)(function(){return 7!=Object.defineProperty(r(121)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdMath=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};var a=function e(){(0,o.default)(this,e)};a.isNumber=function(e){return"number"==typeof e&&isFinite(e)},a.round=function(e,t){return e>=0?parseInt(e*Math.pow(10,t)+.5)/Math.pow(10,t):-(parseInt(-e*Math.pow(10,t)+.5)/Math.pow(10,t))},t.FdMath=a},function(e,t){e.exports=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n}},function(e,t,r){var n=r(50);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t,r){var n=r(74),i=r(177);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(56),i=r(23),o=r(75).f;e.exports=function(e){return function(t){for(var r,a=i(t),s=n(a),c=s.length,u=0,l=[];c>u;)o.call(a,r=s[u++])&&l.push(e?[r,a[r]]:a[r]);return l}}},function(e,t,r){var n=r(8),i=r(143),o=r(35);e.exports=function(e,t,r,a){var s=String(o(e)),c=s.length,u=void 0===r?" ":String(r),l=n(t);if(l<=c||""==u)return s;var h=l-c,d=i.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},function(e,t,r){"use strict";var n=r(95),i=r(5),o=r(8),a=r(28),s=r(7)("isConcatSpreadable");e.exports=function e(t,r,c,u,l,h,d,p){for(var f,v,_=l,y=0,m=!!d&&a(d,p,3);y<u;){if(y in c){if(f=m?m(c[y],y,r):c[y],v=!1,i(f)&&(v=void 0!==(v=f[s])?!!v:n(f)),v&&h>0)_=e(t,r,f,o(f.length),_,h-1)-1;else{if(_>=9007199254740991)throw TypeError();t[_]=f}_++}y++}return _}},function(e,t,r){var n=r(53),i=r(96),o=r(2),a=r(3).Reflect;e.exports=a&&a.ownKeys||function(e){var t=n.f(o(e)),r=i.f;return r?t.concat(r(e)):t}},function(e,t,r){var n=r(34),i=r(8);e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},function(e,t,r){"use strict";var n=r(49),i=r(46).getWeak,o=r(2),a=r(5),s=r(51),c=r(50),u=r(32),l=r(24),h=r(65),d=u(5),p=u(6),f=0,v=function(e){return e._l||(e._l=new _)},_=function(){this.a=[]},y=function(e,t){return d(e.a,function(e){return e[0]===t})};_.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var r=y(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var u=e(function(e,n){s(e,u,t,"_i"),e._t=t,e._i=f++,e._l=void 0,void 0!=n&&c(n,r,e[o],e)});return n(u.prototype,{delete:function(e){if(!a(e))return!1;var r=i(e);return!0===r?v(h(this,t)).delete(e):r&&l(r,this._i)&&delete r[this._i]},has:function(e){if(!a(e))return!1;var r=i(e);return!0===r?v(h(this,t)).has(e):r&&l(r,this._i)}}),u},def:function(e,t,r){var n=i(o(t),!0);return!0===n?v(e).set(t,r):n[e._i]=r,e},ufstore:v}},function(e,t,r){"use strict";var n,i=r(32)(0),o=r(19),a=r(46),s=r(204),c=r(184),u=r(5),l=r(4),h=r(65),d=a.getWeak,p=Object.isExtensible,f=c.ufstore,v={},_=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(u(e)){var t=d(e);return!0===t?f(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(h(this,"WeakMap"),e,t)}},m=e.exports=r(89)("WeakMap",_,y,c,!0,!0);l(function(){return 7!=(new m).set((Object.freeze||Object)(v),7).get(v)})&&(s((n=c.getConstructor(_,"WeakMap")).prototype,y),a.NEED=!0,i(["delete","has","get","set"],function(e){var t=m.prototype,r=t[e];o(t,e,function(t,i){if(u(t)&&!p(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)})}))},function(e,t,r){"use strict";var n=r(187),i=r(65);e.exports=r(89)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){"use strict";var n=r(9).f,i=r(54),o=r(49),a=r(28),s=r(51),c=r(50),u=r(139),l=r(192),h=r(52),d=r(10),p=r(46).fastKey,f=r(65),v=d?"_s":"size",_=function(e,t){var r,n=p(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e(function(e,n){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=n&&c(n,r,e[u],e)});return o(l.prototype,{clear:function(){for(var e=f(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var r=f(this,t),n=_(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[v]--}return!!n},forEach:function(e){f(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!_(f(this,t),e)}}),d&&n(l.prototype,"size",{get:function(){return f(this,t)[v]}}),l},def:function(e,t,r){var n,i,o=_(e,t);return o?o.v=r:(e._l=o={i:i=p(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:_,setStrong:function(e,t,r){u(e,t,function(e,r){this._t=f(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},r?"entries":"values",!r,!0),h(t)}}},function(e,t,r){"use strict";var n=r(187),i=r(65);e.exports=r(89)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(i(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,r){var n=r(2),i=r(5),o=r(127);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){r(10)&&"g"!=/./g.flags&&r(9).f(RegExp.prototype,"flags",{configurable:!0,get:r(92)})},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(12),i=r(55),o=r(8);e.exports=[].copyWithin||function(e,t){var r=n(this),a=o(r.length),s=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),h=1;for(c<s&&s<c+l&&(h=-1,c+=l-1,s+=l-1);l-- >0;)c in r?r[s]=r[c]:delete r[s],s+=h,c+=h;return r}},function(e,t,r){var n=r(15),i=r(12),o=r(76),a=r(8);e.exports=function(e,t,r,s,c){n(t);var u=i(e),l=o(u),h=a(u.length),d=c?h-1:0,p=c?-1:1;if(r<2)for(;;){if(d in l){s=l[d],d+=p;break}if(d+=p,c?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;c?d>=0:h>d;d+=p)d in l&&(s=t(s,l[d],d,u));return s}},function(e,t,r){var n=r(2);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(142),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),c=i(2,-126);e.exports=Math.fround||function(e){var t,r,i=Math.abs(e),u=n(e);return i<c?u*(i/c/a+1/o-1/o)*c*a:(r=(t=(1+a/o)*i)-(t-i))>s||r!=r?u*(1/0):u*r}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,r){var n=r(5),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},function(e,t,r){var n=r(27);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=n(e))throw TypeError(t);return+e}},function(e,t,r){var n=r(3).parseFloat,i=r(67).trim;e.exports=1/n(r(145)+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},function(e,t,r){var n=r(3).parseInt,i=r(67).trim,o=r(145),a=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(a.test(r)?16:10))}:n},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n=r(15),i=r(5),o=r(202),a=[].slice,s={};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),c=function(){var n=r.concat(a.call(arguments));return this instanceof c?function(e,t,r){if(!(t in s)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,r)}(t,n.length,n):o(t,n,e)};return i(t.prototype)&&(c.prototype=t.prototype),c}},function(e,t,r){"use strict";var n=r(56),i=r(96),o=r(75),a=r(12),s=r(76),c=Object.assign;e.exports=!c||r(4)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=a(e),c=arguments.length,u=1,l=i.f,h=o.f;c>u;)for(var d,p=s(arguments[u++]),f=l?n(p).concat(l(p)):n(p),v=f.length,_=0;v>_;)h.call(p,d=f[_++])&&(r[d]=p[d]);return r}:c},function(e,t,r){var n=r(23),i=r(53).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(n(e))}},function(e,t,r){var n=r(9),i=r(2),o=r(56);e.exports=r(10)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,c=0;s>c;)n.f(e,r=a[c++],t[r]);return e}},function(e,t,r){var n=r(24),i=r(23),o=r(97)(!1),a=r(149)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),c=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){t.f=r(7)},function(e,t,r){e.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(151)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdModelServer=void 0;var n=c(r(100)),i=c(r(39)),o=c(r(38)),a=c(r(1)),s=r(43);function c(e){return e&&e.__esModule?e:{default:e}}var u,l,h,d,p,f,v,_,y,m,g,F=function e(){throw(0,a.default)(this,e),new Error("FdModelServer should not be instantiated!")};F.getResourceFinishCount=(u=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/finish/count?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return u.apply(this,arguments)}),F.getFinishResource=(l=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/finish/get?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return l.apply(this,arguments)}),F.deleteModel=(h=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/delete/"+t+"?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return h.apply(this,arguments)}),F.getResourceErrorCount=(d=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/error/count?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return d.apply(this,arguments)}),F.getResourceErrorList=(p=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/error/get?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return p.apply(this,arguments)}),F.getResourceExecutingCount=(f=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/execute/count?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return f.apply(this,arguments)}),F.getResourceExecutingList=(v=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/execute/get?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return v.apply(this,arguments)}),F.getOneResourceInfo=(_=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/getone/"+t.mid+"?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({url:a,type:"GET"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return _.apply(this,arguments)}),F.getOneResourceCount=(y=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/count?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return y.apply(this,arguments)}),F.getOneResourceList=(m=(0,o.default)(i.default.mark(function e(t,r,n,o){var a,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+"/cloudlink/freeserver-one/services/one/resource/get?token="+n,c=[],e.prev=2,e.next=5,s.FdCommon.ajaxJson({data:t,url:a,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return m.apply(this,arguments)}),F.oneStepFreedo=(g=(0,o.default)(i.default.mark(function e(t,r,n,o,a){var s,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/zuul/freeserver-one/services/one/import?token="+n,c=[],e.prev=2,e.next=5,C({url:s,data:t,uploadCB:o});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取失败",e.t0);case 11:a(JSON.parse(c));case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n,i){return g.apply(this,arguments)});var w,C=(w=(0,o.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new n.default(function(e,r){var n=new XMLHttpRequest;n.withCredentials=!0,n.upload.addEventListener("progress",function(e){t.uploadCB(e,n)},!1),n.addEventListener("readystatechange",function(){4===this.readyState&&(n.status>=200&&n.status<300?e(n.responseText):r(n.responseText))}),n.open("POST",t.url),n.send(t.data)}));case 1:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)});t.FdModelServer=F},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPMTSParser=void 0;var n,i=u(r(39)),o=u(r(38)),a=u(r(1)),s=(n=(0,o.default)(i.default.mark(function e(t,r){var n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.FdCommon.ajaxJson({url:t,type:"GET"});case 3:n=e.sent,r(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r(void 0,e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),function(e,t){return n.apply(this,arguments)}),c=r(43);function u(e){return e&&e.__esModule?e:{default:e}}var l,h=function e(){throw(0,a.default)(this,e),new Error("FdPMTSParser should not be instantiated!")},d=function(e,t,r){return e.resourceurl?e.resourceurl.find(function(e){return e.type===r}).template:t.resourceurl?t.resourceurl.find(function(e){return e.type===r}).template:void 0};function p(e,t){var r=[];return e.contents.layers.forEach(function(n){Freedo.FdServer.FdPMTSParser.getMatrixSets(e,n).forEach(function(e){e.matrix.forEach(function(i){var o=Freedo.FdServer.FdPMTSParser.getPModelURL(n,e,i,t);r.push({pModelURL:o,matrix:i,matrixSet:e,layer:n})})})}),r}function f(e){return e.split(",").map(function(e){return+e})}function v(e,t,r,n){var i=new Freedo.Cartesian3(e[0],e[1],e[2]),o=new Freedo.Cartesian3(t[0],t[1],t[2]),a=new Freedo.Cartesian3.fromDegrees(r[0],r[1],r[2]);if(Freedo.Cartesian3.magnitudeSquared(a)>406806315.90769005){var s=FreeDo.Transforms.eastNorthUpToFixedFrame(a),c=o.y;o.y=-o.z,o.z=c,c=i.y,i.y=-i.z,i.z=c,Freedo.Matrix4.multiplyByPoint(s,o,o),Freedo.Matrix4.multiplyByPoint(s,i,i)}else Freedo.Cartesian3.add(a,o,o),Freedo.Cartesian3.add(a,i,i);return n&&(Freedo.Matrix4.multiplyByPoint(n,o,o),Freedo.Matrix4.multiplyByPoint(n,i,i)),FreeDo.BoundingSphere.fromCornerPoints(o,i)}h.getLayerFromID=function(e,t){return e.contents.layers.find(function(e){return e.identifier===t})},h.getMatrixSetFromID=function(e,t){return e.contents.matrixsets.find(function(e){return e.identifier===t})},h.getMatrixFromID=function(e,t){return matrixsets.find(function(e){return e.identifier===t})},h.getMatrixSets=function(e,t){var r=[];return t.matrixsetlink.forEach(function(t){var n=h.getMatrixSetFromID(e,t);if(void 0===n)throw new Error("");r.push(n)}),r},h.getPModelURL=function(e,t,r,n){var i=t.identifier,o=r.identifier,a=d(e,t,"file");return a=(a=(a=a.replace(/{matrixset}/g,i)).replace(/{matrix}/g,o)).replace(/{filepath}/g,o),void 0!==n&&(a=a+"?token="+n),a},h.getPModelURLArray=(l=(0,o.default)(i.default.mark(function e(t,r){var n,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.split("?")[1],(o=Freedo.queryToObject(n)).accesskey?Freedo.FdServer.FdShareServer.getLayerAccesskeyResource(t,"json",function(e,t){if(t)console.error("FdServer.FdShareServer.getLayerAccesskeyResource got error: "+t);else{var n=p(e);r(n)}}):o.token?Freedo.FdServer.FdPMTSServer.getResource(t.split("?")[0],o.token,function(e,t){if(t)console.error("FdPMTSServer.getJson got error: "+t);else{var n=p(e,o.token);r(n)}}):r([]);case 3:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)}),h.getUidJson=function(e,t,r,n,i,o){var a=function(e,t,r,n,i){var o=t.identifier,a=r.identifier,s=d(e,t,"uid");return s=(s=(s=s.replace(/{matrixset}/g,o)).replace(/{matrix}/g,a)).replace(/{uid}/g,n),void 0!==i&&(s=s+"?token="+i),s}(e,t,r,n,i);s(a,function(e,t){o(e,t)})},h.getCidJson=function(e,t,r,n,i,o,a){var c=function(e,t,r,n,i,o){var a=t.identifier,s=r.identifier,c=d(e,t,"cid");return t.propstoragetype&&1!==t.propstoragetype||(c=(c=(c=c.replace(/{matrixset}/g,a)).replace(/{matrix}/g,s)).replace(/{cid}/g,i)),2===t.propstoragetype&&(c=(c=c.replace(/{tileno}/g,n)).replace(/{pguid}/g,i)),void 0!==o&&(c=c+"?token="+o),c}(e,t,r,n,i,o);s(c,function(e,t){a(e,t)})},h.getPropJson=function(e,t,r,n,i,o){var a=function(e,t,r,n,i){var o=t.identifier,a=r.identifier,s=d(e,t,"prop");return t.propstoragetype&&1!==t.propstoragetype||(s=(s=(s=s.replace(/{matrixset}/g,o)).replace(/{matrix}/g,a)).replace(/{comid}/g,n)),2===t.propstoragetype&&(s=s.replace(/{guid}/g,n)),void 0!==i&&(s=s+"?token="+i),s}(e,t,r,n,i);s(a,function(e,t){o(e,t)})},h.getTagJson=function(e,t,r,n,i,o){var a=function(e,t,r,n,i){var o=t.identifier,a=r.identifier,s=d(e,t,"tag");return s=(s=(s=s.replace(/{matrixset}/g,o)).replace(/{matrix}/g,a)).replace(/{tag}/g,n),void 0!==i&&(s=s+"?token="+i),s}(e,t,r,n,i);s(a,function(e,t){o(e,t)})},h.getMatrixBoundingSphere=function(e,t){var r=f(e.metadata.localbounds.min),n=f(e.metadata.localbounds.max),i=f(e.metadata.position),o=i[0];return i[0]=i[1],i[1]=o,v(r,n,i,t)},h.getLayerBoundingSphere=function(e,t,r){Freedo.FdServer.FdPMTSParser.getMatrixSets(e,t).forEach(function(e){return getMatrixBoundingSphere(matrix,r)})},h.getUidBoundingSphere=function(e,t,r,n,i,o,a){if(r.uid===n){var s=h.getMatrixBoundingSphere(r,o);a(s)}else h.getUidJson(e,t,r,n,i,function(e,t){if(void 0===t)if(e&&e.BoundsMin&&e.BoundsMax){var n=f(e.BoundsMin),i=f(e.BoundsMax),s=f(r.metadata.position),c=s[0];s[0]=s[1],s[1]=c;var u=v(n,i,s,o);a(u)}else a(void 0,"getUidBoundingSphere got error!");else a(void 0,t)})},t.FdPMTSParser=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTerrainServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l=function e(){(0,o.default)(this,e)};function h(e){var t=e.documentElement.getElementsByTagName("Contents")[0].getElementsByTagName("ResourceURL");t.length;return t[0].getAttribute("template").replace("{TileMatrix}/{TileCol}/{TileRow}.bil","")}l.getTerrains=(c=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t+"/cloudlink/freeserver-admin/admin/layer/get?token="+r,s=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:o,data:{servicetype:"WETS"},type:"POST",dataType:"json"});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("无法正常获取列表");case 11:i(s);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r){return c.apply(this,arguments)}),l.getTerrain=(u=(0,i.default)(n.default.mark(function e(t,r,i){var o,s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],s=t+"?token="+r,e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,type:"GET",dataType:"XML"});case 5:c=e.sent,o=h(c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log("添加错误");case 12:i(o);case 13:case"end":return e.stop()}},e,this,[[2,9]])})),function(e,t,r){return u.apply(this,arguments)}),t.FdTerrainServer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdImagerylayersServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l=function e(){(0,o.default)(this,e)};function h(e,t){var r={},n=e.documentElement.getElementsByTagName("Contents"),i=n[0].getElementsByTagName("ResourceURL"),o=n[0].getElementsByTagName("Format")[0].innerHTML,a=n[0].getElementsByTagName("ows:Title")[0].innerHTML;r.name=a,r.format=o;var s=n[0].getElementsByTagName("ows:SupportedCRS")[0].innerHTML,c=void 0;s.includes("4326")?c="Geographic":s.includes("3857")&&(c="WebMercator"),r.tilingScheme=c;for(var u=i.length,l=[],h=void 0,d=0;d<u;d++){var p=i[0].getAttribute("template");l.push(p)}for(var f=0;f<u;f++)if(l[f].includes("{TileMatrix}/{TileCol}/{TileRow}")){h=l[f].replace("{TileMatrix}","{z}").replace("{TileCol}","{x}").replace("{TileRow}","{y}");break}return r.imgUrl=h+"?token="+t,r}l.getImagerylayers=(c=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t+"/cloudlink/freeserver-admin/admin/layer/get?token="+r,s=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:o,data:{servicetype:"WMTS"},type:"POST",dataType:"json"});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("获取列表失败");case 11:i(s);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r){return c.apply(this,arguments)}),l.getImagerylayer=(u=(0,i.default)(n.default.mark(function e(t,r,i){var o,s,c,u;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={},s=t+"?token="+r,e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,type:"GET",dataType:"XML"});case 5:c=e.sent,u=h(c,r),o={name:u.name,type:"UrlTemplate",iconUrl:"//res.gbim360.com/lib/freedo/rel/1.5.7/Freedo/Widgets/Images/ImageryProviders/blackMarble.png",layerOption:{show:!0,alpha:1},providerOptions:{url:u.imgUrl,maximumLevel:20,tilingScheme:u.tilingScheme}},e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("获取错误");case 13:i(o);case 14:case"end":return e.stop()}},e,this,[[2,10]])})),function(e,t,r){return u.apply(this,arguments)}),t.FdImagerylayersServer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdShareServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l,h,d,p,f,v,_,y=function e(){(0,o.default)(this,e)};y.getShareObjectID=(c=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/cloudlink-core-framework/app/dataresource/queryList?token="+i+"&appId=0154981b-11c5-49ad-839d-a3420af507d8&dataId="+t.id+"&dataName="+t.name,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,type:"GET"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return c.apply(this,arguments)}),y.addShareObjectID=(u=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c,u,l;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/cloudlink-core-framework/app/dataresource/add?token="+i,c=(new Date).getTime(),u=[],l={appId:"0154981b-11c5-49ad-839d-a3420af507d8",resourceCode:"freedo_data_lid_"+c,resourceName:"freedo_data_lname_"+c,parentId:"610be183-1dda-43ed-8737-49fa2a55cc80",dataId:t.id,dataName:t.name},e.prev=4,e.next=7,a.FdCommon.ajaxJson({url:s,data:l,type:"POST"});case 7:u=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0);case 13:o(u);case 14:case"end":return e.stop()}},e,this,[[4,10]])})),function(e,t,r,n){return u.apply(this,arguments)}),y.getUserList=(l=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t+"/cloudlink/cloudlink-core-framework/user/getListByApp?token="+r+"&appId=0154981b-11c5-49ad-839d-a3420af507d8",s=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:i(s);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r){return l.apply(this,arguments)}),y.addShareScene=(h=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c,u;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/cloudlink-core-framework/app/dataresource/share/add?token="+i,c=[],u={shareType:t.shareType,dataresourceId:t.objectId,accessKeyList:t.accessKeyList,status:1,dataType:t.dataType,effectiveTime:t.effectiveTime,expireTime:t.expireTime,remark:t.remark},e.prev=3,e.next=6,a.FdCommon.ajaxJson({url:s,data:u,type:"POST"});case 6:c=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:o(c);case 13:case"end":return e.stop()}},e,this,[[3,9]])})),function(e,t,r,n){return h.apply(this,arguments)}),y.share=(d=(0,i.default)(n.default.mark(function e(t,r,i,o){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y.getShareObjectID({id:t.lid,name:t.name},r,i,function(e){var n=void 0;e.rows.length?(n=e.rows[0].objectId,y.addShareScene({shareType:t.shareType,objectId:n,accessKeyList:t.accessKeyList,effectiveTime:t.effectiveTime,expireTime:t.expireTime,dataType:t.dataType,remark:t.remark},r,i,function(e){o(e)})):Freedo.FdServer.FdShareServer.addShareObjectID({id:t.lid,name:t.name},r,i,function(e){n=e.rows[0].objectId,y.addShareScene({shareType:t.shareType,objectId:n,accessKeyList:t.accessKeyList,effectiveTime:t.effectiveTime,expireTime:t.expireTime,dataType:t.dataType,remark:t.remark},r,i,function(e){o(e)})})});case 1:case"end":return e.stop()}},e,this)})),function(e,t,r,n){return d.apply(this,arguments)}),y.getSceneAccesskeyURL=(p=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-ocelot/scene/getcapaurl?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return p.apply(this,arguments)}),y.getLayerAccesskeyURL=(f=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-admin/admin/layer/getcapaurl?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return f.apply(this,arguments)}),y.createOneImportLayer=(v=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-admin/admin/layer/importlayer?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return v.apply(this,arguments)}),y.getLayerAccesskeyResource=(_=(0,i.default)(n.default.mark(function e(t,r,i){var o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.FdCommon.ajaxJson({url:t,type:"GET",dataType:r});case 3:o=e.sent,i(o),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i(void 0,e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),function(e,t,r){return _.apply(this,arguments)}),t.FdShareServer=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdSceneServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l,h,d,p,f,v,_,y=function e(){(0,o.default)(this,e)};y.getUserSceneCount=(c=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink//freeserver-ocelot/scene/count?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({data:t,url:s,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取用户场景失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return c.apply(this,arguments)}),y.getUserScenes=(u=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-ocelot/scene/getall?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({data:t,url:s,type:"POST"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("获取用户场景失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return u.apply(this,arguments)}),y.getUserShareScenes=(l=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t+"/cloudlink/cloudlink-core-framework/app/dataresource/share/queryMyShareList?token="+r+"&status=1&dataType=scene",s=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("获取用户分享场景失败",e.t0);case 11:i(s);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r){return l.apply(this,arguments)}),y.getUserSharedScenes=(h=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t+"/cloudlink/cloudlink-core-framework/app/dataresource/share/queryBeSharedList?token="+r+"&status=1&dataType=scene",s=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:o,type:"GET"});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("获取用户被分享列表失败",e.t0);case 11:i(s);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r){return h.apply(this,arguments)}),y.getUserSharedSceneInfo=(d=(0,i.default)(n.default.mark(function e(t,r){var i;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],e.prev=1,e.next=4,a.FdCommon.ajaxJson({url:t,type:"GET"});case 4:i=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log("获取分享场景信息失败",e.t0);case 10:r(i);case 11:case"end":return e.stop()}},e,this,[[1,7]])})),function(e,t){return d.apply(this,arguments)}),y.getUserSceneInfo=(p=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-ocelot/scene/getone/"+t+"?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,type:"GET"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("获取项目信息失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return p.apply(this,arguments)}),y.saveUserScene=(f=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-ocelot/scene/upsert?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:c=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:o(c);case 11:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return f.apply(this,arguments)}),y.deleteUserScene=(v=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-ocelot/scene/remove/"+t+"?token="+i,c=[],e.prev=2,e.next=5,a.FdCommon.ajaxJson({url:s,type:"GET"});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("删除场景失败",e.t0);case 11:o(c);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e,t,r,n){return v.apply(this,arguments)}),y.deleteShareScene=(_=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c,u;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/cloudlink-core-framework/app/dataresource/share/delete?token="+i,c={markId:t},u=[],e.prev=3,e.next=6,a.FdCommon.ajaxJson({url:s,data:c,type:"POST"});case 6:u=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("删除分享场景失败",e.t0);case 12:o(u);case 13:case"end":return e.stop()}},e,this,[[3,9]])})),function(e,t,r,n){return _.apply(this,arguments)}),t.FdSceneServer=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdUserServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l,h,d=function e(){(0,o.default)(this,e)};d.getVerificationCode=(c=(0,i.default)(n.default.mark(function e(t,r){var i,o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={sendMode:"1",sendNum:t.toString(),signName:"飞渡科技",useCategory:"regist"},e.prev=1,o=r+"/cloudlink/cloudlink-core-framework/verfy/getVerifyCode",e.next=5,a.FdCommon.ajaxJson({url:o,data:i,type:"POST"});case 5:e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[1,8]])})),function(e,t){return c.apply(this,arguments)}),d.registerUser=(u=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.prev=1,s=r+"/cloudlink/freeserver-admin/auth/regist",e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:o=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:i(o);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),function(e,t,r){return u.apply(this,arguments)}),d.changePassword=(l=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.prev=1,s=r+"/cloudlink/cloudlink-core-framework/login/resetPassword",e.next=5,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 5:o=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:i(o);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),function(e,t,r){return l.apply(this,arguments)}),d.userLogin=(h=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.prev=1,t.appId="0154981b-11c5-49ad-839d-a3420af507d8",s=r+"/cloudlink/cloudlink-core-framework/login/login",e.next=6,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 6:o=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:i(o);case 13:case"end":return e.stop()}},e,this,[[1,9]])})),function(e,t,r){return h.apply(this,arguments)}),t.FdUserServer=d},function(e,t,r){var n=r(14),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,r){e.exports={default:r(217),__esModule:!0}},function(e,t,r){"use strict";var n=r(17),i=r(99),o=r(154);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){"use strict";var n=r(17),i=r(14),o=r(16),a=r(156),s=r(153);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){var n=r(13)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},function(e,t,r){var n=r(16),i=r(155).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c="process"==r(71)(a);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve();r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var h=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),r=function(){d.data=h=!h}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n,i,o,a,s=r(82),c=r(16),u=r(48),l=r(79),h=r(17),d=r(30),p=r(73),f=r(107),v=r(69),_=r(156),y=r(155).set,m=r(222)(),g=r(99),F=r(154),w=r(153),C=c.TypeError,b=c.process,P=c.Promise,M="process"==l(b),x=function(){},S=i=g.f,T=!!function(){try{var e=P.resolve(1),t=(e.constructor={})[r(13)("species")]=function(e){e(x,x)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t}catch(e){}}(),E=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var r=e._c;m(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&k(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?u(C("Promise-chain cycle")):(o=E(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!a&&l.exit(),u(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){y.call(c,function(){var t,r,n,i=e._v,o=O(e);if(o&&(t=F(function(){M?b.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=M||O(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},k=function(e){y.call(c,function(){var t;M?b.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},I=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw C("Promise can't be resolved itself");(t=E(e))?m(function(){var n={_w:r,_d:!1};try{t.call(e,u(I,n,1),u(L,n,1))}catch(e){L.call(n,e)}}):(r._v=e,r._s=1,D(r,!1))}catch(e){L.call({_w:r,_d:!1},e)}}};T||(P=function(e){f(this,P,"Promise","_h"),p(e),n.call(this);try{e(u(I,this,1),u(L,this,1))}catch(e){L.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(108)(P.prototype,{then:function(e,t){var r=S(_(this,P));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=M?b.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&D(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(I,e,1),this.reject=u(L,e,1)},g.f=S=function(e){return e===P||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!T,{Promise:P}),r(70)(P,"Promise"),r(165)("Promise"),a=r(14).Promise,h(h.S+h.F*!T,"Promise",{reject:function(e){var t=S(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!T),"Promise",{resolve:function(e){return w(s&&this===a?P:this,e)}}),h(h.S+h.F*!(T&&r(221)(function(e){P.all(e).catch(x)})),"Promise",{all:function(e){var t=this,r=S(t),n=r.resolve,i=r.reject,o=F(function(){var r=[],o=0,a=1;v(e,!1,function(e){var s=o++,c=!1;r.push(void 0),a++,t.resolve(e).then(function(e){c||(c=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=S(t),n=r.reject,i=F(function(){v(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(e,t,r){r(78),r(60),r(63),r(224),r(220),r(219),e.exports=r(14).Promise},function(e,t){!function(t){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",u="object"==typeof e,l=t.regeneratorRuntime;if(l)u&&(e.exports=l);else{(l=t.regeneratorRuntime=u?e.exports:{}).wrap=F;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",v={},_={};_[a]=function(){return this};var y=Object.getPrototypeOf,m=y&&y(y(A([])));m&&m!==n&&i.call(m,a)&&(_=m);var g=P.prototype=C.prototype=Object.create(_);b.prototype=g.constructor=P,P.constructor=b,P[c]=b.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(g),e},l.awrap=function(e){return{__await:e}},M(x.prototype),x.prototype[s]=function(){return this},l.AsyncIterator=x,l.async=function(e,t,r,n){var i=new x(F(e,t,r,n));return l.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},M(g),g[c]="Generator",g[a]=function(){return this},g.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},l.values=A,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),v}}}function F(e,t,r,n){var i=t&&t.prototype instanceof C?t:C,o=Object.create(i.prototype),a=new D(n||[]);return o._invoke=function(e,t,r){var n=h;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=S(a,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=w(e,t,r);if("normal"===c.type){if(n=r.done?f:d,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,a),o}function w(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function C(){}function b(){}function P(){}function M(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function x(e){var t;this._invoke=function(r,n){function o(){return new Promise(function(t,o){!function t(r,n,o,a){var s=w(e[r],e,n);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,a)},function(e){t("throw",e,o,a)}):Promise.resolve(u).then(function(e){c.value=e,o(c)},a)}a(s.arg)}(r,n,t,o)})}return t=t?t.then(o,o):o()}}function S(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,S(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=w(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())},function(e,t,r){var n=function(){return this}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r(226),i)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPMTSServer=void 0;var n=s(r(39)),i=s(r(38)),o=s(r(1)),a=r(43);function s(e){return e&&e.__esModule?e:{default:e}}var c,u,l,h=function e(){(0,o.default)(this,e)};h.getResourceCount=(c=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c,u;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-admin/admin/layer/count?token="+i,c=[],u=void 0,t||((t={}).servicetype="PMTS"),e.prev=4,e.next=7,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 7:c=e.sent,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),u=e.t0,console.log("获取列表失败");case 14:o(c,u);case 15:case"end":return e.stop()}},e,this,[[4,10]])})),function(e,t,r,n){return c.apply(this,arguments)}),h.getResourceList=(u=(0,i.default)(n.default.mark(function e(t,r,i,o){var s,c,u;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r+"/cloudlink/freeserver-admin/admin/layer/get?token="+i,c=[],u=void 0,t||((t={}).servicetype="PMTS"),e.prev=4,e.next=7,a.FdCommon.ajaxJson({url:s,data:t,type:"POST"});case 7:c=e.sent,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),u=e.t0,console.log("获取列表失败");case 14:o(c,u);case 15:case"end":return e.stop()}},e,this,[[4,10]])})),function(e,t,r,n){return u.apply(this,arguments)}),h.getResource=(l=(0,i.default)(n.default.mark(function e(t,r,i){var o,s;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t,s=void 0,r&&(o=t+"?token="+r),e.prev=3,e.next=6,a.FdCommon.ajaxJson({url:o,type:"GET"});case 6:s=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("错误");case 12:i(s);case 13:case"end":return e.stop()}},e,this,[[3,9]])})),function(e,t,r){return l.apply(this,arguments)}),t.FdPMTSServer=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdServer=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(228),s=r(216),c=r(215),u=r(214),l=r(213),h=r(212),d=r(211),p=r(210);var f=function e(){(0,o.default)(this,e)};f.FdPMTSServer=a.FdPMTSServer,f.FdUserServer=s.FdUserServer,f.FdSceneServer=c.FdSceneServer,f.FdShareServer=u.FdShareServer,f.FdImagerylayersServer=l.FdImagerylayersServer,f.FdTerrainServer=h.FdTerrainServer,f.FdPMTSParser=d.FdPMTSParser,f.FdModelServer=p.FdModelServer,t.FdServer=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdUserLogining=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a='\n    <div class="FD-login-con">\n            <div class="FD-login-title">\n                <span>用户登录</span>\n            </div>\n            <div class="FD-input-area">\n                <input type="text" id="lg_tel" placeholder="请输入用户手机号">\n                <span id="lg_tel_error"></span>\n                <input type="password" id="lg_pw" placeholder="输入密码">\n                <span id="lg_pw_error"></span>\n            </div>\n            <button id="FD-user-logining-btn">登录</button>\n    </div>\n',s=function(){function e(t,r){(0,n.default)(this,e),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._token=void 0,this._viewer=t,this._container=r,r.innerHTML=a;var i="//"+window.location.host,o=this;document.getElementById("FD-user-logining-btn").onclick=function(){var e=document.getElementById("lg_tel"),t=document.getElementById("lg_pw"),n=document.getElementById("lg_tel_error"),a=document.getElementById("lg_pw_error");if(n.innerHTML="",a.innerHTML="",!e.value)return n.innerHTML="用户名不能为空",!1;if(!t.value)return a.innerHTML="密码不能为空",!1;var s={loginNum:e.value,password:t.value};this._token=void 0,Freedo.FdServer.FdUserServer.userLogin(s,i,function(e){return"PU03000"===e.code?(a.innerHTML=e.msg,!1):"PU03010"===e.code?(n.innerHTML=e.msg,!1):(console.log("token: "+e.token),o._token=e.token,r.style.display="none",void o._event.raiseEvent("TokenChanged",e.token))})}}return(0,i.default)(e,[{key:"getToken",value:function(){return this._token}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"dispose",value:function(){this._container.innerHTML="",this._viewer=void 0,this._container=void 0,this._eventHelper.removeAll(),this._eventHelper=void 0,this._event=void 0}}]),e}();t.FdUserLogining=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdCompass=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a="\n<svg id='compass' viewBox='-299 379 12 36' preserveAspectRatio='xMidYMid meet' focusable='false' style='display: block; width: 100%; height: 100%;'>\n    <g viewBox='-299 379 12 36'>\n        <style>\n            .st0 {\n                fill: #eb2a1c\n            }\n\n            .st1 {\n                fill-opacity: .15\n            }\n\n            .st2 {\n                fill: #fff\n            }\n\n            .st3 {\n                fill-opacity: 7.000000e-02\n            }\n\n            .st4 {\n                fill: #424242\n            }\n        </style>\n        <path class='st0' d='M-293 379l6 18h-12z'></path>\n        <path class='st1' d='M-293 379l6 18h-6z'></path>\n        <path class='st2' d='M-293 415l6-18h-12z'></path>\n        <path class='st3' d='M-293 415v-18h-6z'></path>\n        <circle id='Oval-3' class='st4' cx='-293' cy='397' r='2'>\n        </circle>\n    </g>\n</svg>\n",s=function(){function e(t,r){(0,n.default)(this,e),this._viewer=t,this._compassContainer=r,r.innerHTML=a;var i=r.firstElementChild;function o(e){var r="rotate("+-Freedo.Math.toDegrees(t.camera.heading)+"deg)";i.style.webkitTransform=r,i.style.MozTransform=r,i.style.msTransform=r,i.style.OTransform=r,i.style.transform=r}this._compass=i,o(t.camera.heading),this._removeListener=t.camera.changed.addEventListener(function(){o(t.camera.heading)}),this._compass.onclick=function(){console.log("svg clicked!")}}return(0,i.default)(e,[{key:"dispose",value:function(){this._removeListener(),this._removeListener=void 0,this._compassContainer.innerHTML="",this._viewer=void 0,this._compass=void 0}}]),e}();t.FdCompass=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdWidgets=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(231),s=r(230);var c=function e(){(0,o.default)(this,e)};c.FdCompass=a.FdCompass,c.FdUserLogining=s.FdUserLogining,t.FdWidgets=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTextBox2D=void 0;var n=s(r(1)),i=s(r(6)),o=r(11),a=r(25);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,i){(0,n.default)(this,e),this._viewer=t,this._id=r,this._data=i,this._basePtCo=t.scene.primitives.add(new Freedo.PointPrimitiveCollection),this._basePt=void 0,this._canvas=void 0,this._ple=new a.FdPolylineEditor(t),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this.create()}return(0,i.default)(e,[{key:"option",get:function(){return Freedo.clone(this.getData(),!0)}}]),e}();c.prototype.create=function(){Freedo.defined(this._data)?(Freedo.defined(this._id)||(this._id=Freedo.createGuid()),Freedo.defined(this._data.paddingLeft)||(this._data.paddingLeft=50),Freedo.defined(this._data.moveTop)||(this._data.moveTop=50),this._data.position?this.build():(this._ple.run(),this.addLsnr())):console.error("FdTextBox2D.prototype.create：参数无效")},c.prototype.refresh=function(){this._viewer.scene.requestRender()},c.prototype.update=function(){var e=this._basePt.computeScreenSpacePosition(viewer.scene,new Freedo.Cartesian2);if(!Freedo.defined(e))return!1;this._canvas.style.left=e.x+0+"px",this._canvas.style.top=e.y-this._data.moveTop+"px";var t=this._canvas.getContext("2d");t.clearRect(0,0,this._canvas.width,this._canvas.height),t.lineWidth=2,t.strokeStyle="white",t.shadowColor="rgba(0, 0, 0, 0.8)",t.shadowOffsetX=1,t.shadowOffsetY=1,t.shadowBlur=10;var r=this._data.paddingLeft,n=this._data.width-r,i=this._data.height-1;t.beginPath(),t.moveTo(r,21),t.lineTo(2,this._data.moveTop-1),t.moveTo(r+10,1),t.lineTo(r+n-10,1),t.arcTo(r+n,1,r+n,11,10),t.lineTo(r+n,1+i-10),t.arcTo(r+n,1+i,r+n-10,1+i,10),t.lineTo(r+10,1+i),t.arcTo(r,1+i,r,1+i-10,10),t.lineTo(r,11),t.arcTo(r,1,r+10,1,10),t.closePath(),t.stroke(),t.font="16px 雅黑",t.lineWidth=1,t.fillStyle="white",t.textAlign="left";for(var o=this._data.text.split("|"),a=0;a<o.length;a++)t.fillText(o[a],r+10,1+20*(a+1))},c.prototype.build=function(){var e=this._data,t=e.position,r=e.width,n=e.height;if(Freedo.defined(r)&&Freedo.defined(n)){var i=o.FdMisc.FdGeometric.tc(t),a=Freedo.Cartographic.fromCartesian(i);o.FdMisc.FdGeometric.getLongAndLatRatio(a);this._data.positionC=Freedo.clone(i,!0);this._basePt=this._basePtCo.add({position:i,pixelSize:10,show:!0,color:Freedo.Color.YELLOW,disableDepthTestDistance:Number.POSITIVE_INFINITY}),this._canvas&&(document.body.removeChild(this._canvas),this._canvas=void 0),this._canvas=document.createElement("canvas"),this._canvas.id=this._id,this._canvas.style.position="absolute",this._canvas.style.display="block",this._canvas.style.zIndex="999",this._canvas.width=e.width+10,this._canvas.height=e.height+10,this._canvas.style.pointerEvents="none",this._canvas.addEventListener("click",function(e){console.log("click")},!1),this._canvas.ondrag=function(e){console.log("ondrag")},document.body.appendChild(this._canvas),this.update(),this._viewer.scene.requestRender()}else console.error("FdTextBox2D.prototype.build：width或height参数无效")},c.prototype.addLsnr=function(){this._lsner&&this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){if(console.log(t),"cancel"==t&&this.cancel(),"PointAdded"==t&&(e._data.position=Freedo.clone(r.position,!0),e._ple.cancel(),e._lsner(),e.build()),"Transformed"==t){var n=r.positionG,i=Freedo.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);e._data.position=Freedo.FdMisc.FdGeometric.tg(i),e.clear(),e.build()}})},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.startEdit=function(){console.info("开始编辑"),this.addLsnr(),this._ple.startEdit([this._data.positionC])},c.prototype.endEdit=function(){this._ple.endEdit()},c.prototype.clear=function(){this._basePtCo.remove(this._basePt),this._canvas&&(document.body.removeChild(this._canvas),this._canvas=void 0),this._viewer.scene.requestRender()},c.prototype.remove=function(){this.clear(),this._data=void 0,this._viewer.scene.requestRender()},c.prototype.show=function(){},c.prototype.hide=function(){},c.prototype.setText=function(e){this.clear(),this._data.text=e,this.build()},c.prototype.getData=function(){if(this._data){var e=Freedo.clone(this._data,!0);return{id:this._id,type:"TextBox2D",option:e}}},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel()},c.prototype.dispose=function(){this.reset(),this.remove()},t.FdTextBox2D=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdLoft=void 0;var n=s(r(1)),i=s(r(6)),o=r(72),a=(r(11),r(25));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,i){(0,n.default)(this,e),this._viewer=t,this._lsner=void 0,this._ple=new a.FdPolylineEditor(t),this._ple.setAutoLoop(!1),this._ple.setAutoDelLines(!0),this._handler=void 0,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._id=r,this._data=i,this._entities=[],this._coreLine=void 0,this._smoothRate=5,this._nearRate=4,this.create()}return(0,i.default)(e,[{key:"option",get:function(){return Freedo.clone(this.getData(),!0)}}]),e}();c.prototype.create=function(){Freedo.defined(this._data)?(Freedo.defined(this._id)||(this._id=Freedo.createGuid()),this._data.pts?this.build():(Freedo.defined(this._data.heightOffset)&&this._ple.setHeightOffset(this._data.heightOffset),this._ple.run(),this.addLsnr())):console.error("FdLoft.prototype.create：参数无效")},c.prototype.build=function(){var e,t=this._data,r=[];for(var n in t.pts){var i={position:t.pts[n]};r.push(i)}e=0==t.smoothRate?t.pts:this.smoothPolyline(r),this._data.smoothPts=e,t.showBaseLine&&(this._coreLine=this.addCoreLine(t.pts)),this.buildLoft(),this._ple.cancel(),this._event.raiseEvent("EntityAdded",{}),this._viewer.scene.requestRender()},c.prototype.buildLoft=function(){var e=this._data,t=e.pts;t=e.smoothPts;var r=e.img,n=void 0;n=r?new Freedo.ImageMaterialProperty({image:r,repeat:e.repeat}):Freedo.Color.CHOCOLATE;var i={polylineVolume:{positions:t,shape:e.shape,material:n}},o=this._viewer.entities.add(i);this._entities.push(o)},c.prototype.calcAngle=function(e,t,r){var n=FreeDo.Cartesian3.subtract(e,t,new FreeDo.Cartesian3),i=FreeDo.Cartesian3.subtract(r,t,new FreeDo.Cartesian3);return Freedo.Cartesian3.angleBetween(n,i)},c.prototype.createAreaPrimitive=function(e,t,r){new Freedo.Cartesian3;var n,i=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(i,o,new Freedo.Cartesian3),n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3);var a,s=Freedo.Cartesian3.angleBetween(n,Freedo.Cartesian3.UNIT_Z),c=Freedo.Cartesian3.cross(n,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3),u=Freedo.Quaternion.fromAxisAngle(c,s,new Freedo.Quaternion),l=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,u,new Freedo.Cartesian3(1,1,1)),h=(Freedo.Matrix4.multiplyByPointAsVector(l,n,new Freedo.Cartesian3),[]);for(var d in e){var p=Freedo.Matrix4.multiplyByPointAsVector(l,e[d],new Freedo.Cartesian3);h.push(p)}for(var d in r){p=Freedo.Matrix4.multiplyByPointAsVector(l,r[d],new Freedo.Cartesian3);h.push(p)}for(var f=[],v=0;v<e.length;v++)f.push(1*e[v].x),f.push(1*e[v].y),f.push(1*e[v].z);var _=[];if(r){for(v=0;v<r.length;v++)f.push(1*r[v].x),f.push(1*r[v].y),f.push(1*r[v].z);_.push(e.length)}var y=Freedo.PolygonPipeline.triangulate(h,_),m=new Float64Array(f);return a=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})},indices:new Uint16Array(y),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(m)}),t||(t=new Freedo.Color(1,1,0,.8)),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:a,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:!0,translucent:!0}),asynchronous:!1})},c.prototype.addLsnr=function(){this._lsner&&(this._lsner(),this._lsner=void 0);var e=this;this._lsner=this._ple.on(function(t,r){"PLAdd"==t&&e.onPolylineAdded(r),"EditEnd"==t&&(e._data.pts=Freedo.clone(r.pts),e.reDraw())})},c.prototype.onPolylineAdded=function(e){this._data.pts=Freedo.clone(e.polyline.pts),this.build(),this._ple.cancel()},c.prototype.calcCP=function(e,t,r){var n,i,o;n=e.position,i=t.position,o=r.position;var a=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3),s=FreeDo.Cartesian3.subtract(o,i,new FreeDo.Cartesian3),c=FreeDo.Cartesian3.cross(a,s,new FreeDo.Cartesian3),u=FreeDo.Cartesian3.normalize(a,new FreeDo.Cartesian3),l=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3),h=FreeDo.Cartesian3.add(u,l,new FreeDo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),p=Freedo.Quaternion.fromAxisAngle(c,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),f=Freedo.Matrix3.fromQuaternion(d,new Freedo.Matrix3),v=Freedo.Matrix3.fromQuaternion(p,new Freedo.Matrix3),_=Freedo.Matrix3.multiplyByVector(f,h,new Freedo.Cartesian3),y=Freedo.Matrix3.multiplyByVector(v,h,new Freedo.Cartesian3),m=FreeDo.Cartesian3.normalize(_,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3),F=FreeDo.Cartesian3.distance(n,i),w=FreeDo.Cartesian3.distance(o,i),C=1;C=F<w?F/this._nearRate:w/this._nearRate,m=FreeDo.Cartesian3.multiplyByScalar(m,C,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.add(i,m,new FreeDo.Cartesian3),P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);return FreeDo.Cartesian3.distance(n,b)<FreeDo.Cartesian3.distance(n,P)?[b,P]:[P,b]},c.prototype.setNearRate=function(e){this._nearRate=e,this.reDraw()},c.prototype.smoothPolyline=function(e){var t=[];if(e.length<3)for(var r=0;r<e.length;r++)t.push(e[r].position);else for(r=0;r<=e.length-2;r++){var n={},i={},a={},s={};0==r?(n=e[0],i.position=this.calcCP(e[0],e[1],e[2])[0],a=e[0],s=e[1]):r==e.length-2?(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i=e[r+1],a=e[r],s=e[r+1]):(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i.position=this.calcCP(e[r],e[r+1],e[r+2])[0],a=e[r],s=e[r+1]);var c=new o.FdBezierCurveAlgorithm(a,s,n,i).getVertexForCurve(this._smoothRate);t=t.concat(c)}var u=[];for(r=0;r<t.length;r++){var l;if(l=t[r],u.length>0)FreeDo.Cartesian3.distance(u[u.length-1],l)>1e-4&&u.push(l);else u.push(l)}return u},c.prototype.showBaseLine=function(e){this._data.showBaseLine=e},c.prototype.addCoreLine=function(e){return this._viewer.scene.primitives.add(this.createLinePrimitive(e))},c.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.setSmoothRate=function(e){this._smoothRate=e,this.reDraw()},c.prototype.clearEntities=function(e){for(var t in this._entities){var r=this._entities[t];this._viewer.entities.remove(r)}this._viewer.scene.primitives.remove(this._coreLine),this._entities=[],this._tempLines=[],this._viewer.scene.requestRender()},c.prototype.getData=function(){var e=Freedo.clone(this._data,!0);return{id:this._id,type:"Loft",option:e}},c.prototype.startEdit=function(){this.addLsnr(),this._ple.startEdit(this._data.pts)},c.prototype.editPre=function(){this._ple.editPre()},c.prototype.editNext=function(){this._ple.editNext()},c.prototype.endEdit=function(){this._ple.endEdit(),this._lsner()},c.prototype.remove=function(){this.clearEntities(),this._data=[]},c.prototype.reDraw=function(e){this.clearEntities(),this.build()},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel()},c.prototype.dispose=function(){this.reset(),this.remove()},t.FdLoft=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdCylinder=void 0;var n=s(r(1)),i=s(r(6)),o=r(72),a=(r(11),r(25));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,i){(0,n.default)(this,e),this._viewer=t,this._lsner=void 0,this._ple=new a.FdPolylineEditor(t),this._ple.setAutoLoop(!1),this._ple.setAutoDelLines(!0),this._handler=void 0,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._id=r,this._data=i,this._tempEntities=[],this._tempLines=[],this._entities=[],this._coreLine=void 0,this._offsetCylinder=new Freedo.Cartesian2(0,0),this.create()}return(0,i.default)(e,[{key:"option",get:function(){return Freedo.clone(this.getData(),!0)}}]),e}();c.prototype.create=function(){Freedo.defined(this._data)?(Freedo.defined(this._id)||(this._id=Freedo.createGuid()),this._data.pts?this.build():(this._ple.run(),this.addLsnr())):console.error("FdCylinder.prototype.create：参数无效")},c.prototype.updateM=function(){this._offsetCylinder.x<0&&(this._offsetCylinder.x=1),this._offsetCylinder.x-=.1,viewer.scene.requestRender()},c.prototype.build=function(){var e=this._data,t=[];for(var r in e.pts){var n={position:e.pts[r]};t.push(n)}0==e.smoothRate?points:this.smoothPolyline(t),e.showBaseLine&&(this._coreLine=this.addCoreLine(e.pts)),e.innerRadius?this._entities=this.buildTube():this._entities=this.buildCylinder(),this._event.raiseEvent("EntityAdded",{}),this._viewer.scene.requestRender(),this._inter=setInterval(this.updateM.bind(this),150)},c.prototype.buildCylinder=function(){for(var e=this._data,t=e.pts,r=this.buildSkeleton(t,e.radius),n=[],i=0;i<r.length;i++){var o=Freedo.clone(r[i].startPts,!0),a=Freedo.clone(r[i].endPts,!0),s=new Freedo.Color(1,0,0,.8),c=this._viewer.scene.primitives.add(this.createAreaPrimitive(o,s));n.push(c),c=this._viewer.scene.primitives.add(this.createAreaPrimitive(a,s)),n.push(c),o.push(o[0]),a.push(a[0]);for(var u=0,l=0;l<o.length-1;l++){u+=FreeDo.Cartesian3.distance(o[l],o[l+1])}for(l=0;l<o.length-1;l++){var h=[];h.push(o[l]),h.push(o[l+1]),h.push(a[l+1]),h.push(a[l]);FreeDo.Cartesian3.distance(o[l],o[l+1]);var d=l/o.length*1,p=(l+1)/o.length*1-1e-4;c=e.enableMaterial?this._viewer.scene.primitives.add(this.createRectPrimitive(h,void 0,void 0,d,p,u/1)):this._viewer.scene.primitives.add(this.createAreaPrimitive(h)),n.push(c)}}return n},c.prototype.buildTube=function(){for(var e=this._data,t=this.buildSkeleton(e.pts,e.radius),r=this.buildSkeleton(e.pts,e.innerRadius),n=[],i=0;i<t.length;i++){var o=Freedo.clone(t[i].startPts,!0),a=Freedo.clone(t[i].endPts,!0),s=Freedo.clone(r[i].startPts,!0),c=Freedo.clone(r[i].endPts,!0),u=new Freedo.Color(1,0,0,.8),l=this._viewer.scene.primitives.add(this.createAreaPrimitive(o,u,s));n.push(l),l=this._viewer.scene.primitives.add(this.createAreaPrimitive(a,u,c)),n.push(l),u=new Freedo.Color(1,1,0,.8),o.push(o[0]),a.push(a[0]);for(var h=0;h<o.length-1;h++){(d=[]).push(o[h]),d.push(o[h+1]),d.push(a[h+1]),d.push(a[h]),l=this._viewer.scene.primitives.add(this.createAreaPrimitive(d)),n.push(l)}u=new Freedo.Color(1,0,0,.8),s.push(s[0]),c.push(c[0]);for(h=0;h<s.length-1;h++){var d;(d=[]).push(s[h]),d.push(s[h+1]),d.push(c[h+1]),d.push(c[h]),l=this._viewer.scene.primitives.add(this.createAreaPrimitive(d)),n.push(l)}}return n},c.prototype.buildSkeleton=function(e,t){for(var r={radius:t},n=void 0,i=[],o=0;o<e.length-1;o++){var a=[],s=[];if(0==o){if(L=e[o],o+1==e.length-1){I=e[o+1];for(var c=Freedo.Cartesian3.subtract(I,L,new Freedo.Cartesian3),u=new Freedo.Cartesian3(I.x,I.y,I.z+1),l=Freedo.Cartesian3.subtract(u,L,new Freedo.Cartesian3),h=Freedo.Cartesian3.cross(c,l,new Freedo.Cartesian3),d=Freedo.Cartesian3.normalize(h,new Freedo.Cartesian3),p=Freedo.Cartesian3.multiplyByScalar(d,r.radius,new Freedo.Cartesian3),f=Freedo.Cartesian3.multiplyByScalar(d,1*r.radius,new Freedo.Cartesian3),v=0;v<360;v+=5){var _=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.toRadians(v),new Freedo.Quaternion),y=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,_,new Freedo.Cartesian3(1,1,1)),m=Freedo.Matrix4.multiplyByPointAsVector(y,p,new Freedo.Cartesian3),g=Freedo.Matrix4.multiplyByPointAsVector(y,f,new Freedo.Cartesian3),F=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1),w=new Freedo.Cartesian3(L.x+m.x,L.y+m.y,L.z+m.z);n=this._viewer.entities.add({position:w,point:{color:F,show:!1,pixelSize:10}}),this._tempEntities.push(n);var C=new Freedo.Cartesian3(I.x+g.x,I.y+g.y,I.z+g.z);n=this._viewer.entities.add({position:C,point:{color:F,show:!1,pixelSize:20}}),this._tempEntities.push(n),a.push(w),s.push(C)}}if(o+1<e.length-1){I=e[o+1],R=e[o+2];c=FreeDo.Cartesian3.subtract(L,I,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.subtract(I,L,new FreeDo.Cartesian3),P=(l=FreeDo.Cartesian3.subtract(R,I,new FreeDo.Cartesian3),Freedo.Cartesian3.angleBetween(c,l)),M=FreeDo.Cartesian3.normalize(c,new FreeDo.Cartesian3),x=FreeDo.Cartesian3.normalize(l,new FreeDo.Cartesian3),S=FreeDo.Cartesian3.add(M,x,new FreeDo.Cartesian3);for(h=Freedo.Cartesian3.cross(c,l,new Freedo.Cartesian3),d=Freedo.Cartesian3.normalize(h,new Freedo.Cartesian3),p=Freedo.Cartesian3.multiplyByScalar(d,r.radius,new Freedo.Cartesian3),f=Freedo.Cartesian3.multiplyByScalar(d,1*r.radius,new Freedo.Cartesian3),v=0;v<360;v+=5){_=Freedo.Quaternion.fromAxisAngle(b,Freedo.Math.toRadians(v),new Freedo.Quaternion),y=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,_,new Freedo.Cartesian3(1,1,1)),m=Freedo.Matrix4.multiplyByPointAsVector(y,p,new Freedo.Cartesian3),F=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1),w=new Freedo.Cartesian3(L.x+m.x,L.y+m.y,L.z+m.z);n=this._viewer.entities.add({position:w,point:{color:F,show:!1,pixelSize:10}}),this._tempEntities.push(n);var T=Freedo.Cartesian3.cross(h,S,new Freedo.Cartesian3),E=Freedo.Quaternion.fromAxisAngle(T,Freedo.Math.toRadians(v),new Freedo.Quaternion),D=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,E,new Freedo.Cartesian3(1,1,1));g=Freedo.Matrix4.multiplyByPointAsVector(D,f,new Freedo.Cartesian3),C=new Freedo.Cartesian3(I.x+g.x,I.y+g.y,I.z+g.z);n=this._viewer.entities.add({position:C,point:{color:F,show:!1,pixelSize:20}}),this._tempEntities.push(n),a.push(w),s.push(C)}}}if(0!=o){if(o+1==e.length-1){L=e[o-1],I=e[o],R=e[o+1];for(c=Freedo.Cartesian3.subtract(L,I,new Freedo.Cartesian3),l=Freedo.Cartesian3.subtract(R,I,new Freedo.Cartesian3),P=Freedo.Cartesian3.angleBetween(c,l),M=FreeDo.Cartesian3.normalize(c,new FreeDo.Cartesian3),x=FreeDo.Cartesian3.normalize(l,new FreeDo.Cartesian3),S=FreeDo.Cartesian3.add(M,x,new FreeDo.Cartesian3),h=Freedo.Cartesian3.cross(c,l,new Freedo.Cartesian3),d=Freedo.Cartesian3.normalize(h,new Freedo.Cartesian3),p=Freedo.Cartesian3.multiplyByScalar(d,r.radius,new Freedo.Cartesian3),f=Freedo.Cartesian3.multiplyByScalar(d,r.radius,new Freedo.Cartesian3),v=0;v<360;v+=5){b=Freedo.Cartesian3.cross(h,S,new Freedo.Cartesian3);var A=Freedo.Quaternion.fromAxisAngle(b,Freedo.Math.toRadians(v),new Freedo.Quaternion),O=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,A,new Freedo.Cartesian3(1,1,1)),k=Freedo.Matrix4.multiplyByPointAsVector(O,p,new Freedo.Cartesian3);F=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1),w=new Freedo.Cartesian3(I.x+k.x,I.y+k.y,I.z+k.z);n=this._viewer.entities.add({position:w,point:{color:F,show:!1,pixelSize:10}}),this._tempEntities.push(n);E=Freedo.Quaternion.fromAxisAngle(l,Freedo.Math.toRadians(v),new Freedo.Quaternion),D=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,E,new Freedo.Cartesian3(1,1,1)),g=Freedo.Matrix4.multiplyByPointAsVector(D,f,new Freedo.Cartesian3),C=new Freedo.Cartesian3(R.x+g.x,R.y+g.y,R.z+g.z);n=this._viewer.entities.add({position:C,point:{color:F,show:!1,pixelSize:20}}),this._tempEntities.push(n),a.push(w),s.push(C)}}if(o+1<e.length-1){var L,I,R,N;L=e[o-1],I=e[o],R=e[o+1],N=e[o+2];c=Freedo.Cartesian3.subtract(L,I,new Freedo.Cartesian3),l=Freedo.Cartesian3.subtract(R,I,new Freedo.Cartesian3);var B=Freedo.Cartesian3.subtract(I,R,new Freedo.Cartesian3),G=Freedo.Cartesian3.subtract(N,R,new Freedo.Cartesian3),j=(P=Freedo.Cartesian3.angleBetween(c,l),Freedo.Cartesian3.angleBetween(B,G),M=FreeDo.Cartesian3.normalize(c,new FreeDo.Cartesian3),x=FreeDo.Cartesian3.normalize(l,new FreeDo.Cartesian3),FreeDo.Cartesian3.normalize(B,new FreeDo.Cartesian3)),H=FreeDo.Cartesian3.normalize(G,new FreeDo.Cartesian3),V=(S=FreeDo.Cartesian3.add(M,x,new FreeDo.Cartesian3),FreeDo.Cartesian3.add(j,H,new FreeDo.Cartesian3)),X=(P=Freedo.Math.toDegrees(Freedo.Cartesian3.angleBetween(S,V)),h=Freedo.Cartesian3.cross(c,l,new Freedo.Cartesian3),d=Freedo.Cartesian3.normalize(h,new Freedo.Cartesian3),Freedo.Cartesian3.cross(B,G,new Freedo.Cartesian3)),Y=Freedo.Cartesian3.normalize(X,new Freedo.Cartesian3);for(p=Freedo.Cartesian3.multiplyByScalar(d,r.radius,new Freedo.Cartesian3),f=Freedo.Cartesian3.multiplyByScalar(Y,1*r.radius,new Freedo.Cartesian3),v=0;v<360;v+=5){b=Freedo.Cartesian3.cross(h,S,new Freedo.Cartesian3),A=Freedo.Quaternion.fromAxisAngle(b,Freedo.Math.toRadians(v),new Freedo.Quaternion),O=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,A,new Freedo.Cartesian3(1,1,1)),k=Freedo.Matrix4.multiplyByPointAsVector(O,p,new Freedo.Cartesian3),F=new Freedo.Color(Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),Freedo.Math.nextRandomNumber(),1),w=new Freedo.Cartesian3(I.x+k.x,I.y+k.y,I.z+k.z);n=this._viewer.entities.add({position:w,point:{color:F,show:!1,pixelSize:10}}),this._tempEntities.push(n);T=Freedo.Cartesian3.cross(X,V,new Freedo.Cartesian3);var z=v;P>90&&(z=v+180);E=Freedo.Quaternion.fromAxisAngle(T,Freedo.Math.toRadians(z),new Freedo.Quaternion),D=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,E,new Freedo.Cartesian3(1,1,1)),g=Freedo.Matrix4.multiplyByPointAsVector(D,f,new Freedo.Cartesian3),C=new Freedo.Cartesian3(R.x+g.x,R.y+g.y,R.z+g.z);n=this._viewer.entities.add({position:C,point:{color:F,show:!1,pixelSize:20}}),this._tempEntities.push(n),a.push(w),s.push(C)}}}i.push({startPts:a,endPts:s})}return i},c.prototype.calcAngle=function(e,t,r){var n=FreeDo.Cartesian3.subtract(e,t,new FreeDo.Cartesian3),i=FreeDo.Cartesian3.subtract(r,t,new FreeDo.Cartesian3);return Freedo.Cartesian3.angleBetween(n,i)},c.prototype.createAreaPrimitive=function(e,t,r){new Freedo.Cartesian3;var n,i=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(i,o,new Freedo.Cartesian3),n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3);var a,s=Freedo.Cartesian3.angleBetween(n,Freedo.Cartesian3.UNIT_Z),c=Freedo.Cartesian3.cross(n,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3),u=Freedo.Quaternion.fromAxisAngle(c,s,new Freedo.Quaternion),l=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,u,new Freedo.Cartesian3(1,1,1)),h=(Freedo.Matrix4.multiplyByPointAsVector(l,n,new Freedo.Cartesian3),[]);for(var d in e){var p=Freedo.Matrix4.multiplyByPointAsVector(l,e[d],new Freedo.Cartesian3);h.push(p)}for(var d in r){p=Freedo.Matrix4.multiplyByPointAsVector(l,r[d],new Freedo.Cartesian3);h.push(p)}for(var f=[],v=0;v<e.length;v++)f.push(1*e[v].x),f.push(1*e[v].y),f.push(1*e[v].z);var _=[];if(r){for(v=0;v<r.length;v++)f.push(1*r[v].x),f.push(1*r[v].y),f.push(1*r[v].z);_.push(e.length)}var y=Freedo.PolygonPipeline.triangulate(h,_),m=new Float64Array(f);return a=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})},indices:new Uint16Array(y),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(m)}),t||(t=new Freedo.Color(1,1,0,.8)),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:a,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:!0,translucent:!0}),asynchronous:!1})},c.prototype.createRectPrimitive=function(e,t,r,n,i,o){new Freedo.Cartesian3;var a,s=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),c=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);a=Freedo.Cartesian3.cross(s,c,new Freedo.Cartesian3),a=Freedo.Cartesian3.normalize(a,new Freedo.Cartesian3);var u,l=Freedo.Cartesian3.angleBetween(a,Freedo.Cartesian3.UNIT_Z),h=Freedo.Cartesian3.cross(a,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(h,l,new Freedo.Quaternion),p=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,d,new Freedo.Cartesian3(1,1,1)),f=(Freedo.Matrix4.multiplyByPointAsVector(p,a,new Freedo.Cartesian3),[]);for(var v in e){var _=Freedo.Matrix4.multiplyByPointAsVector(p,e[v],new Freedo.Cartesian3);f.push(_)}for(var v in r){_=Freedo.Matrix4.multiplyByPointAsVector(p,r[v],new Freedo.Cartesian3);f.push(_)}for(var y=[],m=0;m<e.length;m++)y.push(1*e[m].x),y.push(1*e[m].y),y.push(1*e[m].z);var g=[],F=(FreeDo.Cartesian3.distance(e[0],e[1]),FreeDo.Cartesian3.distance(e[1],e[2])/o);g.push(0,n),g.push(0,i),g.push(F,i),g.push(F,n);var w=[];if(r){for(m=0;m<r.length;m++)y.push(1*r[m].x),y.push(1*r[m].y),y.push(1*r[m].z);w.push(e.length)}var C=Freedo.PolygonPipeline.triangulate(f,w),b=new Float64Array(y);u=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:b}),st:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:g})},indices:new Uint16Array(C),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(b)}),t||(t=new Freedo.Color(1,1,0,.8));var P=Freedo.FdApp.getFreedoXPath()+"Assets/Textures/ori/redtube.jpg";return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:u,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(t)}}),appearance:new Freedo.MaterialAppearance({materialSupport:Freedo.MaterialAppearance.MaterialSupport.TEXTURED,material:new Freedo.Material({fabric:{type:"DiffuseMap",uniforms:{image:P,repeat:4,offset:this._offsetCylinder},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st+offset)).channels"}}})}),asynchronous:!1})},c.prototype.addLsnr=function(){this._lsner&&(this._lsner(),this._lsner=void 0);var e=this;this._lsner=this._ple.on(function(t,r){"PLAdd"==t&&e.onPolylineAdded(r),"EditEnd"==t&&(e._data.pts=Freedo.clone(r.pts),e.reDraw())})},c.prototype.onPolylineAdded=function(e){this._data.pts=Freedo.clone(e.polyline.pts),this.build(),this._ple.cancel()},c.prototype.calcCP=function(e,t,r){var n,i,o;n=e.position,i=t.position,o=r.position;var a=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3),s=FreeDo.Cartesian3.subtract(o,i,new FreeDo.Cartesian3),c=FreeDo.Cartesian3.cross(a,s,new FreeDo.Cartesian3),u=FreeDo.Cartesian3.normalize(a,new FreeDo.Cartesian3),l=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3),h=FreeDo.Cartesian3.add(u,l,new FreeDo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),p=Freedo.Quaternion.fromAxisAngle(c,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),f=Freedo.Matrix3.fromQuaternion(d,new Freedo.Matrix3),v=Freedo.Matrix3.fromQuaternion(p,new Freedo.Matrix3),_=Freedo.Matrix3.multiplyByVector(f,h,new Freedo.Cartesian3),y=Freedo.Matrix3.multiplyByVector(v,h,new Freedo.Cartesian3),m=FreeDo.Cartesian3.normalize(_,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3),F=FreeDo.Cartesian3.distance(n,i),w=FreeDo.Cartesian3.distance(o,i),C=1;C=F<w?F/this._nearRate:w/this._nearRate,m=FreeDo.Cartesian3.multiplyByScalar(m,C,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.add(i,m,new FreeDo.Cartesian3),P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);return FreeDo.Cartesian3.distance(n,b)<FreeDo.Cartesian3.distance(n,P)?[b,P]:[P,b]},c.prototype.setNearRate=function(e){this._nearRate=e,this.reDraw()},c.prototype.smoothPolyline=function(e){var t=[];if(e.length<3)for(var r=0;r<e.length;r++)t.push(e[r].position);else for(r=0;r<=e.length-2;r++){var n={},i={},a={},s={};0==r?(n=e[0],i.position=this.calcCP(e[0],e[1],e[2])[0],a=e[0],s=e[1]):r==e.length-2?(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i=e[r+1],a=e[r],s=e[r+1]):(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i.position=this.calcCP(e[r],e[r+1],e[r+2])[0],a=e[r],s=e[r+1]);var c=new o.FdBezierCurveAlgorithm(a,s,n,i).getVertexForCurve(this._smoothRate);t=t.concat(c)}var u=[];for(r=0;r<t.length;r++){var l;if(l=t[r],u.length>0)FreeDo.Cartesian3.distance(u[u.length-1],l)>1e-4&&u.push(l);else u.push(l)}return u},c.prototype.showBaseLine=function(e){this._data.showBaseLine=e},c.prototype.addCoreLine=function(e){return this._viewer.scene.primitives.add(this.createLinePrimitive(e))},c.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.setSmoothRate=function(e){this._smoothRate=e,this.reDraw()},c.prototype.clear=function(e){for(var t in this._entities){var r=this._entities[t];this._viewer.scene.primitives.remove(r)}for(var t in this._viewer.scene.primitives.remove(this._coreLine),this._tempEntities)this._viewer.entities.remove(this._tempEntities[t]);for(var t in this._tempLines)this._viewer.scene.primitives.remove(this._tempLines[t]);this._entities=[],this._tempLines=[],this._viewer.scene.requestRender()},c.prototype.getData=function(){if(!this._data)return this._data;var e=Freedo.clone(this._data,!0);return{id:this._id,type:"Cylinder",option:e}},c.prototype.startEdit=function(){this.addLsnr(),this._ple.startEdit(this._data.pts)},c.prototype.editPre=function(){this._ple.editPre()},c.prototype.editNext=function(){this._ple.editNext()},c.prototype.endEdit=function(){this._ple.endEdit(),this._lsner()},c.prototype.remove=function(){this.clear(),this._data=void 0},c.prototype.reDraw=function(e){this.clear(),this.build()},c.prototype.setHeightOffset=function(e){this._ple.setHeightOffset(e)},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel(),clearInterval(this._inter)},c.prototype.dispose=function(){this.reset(),this.remove()},t.FdCylinder=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdBillboard=void 0;var n=s(r(1)),i=s(r(6)),o=r(11),a=r(25);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,i){(0,n.default)(this,e),this._viewer=t,this._id=r,this._data=i,this._board=void 0,this._arrow=void 0,this._canvas=void 0,this._ple=new a.FdPolylineEditor(t),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this.create()}return(0,i.default)(e,[{key:"option",get:function(){return Freedo.clone(this.getData(),!0)}}]),e}();c.prototype.create=function(){Freedo.defined(this._data)?(Freedo.defined(this._id)||(this._id=Freedo.createGuid()),Freedo.defined(this._data.rotate)||(this._data.rotate=0),this._data.position?this.build():(this._ple.run(),this.addLsnr())):console.error("FdBillboard.prototype.create：参数无效")},c.prototype.createAreaPrimitive=function(e,t){var r;t=t||{};new Freedo.Cartesian3;var n=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),i=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);r=Freedo.Cartesian3.cross(n,i,new Freedo.Cartesian3),r=Freedo.Cartesian3.normalize(r,new Freedo.Cartesian3);var o,a=Freedo.Cartesian3.angleBetween(r,Freedo.Cartesian3.UNIT_Z),s=Freedo.Cartesian3.cross(r,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3),c=Freedo.Quaternion.fromAxisAngle(s,a,new Freedo.Quaternion),u=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,c,new Freedo.Cartesian3(1,1,1)),l=(Freedo.Matrix4.multiplyByPointAsVector(u,r,new Freedo.Cartesian3),[]);for(var h in e){var d=Freedo.Matrix4.multiplyByPointAsVector(u,e[h],new Freedo.Cartesian3);l.push(d)}for(var p=[],f=0;f<e.length;f++)p.push(1*e[f].x),p.push(1*e[f].y),p.push(1*e[f].z);var v,_=Freedo.PolygonPipeline.triangulate(l),y=new Float64Array(p);return o=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})},indices:new Uint16Array(_),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(y)}),t.color||(v=new Freedo.Color(1,1,1,1)),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:o,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(v)}}),appearance:new Freedo.PerInstanceColorAppearance({flat:!0,translucent:!0}),asynchronous:!1})},c.prototype.callbackM=function(e,t){return this._canvas&&(t=this._canvas),Math.random()>.9&&this._viewer.scene.requestRender(),t},c.prototype.refresh=function(){this._viewer.scene.requestRender()},c.prototype.update=function(){var e=this._data.divID,t=this;html2canvas(document.getElementById(e),{backgroundColor:"#ffffff"}).then(function(e){t._canvas=e})},c.prototype.build=function(){var e=this._data,t=e.position,r=e.width,n=e.height,i=t[2];if(this.update(),Freedo.defined(r)&&Freedo.defined(n)){var a=o.FdMisc.FdGeometric.tc(t),s=Freedo.Cartographic.fromCartesian(a),c=o.FdMisc.FdGeometric.getLongAndLatRatio(s);this._data.positionC=Freedo.clone(a,!0);var u=new Freedo.CallbackProperty(this.callbackM.bind(this),!1),l=Freedo.Math.toRadians(e.rotate);this._board=viewer.entities.add({name:"boardEntity",wall:{positions:Freedo.Cartesian3.fromDegreesArrayHeights([t[0]-Freedo.Math.toDegrees(r*c[0]/2)*Math.cos(l),t[1]-Freedo.Math.toDegrees(r*c[1]/2)*Math.sin(l),n+i,t[0]+Freedo.Math.toDegrees(r*c[0]/2)*Math.cos(l),t[1]+Freedo.Math.toDegrees(r*c[1]/2)*Math.sin(l),n+i]),material:new Freedo.ImageMaterialProperty({image:u}),minimumHeights:[i+r/10,i+r/10],outline:!0}});var h;h=Freedo.Cartesian3.fromDegreesArrayHeights([t[0],t[1],i,t[0]+Freedo.Math.toDegrees(r*c[0]/10)*Math.cos(l),t[1]+Freedo.Math.toDegrees(r*c[1]/10)*Math.sin(l),r/10+i,t[0]-Freedo.Math.toDegrees(r*c[0]/10)*Math.cos(l),t[1]-Freedo.Math.toDegrees(r*c[1]/10)*Math.sin(l),r/10+i,t[0],t[1],i]),this._arrow=viewer.scene.primitives.add(this.createAreaPrimitive(h)),this._viewer.scene.requestRender()}else console.error("FdBillboard.prototype.build：width或height参数无效")},c.prototype.addLsnr=function(){this._lsner&&this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){if(console.log(t),"cancel"==t&&this.cancel(),"PointAdded"==t&&(e._data.position=Freedo.clone(r.position,!0),e._ple.cancel(),e._lsner(),e.build()),"Transformed"==t){var n=r.positionG,i=Freedo.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);e._data.position=Freedo.FdMisc.FdGeometric.tg(i),e.clear(),e.build()}})},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.startEdit=function(){console.info("开始编辑"),this.addLsnr(),this._ple.startEdit([this._data.positionC])},c.prototype.endEdit=function(){this._ple.endEdit()},c.prototype.clear=function(){this._viewer.entities.remove(this._board),this._viewer.scene.primitives.remove(this._arrow),this._board=void 0,this._arrow=void 0,this._viewer.scene.requestRender()},c.prototype.remove=function(){this.clear(),this._data=void 0,this._viewer.scene.requestRender()},c.prototype.show=function(){this._board&&(this._board.show=!0),this._arrow&&(this._arrow.show=!0)},c.prototype.hide=function(){this._board&&(this._board.show=!1),this._arrow&&(this._arrow.show=!1)},c.prototype.getData=function(){if(this._data){var e=Freedo.clone(this._data,!0);return{id:this._id,type:"Billboard",option:e}}},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel()},c.prototype.dispose=function(){this.reset(),this.remove()},t.FdBillboard=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdModelManager=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(236),s=r(235),c=r(234),u=r(233);var l=function e(t){(0,o.default)(this,e),this._viewer=t,this._scene=this._viewer.scene,this._entities=[],this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper};l.prototype.addLsnr=function(){this._lsner&&this._lsner()},l.prototype.add=function(e,t,r){Freedo.defined(e)||console.error("FdModelManager.add：type参数无效");var n=void 0;if("Billboard"==e&&(n=new a.FdBillboard(this._viewer,r,t)),"Cylinder"==e&&(n=new s.FdCylinder(this._viewer,r,t)),"Loft"==e&&(n=new c.FdLoft(this._viewer,r,t)),"TextBox2D"==e&&(n=new u.FdTextBox2D(this._viewer,r,t)),n)return n.type,this._entities.push(n),this._viewer.scene.requestRender(),n},l.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},l.prototype.clearEntities=function(){for(var e in this._entities)this._entities[e].remove();this._entities=[],this._viewer.scene.requestRender()},l.prototype.getData=function(){var e=[];for(var t in this._entities){var r=this._entities[t].getData();r&&e.push(r)}return e},l.prototype.removeAll=function(){this.clearEntities()},l.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel()},l.prototype.dispose=function(){this.reset(),this.clearEntities()},t.FdModelManager=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdModel=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(237);var s=function e(){(0,o.default)(this,e)};s.FdModelManager=a.FdModelManager,t.FdModel=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdViewSwitcher=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};var a=function e(t){(0,o.default)(this,e),this._viewer=t,this._tempBall=null,this._spSize=0,this._oldType="",this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper};a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.checkModelExist=function(){return!1},a.prototype.getMode=function(){return this._oldType},a.prototype.start=function(e){if(this._viewer.scene.noSphereMode=!0,"MODEL_VIEW"===e){this._viewer.scene.skyAtmosphere.show=!1,this._viewer.scene.fog.enabled=!1,this._viewer.scene.globe.show=!1;for(var t=0;t<this._viewer.dataSources.length;t++){this._viewer.dataSources.get(t).show=!1}}if("COLUMBUS_VIEW"===e){this._viewer.scene.mode=Freedo.SceneMode.COLUMBUS_VIEW,"MODEL_VIEW"==this._oldType&&(this._viewer.terrainProvider=new Freedo.EllipsoidTerrainProvider);for(t=0;t<this._viewer.dataSources.length;t++){this._viewer.dataSources.get(t).show=!0}this._viewer.scene.globe.show=!0}if("2D"===e){null==this._tempBall&&(this._viewer.entities.remove(this._tempBall),this._tempBall=null),this._viewer.scene.morphTo2D(.02),this._viewer.terrainProvider=new Freedo.EllipsoidTerrainProvider;for(t=0;t<this._viewer.dataSources.length;t++){this._viewer.dataSources.get(t).show=!0}this._viewer.trackedEntity=void 0}"NORMAL_VIEW"===e&&this.cancel(),this._oldType=e,this._event.raiseEvent("Start",{mode:this._oldType}),this._viewer.scene.requestRender()},a.prototype.morphTo3D=function(){this._viewer.scene.mode=Freedo.SceneMode.SCENE3D},a.prototype.cancel=function(){this._oldType,this._viewer.scene.globe.show=!0,this._viewer.scene.skyAtmosphere.show=!0,this._viewer.scene.fog.enabled=!0,this._viewer.scene.noSphereMode=!1,setTimeout(this.morphTo3D.bind(this),500);for(var e=0;e<this._viewer.dataSources.length;e++){this._viewer.dataSources.get(e).show=!0}null!=this._tempBall&&(this._viewer.entities.remove(this._tempBall),this._tempBall=null),this._event.raiseEvent("Cancel",{mode:this._oldType}),this._oldType="NORMAL_VIEW",this._viewer.scene.requestRender()},a.prototype.reset=function(){this.cancel()},a.prototype.dispose=function(){this.reset()},t.FdViewSwitcher=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPMTSManager=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),this._pmtsOpts=new Freedo.AssociativeArray,this._pmtsCollection=new Freedo.AssociativeArray,this._viewer=t,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper}return(0,i.default)(e,[{key:"add",value:function(e,t){void 0===e.id&&(e.id=Freedo.createGuid());var r=e.url;this._pmtsOpts.set(e.id,Freedo.clone(e,!0));var n={};this._pmtsCollection.set(e.id,n);var i=this;return Freedo.FdServer.FdPMTSServer.getResource(r,t,function(r,o){o?console.error("FdServer.FdShareServer.getLayerAccesskeyResource got error: "+o):(n.pModelInfos=[],r.contents.layers.forEach(function(o){Freedo.FdServer.FdPMTSParser.getMatrixSets(r,o).forEach(function(r){r.matrix.forEach(function(a){var s=Freedo.FdServer.FdPMTSParser.getPModelURL(o,r,a,t),c=i._viewer.scene.primitives.add(new Freedo.FreedoPModelset({url:s}));void 0!==e.modelMatrix&&(c.modelMatrix=Freedo.Matrix4.fromArray(e.modelMatrix)),n.pModelInfos.push({pModel:c,matrix:a,matrixSet:r,layer:o})})})}),i._event.raiseEvent("PmtsLoaded",e.id))}),this._event.raiseEvent("Changed"),e.id}},{key:"remove",value:function(e){var t=this;this._pmtsOpts.remove(e);var r=this._pmtsCollection.get(e);void 0!==r&&r.pModelInfos.forEach(function(e){t._viewer.scene.primitives.remove(e.pModel)}),this._pmtsCollection.remove(e),this._event.raiseEvent("Changed")}},{key:"removeAll",value:function(){this._pmtsOpts.removeAll(),this._pmtsCollection.values.forEach(function(e){var t=this;void 0!==e.pModelInfos&&e.pModelInfos.forEach(function(e){t._viewer.scene.primitives.remove(e.pModel)})}),this._pmtsCollection.removeAll(),this._event.raiseEvent("Changed")}},{key:"getPmts",value:function(e){return this._pmtsCollection.get(e)}},{key:"setModelMatrix",value:function(e,t){var r=Freedo.Matrix4.fromArray(t);this._pmtsCollection.get(e).pModelInfos.forEach(function(e){e.pModel.modelMatrix=r}),this._pmtsOpts.get(e).modelMatrix=t,this._event.raiseEvent("Changed")}},{key:"getModelMatrix",value:function(e){return this._pmtsOpts.get(e).modelMatrix}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this.removeAll()}},{key:"dispose",value:function(){this.reset(),this._eventHelper.removeAll()}},{key:"data",get:function(){return Freedo.clone({collection:this._pmtsOpts.values},!0)}}]),e}();a.getPublicSharedPmtsURL=function(e,t){return"undefined"==typeof g_pmtsServer&&(g_pmtsServer="cfgateway.gbim360.cn"),"//"+g_pmtsServer+"/freeserver-pmts/services/share/"+e+"/pmts/1.0.0/PMTSCapabilities.json?accesskey="+t},t.FdPMTSManager=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdFlyToController=void 0;var n=a(r(1)),i=a(r(6)),o=r(122);function a(e){return e&&e.__esModule?e:{default:e}}new Freedo.Matrix4;var s=function(){function e(t){(0,n.default)(this,e),this._viewpoints=null,this._camera=t,this._currentIndex=-1,this._status="Stopped",this._flyingToIndex=-1,this._loop=!1,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._timeoutID=void 0}return(0,i.default)(e,[{key:"startOrResume",value:function(){switch(this._status){case"Playing":break;case"Stopped":case"Paused":this._play();break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"pause",value:function(){switch(this._status){case"Playing":this._pause();break;case"Stopped":case"Paused":break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"stop",value:function(){switch(this._status){case"Playing":this._stop();break;case"Stopped":break;case"Paused":this._stop();break;default:throw new Error("ViewpointsManager FdFlyToController error")}}},{key:"reset",value:function(){this._stop(),this._viewpoints=null}},{key:"dispose",value:function(){this._viewpoints=null}},{key:"_setViewpoints",value:function(e){this._stop(),this._viewpoints=e}},{key:"_getViewpoints",value:function(){return this._viewpoints}},{key:"_play",value:function(){if(null===this._viewpoints)throw new Error("FdFlyToController play error!");this._flytoNext(),this._setStatus("Playing")}},{key:"_pause",value:function(){this._cancel(),this._setStatus("Paused")}},{key:"_stop",value:function(){this._cancel(),this._setCurrentIndex(-1),this._setStatus("Stopped")}},{key:"_completeCallback",value:function(){this._setCurrentIndex(this._flyingToIndex),this._currentIndex>=this._viewpoints.length&&this._setCurrentIndex(-1),this._flyingToIndex=-1;var e=this;this._timeoutID=setTimeout(function(){e._flytoNext()},1e3)}},{key:"_flytoNext",value:function(){var e;if(this._cancel(),this._currentIndex>=this._viewpoints.length-1?this._loop&&1!==this._viewpoints.length?this._flyingToIndex=0:this._stop():this._flyingToIndex=this._currentIndex+1,-1!==this._flyingToIndex&&void 0!==(e=this._viewpoints[this._flyingToIndex].cameraInfo)){var t=this;(0,o.flyToByCameraInfo)(t._camera,e,{complete:function(){t._completeCallback()}})}}},{key:"_cancel",value:function(){clearTimeout(this._timeoutID),this._timeoutID=void 0,this._camera.cancelFlight(),this._flyingToIndex=-1}},{key:"_goto",value:function(e){if(e>=this._viewpoints.length)throw new Error("FdFlyToController inde error");this._cancel();var t=this._viewpoints.list[e].cameraInfo;if(void 0===t)throw new Error("FdFlyToController cameraInfo error");(0,o.goToByCameraInfo)(this._camera,t)}},{key:"_setStatus",value:function(e){this._status=e,this._event.raiseEvent("StatusChanged",e)}},{key:"_setCurrentIndex",value:function(e){this._currentIndex=e,this._event.raiseEvent("CurrentIndexChanged",e)}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this._setViewpoints(null),this._stop()}},{key:"dispose",value:function(){this.reset(),this._eventHelper.removeAll()}},{key:"currentIndex",get:function(){return this._currentIndex},set:function(e){this._goto(e),this._setCurrentIndex(e)}},{key:"status",get:function(){return this._status}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e,this._event.raiseEvent("PropertyChanged")}}]),e}();t.FdFlyToController=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdViewPointsManager=void 0;var n=s(r(1)),i=s(r(6)),o=r(122),a=r(241);function s(e){return e&&e.__esModule?e:{default:e}}new Freedo.Matrix4;var c=function(){function e(t){(0,n.default)(this,e),this._viewpointOpts={},this._viewer=t,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._flytoControl=new a.FdFlyToController(t.scene.camera),this._currentPlayingGroupID=void 0;var r=this;this._flytoControl.on(function(e,t){r.flyToEventCallback(e,t)})}return(0,i.default)(e,[{key:"flyToEventCallback",value:function(e,t){"CurrentIndexChanged"===e?this._event.raiseEvent("PlayingGroupCurrentIndexChanged",t):"StatusChanged"===e?this._event.raiseEvent("PlayingGroupStatusChanged",t):"PropertyChanged"===e&&this._event.raiseEvent("PlayingGroupPropertyChanged",t)}},{key:"createGroup",value:function(e,t){return void 0===t&&(t=Freedo.createGuid()),this._viewpointOpts[t]={name:e,list:[]},this._event.raiseEvent("GroupsChanged",t),t}},{key:"removeGroup",value:function(e){return void 0!==this._viewpointOpts[e]&&(this._currentPlayingGroupID===e&&this._flytoControl.reset(),delete this._viewpointOpts[e],this._event.raiseEvent("GroupsChanged",e),!0)}},{key:"getGroupName",value:function(e){return void 0===this._viewpointOpts[e]?"":this._viewpointOpts[e].name}},{key:"setGroupName",value:function(e,t){if(void 0===this._viewpointOpts[e])return"";this._viewpointOpts[e].name=t}},{key:"getGroupOptions",value:function(e){if(void 0!==this._viewpointOpts[e])return Freedo.clone(this._viewpointOpts[e],!0)}},{key:"removeAllGroups",value:function(){for(var e in this._flytoControl.reset(),this._viewpointOpts)delete this._viewpointOpts[e];return this._currentPlayingGroupID=void 0,this._event.raiseEvent("GroupsChanged"),!0}},{key:"getAllGroupIDs",value:function(){var e=[];for(var t in this._viewpointOpts)e.push(t);return e}},{key:"appendViewpoint",value:function(e,t){if(void 0===this._viewpointOpts[e])return!1;var r=Freedo.clone(t,!0);return this._viewpointOpts[e].list.push(r),this._event.raiseEvent("GroupChanged",e),!0}},{key:"insertViewpoint",value:function(e,t,r){if(void 0===this._viewpointOpts[e])return!1;var n=Freedo.clone(t,!0);return this._viewpointOpts[e].list.splice(r,0,n),this._event.raiseEvent("GroupChanged",e),!0}},{key:"removeViewpoint",value:function(e,t){return void 0!==this._viewpointOpts[e]&&(void 0!==this._viewpointOpts[e].list[t]&&(this._viewpointOpts[e].list.splice(t,1),this._event.raiseEvent("GroupChanged",e),!0))}},{key:"getViewpointsLength",value:function(e){if(void 0===this._viewpointOpts[e])throw new Error("getViewpointsLength error!");return this._viewpointOpts[e].list.length}},{key:"setViewpoint",value:function(e,t,r){if(void 0===this._viewpointOpts[e])return!1;if(void 0===this._viewpointOpts[e].list[t])return!1;var n=Freedo.clone(r,!0);return this._viewpointOpts[e].list[t]=n,this._event.raiseEvent("ViewPointChanged",n),!0}},{key:"getViewPoint",value:function(e,t){if(void 0===this._viewpointOpts[e])throw new Error("getViewPoint error");if(void 0===this._viewpointOpts[e].list[t])return new Error("getViewPoint error");var r=this._viewpointOpts[e].list[t];return Freedo.clone(r,!0)}},{key:"flyTo",value:function(e,t){if(void 0===this._viewpointOpts[e])return!1;if(void 0===this._viewpointOpts[e].list[t])return!1;var r=this._viewpointOpts[e].list[t].cameraInfo;if(void 0===r)return!1;var n=this._viewer.scene.camera;return(0,o.flyToByCameraInfo)(n,r),!0}},{key:"goTo",value:function(e,t){if(void 0===this._viewpointOpts[e])return!1;if(void 0===this._viewpointOpts[e].list[t])return!1;var r=this._viewpointOpts[e].list[t].cameraInfo;if(void 0===r)return!1;var n=this._viewer.scene.camera;return(0,o.goToByCameraInfo)(n,r),!0}},{key:"startOrResumeGroup",value:function(e){if(void 0===e){if(void 0===this._currentPlayingGroupID)throw new Error("FdViewPointsManager startOrResume should have argument!");e=this._currentPlayingGroupID}void 0!==this._currentPlayingGroupID?e!==this._currentPlayingGroupID?(this._flytoControl.stop(),this._flytoControl._setViewpoints(null),this._flytoControl._setViewpoints(this._viewpointOpts[e].list),this._currentPlayingGroupID=e,this._flytoControl.startOrResume()):this._flytoControl.startOrResume():(this._flytoControl._setViewpoints(this._viewpointOpts[e].list),this._currentPlayingGroupID=e,this._flytoControl.startOrResume())}},{key:"pauseGroup",value:function(){this._flytoControl.pause()}},{key:"stopGroup",value:function(){this._flytoControl.stop()}},{key:"getGroupPlayingStatus",value:function(){return this._flytoControl.status}},{key:"getGroupPlayingIndex",value:function(){return this._flytoControl.currentIndex}},{key:"setGroupPlayingIndex",value:function(e){this._flytoControl.currentIndex=e}},{key:"getGroupPlayingGroupID",value:function(){return this._currentPlayingGroupID}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this.removeAllGroups(),this._flytoControl.reset()}},{key:"dispose",value:function(){this.reset(),this._flytoControl.dispose(),this._eventHelper.removeAll()}},{key:"viewPointsOptions",get:function(){return this._viewpointOpts}},{key:"playingLoop",get:function(){return this._flytoControl.loop},set:function(e){this._flytoControl.loop!==e&&(this._flytoControl.loop=e)}}]),e}();t.FdViewPointsManager=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTerrain=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._scene=this._viewer.scene,this._terrainOption={},this._showTerrain=!1,this._terrain=new Freedo.CesiumTerrainProvider({url:"//terrain.gbim360.com",requestWaterMask:!1}),this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._defaultTerrain=new Freedo.EllipsoidTerrainProvider}return(0,i.default)(e,[{key:"setTerrain",value:function(e,t,r){if("string"==typeof e){if("HM"===t)this._terrain=new Freedo.CesiumTerrainProvider({url:e,constraintRegions:r,requestWaterMask:!1});else if("STK"===t)this._terrain=new Freedo.CesiumTerrainProvider({url:e,constraintRegions:r,requestWaterMask:!1});else{if("WETS"!==t)throw new Freedo.RuntimeError("The Terrain Type:"+t+" is not supported at present!");this._terrain=new Freedo.WETSTerrainProvider({sources:[{capabilitiesUrl:e}],constraintRegions:r})}this._terrainOption.type=t,this._terrainOption.show=!0,this._terrainOption.options=e,this._event.raiseEvent("TypeChanged",{type:t}),this.visible=!0}else this.setWETSTerrain(e,r)}},{key:"setWETSTerrain",value:function(e,t){if(!(e instanceof Array))throw new Error("The parameter of setWETSTerrain must be an Array!");e.length<1||(!t instanceof Array&&(t=void 0),this._terrain=new Freedo.WETSTerrainProvider({sources:e,constraintRegions:t}),this._terrainOption.type="WETS",this._terrainOption.show=!0,this._terrainOption.options=e,this._event.raiseEvent("TypeChanged",{type:"WETS"}),this.visible=!0)}},{key:"enableTerrainReverseSkirt",value:function(){var e=this._terrain;if(!(e instanceof Freedo.WETSTerrainProvider))throw new Error("The current Terrain is not The Freedo.WETSTerrainProvider Object!");var t=this._viewer;t.scene.screenSpaceCameraController.enableCollisionDetection=!1;var r=t.camera;r.showTerrainWhenUnderGround=!0,r.reverseSkirtWhenUnderGround=!0,e.addReverseSkirt=!0,e._hideSkirtIndexBufferWithContext=[],e._reverseSkirtIndexBufferWithContext=[],e._heightmapWidth1=65,e._heightmapHeight1=65,e.getHideSkirtIndexBuffer=function(){return function(e){var t=this._hideSkirtIndexBufferWithContext[e.id];return t||((t=this._hideSkirtIndexBufferWithContext[e.id]=Freedo.Buffer.createIndexBuffer({context:e,typedArray:function(e,t){for(var r=new Uint16Array((e-1)*(t-1)*6),n=0,i=0,o=0;o<t+1;++o){for(var a=0;a<e+1;++a){if(o>0&&o<t&&a>0&&a<e){var s=n,c=s+e+2,u=c+1,l=s+1;r[i++]=s,r[i++]=c,r[i++]=l,r[i++]=l,r[i++]=c,r[i++]=u}++n}++n}return r}(this._heightmapWidth1,this._heightmapHeight1),usage:Freedo.BufferUsage.STATIC_DRAW,indexDatatype:Freedo.IndexDatatype.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,t.referenceCount=1),t}}(),e.getReverseSkirtIndexBuffer=function(){return function(e){var t=this._reverseSkirtIndexBufferWithContext[e.id];return t||((t=this._reverseSkirtIndexBufferWithContext[e.id]=Freedo.Buffer.createIndexBuffer({context:e,typedArray:function(e,t){for(var r=new Uint16Array((e+1)*(t+1)*6),n=0,i=0,o=(e+2)*(t+2),a=0;a<t+1;++a){for(var s=0;s<e+1;++s){var c=n,u=c+e+2,l=u+1,h=c+1;0===a?(h=(c=o+s)+1,0===s?u=o+(e+2):s===e&&(l=o+(e+2)+1)):a===t?(l=(u=o+(e+2+2*t)+s)+1,0===s?c=o+(e+2+2*(t-1)):s===e&&(h=o+(e+2+2*(t-1))+1)):0===s?u=(c=o+(e+2)+2*(a-1)+s)+2:s===e&&(l=(h=o+(e+2)+2*(a-1)+1)+2),r[i++]=c,r[i++]=u,r[i++]=h,r[i++]=h,r[i++]=u,r[i++]=l,++n}++n}return r}(this._heightmapWidth1,this._heightmapHeight1),usage:Freedo.BufferUsage.STATIC_DRAW,indexDatatype:Freedo.IndexDatatype.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,t.referenceCount=1),t}}()}},{key:"setDepthTest",value:function(e){this._viewer.scene.globe.depthTestAgainstTerrain=e,this._viewer.scene.requestRender()}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this.visible=!1}},{key:"dispose",value:function(){this.reset(),this._terrainOption={},this._terrain=null,this._eventHelper.removeAll()}},{key:"visible",get:function(){return this._showTerrain},set:function(e){this._showTerrain&&!1===e?(this._viewer.terrainProvider=this._defaultTerrain,this._showTerrain=!1):this._showTerrain||!0!==e?this._showTerrain&&!0===e&&(this._viewer.terrainProvider=this._terrain,this._showTerrain=!0):(this._viewer.terrainProvider=this._terrain,this._showTerrain=!0),this._terrainOption.show=e,this._event.raiseEvent("StatusChanged",{status:e}),this._viewer.scene.requestRender()}},{key:"terrain",get:function(){return this._terrain}},{key:"terrainOptions",get:function(){return this._terrainOption}}]),e}();t.FdTerrain=a},function(e,t,r){r(101)("observable")},function(e,t,r){r(101)("asyncIterator")},function(e,t,r){var n=r(77),i=r(83),o=r(61),a=r(120),s=r(47),c=r(174),u=Object.getOwnPropertyDescriptor;t.f=r(29)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(61),i=r(157).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(n(e))}},function(e,t,r){var n=r(81),i=r(103),o=r(77);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,r){"use strict";var n=r(16),i=r(47),o=r(29),a=r(17),s=r(170),c=r(106).KEY,u=r(64),l=r(111),h=r(70),d=r(80),p=r(13),f=r(102),v=r(101),_=r(248),y=r(163),m=r(40),g=r(30),F=r(61),w=r(120),C=r(83),b=r(115),P=r(247),M=r(246),x=r(31),S=r(81),T=M.f,E=x.f,D=P.f,A=n.Symbol,O=n.JSON,k=O&&O.stringify,L=p("_hidden"),I=p("toPrimitive"),R={}.propertyIsEnumerable,N=l("symbol-registry"),B=l("symbols"),G=l("op-symbols"),j=Object.prototype,H="function"==typeof A,V=n.QObject,X=!V||!V.prototype||!V.prototype.findChild,Y=o&&u(function(){return 7!=b(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=T(j,t);n&&delete j[t],E(e,t,r),n&&e!==j&&E(j,t,n)}:E,z=function(e){var t=B[e]=b(A.prototype);return t._k=e,t},Z=H&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},U=function(e,t,r){return e===j&&U(G,t,r),m(e),t=w(t,!0),m(r),i(B,t)?(r.enumerable?(i(e,L)&&e[L][t]&&(e[L][t]=!1),r=b(r,{enumerable:C(0,!1)})):(i(e,L)||E(e,L,C(1,{})),e[L][t]=!0),Y(e,t,r)):E(e,t,r)},W=function(e,t){m(e);for(var r,n=_(t=F(t)),i=0,o=n.length;o>i;)U(e,r=n[i++],t[r]);return e},q=function(e){var t=R.call(this,e=w(e,!0));return!(this===j&&i(B,e)&&!i(G,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,L)&&this[L][e])||t)},Q=function(e,t){if(e=F(e),t=w(t,!0),e!==j||!i(B,t)||i(G,t)){var r=T(e,t);return!r||!i(B,t)||i(e,L)&&e[L][t]||(r.enumerable=!0),r}},K=function(e){for(var t,r=D(F(e)),n=[],o=0;r.length>o;)i(B,t=r[o++])||t==L||t==c||n.push(t);return n},J=function(e){for(var t,r=e===j,n=D(r?G:F(e)),o=[],a=0;n.length>a;)!i(B,t=n[a++])||r&&!i(j,t)||o.push(B[t]);return o};H||(s((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===j&&t.call(G,r),i(this,L)&&i(this[L],e)&&(this[L][e]=!1),Y(this,e,C(1,r))};return o&&X&&Y(j,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",function(){return this._k}),M.f=Q,x.f=U,r(157).f=P.f=K,r(77).f=q,r(103).f=J,o&&!r(82)&&s(j,"propertyIsEnumerable",q,!0),f.f=function(e){return z(p(e))}),a(a.G+a.W+a.F*!H,{Symbol:A});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;$.length>ee;)p($[ee++]);for(var te=S(p.store),re=0;te.length>re;)v(te[re++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return i(N,e+="")?N[e]:N[e]=A(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in N)if(N[t]===e)return t},useSetter:function(){X=!0},useSimple:function(){X=!1}}),a(a.S+a.F*!H,"Object",{create:function(e,t){return void 0===t?b(e):W(b(e),t)},defineProperty:U,defineProperties:W,getOwnPropertyDescriptor:Q,getOwnPropertyNames:K,getOwnPropertySymbols:J}),O&&a(a.S+a.F*(!H||u(function(){var e=A();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(g(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Z(t))return t}),n[1]=t,k.apply(O,n)}}),A.prototype[I]||r(44)(A.prototype,I,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},function(e,t,r){r(249),r(78),r(245),r(244),e.exports=r(14).Symbol},function(e,t,r){e.exports={default:r(250),__esModule:!0}},function(e,t,r){r(60),r(63),e.exports=r(102).f("iterator")},function(e,t,r){e.exports={default:r(252),__esModule:!0}},function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(253)),i=a(r(251)),o="function"==typeof i.default&&"symbol"==typeof n.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===o(n.default)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":o(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdImageryLayersManager=void 0;var n=a(r(254)),i=a(r(1)),o=a(r(6));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,i.default)(this,e),this._imageryLayersOpts=[],this._viewer=t,this._imageryLayers=t.imageryLayers,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._imageryLayers.layerAdded.addEventListener(e.prototype._rawEventCallback,this),this._imageryLayers.layerMoved.addEventListener(e.prototype._rawEventCallback,this),this._imageryLayers.layerRemoved.addEventListener(e.prototype._rawEventCallback,this),this._imageryLayers.layerShownOrHidden.addEventListener(e.prototype._rawEventCallback,this)}return(0,o.default)(e,[{key:"_rawEventCallback",value:function(){this._event.raiseEvent("Changed")}},{key:"addDefaultImageryLayer",value:function(){var e=this._imageryLayers.length;this.add({name:"谷歌影像",type:"UrlTemplate",iconUrl:"../../Freedo/Freedo/Widgets/Images/ImageryProviders/blackMarble.png",layerOption:{show:!0,alpha:1},providerOptions:{url:"//mt0.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&y={y}&z={z}",maximumLevel:20,tilingScheme:"WebMercator"}},e)}},{key:"getLayerProperty",value:function(e,t){var r=this._imageryLayersOpts[e];if(void 0===r)throw new Error("FdImageryLayersManager.getLayerProperty: cannot get property!");if(r.layerOption&&void 0!==r.layerOption[t])return r.layerOption[t];var i=this._imageryLayers.get(e);if((0,n.default)("undefined"!==i[t]))return i[t];throw new Error("FdImageryLayersManager.getLayerProperty: cannot get property!")}},{key:"setLayerProperty",value:function(e,t,r){var i=this._imageryLayersOpts[e];if(void 0===i)throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!");var o=this.getLayerProperty(e,t);if(!_.isEqual(o,r)){var a=this._imageryLayers.get(e);if(!(0,n.default)("undefined"!==a[t]))throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!");a[t]=r,void 0===i.layerOption&&(i.layerOption={}),i.layerOption[t]=r,this._event.raiseEvent("Changed"),this._viewer.scene.requestRender()}}},{key:"add",value:function(e,t){0===this._imageryLayersOpts.length&&(this._imageryLayers.removeAll(),t=0),void 0===t?(t=this._imageryLayersOpts.length,this._imageryLayersOpts.push(e)):this._imageryLayersOpts.splice(t,0,e);var r,i=Freedo.clone(e.providerOptions,!0);switch(e.type){case"BingMaps":"AERIAL"===i.mapStyle?i.mapStyle=Freedo.BingMapsStyle.AERIAL:"AERIAL_WITH_LABELS"===i.mapStyle?i.mapStyle=Freedo.BingMapsStyle.AERIAL_WITH_LABELS:"ROAD"===i.mapStyle&&(i.mapStyle=Freedo.BingMapsStyle.ROAD),r=new Freedo.BingMapsImageryProvider(i);break;case"Mapbox":r=new Freedo.MapboxImageryProvider(i);break;case"ESRI":r=new Freedo.ArcGisMapServerImageryProvider(i);break;case"OpenStreetMap":r=Freedo.createOpenStreetMapImageryProvider(i);break;case"WMTS":if("Geographic"===i.tilingScheme&&(i.tilingScheme=new Freedo.GeographicTilingScheme),i.tileDiscardPolicy){var o=i.tileDiscardPolicy;if(o.pixelsToCheck){for(var a=i.tileDiscardPolicy.pixelsToCheck,s=[],c=0;c<a.length;++c)s.push(new Freedo.Cartesian2(a[c][0],a[c][1]));o.pixelsToCheck=s}i.tileDiscardPolicy=new Freedo.DiscardMissingTileImagePolicy(o)}r=new Freedo.WebMapTileServiceImageryProvider(i);break;case"TileMapService":"WebMercator"===i.tilingScheme?i.tilingScheme=new Freedo.WebMercatorTilingScheme:"Geographic"===i.tilingScheme&&(i.tilingScheme=new Freedo.GeographicTilingScheme),r=Freedo.createTileMapServiceImageryProvider(i);break;case"UrlTemplate":"WebMercator"===i.tilingScheme?i.tilingScheme=new Freedo.WebMercatorTilingScheme:"Geographic"===i.tilingScheme&&(i.tilingScheme=new Freedo.GeographicTilingScheme),r=new Freedo.UrlTemplateImageryProvider(i)}this._imageryLayers.addImageryProvider(r,t);var u=this._imageryLayers.get(t);for(var l in e.layerOption){if(this.setLayerProperty(t,l,e.layerOption[l]),!(0,n.default)("undefined"!==u[l]))throw new Error("FdImageryLayersManager.setLayerProperty: cannot get property!");u[l]=e.layerOption[l]}}},{key:"raise",value:function(e){if(e>=0&&e<this.length-1){var t=this._imageryLayersOpts[e];this._imageryLayersOpts[e]=this._imageryLayersOpts[e+1],this._imageryLayersOpts[e+1]=t;var r=this._imageryLayers.get(e);this._imageryLayers.raise(r),this._viewer.scene.requestRender()}}},{key:"lower",value:function(e){if(e>0&&e<this.length){var t=this._imageryLayersOpts[e];this._imageryLayersOpts[e]=this._imageryLayersOpts[e-1],this._imageryLayersOpts[e-1]=t;var r=this._imageryLayers.get(e);this._imageryLayers.lower(r),this._viewer.scene.requestRender()}}},{key:"remove",value:function(e){if(e>=0&&e<this.length){this._imageryLayersOpts.splice(e,1);var t=this._imageryLayers.get(e);this._imageryLayers.remove(t)}}},{key:"removeAll",value:function(){this._imageryLayersOpts.splice(0,this.length),this._imageryLayers.removeAll()}},{key:"getAllLayers",value:function(){return Freedo.clone(this._imageryLayersOpts,!0)}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this.removeAll()}},{key:"dispose",value:function(){this.reset(),this._eventHelper.removeAll()}},{key:"imageryLayersOptions",get:function(){return this._imageryLayersOpts}},{key:"length",get:function(){return this._imageryLayersOpts.length}}]),e}();t.FdImageryLayersManager=s},function(e,t,r){"use strict";var n=r(81),i=r(103),o=r(77),a=r(109),s=r(118),c=Object.assign;e.exports=!c||r(64)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=a(e),c=arguments.length,u=1,l=i.f,h=o.f;c>u;)for(var d,p=s(arguments[u++]),f=l?n(p).concat(l(p)):n(p),v=f.length,_=0;v>_;)h.call(p,d=f[_++])&&(r[d]=p[d]);return r}:c},function(e,t,r){var n=r(17);n(n.S+n.F,"Object",{assign:r(256)})},function(e,t,r){r(257),e.exports=r(14).Object.assign},function(e,t,r){e.exports={default:r(258),__esModule:!0}},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(173),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(e,t,r){return t in e?(0,o.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdLabelsManager=void 0;var n=c(r(260)),i=c(r(259)),o=c(r(1)),a=c(r(6)),s=r(124);function c(e){return e&&e.__esModule?e:{default:e}}var u=r(123),l=(0,s.getFreedoXPath)()+"Assets/Textures/pin/pin.png",h=function(){function e(t,r){(0,o.default)(this,e),this._viewer=t,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper;var n=t.scene.primitives.add(new Freedo.PrimitiveCollection),i=n.add(new Freedo.BillboardCollection),a=n.add(new Freedo.PointPrimitiveCollection),s=n.add(new Freedo.LabelCollection);this._collection=n,this._billboards=i,this._points=a,this._texts=s,this._setData(r)}return(0,a.default)(e,[{key:"addLabel",value:function(e){var t=e.image,r=void 0===t?"":t,n=e.position,i=e.text,o=void 0===i?"":i,a=e.show,s=void 0===a||a;return this.data.collection.push({image:r,position:n,text:o,show:s}),this.data.collection.length-1}},{key:"removeLabel",value:function(e){this.data.collection.splice(e,1)}},{key:"setLabel",value:function(e,t){(0,i.default)(this.data.collection[e],t)}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"dispose",value:function(){this._viewer.scene.primitives.remove(this._collection),this._collection=void 0,this._billboards=void 0,this._points=void 0,this._texts=void 0,this._data=void 0,this._mobxSpy(),this._mobxSpy=void 0,this._event.raiseEvent("Changed"),this._eventHelper.removeAll(),this._eventHelper=void 0,this._event=void 0,this._viewer.scene.requestRender()}},{key:"_setData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0===t.show&&(t.show=!0),void 0===t.collection&&(t.collection=[]),t.collection.forEach(function(e){void 0===e.show&&(e.show=!0)});var r=u.observable(t);r.collection.forEach(function(t){t.label=e._addLabel(t)}),this._data=r,this._collection.show=t.show;var i=this;this._mobxSpy=u.spy(function(e){if("splice"===e.type&&e.object===i._data.collection&&(e.addedCount>0&&e.added.forEach(function(e){e.label=i._addLabel(e),setTimeout(function(){i._event.raiseEvent("Changed")},0)}),e.removedCount>0&&e.removed.forEach(function(e){var t=e.label;i._removeLabel(t),setTimeout(function(){i._event.raiseEvent("Changed")},0)})),"update"===e.type)if(e.object===i._data)"show"===e.key?(i._collection.show=e.newValue,i._viewer.scene.requestRender(),i._event.raiseEvent("Changed")):"collection"===e.key&&(i._data.collection.forEach(function(e){i._removeLabel(e.label)}),e.newValue.forEach(function(e){i._addLabel(e)}),setTimeout(function(){i._event.raiseEvent("Changed")},0));else if(void 0!==e.object.label&&i._containsLabel(e.object.label)){var t=e.object.label;i._setLabel(t,(0,n.default)({},e.key,e.newValue)),setTimeout(function(){i._event.raiseEvent("Changed")},0)}})}},{key:"_addLabel",value:function(e){var t=e.position,r=e.text,n=void 0===r?"":r,i=e.image,o=void 0===i?"":i,a=e.show,s=void 0===a||a,c=Freedo.Cartesian3.fromDegrees(t[0],t[1],t[2]);void 0!==o&&""!==o||(o=l);var u=this._billboards.add({position:c,image:o,show:s,pixelOffset:new Freedo.Cartesian2(0,-1),horizontalOrigin:Freedo.HorizontalOrigin.CENTER,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,width:32,height:32,id:void 0,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,2e7),disableDepthTestDistance:Number.POSITIVE_INFINITY}),h=this._points.add({show:!1,position:c,pixelSize:3,color:Freedo.Color.YELLOW,outlineColor:Freedo.Color.BLACK,outlineWidth:1,id:void 0,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,2e7),disableDepthTestDistance:Number.POSITIVE_INFINITY}),d=this._texts.add({show:s,position:c,text:n,font:"16px sans-serif",fillColor:Freedo.Color.WHITE,outlineColor:Freedo.Color.BLACK,outlineWidth:1,showBackground:!1,style:Freedo.LabelStyle.FILL_AND_OUTLINE,pixelOffset:new Freedo.Cartesian2(18,-16),horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.CENTER,id:void 0,distanceDisplayCondition:new Freedo.DistanceDisplayCondition(0,2e7),disableDepthTestDistance:Number.POSITIVE_INFINITY});return this._viewer.scene.requestRender(),{text:d,point:h,billboard:u}}},{key:"_setLabel",value:function(e,t){var r=t.position,n=t.text,i=t.image,o=t.show;if(void 0!==r){var a=Freedo.Cartesian3.fromDegrees(r[0],r[1],r[2]);e.billboard.position=a,e.point.position=a,e.text.position=a}void 0!==o&&(e.billboard.show=o,e.text.show=o),void 0!==n&&(e.text.text=n),void 0!==i&&i&&(e.billboard.image=i),this._viewer.scene.requestRender()}},{key:"_removeLabel",value:function(e){this._points.remove(e.point),this._texts.remove(e.text),this._billboards.remove(e.billboard),this._viewer.scene.requestRender()}},{key:"_containsLabel",value:function(e){return this._points.contains(e.point)}},{key:"data",set:function(e){throw new Error("FdLabelsManager不支持直接赋值！")},get:function(){return this._data}}]),e}();t.FdLabelsManager=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTools=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(261),s=r(255),c=r(243),u=r(242),l=r(84),h=r(158),d=r(159),p=r(240),f=r(239),v=r(238);var _=function e(){throw(0,o.default)(this,e),new Error("FdTools should not be instatiated!")};_.FdLabelsManager=a.FdLabelsManager,_.FdImageryLayersManager=s.FdImageryLayersManager,_.FdTerrain=c.FdTerrain,_.FdViewPointsManager=u.FdViewPointsManager,_.FdKeyboard=l.FdKeyboard,_.FdEraseGroundManager=h.FdEraseGroundManager,_.FdGeologySimulationManager=d.FdGeologySimulationManager,_.FdPMTSManager=p.FdPMTSManager,_.FdViewSwitcher=f.FdViewSwitcher,_.FdModel=v.FdModel,t.FdTools=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdDrawPolyline=void 0;var n=s(r(1)),i=s(r(6)),o=r(72),a=(r(11),r(25));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._polylines=[],this._data=[],this._lsner=void 0,this._ple=new a.FdPolylineEditor(t),this._ple.setAutoLoop(!1),this._ple.setAutoDelLines(!0),this._handler=void 0,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._smoothRate=0,this._currentIndex=0}return(0,i.default)(e,[{key:"polylinesOptions",get:function(){return this._data},set:function(e){if(Freedo.defined(e))for(var t in this.clearPolylines(),e)this.addPolyline(e[t].pts);else console.error("polyline数据错误")}}]),e}();c.prototype.start=function(){this._ple.run(),this.addLsnr(),this._event.raiseEvent("Start",{})},c.prototype.addLsnr=function(){this._lsner&&(this._lsner(),this._lsner=void 0);var e=this;this._lsner=this._ple.on(function(t,r){"PLAdd"==t&&e.onPLAdd(r),"EditEnd"==t&&(e.polylinesOptions[e._currentIndex].pts=Freedo.clone(r.pts),e.reDraw())})},c.prototype.onPLAdd=function(e){this.addPolyline(e.polyline.pts)},c.prototype.calcCP=function(e,t,r){var n,i,o;n=e.position,i=t.position,o=r.position;var a=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3),s=FreeDo.Cartesian3.subtract(o,i,new FreeDo.Cartesian3),c=FreeDo.Cartesian3.cross(a,s,new FreeDo.Cartesian3),u=FreeDo.Cartesian3.normalize(a,new FreeDo.Cartesian3),l=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3),h=FreeDo.Cartesian3.add(u,l,new FreeDo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),p=Freedo.Quaternion.fromAxisAngle(c,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),f=Freedo.Matrix3.fromQuaternion(d,new Freedo.Matrix3),v=Freedo.Matrix3.fromQuaternion(p,new Freedo.Matrix3),_=Freedo.Matrix3.multiplyByVector(f,h,new Freedo.Cartesian3),y=Freedo.Matrix3.multiplyByVector(v,h,new Freedo.Cartesian3),m=FreeDo.Cartesian3.normalize(_,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3),F=FreeDo.Cartesian3.distance(n,i),w=FreeDo.Cartesian3.distance(o,i),C=1;C=F<w?F/4:w/4,m=FreeDo.Cartesian3.multiplyByScalar(m,C,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.add(i,m,new FreeDo.Cartesian3),P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);return FreeDo.Cartesian3.distance(n,b)<FreeDo.Cartesian3.distance(n,P)?[b,P]:[P,b]},c.prototype.smoothPolyline=function(e){var t=[];if(e.length<3)for(var r=0;r<e.length;r++)t.push(e[r].position);else for(r=0;r<=e.length-2;r++){var n={},i={},a={},s={};0==r?(n=e[0],i.position=this.calcCP(e[0],e[1],e[2])[0],a=e[0],s=e[1]):r==e.length-2?(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i=e[r+1],a=e[r],s=e[r+1]):(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i.position=this.calcCP(e[r],e[r+1],e[r+2])[0],a=e[r],s=e[r+1]);var c=new o.FdBezierCurveAlgorithm(a,s,n,i).getVertexForCurve(this._smoothRate);t=t.concat(c)}var u=[];for(r=0;r<t.length;r++){var l;if(l=t[r],u.length>0)FreeDo.Cartesian3.distance(u[u.length-1],l)>1e-4&&u.push(l);else u.push(l)}return u},c.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})},c.prototype.addPolyline=function(e){var t={};t.pts=e;var r,n=[];for(var i in e){var o={position:e[i]};n.push(o)}0==this._smoothRate?t.smoothPts=e:t.smoothPts=this.smoothPolyline(n),r=this._viewer.scene.primitives.add(this.createLinePrimitive(t.smoothPts)),t.polyline=r,this._polylines.push(t),this._data.push({pts:e}),this._event.raiseEvent("PolylineAdd",e),this._event.raiseEvent("DataChanged",{pts:e}),this._viewer.scene.requestRender()},c.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:5,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",width:5,uniforms:{color:new Freedo.Color(1,1,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",width:5,uniforms:{color:new Freedo.Color(1,1,0,1)}}})})})},c.prototype.cancel=function(){this._ple.cancel(),this._event.raiseEvent("Cancel",{})},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.setSmoothRate=function(e){this._smoothRate=e,this.reDraw()},c.prototype.clearPolylines=function(e){for(var t in this._polylines)this._viewer.scene.primitives.remove(this._polylines[t].polyline);this._polylines=[],this._viewer.scene.requestRender()},c.prototype.getData=function(){return Freedo.clone(this._data,!0)},c.prototype.startEdit=function(e){this.addLsnr(),this._currentIndex=e,this._ple.startEdit(this.polylinesOptions[e].pts)},c.prototype.editPre=function(){this._ple.editPre()},c.prototype.editNext=function(){this._ple.editNext()},c.prototype.endEdit=function(){this._ple.endEdit()},c.prototype.removeAll=function(){this.clearPolylines(),this._data=[]},c.prototype.reDraw=function(e){this.clearPolylines();var t=Freedo.clone(this._data,!0);for(var r in this._data=[],t)this.addPolyline(t[r].pts)},c.prototype.setHeightOffset=function(e){this._ple.setHeightOffset(e)},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this.clearPolylines(),this._data=[]},c.prototype.dispose=function(){},t.FdDrawPolyline=c},function(e,t,r){var n=r(79),i=r(13)("iterator"),o=r(62);e.exports=r(14).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||o.hasOwnProperty(n(t))}},function(e,t,r){r(63),r(60),e.exports=r(264)},function(e,t,r){e.exports={default:r(265),__esModule:!0}},function(e,t,r){"use strict";t.__esModule=!0;var n=o(r(266)),i=o(r(119));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,n.default)(Object(e)))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var s,c=(0,i.default)(e);!(n=(s=c.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPickPMComponent=void 0;var n=s(r(119)),i=s(r(267)),o=s(r(104)),a=s(r(1));r(11);function s(e){return e&&e.__esModule?e:{default:e}}var c=function e(t,r,n){(0,a.default)(this,e),this._viewer=t,this._bInSurvey=!1,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._currentTileSet=void 0,this._baseColor=[255,255,255,1],this._highlightColor=[255,0,0,1];this.updatePModelStyleThrottle=_.throttle(this.updatePModelStyle,100),this._mode="HIGH_LIGHT",this._clickMode=Freedo.ScreenSpaceEventType.LEFT_CLICK,this._pModelSetMap=new o.default,this._pModelInfos=r,this._token=n};c.prototype.setPModelSets=function(e){this._aPModelSet=e},c.prototype.setMode=function(e){this._mode=e},c.prototype.setClickMode=function(e){this._clickMode=e},c.prototype.start=function(){this.cancel(),this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.handleLeftClick.bind(this),this._clickMode),this._bInSurvey=!0},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.updatePModelStyle=function(){var e=[],t=[],r=!0,o=!1,a=void 0;try{for(var s,c=(0,n.default)(this._pModelSetMap);!(r=(s=c.next()).done);r=!0){var u=s.value,l=(0,i.default)(u,2),h=l[0],d=l[1];e.splice(0,e.length),t.splice(0,t.length);var p=d;if(void 0!==p){for(var f in p){var v=p[f];if(void 0!==v.color){var _=v.color,y="rgba("+_[0]+","+_[1]+","+_[2]+","+_[3]+")";e.push(["${component} ~== '"+f+"'",y])}void 0!==v.show&&(v.show||t.push(["${component} ~== '"+f+"'","false"]))}var m=this._baseColor,g="rgba("+m[0]+","+m[1]+","+m[2]+","+m[3]+")";e.push(["true",g]),t.push(["true","true"]),h.style=new Freedo.FreedoPModelStyle({color:{conditions:e},show:{conditions:t}})}}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}this._viewer.scene.requestRender()},c.prototype.findPModel=function(e){var t=e._content._tileset;for(var r in this._aPModelSet)if(this._aPModelSet[r]===t)return r},c.prototype.pickComponent=function(e,t,r){var n=this._viewer.scene.pick(e);if(Freedo.defined(n)&&Freedo.defined(n.tileset)){this._pModelSetMap.has(n.tileset)||this._pModelSetMap.set(n.tileset,{});n.getPropertyNames();console.log(n.content.tile.computedTransform),console.log(n.content.tile.boundingSphere.center);var i=n.getProperty("component");if(Freedo.defined(i)){var o=void 0;return r&&(o=n.getAncestors("component")),t(i,n.tileset,o),void this._event.raiseEvent("DataChanged",{tilesetUrl:n.tileset.basePath,tileset:n.tileset,componentid:i})}}t(void 0,void 0)},c.prototype.getData=function(){var e=[],t=!0,r=!1,o=void 0;try{for(var a,s=(0,n.default)(this._pModelSetMap);!(t=(a=s.next()).done);t=!0){var c=a.value,u=(0,i.default)(c,2),l=u[0],h=u[1];for(var d in h)e.push({tileset:l,tilesetURL:l.basePath,componentid:d})}}catch(e){r=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw o}}return e},c.prototype.unhighlightAllComponents=function(){var e=!0,t=!1,r=void 0;try{for(var o,a=(0,n.default)(this._pModelSetMap);!(e=(o=a.next()).done);e=!0){var s=o.value,c=(0,i.default)(s,2),u=(c[0],c[1]);for(var l in u)delete u[l].color}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}this.updatePModelStyleThrottle()},c.prototype.showAllComponents=function(e){var t=!0,r=!1,o=void 0;try{for(var a,s=(0,n.default)(this._pModelSetMap);!(t=(a=s.next()).done);t=!0){var c=a.value,u=(0,i.default)(c,2),l=(u[0],u[1]);for(var h in l)delete l[h].show}}catch(e){r=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw o}}this.updatePModelStyleThrottle()},c.prototype.handleLeftClick=function(e){if(0!=this._bInSurvey){var t=this;this.pickComponent(e.position,function(e,r){if("HIGH_LIGHT"==t._mode)if(Freedo.defined(e)){var n=t._highlightColor[0],i=t._highlightColor[1],o=t._highlightColor[2],a=t._highlightColor[3];t.highlightComponent(e,r,n,i,o,a)}else t.unhighlightAllComponents();if("SHOW_HIDE"==t._mode)if(Freedo.defined(e)){n=255*Math.random(),i=255*Math.random(),o=255*Math.random(),a=.5*Math.random()+.5;t.showComponent(e,r,!1)}else t.showAllComponents();if("HALF_ALPHA"==t._mode)if(Freedo.defined(e)){n=255*Math.random(),i=255*Math.random(),o=255*Math.random(),a=.5*Math.random()+.5;t.highlightComponent(e,r,255,255,0,.1)}else t.unhighlightAllComponents()},!1)}},c.prototype.highlightComponent=function(e,t,r,n,i,o){if(Freedo.defined(e)){void 0===this._pModelSetMap.get(t)&&this._pModelSetMap.set(t,{});var a=this._pModelSetMap.get(t);return void 0===a[e]&&(a[e]={}),a[e].color=[r,n,i,o],this.updatePModelStyleThrottle(),!0}return!1},c.prototype.setHighlightColor=function(e,t,r,n){this._highlightColor=[e,t,r,n]},c.prototype.showComponent=function(e,t,r){if(Freedo.defined(e)){void 0===this._pModelSetMap.get(t)&&this._pModelSetMap.set(t,{});var n=this._pModelSetMap.get(t);void 0===n[e]&&(n[e]={}),n[e].show=r}this.updatePModelStyleThrottle()},c.prototype.getUidBoundingSphere=function(e,t,r){var n=this._pModelInfos.find(function(t){return t.pModel===e});Freedo.FdServer.FdPMTSParser.getUidBoundingSphere(n.layer,n.matrixSet,n.matrix,t,token,void 0,function(e,t){void 0===t?r(e):console.log("getUidBoundingSphere got error!")})},c.prototype.cancel=function(){this.reset()},c.prototype.reset=function(){this._bInSurvey=!1,this._hanlder=this._hanlder&&this._hanlder.destroy(),this.unhighlightAllComponents(),this.showAllComponents()},t.FdPickPMComponent=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdEraseGroundHandler=void 0;var n=a(r(1)),i=a(r(6)),o=r(25);r(158);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,r){(0,n.default)(this,e),this._viewer=t,this._lsner=void 0,Freedo.defined(r)||(r=new FdTools.FdEraseGroundManager(t)),this._eraseGroundManager=r,this._ple=new o.FdPolylineEditor(t),this._ple.setAutoDelLines(!0),this._data=[],this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper;var i=this;this._eraseGroundManager.on(function(e,t){"dataAdded"===e&&(i._data.push(t),i._event.raiseEvent("dataChanged",t))})}return(0,i.default)(e,[{key:"getData",value:function(){return this._data}},{key:"start",value:function(e){e=Freedo.defaultValue(e,[0,0,0,1]),this._ple.run(),this._lsner&&(this._lsner(),this._lsner=void 0);var t=this;this._lsner=this._ple.on(function(r,n){"PLAdd"===r&&t.onPLAdd(n,e)}),this._event.raiseEvent("start",{})}},{key:"onPLAdd",value:function(e,t){e.polyline&&(2!==e.polyline.pts.length?this._eraseGroundManager.eraseGroudByPointsArray(e.polyline.pts,t):this._ple.delResult())}},{key:"cancel",value:function(){this._ple.cancel(),this._event.raiseEvent("cancel",{})}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"reset",value:function(){this._lsner&&this._lsner(),this._lsner=void 0,this._data=[],this._ple.cancel(),this._event.raiseEvent("Dispose",{})}},{key:"dispose",value:function(){this.reset(),this._eventHelper.removeAll()}},{key:"eraseGoundManager",get:function(){return this._eraseGroundManager}}]),e}();t.FdEraseGroundHandler=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSimulateDrill=t.getOffsetPoint=t.interpolate=void 0;var n,i=r(104),o=(n=i)&&n.__esModule?n:{default:n};var a=new Freedo.Cartesian3;new Freedo.Cartesian3;function s(e,t){Freedo.defined(t)||(t=[]);for(var r=0;r<e.length;r++)t.push({name:e[r].name,depth:e[r].depth,thickness:e[r].thickness});return t}t.interpolate=function(e,t,r){var n=[],i=Freedo.Cartesian3.fromRadians(e.longitude,e.latitude,e.height),o=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,t.height),s=Freedo.Cartesian3.distance(i,o);if(s>r)for(var c=s/r,u=0;u<c-1;++u){Freedo.Cartesian3.lerp(i,o,(u+1)/c,a);var l=Freedo.Cartographic.fromCartesian(a);n.push(l)}return n},t.getOffsetPoint=function(e,t,r){var n=new Freedo.Cartesian3;return Freedo.Cartesian3.multiplyByScalar(t,r,n),Freedo.Cartesian3.add(e,n,n),n},t.getSimulateDrill=function(e,t,r){for(var n=[],i=Freedo.Cartesian3.fromRadians(t.longitude,t.latitude,0),a=0,c=0;c<e._drillDataArray.length;c++){var u=e._drillDataArray[c];(p=Freedo.Cartesian3.distance(u.cartesianOnZeroHeight,i))<=r&&(n.push({name:u.name,waterDepth:u.waterDepth,layers:s(u.layers),weight:1/p,pos:u.pos}),a+=1/p)}var l=n.length;if(l<1){var h=Number.MAX_VALUE,d=-1;for(c=0;c<e._drillDataArray.length;c++){var p;(p=Freedo.Cartesian3.distance(e._drillDataArray[c].cartesianOnZeroHeight,i))<=h&&(d=c)}return{waterDepth:e._drillDataArray[d].waterDepth,drillsInfo:[{drillName:e._drillDataArray[d].name,drillPos:e._drillDataArray[d].pos,layers:e._drillDataArray[d].layers}],layers:s(e._drillDataArray[d].layers)}}var f=0,v=[];for(c=0;c<l;c++)n[c].weight/=a,f+=n[c].waterDepth*n[c].weight,v.push({drillName:n[c].name,drillPos:n[c].pos,layers:Freedo.clone(n[c].layers)});for(var _=[];;){var y=!1;for(c=0;c<l;c++)if(n[c].layers.length>0){y=!0;break}if(!y)break;var m=new o.default;for(c=0;c<l;c++)if(n[c].layers.length>0){var g=n[c].layers[0].name;m.has(g)?m.set(g,{weight:m.get(g).weight+n[c].weight,thickness:m.get(g).thickness+n[c].layers[0].thickness*n[c].weight}):m.set(g,{weight:n[c].weight,thickness:n[c].layers[0].thickness*n[c].weight})}var F,w=0,C=0;for(m.forEach(function(e,t){w<e.weight&&(w=e.weight,F=t,C=e.thickness)}),c=0;c<l;c++)n[c].layers.length>0&&n[c].layers[0].name===F&&n[c].layers.shift();_.push({name:F,thickness:C,depth:C+(_.length>0?_[_.length-1].depth:0)})}return{waterDepth:f,drillsInfo:v,pos:t,layers:_}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerData=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};t.LayerData=function e(t){(0,o.default)(this,e),this.name=t.name,this.depth=parseFloat(t.depth)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrillData=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(271);t.DrillData=function e(t){(0,o.default)(this,e),this.name=t.name,this.waterDepth=parseFloat(t.water_depth);var r=t.pos.split(",");this.cartographic=Freedo.Cartographic.fromDegrees(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2])),this.cartesian=Freedo.Cartesian3.fromRadians(this.cartographic.longitude,this.cartographic.latitude,this.cartographic.height),this.cartesianOnZeroHeight=Freedo.Cartesian3.fromRadians(this.cartographic.longitude,this.cartographic.latitude,0),this.pos=t.pos,this.layers=[];for(var n=t.layer.length-1;n>=0;n--)this.layers.push(new a.LayerData(t.layer[n]));this.layers.sort(function(e,t){return e.depth-t.depth});for(n=0;n<this.layers.length;n++)this.layers[n].thickness=n>0?this.layers[n].depth-this.layers[n-1].depth:this.layers[n].depth}},function(e,t,r){r(160)("Map")},function(e,t,r){r(161)("Map")},function(e,t,r){var n=r(17);n(n.P+n.R,"Map",{toJSON:r(162)("Map")})},function(e,t,r){"use strict";var n=r(166),i=r(105);e.exports=r(164)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(i(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,r){r(78),r(60),r(63),r(276),r(275),r(274),r(273),e.exports=r(14).Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdGeologySimulationHandler=void 0;var n=a(r(1)),i=a(r(6)),o=r(25);r(159);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,r,i){if((0,n.default)(this,e),!Freedo.defined(r))throw new Freedo.DeveloperError("geologySimulationManager Is Required!");this._viewer=t,this._scene=this._viewer.scene,this._ple=new o.FdPolylineEditor(t),this._ple.setAutoDelLines(!0),this._geologySimulationManager="string"==typeof r?new FdTools.FdGeologySimulationManager(t.scene,JSON.parse(r),i):r,this._data=[],this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper;var a=this;this._geologySimulationManager.on(function(e,t){"dataAdded"===e&&(a._data.push(t),a._event.raiseEvent("dataChanged",t))})}return(0,i.default)(e,[{key:"getData",value:function(){return this._data}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"start",value:function(){this._ple.run(),this._lsner&&(this._lsner(),this._lsner=void 0);var e=this;this._lsner=this._ple.on(function(t,r){"PLAdd"===t&&e.onPLAdd(r)}),this._event.raiseEvent("start",{})}},{key:"cancel",value:function(){this._ple.cancel(),this._event.raiseEvent("cancel",{})}},{key:"onPLAdd",value:function(e){if(e.polyline)if(2!==e.polyline.pts.length){for(var t=e.polyline.pts,r=[],n=0;n<t.length;n++)r.push(Freedo.Cartographic.fromCartesian(t[n]));this._geologySimulationManager.addGeologySimulation(r,1,5,5,void 0,!0)}else this._ple.delResult()}},{key:"reset",value:function(){this._lsner&&this._lsner(),this._lsner=void 0,this._data=[],this._ple.cancel()}},{key:"dispose",value:function(){this.reset(),this._event.raiseEvent("dispose",{}),this._eventHelper.removeAll()}},{key:"geologySimulationManager",get:function(){return this._geologySimulationManager}}]),e}();t.FdGeologySimulationHandler=s},function(e,t,r){r(160)("Set")},function(e,t,r){r(161)("Set")},function(e,t,r){var n=r(69);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t,r){var n=r(17);n(n.P+n.R,"Set",{toJSON:r(162)("Set")})},function(e,t,r){var n=r(30),i=r(163),o=r(13)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){var n=r(283);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(48),i=r(118),o=r(109),a=r(114),s=r(284);e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,h=6==e,d=5==e||h,p=t||s;return function(t,s,f){for(var v,_,y=o(t),m=i(y),g=n(s,f,3),F=a(m.length),w=0,C=r?p(t,F):c?p(t,0):void 0;F>w;w++)if((d||w in m)&&(_=g(v=m[w],w,y),e))if(r)C[w]=_;else if(_)switch(e){case 3:return!0;case 5:return v;case 6:return w;case 2:C.push(v)}else if(l)return!1;return h?-1:u||l?l:C}}},function(e,t,r){var n=r(62),i=r(13)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(40);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){"use strict";var n=r(166),i=r(105);e.exports=r(164)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){r(78),r(60),r(63),r(288),r(282),r(280),r(279),e.exports=r(14).Set},function(e,t,r){e.exports={default:r(289),__esModule:!0}},function(e,t,r){var n=r(40),i=r(167);e.exports=r(14).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},function(e,t,r){var n=r(113),i=r(117);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),c=n(r),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t,r){var n=r(47),i=r(109),o=r(112)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(113),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t,r){var n=r(61),i=r(114),o=r(294);e.exports=function(e){return function(t,r,a){var s,c=n(t),u=i(c.length),l=o(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(31),i=r(40),o=r(81);e.exports=r(29)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,c=0;s>c;)n.f(e,r=a[c++],t[r]);return e}},function(e,t,r){"use strict";var n=r(115),i=r(83),o=r(70),a={};r(44)(a,r(13)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t){e.exports=function(){}},function(e,t,r){"use strict";var n=r(298),i=r(171),o=r(62),a=r(61);e.exports=r(116)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t,r){r(63),r(60),e.exports=r(291)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPickPModel=void 0;var n=a(r(119)),i=a(r(290)),o=a(r(1));r(11);function a(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){(0,o.default)(this,e),this._viewer=t,this._bInSurvey=!1,this._tss=new i.default,this._clickMode=Freedo.ScreenSpaceEventType.LEFT_CLICK,this._highlightColor=Freedo.Color.RED.withAlpha(.8),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper};s.prototype.setClickMode=function(e){this._clickMode=e},s.prototype.setHighlightColor=function(e,t,r,n){this._highlightColor=new Freedo.Color(e/255,t/255,r/255,n)},s.prototype.start=function(){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.handleLeftClick.bind(this),this._clickMode),this._bInSurvey=!0},s.prototype.cancel=function(){this.reset()},s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},s.prototype.handleLeftClick=function(e){0!=this._bInSurvey&&this.pickModel(e.position)},s.prototype.pickModel=function(e){var t=this._viewer.scene.drillPick(e);if(Freedo.defined(t)&&t.length>0){for(var r=0;r<t.length;r++)if(void 0==t[r].tileset.style){this._tss.add(t[r]),Freedo.defined(t[r].id)&&"PINICON"==t[r].id.name&&console.info(t[r].id.sceneObjectID);var i=this._highlightColor,o=new Freedo.Cesium3DTileStyle;o.color={evaluateColor:function(e,t,r){return Freedo.Color.clone(i,r)}},t[r].tileset.style=o,this._event.raiseEvent("DataChanged",t[r].tileset.basePath)}}else{var a=!0,s=!1,c=void 0;try{for(var u,l=(0,n.default)(this._tss.keys());!(a=(u=l.next()).done);a=!0){u.value.tileset.style=void 0}}catch(e){s=!0,c=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw c}}this._tss.clear()}this._viewer.scene.requestRender()},s.prototype.getData=function(){if(Freedo.defined(this._tss)){var e=[],t=!0,r=!1,i=void 0;try{for(var o,a=(0,n.default)(this._tss.keys());!(t=(o=a.next()).done);t=!0){var s=o.value;e.push(s.tileset.basePath)}}catch(e){r=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw i}}return e}},s.prototype.reset=function(){this._bInSurvey=!1,this._hanlder=this._hanlder&&this._hanlder.destroy();var e=!0,t=!1,r=void 0;try{for(var i,o=(0,n.default)(this._tss.keys());!(e=(i=o.next()).done);e=!0){i.value.tileset.style=void 0}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}this._tss.clear()},t.FdPickPModel=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdClipPlaneEditor=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(11);var a=function e(t,r){(0,o.default)(this,e),this._viewer=t,this._bInTransform=!1,this._transType="MOVE",this._bInRun=!1,this._startPt=null,this._endPt=null,this._points2=null,this._xAxisPL=null,this._yAxisPL=null,this._zAxisPL=null,this._XYPlane=null,this._YZPlane=null,this._XZPlane=null,this._XYCircle=null,this._XZCircle=null,this._selectedAxis="",this._mouseDownPos=null,this._mouseDownXY=null,this._mouseDownStartXY=null,this._mouseDownEndXY=null,this._initSphere=null,this._useDepthPicking=!0,this._pickTranslucentDepth=!0,this._fixedAxis="",this._DISPERRAD=111e3,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._oldPt=null,this._started=!1,this._mouseDown=!1,this._lastDis=-1,this._alpha=.5,this._axisZoom=1,this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3},this._t12=void 0,this._handler=void 0,this._xzOri=1,this._yzOri=1,this._oriObj={},this._m4=void 0,this._isPlaneMode=r};a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.startClip=function(e){this._transType=e,this._bInTransform||(this._bInTransform=!0,this.addListeners(),this._bInRun=!0)},a.prototype.show=function(e){this._initSphere=FreeDo.clone(e,!0),this.calcAxisZoom(),this.clearAxis(),this.calcCallbackArgs(),this.showAxis()},a.prototype.updateMatrix4=function(e){this._m4=Freedo.clone(e,!0)},a.prototype.updateSceneSphere=function(e){this._initSphere=FreeDo.clone(e,!0)},a.prototype.addListeners=function(){this._handler=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._handler.setInputAction(this.onLeftDown.bind(this),FreeDo.ScreenSpaceEventType.LEFT_DOWN),this._handler.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE),this._handler.setInputAction(this.onLeftUp.bind(this),FreeDo.ScreenSpaceEventType.LEFT_UP),this._handler.setInputAction(this.onWheel.bind(this),FreeDo.ScreenSpaceEventType.WHEEL);window.addEventListener("keydown",this.onKeyDown.bind(this))},a.prototype.calcAxisZoom=function(){if(!1!==this._bInTransform){var e,t=this._initSphere.center,r=this._viewer.camera.positionWC;e=Freedo.Cartesian3.distance(t,r)/6,this._viewer.camera.getPixelSize(this._initSphere,100,100),this._axisZoom=e,this._axisZoom>4e5&&(this._axisZoom=4e5),this._axisZoom<20&&(this._axisZoom=20)}else this._axisZoom=1},a.prototype.onWheel=function(){!1!==this._bInTransform&&this.calcAxisZoom()},a.prototype.onKeyDown=function(){this._bInTransform},a.prototype.onMouseMove=function(e){this._bInTransform&&(""!=this._selectedAxis&&(this._event.raiseEvent("Transforming",{MouseDownStartXY:this._mouseDownStartXY,MouseDownEndXY:this._mouseDownEndXY,MouseDownXY:this._mouseDownXY,MouseMoveXY:e.endPosition,SelectedAxis:this._selectedAxis,Ori:this._oriObj}),this.regenPts(),this.calcAxisZoom()),this._viewer.scene.requestRender())},a.prototype.regenPts=function(){null===this._points2&&(this._points2=this._viewer.scene.primitives.add(new Freedo.PointPrimitiveCollection)),this._points2.length>0&&this._points2.removeAll();var e=Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l,h,d+c]);this._isPlaneMode&&(e=[new Freedo.Cartesian3(l,h,d),new Freedo.Cartesian3(l,h,d+c)]),void 0!==this._m4&&(e[0]=Freedo.Matrix4.multiplyByPoint(this._m4,e[0],new Freedo.Cartesian3),e[1]=Freedo.Matrix4.multiplyByPoint(this._m4,e[1],new Freedo.Cartesian3)),this._points2.add({position:e[0],pixelSize:10,show:!1,color:Freedo.Color.YELLOW}),this._points2.add({position:e[1],pixelSize:10,show:!1,color:Freedo.Color.YELLOW})},a.prototype.onLeftDown=function(e){if(this._bInTransform){this.regenPts(),this._mouseDown=!0,this._oldPt=null,this._started=!1,this._lastDis=-1;var t=this._viewer.scene.pick(e.position);if(!FreeDo.defined(t)||!FreeDo.defined(t.id)||!FreeDo.defined(t.id._name)){for(var r=this._viewer.scene.drillPick(e.position),n=0;n<r.length;n++)if(FreeDo.defined(r[n].id)&&FreeDo.defined(r[n].id._name)){t=r[n];break}if(!FreeDo.defined(t))return}if(FreeDo.defined(t.id)&&FreeDo.defined(t.id._name)){var i=t.id._name;if(("X_AXIS"===i||"Y_AXIS"===i||"Z_AXIS"===i)&&this._transType.indexOf("CLIP")>=0&&(t.id.polyline.material.color=new Freedo.Color(1,1,0,1)),"XY_CIRCLE"!==i&&"YZ_CIRCLE"!==i&&"XZ_CIRCLE"!==i||(t.id.polyline.material.color=new Freedo.Color(1,1,0,1)),"XY_CIRCLE"===i||"XZ_CIRCLE"===i||"YZ_CIRCLE"===i||"XY"===i||"XZ"===i||"YZ"===i||"X_AXIS"===i||"Y_AXIS"===i||"Z_AXIS"===i){this._selectedAxis=FreeDo.clone(i,!0),this._viewer.scene.screenSpaceCameraController.enableRotate=!1,this._viewer.scene.screenSpaceCameraController.enableLook=!1,this._mouseDownPos=null;var o=this._viewer.camera.getPickRay(e.position);this._oriObj.rayDirection=o.direction,this._event.raiseEvent("Transform",{})}}this._mouseDownXY=e.position;var a=this._points2.get(0),s=this._points2.get(1);this._mouseDownStartXY=a.computeScreenSpacePosition(this._viewer.scene,new Freedo.Cartesian2),this._mouseDownEndXY=s.computeScreenSpacePosition(this._viewer.scene,new Freedo.Cartesian2),this._viewer.scene.requestRender()}},a.prototype.backToEnableRotate=function(e){""===this._selectedAxis&&(this._viewer.scene.screenSpaceCameraController.enableRotate=!0,this._viewer.scene.screenSpaceCameraController.enableLook=!0)},a.prototype.onLeftUp=function(e){setTimeout(this.backToEnableRotate.bind(this),500),this._bInTransform&&(this._mouseDown=!1,"XY_CIRCLE"===this._selectedAxis&&(this._XYCircle.polyline.material.color=new Freedo.Color(0,0,1,this._alpha)),"XZ_CIRCLE"===this._selectedAxis&&(this._XZCircle.polyline.material.color=new Freedo.Color(0,1,0,this._alpha)),"YZ_CIRCLE"===this._selectedAxis&&(this._YZCircle.polyline.material.color=new Freedo.Color(1,0,0,this._alpha)),"X_AXIS"===this._selectedAxis&&(this._xAxisPL.polyline.material.color=FreeDo.Color.RED),"Y_AXIS"===this._selectedAxis&&(this._yAxisPL.polyline.material.color=FreeDo.Color.GREEN),"Z_AXIS"===this._selectedAxis&&(this._zAxisPL.polyline.material.color=FreeDo.Color.BLUE),""!==this._selectedAxis&&this._event.raiseEvent("Transformed",{}),this._selectedAxis="",this._viewer.scene.requestRender())},a.prototype.clearAxis=function(){null!=this._xAxisPL&&(this._viewer.entities.remove(this._xAxisPL),this._viewer.entities.remove(this._yAxisPL),this._viewer.entities.remove(this._zAxisPL),this._viewer.scene.primitives.remove(this._points2),this._points2=null,this._viewer.entities.remove(this._XZPlane),this._viewer.entities.remove(this._YZPlane),this._viewer.entities.remove(this._XYPlane),this._viewer.entities.remove(this._XYCircle),this._viewer.entities.remove(this._XZCircle),this._viewer.entities.remove(this._YZCircle)),this._selectedAxis=""};var s=null,c=null,u=null,l=null,h=null,d=null,p=[];a.prototype.calcCallbackArgs=function(){s=this._initSphere.center,(c=4*this._initSphere.radius)>160&&(c=160),u=Freedo.Cartographic.fromCartesian(s),this._isPlaneMode?(l=s.x,h=s.y,d=s.z,p=[1,1]):(l=Freedo.Math.toDegrees(u.longitude),h=Freedo.Math.toDegrees(u.latitude),d=u.height,p=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u)),c=this._axisZoom},a.prototype.callbackXYHalfCircle=function(e,t){this.calcCallbackArgs();this._DISPERRAD;for(var r=[],n=FreeDo.Math.toDegrees(.9*c*p[0]),i=FreeDo.Math.toDegrees(.9*c*p[1]),o=0;o<=Math.PI/2;o+=.1){var a=l+n*Math.cos(o),s=h+i*Math.sin(o),u=Freedo.Cartesian3.fromDegrees(a,s,d);r.push(u)}return r},a.prototype.callbackXZHalfCircle=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(.9*c*p[0]);FreeDo.Math.toDegrees(.9*c*p[1]);if(this._isPlaneMode)r=.9*c;var n=[],i=Math.PI/2+.3,o=Math.PI/2-.3;"XZ_CIRCLE"==this._selectedAxis&&(i=2*Math.PI,o=0);for(var a=i;a>=o;a-=.001){var s,u=l+r*Math.cos(a),f=h,v=d+.9*c*Math.sin(a);s=this._isPlaneMode?new Freedo.Cartesian3(u,f,v):Freedo.Cartesian3.fromDegrees(u,f,v),n.push(s)}return t=n,this.reCalcPos(t),t},a.prototype.callbackYZHalfCircle=function(e,t){this.calcCallbackArgs();FreeDo.Math.toDegrees(.9*c*p[0]);var r=FreeDo.Math.toDegrees(.9*c*p[1]);if(this._isPlaneMode)r=.9*c;var n=[],i=Math.PI/2+.3,o=Math.PI/2-.3;"YZ_CIRCLE"==this._selectedAxis&&(i=2*Math.PI,o=0);for(var a=i;a>=o;a-=.001){var s,u=l,f=h+r*Math.cos(a),v=d+.9*c*Math.sin(a);s=this._isPlaneMode?new Freedo.Cartesian3(u,f,v):Freedo.Cartesian3.fromDegrees(u,f,v),n.push(s)}return t=n,this.reCalcPos(t),t},a.prototype.callbackXYCCBPMin=function(e,t){return this.calcCallbackArgs(),this._mouseDown&&"XY_CIRCLE"==this._selectedAxis?.75*c:.5*c*2},a.prototype.callbackXYRect=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(1.2*c*p[0]),n=FreeDo.Math.toDegrees(1.2*c*p[1]);return this._isPlaneMode?(r=1.2*c,n=1.2*c,t=[new Freedo.Cartesian3(l+r,h+n,d),new Freedo.Cartesian3(l-r,h+n,d),new Freedo.Cartesian3(l-r,h-n,d),new Freedo.Cartesian3(l+r,h-n,d),new Freedo.Cartesian3(l+r,h+n,d)]):t=Freedo.Cartesian3.fromDegreesArrayHeights([l+r,h+n,d,l-r,h+n,d,l-r,h-n,d,l+r,h-n,d,l+r,h+n,d]),this.reCalcPos(t),t},a.prototype.callbackXYShow=function(e,t){return this.calcCallbackArgs(),t=!0,"XY_CIRCLE"==this._selectedAxis&&(t=!1),t},a.prototype.callbackXYH=function(e,t){return d+.1},a.prototype.callbackXZ=function(e,t){this.calcCallbackArgs();var r=FreeDo.Math.toDegrees(1*c*p[0]);FreeDo.Math.toDegrees(1*c*p[1]);return Freedo.Cartesian3.fromDegreesArrayHeights([l+r,h,d-c,l+r,h,d+c,l-r,h,d+c,l-r,h,d-c,l+r,h,d-c])},a.prototype.callbackXZMinimumHeights=function(e,t){return this.calcCallbackArgs(),[d,d]},a.prototype.callbackXZMaximumHeights=function(e,t){return this.calcCallbackArgs(),[d+.5*c,d+.5*c]},a.prototype.callbackYZ=function(e,t){this.calcCallbackArgs();FreeDo.Math.toDegrees(1*c*p[0]);var r=FreeDo.Math.toDegrees(1*c*p[1]);return Freedo.Cartesian3.fromDegreesArrayHeights([l,h+r,d-c,l,h+r,d+c,l,h-r,d+c,l,h-r,d-c,l,h+r,d-c])},a.prototype.callbackXYCCBP=function(e,t){return this.calcCallbackArgs(),Freedo.Cartesian3.fromDegrees(l,h)},a.prototype.callbackX=function(e,t){this.calcCallbackArgs();var r=0;return this._isPlaneMode?(r=c,t=[new Freedo.Cartesian3(l,h,d),new Freedo.Cartesian3(l+r,h,d)]):(r=FreeDo.Math.toDegrees(c*p[0]),t=Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l+r,h,d])),void 0!==this._m4&&(t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3),t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)),this._oriObj.xAxis=t,t},a.prototype.callbackY=function(e,t){this.calcCallbackArgs();var r=0;return this._isPlaneMode?(r=c,t=[new Freedo.Cartesian3(l,h,d),new Freedo.Cartesian3(l,h+r,d)]):(r=c/this._DISPERRAD,t=Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l,h+r,d])),void 0!==this._m4&&(t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3),t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)),this._oriObj.yAxis=t,t},a.prototype.callbackZ=function(e,t){return this.calcCallbackArgs(),t=this._isPlaneMode?[new Freedo.Cartesian3(l,h,d),new Freedo.Cartesian3(l,h,d+c)]:Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l,h,d+c]),void 0!==this._m4&&(t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3),t[1]=Freedo.Matrix4.multiplyByPoint(this._m4,t[1],new Freedo.Cartesian3)),t},a.prototype.callbackStart=function(e,t){return this.calcCallbackArgs(),t=Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d]),void 0!==this._m4&&(t[0]=Freedo.Matrix4.multiplyByPoint(this._m4,t[0],new Freedo.Cartesian3)),t},a.prototype.callbackH=function(e,t){return this.calcCallbackArgs(),d},a.prototype.reCalcPos=function(e){if(void 0!==this._m4)for(var t in e)e[t]=Freedo.Matrix4.multiplyByPoint(this._m4,e[t],new Freedo.Cartesian3)},a.prototype.showAxis=function(){var e=new Freedo.CallbackProperty(this.callbackXYRect.bind(this),!1),t=new Freedo.CallbackProperty(this.callbackXYHalfCircle.bind(this),!1),r=new Freedo.CallbackProperty(this.callbackXZHalfCircle.bind(this),!1),n=new Freedo.CallbackProperty(this.callbackYZHalfCircle.bind(this),!1),i=new Freedo.CallbackProperty(this.callbackXYCCBPMin.bind(this),!1),o=new Freedo.CallbackProperty(this.callbackXZ.bind(this),!1),a=new Freedo.CallbackProperty(this.callbackYZ.bind(this),!1),s=new Freedo.CallbackProperty(this.callbackXYCCBP.bind(this),!1),c=new Freedo.CallbackProperty(this.callbackX.bind(this),!1),u=new Freedo.CallbackProperty(this.callbackY.bind(this),!1),l=new Freedo.CallbackProperty(this.callbackZ.bind(this),!1),h=new Freedo.CallbackProperty(this.callbackH.bind(this),!1);this._xAxisPL=this._viewer.entities.add({name:"X_AXIS",polyline:{positions:c,width:0,show:!0,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.RED)}}),this._yAxisPL=this._viewer.entities.add({name:"Y_AXIS",polyline:{positions:u,width:0,show:!0,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.GREEN)}}),this._zAxisPL=this._viewer.entities.add({name:"Z_AXIS",polyline:{positions:l,width:8,show:"CLIPXY"==this._transType,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.BLUE)}}),this._transType.indexOf("CLIP")>=0&&(this._YZPlane=this._viewer.entities.add({name:"YZ",polyline:{positions:a,width:2,show:"CLIPYZ"==this._transType,followSurface:!1,material:new Freedo.Color(1,0,0,this._alpha)}})),this._transType.indexOf("CLIP")>=0&&(this._XYPlane=this._viewer.entities.add({name:"XY_RECT",polyline:{positions:e,width:.8,show:!0,followSurface:!1,material:new Freedo.Color(0,0,1,this._alpha)}})),this._transType.indexOf("CLIP")>=0&&(this._XZPlane=this._viewer.entities.add({name:"XZ",polyline:{positions:o,width:2,show:!1,followSurface:!1,material:new Freedo.Color(0,1,0,this._alpha)}})),this._XYCircle=this._viewer.entities.add({name:"XY_NONE_CIRCLE",position:s,ellipse:{semiMinorAxis:i,semiMajorAxis:i,height:h,show:!1,material:new Freedo.Color(1,1,0,.2)}}),(this._transType.indexOf("ROTATE")>=0||this._transType.indexOf("SCALE")>=0)&&(this._XYCircle=this._viewer.entities.add({name:"XY_CIRCLE",polyline:{positions:t,width:4,show:!0,material:new Freedo.Color(0,0,1,this._alpha)}})),this._transType.indexOf("CLIPXY")>=0&&(this._XZCircle=this._viewer.entities.add({name:"XZ_CIRCLE",polyline:{positions:r,width:4,show:!0,material:new Freedo.Color(0,1,0,this._alpha)}}),this._YZCircle=this._viewer.entities.add({name:"YZ_CIRCLE",polyline:{positions:n,width:4,show:!0,material:new Freedo.Color(1,0,0,this._alpha)}})),this.regenPts(),this._viewer.scene.requestRender()},a.prototype.reset=function(){this._handler=this._handler&&this._handler.destroy(),this._bInTransform=!1,this.clearAxis(),this._mouseDownPos=null,this._initSphere=null,this._fixedAxis=""},a.prototype.dispose=function(){this.reset()},t.FdClipPlaneEditor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdClipPlane=void 0;var n=a(r(1)),i=a(r(6)),o=r(302);r(11);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,r,i){(0,n.default)(this,e),this._viewer=t,this._tileset=r,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._mani=new o.FdClipPlaneEditor(t,i),this._selectedAxis="",this._transType="CLIP",this._mouseDown12Arg={},this._axisZoom=1,this._isPlaneMode=i,this._t12={TMoveX:0,TMoveY:0,TMoveZ:0,THeading:0,TPitch:0,TRoll:0,TScaleX:1,TScaleY:1,TScaleZ:1,TBaseX:0,TBaseY:0,TBaseZ:0},this._q4=new Freedo.Quaternion(0,0,0,1),this._lsner=void 0}return(0,i.default)(e,[{key:"clipOptions",get:function(){return{type:"CLIPXY",Q4:this._q4,TMoveX:this._t12.TMoveX,TMoveY:this._t12.TMoveY,TMoveZ:this._t12.TMoveZ,TPitch:this._t12.TPitch,TRoll:this._t12.TRoll}},set:function(e){Freedo.defined(e)&&Freedo.defined(e.type)&&this.start(e.type,e)}}]),e}();s.prototype.setSceneObjectIDs=function(e){this._aSceneObjectId=FreeDo.clone(e,!0)},s.prototype.calcSceneBS=function(){var e=[];for(var t in this._tileset){var r=this._tileset[t].boundingSphere;e.push(r)}this._sceneSphere=FreeDo.BoundingSphere.fromBoundingSpheres(e,new FreeDo.BoundingSphere)},s.prototype.getType=function(){return this._transType},s.prototype.start=function(e,t){e||(e="CLIPXY"),this.startClip(e,t)},s.prototype.startClip=function(e,t){this._transType=e,this._bInClip=!0,this.calcSceneBS();var r=this;this._lsner&&(this._lsner(),this._lsner=void 0,this._q4=new Freedo.Quaternion(0,0,0,1)),this._lsner=this._mani.on(function(e,t){"Transform"==e&&r.onTransformStart(),"Transformed"==e&&r.onTransformEnd(),"Transforming"==e&&r.onTransforming(t)}),this._mani.startClip("CLIPXY"),"CLIPXY"==e||"CLIPXYNEG"==e||"CLIPYZ"==e||"CLIPXZ"==e?this._selectedAxis="Z_AXIS":console.warn("不支持此种类型："+e),Freedo.defined(t)?(this._t12.TMoveX=t.TMoveX,this._t12.TMoveY=t.TMoveY,this._t12.TMoveZ=t.TMoveZ,this._q4=Freedo.clone(t.Q4)):this.reset12Args(),"CLIPYZ"==e&&(this._t12.TPitch=90),"CLIPXZ"==e&&(this._t12.TRoll=90),"CLIPXYNEG"==e&&(this._t12.TPitch=180),this.onTransformStart();var n=Freedo.clone(this._mouseDown12Arg,!0);if(this.updatePlane(n),"CLIPYZ"==e||"CLIPXZ"==e||"CLIPXYNEG"==e){var i,o,a,s=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);s&&(i=s.longitude,o=s.latitude,a=s.height),this._isPlaneMode&&(i=this._sceneSphere.center.x,o=this._sceneSphere.center.y,a=this._sceneSphere.center.z),"CLIPXYNEG"!=e&&"CLIPYZ"!=e||(this._selectedAxis="XZ_CIRCLE"),"CLIPXZ"==e&&(this._selectedAxis="YZ_CIRCLE");var c=new Freedo.Matrix3,u=new Freedo.Quaternion;this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,i,o,a,c,u);Freedo.Quaternion.multiply(this._q4,u,this._q4)}"CLIPYZ"==e&&(this._t12.TPitch=0),"CLIPXZ"==e&&(this._t12.TRoll=0),"CLIPXYNEG"==e&&(this._t12.TPitch=0),this._mani.show(this._sceneSphere),this._event.raiseEvent("Start",{})},s.prototype.getMatrix=function(e,t,r,n,i,o,a,s,c,u,l,h){var d=Freedo.Cartesian3.fromRadians(s,c,u),p=Freedo.Cartesian3.fromRadians(s+t,c+r,u+n);this._isPlaneMode&&(d=new Freedo.Cartesian3(s,c,u),p=new Freedo.Cartesian3(s+t,c+r,u+n));var f,v,_,y=Freedo.clone(e,!0);if(o=Freedo.Math.toRadians(o),a=Freedo.Math.toRadians(a),"XZ_CIRCLE"==this._selectedAxis){var m=Freedo.Quaternion.fromAxisAngle(new FreeDo.Cartesian3(1,0,0),a,new Freedo.Quaternion);f=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,m,new Freedo.Cartesian3(1,1,1));var g=Freedo.Matrix4.getRotation(f,new Freedo.Matrix3),F=Freedo.Matrix3.multiplyByVector(g,new FreeDo.Cartesian3(0,-1,0),new Freedo.Cartesian3);F=new FreeDo.Cartesian3(0,-1,0),_=Freedo.Quaternion.fromAxisAngle(F,o,new Freedo.Quaternion)}else{m=Freedo.Quaternion.fromAxisAngle(new FreeDo.Cartesian3(0,-1,0),o,new Freedo.Quaternion);f=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,m,new Freedo.Cartesian3(1,1,1));g=Freedo.Matrix4.getRotation(f,new Freedo.Matrix3),F=Freedo.Matrix3.multiplyByVector(g,new FreeDo.Cartesian3(1,0,0),new Freedo.Cartesian3);F=new FreeDo.Cartesian3(1,0,0),_=Freedo.Quaternion.fromAxisAngle(F,a,new Freedo.Quaternion)}for(var w in Freedo.Quaternion.multiply(y,_,y),_)h&&(h[w]=_[w]);v=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3(0,0,0),y,new Freedo.Cartesian3(1,1,1));var C=Freedo.Transforms.eastNorthUpToFixedFrame(d);this._isPlaneMode&&(C=Freedo.Matrix4.fromTranslation(d));var b=Freedo.Matrix4.inverse(C,new Freedo.Matrix4),P=Freedo.Transforms.eastNorthUpToFixedFrame(p);this._isPlaneMode&&(P=Freedo.Matrix4.fromTranslation(p));var M=Freedo.Matrix4.multiply(f,b,new Freedo.Matrix4),x=Freedo.Matrix4.multiply(v,M,new Freedo.Matrix4),S=Freedo.Matrix4.multiply(P,x,new Freedo.Matrix4),T=Freedo.Matrix4.getRotation(S,new Freedo.Matrix3);for(var w in T)l&&(l[w]=T[w]);return S},s.prototype.calcAxisZoom=function(){if(!1!==this._bInClip){var e,t=this._sceneSphere.center,r=this._viewer.camera.positionWC;e=Freedo.Cartesian3.distance(t,r)/6,this._viewer.camera.getPixelSize(this._sceneSphere,100,100),this._axisZoom=e,this._axisZoom>4e5&&(this._axisZoom=4e5),this._axisZoom<20&&(this._axisZoom=20)}else this._axisZoom=1},s.prototype.onTransforming=function(e){var t=e.SelectedAxis;this._selectedAxis=t;var r=[0,0,0],n=0,i=0;this.calcAxisZoom();var o=Freedo.clone(this._mouseDown12Arg,!0),a=Freedo.FdMisc.FdGeometric.calcAngle(e.MouseDownStartXY,e.MouseDownXY,e.MouseDownStartXY,e.MouseMoveXY);if("Z_AXIS"===t){var s=Math.sqrt(Math.pow(e.MouseDownXY.y-e.MouseMoveXY.y,2)+Math.pow(e.MouseDownXY.x-e.MouseMoveXY.x,2))*this._axisZoom/200;if(0==s)return;var c,u,l,h=[e.MouseDownEndXY.x-e.MouseDownStartXY.x,e.MouseDownEndXY.y-e.MouseDownStartXY.y],d=[e.MouseMoveXY.x-e.MouseDownXY.x,e.MouseMoveXY.y-e.MouseDownXY.y],p=(h[0]*d[0]+h[1]*d[1])/(Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2))*Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2))),f=Math.acos(p);this._isPlaneMode?((c={}).longitude=this._sceneSphere.center.x,c.latitude=this._sceneSphere.center.y,c.height=this._sceneSphere.center.z,u=new FreeDo.Cartesian3(this._sceneSphere.center.x,this._sceneSphere.center.y,this._sceneSphere.center.z+1),l=FreeDo.Cartesian3.subtract(u,this._sceneSphere.center,new FreeDo.Cartesian3)):(c=Freedo.Cartographic.fromCartesian(this._sceneSphere.center),u=FreeDo.Cartesian3.fromRadians(c.longitude,c.latitude,c.height+1),l=FreeDo.Cartesian3.subtract(u,this._sceneSphere.center,new FreeDo.Cartesian3));var v=new Freedo.Matrix3;this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,c.longitude,c.latitude,c.height,v);var _=Freedo.Matrix3.multiplyByVector(v,l,new Freedo.Cartesian3),y=Freedo.Transforms.eastNorthUpToFixedFrame(this._sceneSphere.center);this._isPlaneMode&&(y=Freedo.Matrix4.fromTranslation(this._sceneSphere.center));var m=Freedo.Matrix4.inverse(y,new Freedo.Matrix4);v=Freedo.Matrix4.getRotation(m,new Freedo.Matrix3);var g=Freedo.Matrix3.multiplyByVector(v,_,new Freedo.Cartesian3),F=[1,1];F=this._isPlaneMode?[1,1]:Freedo.FdMisc.FdGeometric.getLongAndLatRatio(c),r[0]=F[1]*s*g.x*Math.cos(f),r[1]=F[0]*s*g.y*Math.cos(f),r[2]=s*g.z*Math.cos(f)}if("XZ_CIRCLE"===t){var w=FreeDo.Cartesian3.subtract(e.Ori.yAxis[1],e.Ori.yAxis[0],new FreeDo.Cartesian3);n=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(w,e.Ori.rayDirection))>90?a:-1*a}if("YZ_CIRCLE"===t){var C=FreeDo.Cartesian3.subtract(e.Ori.xAxis[1],e.Ori.xAxis[0],new FreeDo.Cartesian3);i=Freedo.Math.toDegrees(FreeDo.Cartesian3.angleBetween(C,e.Ori.rayDirection))>90?-1*a:a}var b={TMoveX:r[0],TMoveY:r[1],TMoveZ:r[2],THeading:0,TPitch:n,TRoll:i,TScaleX:1,TScaleY:1,TScaleZ:1};o.TMoveX+=b.TMoveX,o.TMoveY+=b.TMoveY,o.TMoveZ+=b.TMoveZ,o.TRoll=b.TRoll,o.TPitch=b.TPitch,this._t12.TMoveX=o.TMoveX,this._t12.TMoveY=o.TMoveY,this._t12.TMoveZ=o.TMoveZ,this._t12.TPitch=o.TPitch,this._t12.TRoll=o.TRoll,this.refineArgs(),this._event.raiseEvent("Cliping",this.clipOptions),this._event.raiseEvent("DataChanged",this.clipOptions),this.updatePlane(this._t12),this._viewer.scene.requestRender()},s.prototype.getNewPlane=function(e){var t=new Freedo.Plane(new Freedo.Cartesian3(0,0,1),0),r=Freedo.Transforms.eastNorthUpToFixedFrame(this._sceneSphere.center);if(this._isPlaneMode)r=Freedo.Matrix4.fromTranslation(this._sceneSphere.center);return Freedo.Matrix4.multiply(e,r,r),Freedo.Plane.transform(t,r,t),t},s.prototype.updatePlane=function(e){var t,r,n,i=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);i&&(t=i.longitude,r=i.latitude,n=i.height),this._isPlaneMode&&(t=this._sceneSphere.center.x,r=this._sceneSphere.center.y,n=this._sceneSphere.center.z);var o=void 0,a=new Freedo.Matrix3,s=new Freedo.Matrix4;if("Z_AXIS"===this._selectedAxis||"XZ_CIRCLE"===this._selectedAxis||"YZ_CIRCLE"===this._selectedAxis){var c;if(this._isPlaneMode){(c=Freedo.clone(this._sceneSphere.center,!0)).z-=1;var u=Freedo.clone(c,!0)}else{(c=Freedo.Cartographic.fromCartesian(this._sceneSphere.center)).height-=1;u=Freedo.Cartesian3.fromRadians(c.longitude,c.latitude,c.height)}var l=FreeDo.Cartesian3.subtract(u,this._sceneSphere.center,new FreeDo.Cartesian3);s=this.getMatrix(this._q4,e.TMoveX,e.TMoveY,e.TMoveZ,e.THeading,e.TPitch,e.TRoll,t,r,n,a);var h=Freedo.Matrix3.multiplyByVector(a,l,new Freedo.Cartesian3);if(isNaN(h.x))return void console.warn("出现异常v2");o=Freedo.Cartesian3.normalize(h,new Freedo.Cartesian3)}if(void 0!==o){var d=[this.getNewPlane(s)];for(var p in this._tileset){this._tileset[p].clippingPlanes=new Freedo.ClippingPlaneCollection({planes:d,edgeWidth:1,useGltfModelMatrix:!1})}}this._mani.updateMatrix4(s)},s.prototype.refineArgs=function(){this._t12.TMoveX=Freedo.FdMisc.FdMath.round(this._t12.TMoveX,8),this._t12.TMoveY=Freedo.FdMisc.FdMath.round(this._t12.TMoveY,8),this._t12.TMoveZ=Freedo.FdMisc.FdMath.round(this._t12.TMoveZ,6),this._t12.TPitch=Freedo.FdMisc.FdMath.round(this._t12.TPitch,4),this._t12.TRoll=Freedo.FdMisc.FdMath.round(this._t12.TRoll,4)},s.prototype.getData=function(){return{type:this._transType,TMoveX:this._t12.TMoveX,TMoveY:this._t12.TMoveY,TMoveZ:this._t12.TMoveZ,TPitch:this._t12.TPitch,TRoll:this._t12.TRoll}},s.prototype.setData=function(e){this._tileset=e},s.prototype.reset12Args=function(){this._t12.TMoveX=0,this._t12.TMoveY=0,this._t12.TMoveZ=0,this._t12.TPitch=0,this._t12.TRoll=0},s.prototype.onTransformStart=function(e){this._event.raiseEvent("ClipStart",{}),this.refineArgs(),this._mouseDown12Arg=Freedo.clone(this._t12,!0)},s.prototype.onTransformEnd=function(e){var t,r,n;if(this._isPlaneMode)t=this._sceneSphere.center.x,r=this._sceneSphere.center.y,n=this._sceneSphere.center.z;else{var i=Freedo.Cartographic.fromCartesian(this._sceneSphere.center);t=i.longitude,r=i.latitude,n=i.height}var o=new Freedo.Quaternion;this.getMatrix(this._q4,this._t12.TMoveX,this._t12.TMoveY,this._t12.TMoveZ,this._t12.THeading,this._t12.TPitch,this._t12.TRoll,t,r,n,new Freedo.Matrix3,o);Freedo.Quaternion.multiply(this._q4,o,this._q4),this.refineArgs(),this._event.raiseEvent("ClipEnd",FreeDo.clone(this._t12,!0))},s.prototype.backToOriginPlane=function(){this.start(this._transType),this._event.raiseEvent("ClipReset",FreeDo.clone(this._t12,!0))},s.prototype.cancelClip=function(){this.reset(),this._event.raiseEvent("Cancel",{})},s.prototype.cancel=function(){this.cancelClip()},s.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},s.prototype.reset=function(){this._bInClip=!1,this._sceneSphere=null,this.reset12Args(),this._mani.reset(),this._lsner&&this._lsner(),this._lsner=void 0,this._q4=new Freedo.Quaternion(0,0,0,1)},s.prototype.dispose=function(){this.reset()},t.FdClipPlane=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPathAnimator=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(72),s=r(84);r(11);var c=function e(t){(0,o.default)(this,e),this._viewer=t,this._points={},this._ptsSmoothed=[],this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._kb=new s.FdKeyboard(t),this._kbCallback=void 0,this._bKBActive=!1,this._lines=[],this._bStop=!0,this._bPause=!0,this._bPauseMannul=0,this._bRun=!1,this._dPitch=15,this._dOffsetH=0,this._dHeight=100,this._dSpeed=1e3,this._bLock=1,this._lastTS=0,this._timeUsed=0,this._totalLen=0,this._passedLen=0,this._dHeading=0,this._pathPL=void 0,this._smoothRate=2,this._nearRate=4,this.addKBLsnr(),this._showPath=!1,this._loop=!1,this._pathViewMode=!1,this._aTmpPoint=[],this._centerPt=void 0};c.prototype.start=function(){if(!this._bRun){var e=this;this._bRun=!0,this._viewer.scene.preRender.addEventListener(function(){e.tick()})}(this._bStop||1==this._bPauseMannul)&&(this._bStop&&(this._bStop=!1,this._bPause=!1,this._bPauseMannul=2,this._startTime=0,this._timeUsed=0),1==this._bPauseMannul&&(this._bPauseMannul=2,console.log(this._bPauseMannul)),this._event.raiseEvent("StatusChanged",{status:"play"}),this._kb.setFocus())},c.prototype.enable=function(){this._bKBActive=!0,this._kb.enable()},c.prototype.disable=function(){this._bKBActive=!1,this._kb.disable()},c.prototype.getKeyboardStatus=function(){return this._bKBActive},c.prototype.addKBLsnr=function(){var e=this;this._kbCallback=this._kb.on(function(t,r){"timer"!==t||e.onKeyboard(r.metaData)})},c.prototype.onKeyboard=function(e){if(this._bKBActive&&0!=this._points.length){if(e[33]){this._bPauseMannul=1;var t=33.3/1e3*this._dSpeed;this.kbtick(t)}if(e[34]){this._bPauseMannul=1;t=-33.3/1e3*this._dSpeed;this.kbtick(t)}}},c.prototype.stop=function(){this._bStop||(this._bStop=!0,this._event.raiseEvent("StatusChanged",{status:"stop"}),this._kb.setFocus(),this._centerPt&&(this._viewer.entities.remove(this._centerPt),this._centerPt=void 0),this._viewer.scene.requestRender(),this._viewer.camera.lookAtTransform(Freedo.Matrix4.IDENTITY))},c.prototype.pause=function(){this._bStop||(this._bPauseMannul=1,this._event.raiseEvent("StatusChanged",{status:"pause"}),this._kb.setFocus())},c.prototype.getSpeed=function(){return this._dSpeed},c.prototype.setSpeed=function(e){this._dSpeed=e},c.prototype.setNearRate=function(e){this._nearRate=e},c.prototype.getPitch=function(){return this._dPitch},c.prototype.setPitch=function(e){this._dPitch=-1*e},c.prototype.setOffsetH=function(e){this._dOffsetH=e,this.smoothPath()},c.prototype.setPathViewMode=function(e){this._pathViewMode=e},c.prototype.setSmoothRate=function(e){this._smoothRate=e,this.smoothPath()},c.prototype.getHeight=function(){return this._dHeight},c.prototype.setHeight=function(e){this._dHeight=e},c.prototype.setHeading=function(e){this._dHeading=e},c.prototype.setPathShow=function(e){this._showPath!==e&&this._event.raiseEvent("PathStatusChanged",{status:this._showPath}),this._showPath=e,this.showPath()},c.prototype.getStatus=function(){return this._bStop?"stop":1==this._bPauseMannul?"pause":"play"},c.prototype.showPath=function(){if(this._showPath){for(var e in void 0!==this._pathPL&&(this._viewer.entities.remove(this._pathPL),this._pathPL=void 0),this._aTmpPoint)this._viewer.entities.remove(this._aTmpPoint[e]);this._aTmpPoint=[];for(var t=0;t<this._points.length;t++){var r=Freedo.Cartesian3.fromDegrees(this._points[t][0],this._points[t][1],this._points[t][2]+this._dOffsetH),n=this._viewer.entities.add({position:r,point:{color:Freedo.Color.RED,pixelSize:10,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0}});this._aTmpPoint.push(n)}this._pathPL=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:this._ptsSmoothed,width:3,material:Freedo.Color.YELLOW,depthFailMaterial:Freedo.Color.YELLOW}})}else for(var e in this._viewer.entities.remove(this._pathPL),this._pathPL=void 0,this._aTmpPoint)this._viewer.entities.remove(this._aTmpPoint[e]);this._kb.setFocus(),this._viewer.scene.requestRender()},c.prototype.calVectorOri=function(e,t){var r=FreeDo.Cartographic.fromCartesian(e),n=FreeDo.Cartographic.fromCartesian(t);return n.longitude>r.longitude&&n.latitude>r.latitude?1:n.longitude>r.longitude&&n.latitude<r.latitude?2:n.longitude<r.longitude&&n.latitude<r.latitude?3:n.longitude<r.longitude&&n.latitude>r.latitude?4:void 0},c.prototype.calVectorHeading=function(e,t){var r=FreeDo.Cartographic.fromCartesian(e),n=FreeDo.Cartographic.fromCartesian(t);return Math.atan((n.longitude-r.longitude)/(n.latitude-r.latitude))},c.prototype.calcCP=function(e,t,r){var n,i,o;n=e.position,i=t.position,o=r.position;var a=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3),s=FreeDo.Cartesian3.subtract(o,i,new FreeDo.Cartesian3),c=FreeDo.Cartesian3.cross(a,s,new FreeDo.Cartesian3),u=FreeDo.Cartesian3.normalize(a,new FreeDo.Cartesian3),l=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3),h=FreeDo.Cartesian3.add(u,l,new FreeDo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),p=Freedo.Quaternion.fromAxisAngle(c,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),f=Freedo.Matrix3.fromQuaternion(d,new Freedo.Matrix3),v=Freedo.Matrix3.fromQuaternion(p,new Freedo.Matrix3),_=Freedo.Matrix3.multiplyByVector(f,h,new Freedo.Cartesian3),y=Freedo.Matrix3.multiplyByVector(v,h,new Freedo.Cartesian3),m=FreeDo.Cartesian3.normalize(_,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3),F=FreeDo.Cartesian3.distance(n,i),w=FreeDo.Cartesian3.distance(o,i),C=1;C=F<w?F/this._nearRate:w/this._nearRate,m=FreeDo.Cartesian3.multiplyByScalar(m,C,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.add(i,m,new FreeDo.Cartesian3),P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);return FreeDo.Cartesian3.distance(n,b)<FreeDo.Cartesian3.distance(n,P)?[b,P]:[P,b]},c.prototype.smoothPolyline=function(e){var t=[];if(e.length<3)for(var r=0;r<e.length;r++)t.push(e[r].position);else for(r=0;r<=e.length-2;r++){var n={},i={},o={},s={};0==r?(n=e[0],i.position=this.calcCP(e[0],e[1],e[2])[0],o=e[0],s=e[1]):r==e.length-2?(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i=e[r+1],o=e[r],s=e[r+1]):(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i.position=this.calcCP(e[r],e[r+1],e[r+2])[0],o=e[r],s=e[r+1]);var c=new a.FdBezierCurveAlgorithm(o,s,n,i).getVertexForCurve(this._smoothRate);t=t.concat(c)}var u=[];for(r=0;r<t.length;r++){var l;if(l=t[r],u.length>0)FreeDo.Cartesian3.distance(u[u.length-1],l)>1e-4&&u.push(l);else u.push(l)}return u},c.prototype.calcHeading=function(e){var t=this.calVectorHeading(this._ptsSmoothed[e],this._ptsSmoothed[e+1]),r=this.calVectorOri(this._ptsSmoothed[e],this._ptsSmoothed[e+1]);return t=Freedo.Math.toDegrees(t),1==r&&(t+=0),2==r&&(t+=180),3==r&&(t+=180),4==r&&(t+=360),t},c.prototype.smoothPath=function(){if(this._points){for(var e=[],t=0;t<this._points.length;t++){var r=Freedo.Cartesian3.fromDegrees(this._points[t][0],this._points[t][1],this._points[t][2]+this._dOffsetH);e.push({position:r})}this._ptsSmoothed=this.smoothPolyline(e),this.showPath(),this._totalLen=Freedo.FdMisc.FdGeometric.calculateLength(this._ptsSmoothed),this._kb.setFocus()}},c.prototype.getTotalLength=function(){return this._totalLen},c.prototype.setPoints=function(e){this._points=e,this.smoothPath()},c.prototype.setLoop=function(e){this._loop=e},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.callbackCenter=function(e,t){return this._center},c.prototype.gotoSubByLength=function(e,t,r){var n,i,o,a=0,s=0;s=(n=this.calcHeading(e))+t/r*((a=e==this._ptsSmoothed.length-2?n:this.calcHeading(e+1))-n);n+180<a&&(t/r<n/(o=360-a+n)?(s=n-t/r/(n/o)*n)<0&&(s+=360):s=360-(t/r-n/o)/((360-a)/o)*(360-a));n-180>a&&(t/r<(360-n)/(o=360-n+a)?(s=n+t/r/((360-n)/o)*(360-n))>360&&(s-=360):s=(t/r-(360-n)/o)/(a/o)*a);var c={};c.x=this._ptsSmoothed[e].x+t/r*(this._ptsSmoothed[e+1].x-this._ptsSmoothed[e].x),c.y=this._ptsSmoothed[e].y+t/r*(this._ptsSmoothed[e+1].y-this._ptsSmoothed[e].y),c.z=this._ptsSmoothed[e].z+t/r*(this._ptsSmoothed[e+1].z-this._ptsSmoothed[e].z);var u=FreeDo.Cartographic.fromCartesian(c),l=FreeDo.Math.toDegrees(u.longitude),h=FreeDo.Math.toDegrees(u.latitude),d=Freedo.Cartesian3.fromDegrees(l,h,u.height);if(this._center=d,!this._centerPt){var p=new Freedo.CallbackProperty(this.callbackCenter.bind(this),!1);this._centerPt=this._viewer.entities.add({position:p,point:{color:Freedo.Color.GREEN,pixelSize:10,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!1}})}s=Freedo.Math.toRadians(s+this._dHeading),i=Freedo.Math.toRadians(this._dPitch),this._dHeight<1&&(this._dHeight=100),this._viewer.camera.lookAt(d,new Freedo.HeadingPitchRange(s,i,this._dHeight)),this._viewer.scene.requestRender()},c.prototype.gotoSubByLengthUsePathViewMode=function(e,t,r){var n={};n.x=this._ptsSmoothed[e].x+t/r*(this._ptsSmoothed[e+1].x-this._ptsSmoothed[e].x),n.y=this._ptsSmoothed[e].y+t/r*(this._ptsSmoothed[e+1].y-this._ptsSmoothed[e].y),n.z=this._ptsSmoothed[e].z+t/r*(this._ptsSmoothed[e+1].z-this._ptsSmoothed[e].z);var i=FreeDo.Cartographic.fromCartesian(n),o=FreeDo.Math.toDegrees(i.longitude),a=FreeDo.Math.toDegrees(i.latitude),s=Freedo.Cartesian3.fromDegrees(o,a,i.height+this._dHeight),c=FreeDo.Cartesian3.subtract(this._ptsSmoothed[e+1],this._ptsSmoothed[e],new FreeDo.Cartesian3),u=Freedo.Cartesian3.normalize(c,new Freedo.Cartesian3),l=Freedo.Cartesian3.normalize(s,new Freedo.Cartesian3);this._viewer.camera.setView({destination:s,orientation:{direction:u,up:l}}),s=null,c=null,l=null},c.prototype.gotoByLength=function(e){for(var t=0,r=0,n=0;n<this._ptsSmoothed.length-1;n++){if(r=FreeDo.Cartesian3.distance(this._ptsSmoothed[n],this._ptsSmoothed[n+1]),e>t&&e<t+r){this._pathViewMode?this.gotoSubByLengthUsePathViewMode(n,e-t,r):this.gotoSubByLength(n,e-t,r);break}t+=r}},c.prototype.tick=function(){var e=(new Date).getTime();if(this._bStop)return this._lastTS=0,void(this._timeUsed=0);this._bStop||this._bPause||!Freedo.defined(e)||0!=this._bPauseMannul&&2!=this._bPauseMannul||(0==this._lastTS?this._lastTS=e:(this._timeUsed+=e-this._lastTS,this._passedLen=this._timeUsed/1e3*this._dSpeed,this._passedLen<this._totalLen?this.gotoByLength(this._passedLen):(this.stop(),this._event.raiseEvent("Finished",{status:"Finished"}),this._loop&&this.start()))),this._lastTS=e},c.prototype.kbtick=function(e){this._timeUsed+=33*e/Math.abs(e),this._passedLen+=e,this._passedLen<=0&&(this._passedLen=0,this._timeUsed=0,console.log("重新播放:"+this._passedLen)),this._passedLen<this._totalLen?this.gotoByLength(this._passedLen):(this._passedLen=0,this._timeUsed=0)},c.prototype.clear=function(){for(var e in this._lines)this._viewer.entities.remove(this._lines[e]);for(var e in this._pathPL&&(this._viewer.entities.remove(this._pathPL),this._pathPL=void 0),this._aTmpPoint)this._viewer.entities.remove(this._aTmpPoint[e]);this._aTmpPoint=[],this._centerPt&&(this._viewer.entities.remove(this._centerPt),this._centerPt=void 0),this._viewer.scene.requestRender()},c.prototype.reset=function(){this.clear(),this._bStop=!0,this._points=void 0},c.prototype.dispose=function(){this.reset()},t.FdPathAnimator=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdPathsManager=void 0;var n=c(r(1)),i=c(r(6)),o=r(304),a=r(11),s=r(25);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,r){var i=this;(0,n.default)(this,e),this._pathsOpts=r,this._pa=new o.FdPathAnimator(t),this._pa.on(function(e,t){i.pathAnimatorEventCallback(e,t)}),this._ple=new s.FdPolylineEditor(t),this._ple.setAutoLoop(!1),this._ple.setAutoDelLines(!0),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._currentPlayingGroupID=void 0,this._currentGroupID=void 0;var c=this;this._lsner=this._ple.on(function(e,t){if("PointAdded"==e&&c.appendPathPoint(c._currentGroupID,t),"PLAdd"==e&&(c._ple.cancel(),c.reloadPA(),c._event.raiseEvent("DataChanged",c._pathsOpts[c._currentGroupID])),"EditEnd"==e){var r=c._pathsOpts[c._currentGroupID].list;for(var n in t.pts){var i=a.FdMisc.FdGeometric.tg(t.pts[n]);r[n].position=i}c.reloadPA(c._currentGroupID),c._event.raiseEvent("DataChanged",c._pathsOpts[c._currentGroupID])}})}return(0,i.default)(e,[{key:"pathsOptions",get:function(){return this._pathsOpts},set:function(e){Freedo.defined(e)&&(this._pathsOpts=e)}}]),e}();u.prototype.pathAnimatorEventCallback=function(e,t){this._event.raiseEvent(e,t)},u.prototype.createGroup=function(e,t){return void 0===t&&(t=Freedo.createGuid()),this._pathsOpts[t]={name:e,smooth:5,list:[]},this._currentGroupID=t,t},u.prototype.removeGroup=function(e){return void 0!==this._pathsOpts[e]&&(this._currentGroupID===e&&(this._pa.reset(),this._currentGroupID=void 0),this._currentPlayingGroupID,delete this._pathsOpts[e],this._event.raiseEvent("GroupsChanged"),!0)},u.prototype.getGroupName=function(e){return void 0===this._pathsOpts[e]?"":this._pathsOpts[e].name},u.prototype.setGroupName=function(e,t){if(void 0===this._pathsOpts[e])return"";this._pathsOpts[e].name=t},u.prototype.getGroupSmooth=function(e){return void 0===this._pathsOpts[e]?-1:this._pathsOpts[e].smooth?this._pathsOpts[e].smooth:5},u.prototype.setGroupSmooth=function(e,t){return void 0!==this._pathsOpts[e]&&(this._pathsOpts[e].smooth=t,this._pa.setSmoothRate(t),!0)},u.prototype.getGroupOptions=function(e){if(void 0!==this._pathsOpts[e])return Freedo.clone(this._pathsOpts[e],!0)},u.prototype.removeAllGroups=function(){for(var e in this._pathsOpts)delete this._pathsOpts[e];return this._currentPlayingGroupID=void 0,this._event.raiseEvent("GroupsChanged"),!0},u.prototype.getAllGroupIDs=function(){var e=[];for(var t in this._pathsOpts)e.push(t);return e},u.prototype.preAppendPathPoint=function(){if(Freedo.defined(this._currentGroupID)&&0!=this._currentGroupID.length){var e=this._pathsOpts[this._currentGroupID].list;if(e&&e.length>=1){var t=e[e.length-1];this._ple.setStartPt(Freedo.FdMisc.FdGeometric.tc(t.position))}this._ple.run()}},u.prototype.endAppendPathPoint=function(){this._ple.cancel(),this._lsner&&(this._lsner(),this._lsner=void 0)},u.prototype.appendPathPoint=function(e,t){if(void 0===this._pathsOpts[e])return!1;var r=Freedo.clone(t,!0);return r.name="路径点_"+(new Date).getTime(),this._pathsOpts[e].list.push(r),this._event.raiseEvent("GroupChanged",e),!0},u.prototype.insertPathPoint=function(e,t,r){if(void 0===this._pathsOpts[e])return!1;var n=Freedo.clone(t,!0);return this._pathsOpts[e].list.splice(r,0,n),this._event.raiseEvent("GroupChanged",e),!0},u.prototype.removePathPoint=function(e,t){return void 0!==this._pathsOpts[e]&&(void 0!==this._pathsOpts[e].list[t]&&(this._pathsOpts[e].list.splice(t,1),this._event.raiseEvent("GroupChanged",e),this.reloadPA(e),!0))},u.prototype.getPathsLength=function(e){if(void 0===this._pathsOpts[e])throw new Error("getPathsLength error!");return this._pathsOpts[e].list.length},u.prototype.setPathPoint=function(e,t,r){if(void 0===this._pathsOpts[e])return!1;if(void 0===this._pathsOpts[e].list[t])return!1;var n=Freedo.clone(r,!0);return this._pathsOpts[e].list[t]=n,!0},u.prototype.getPathPoint=function(e,t){if(void 0===this._pathsOpts[e])throw new Error("getPath error");if(void 0===this._pathsOpts[e].list[t])return new Error("getPath error");var r=this._pathsOpts[e].list[t];return Freedo.clone(r,!0)},u.prototype.flyTo=function(e,t){if(void 0===this._pathsOpts[e])return!1;if(void 0===this._pathsOpts[e].list[t])return!1;var r=this._pathsOpts[e].list[t],n=this._pa.getTotalLength();new Freedo.BoundingSphere(Freedo.FdMisc.FdGeometric.tc(r.position),n/400);return!0},u.prototype.goto=function(e,t){return void 0!==this._pathsOpts[e]&&(void 0!==this._pathsOpts[e].list[t]&&void 0!==this._pathsOpts[e].list[t].cameraInfo)},u.prototype.start=function(){this._pa.start()},u.prototype.pause=function(){this._pa.pause()},u.prototype.stop=function(){this._pa.stop()},u.prototype.getGroupPlayingStatus=function(){},u.prototype.getGroupPlayingGroupID=function(){return this._currentPlayingGroupID},u.prototype.setCurrentGroupID=function(e){this._currentGroupID=e,this.reloadPA(e)},u.prototype.startEdit=function(e){this._currentGroupID=e;var t=this._pathsOpts[this._currentGroupID].list,r=[];for(var n in t){var i=a.FdMisc.FdGeometric.tc(t[n].position);r.push(i)}this._ple.startEdit(r)},u.prototype.editPre=function(){this._ple.editPre()},u.prototype.editNext=function(){this._ple.editNext()},u.prototype.endEdit=function(){this._ple.endEdit()},u.prototype.reloadPA=function(e){e||(e=this._currentGroupID);var t=this._pathsOpts[e];if(void 0===t)throw new Error("getPath error");if(void 0===t.list)return new Error("getPath error");var r=[];for(var n in t.list)r.push(t.list[n].position);this._pa.setPoints(r)},u.prototype.setPathShow=function(e){this._pa.setPathShow(e)},u.prototype.setLoop=function(e){this._pa.setLoop(e)},u.prototype.setKBStatus=function(e){e?this._pa.enable():this._pa.disable()},u.prototype.getPitch=function(){return this._pa.getPitch()},u.prototype.setPitch=function(e){this._pa.setPitch(e)},u.prototype.setPathViewMode=function(e){this._pa.setPathViewMode(e)},u.prototype.getSpeed=function(){this._pa.getSpeed()},u.prototype.setSpeed=function(e){this._pa.setSpeed(e)},u.prototype.setSmoothRate=function(e){this._pa.setSmoothRate(e)},u.prototype.getHeight=function(){return this._pa.getHeight()},u.prototype.setHeight=function(e){this._pa.setHeight(e)},u.prototype.setHeading=function(e){this._pa.setHeading(e)},u.prototype.setNearRate=function(e){this._pa.setNearRate(e)},u.prototype.setOffsetH=function(e){this._pa.setOffsetH(e)},u.prototype.getData=function(){return Freedo.clone(this._pathsOpts,!0)},u.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},u.prototype.reset=function(){this.removeAllGroups(),this._pa.reset(),this._lsner&&(this._lsner(),this._lsner=void 0)},u.prototype.dispose=function(){this.reset(),this._eventHelper.removeAll()},t.FdPathsManager=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdDrawRoad=void 0;var n=s(r(1)),i=s(r(6)),o=r(72),a=(r(11),r(25));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._scene=this._viewer.scene,this._roads=[],this._centerLines=[],this._roadsOptions=[],this._lsner=void 0,this._ple=new a.FdPolylineEditor(t),this._ple.setAutoLoop(!1),this._ple.setAutoDelLines(!0),this._handler=void 0,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._level=void 0,this._smoothRate=5,this._nearRate=4,this._hideCenterLine=!0,this._currentId=void 0}return(0,i.default)(e,[{key:"roadsOptions",get:function(){return this._roadsOptions},set:function(e){if(Freedo.defined(e))for(var t in this.clearRoads(),e)this.addRoad(e[t].id,e[t].pts,e[t].level,e[t].width)}}]),e}();c.prototype.start=function(e){Freedo.defined(e)?(this._ple.run(),this._level=e,this.addLsnr(),this._event.raiseEvent("Start",{})):console.error("start：参数level无效")},c.prototype.addLsnr=function(){this._lsner&&this._lsner();var e=this;this._lsner=this._ple.on(function(t,r){if("PLAdd"==t&&e.onPLAdd(r),"EditEnd"==t){for(var n in e._roadsOptions)e._currentId==e._roadsOptions[n].id&&(e._roadsOptions[n].pts=Freedo.clone(r.pts));e.reDraw()}})},c.prototype.onPLAdd=function(e){this.addRoad(void 0,e.polyline.pts,this._level,5)},c.prototype.addRoad=function(e,t,r,n){Freedo.defined(e)||(e=Freedo.createGuid());for(var i=this.getRoadUrlByLevel(r),o=[],a=Freedo.Math.toDegrees,s=0;s<t.length;s++){var c=Freedo.Cartographic.fromCartesian(t[s]);o.push({lon:a(c.longitude),lat:a(c.latitude),height:c.height+3})}var u=this.drawRoad(o,n,i);if(!this._hideCenterLine){var l=this._viewer.scene.primitives.add(this.createLinePrimitive(t));this._centerLines.push(l)}this._viewer.scene.requestRender(),this._roads.push(u);var h={id:e,pts:t,level:r,width:n};this._roadsOptions.push(h),this._event.raiseEvent("RoadAdd",{}),this._event.raiseEvent("DataChanged",h)},c.prototype.TransfPointToCartesian3=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=FreeDo.Cartesian3.fromDegrees(e[r].lon,e[r].lat,e[r].height);return t};var u=new FreeDo.Cartesian3;c.prototype.TransfCartesian3ToSelf=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=new Freedo.Cartesian3(e[r].x-u.x,e[r].y-u.y,e[r].z-u.z);return t},c.prototype.getPointArray=function(e,t,r){var n=new FreeDo.Cartesian3,i=new FreeDo.Cartesian3,o=new FreeDo.Cartesian3,a=new FreeDo.Cartesian3,s=new FreeDo.Cartesian3,c=new FreeDo.Cartesian3,u=new FreeDo.Cartesian3,l=(new FreeDo.Cartesian3,new FreeDo.Cartesian3),h=new FreeDo.Cartesian3,d=null,p=null,f=[];switch(t.length){case 0:case 1:break;case 2:FreeDo.Cartesian3.subtract(t[1],t[0],n),FreeDo.Cartesian3.cross(e[0],n,o),FreeDo.Cartesian3.cross(n,e[0],a),FreeDo.Cartesian3.normalize(o,s),FreeDo.Cartesian3.normalize(a,c),s.x=s.x*r,s.y=s.y*r,s.z=s.z*r,c.x=c.x*r,c.y=c.y*r,c.z=c.z*r,FreeDo.Cartesian3.add(t[0],s,l),FreeDo.Cartesian3.add(t[0],c,h),f.push(new FreeDo.Cartesian3(l.x,l.y,l.z)),f.push(new FreeDo.Cartesian3(h.x,h.y,h.z)),FreeDo.Cartesian3.add(t[1],s,l),FreeDo.Cartesian3.add(t[1],c,h),f.push(new FreeDo.Cartesian3(l.x,l.y,l.z)),f.push(new FreeDo.Cartesian3(h.x,h.y,h.z));break;default:for(var v=1;v<t.length-1;v++)FreeDo.Cartesian3.subtract(t[v],t[v-1],n),FreeDo.Cartesian3.subtract(t[v+1],t[v],i),0==FreeDo.Cartesian3.angleBetween(n,i)&&t.splice(v--,1);for(var _=0;_<t.length;_++)0==_?(FreeDo.Cartesian3.subtract(t[_+1],t[_],n),FreeDo.Cartesian3.cross(e[_],n,o),FreeDo.Cartesian3.cross(n,e[_],a),FreeDo.Cartesian3.normalize(o,s),FreeDo.Cartesian3.normalize(a,c),s.x=s.x*r,s.y=s.y*r,s.z=s.z*r,c.x=c.x*r,c.y=c.y*r,c.z=c.z*r,FreeDo.Cartesian3.add(t[_],s,l),FreeDo.Cartesian3.add(t[_],c,h),f.push(new FreeDo.Cartesian3(l.x,l.y,l.z)),f.push(new FreeDo.Cartesian3(h.x,h.y,h.z))):_==t.length-1?(FreeDo.Cartesian3.subtract(t[_],t[_-1],n),FreeDo.Cartesian3.cross(e[_],n,o),FreeDo.Cartesian3.cross(n,e[_],a),FreeDo.Cartesian3.normalize(o,s),FreeDo.Cartesian3.normalize(a,c),s.x=s.x*r,s.y=s.y*r,s.z=s.z*r,c.x=c.x*r,c.y=c.y*r,c.z=c.z*r,FreeDo.Cartesian3.add(t[_],s,l),FreeDo.Cartesian3.add(t[_],c,h),f.push(new FreeDo.Cartesian3(l.x,l.y,l.z)),f.push(new FreeDo.Cartesian3(h.x,h.y,h.z))):(FreeDo.Cartesian3.subtract(t[_-1],t[_],n),FreeDo.Cartesian3.subtract(t[_+1],t[_],i),p=FreeDo.Cartesian3.angleBetween(n,i)/2,d=r/Math.sin(p),FreeDo.Cartesian3.subtract(t[_+1],t[_],n),FreeDo.Cartesian3.subtract(t[_],t[_-1],i),FreeDo.Cartesian3.normalize(n,n),FreeDo.Cartesian3.normalize(i,i),FreeDo.Cartesian3.add(n,i,u),FreeDo.Cartesian3.cross(e[_],u,o),FreeDo.Cartesian3.normalize(o,s),s.x=s.x*d,s.y=s.y*d,s.z=s.z*d,FreeDo.Cartesian3.add(t[_],s,l),FreeDo.Cartesian3.cross(u,e[_],a),FreeDo.Cartesian3.normalize(a,c),c.x=c.x*d,c.y=c.y*d,c.z=c.z*d,FreeDo.Cartesian3.add(t[_],c,h),f.push(new FreeDo.Cartesian3(l.x,l.y,l.z)),f.push(new FreeDo.Cartesian3(h.x,h.y,h.z)))}return f},c.prototype.getRoadUrlByLevel=function(e){return"一级"==e?Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road1.jpg":"二级"==e?Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road2.jpg":"三级"==e?Freedo.FdApp.getFreedoXPath()+"Assets/Textures/road/road3.jpg":null},c.prototype.calcCP=function(e,t,r){var n,i,o;n=e.position,i=t.position,o=r.position;var a=FreeDo.Cartesian3.subtract(n,i,new FreeDo.Cartesian3),s=FreeDo.Cartesian3.subtract(o,i,new FreeDo.Cartesian3),c=FreeDo.Cartesian3.cross(a,s,new FreeDo.Cartesian3),u=FreeDo.Cartesian3.normalize(a,new FreeDo.Cartesian3),l=FreeDo.Cartesian3.normalize(s,new FreeDo.Cartesian3),h=FreeDo.Cartesian3.add(u,l,new FreeDo.Cartesian3),d=Freedo.Quaternion.fromAxisAngle(c,Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),p=Freedo.Quaternion.fromAxisAngle(c,-1*Freedo.Math.PI_OVER_TWO,new Freedo.Quaternion),f=Freedo.Matrix3.fromQuaternion(d,new Freedo.Matrix3),v=Freedo.Matrix3.fromQuaternion(p,new Freedo.Matrix3),_=Freedo.Matrix3.multiplyByVector(f,h,new Freedo.Cartesian3),y=Freedo.Matrix3.multiplyByVector(v,h,new Freedo.Cartesian3),m=FreeDo.Cartesian3.normalize(_,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.normalize(y,new FreeDo.Cartesian3),F=FreeDo.Cartesian3.distance(n,i),w=FreeDo.Cartesian3.distance(o,i),C=1;C=F<w?F/this._nearRate:w/this._nearRate,m=FreeDo.Cartesian3.multiplyByScalar(m,C,new FreeDo.Cartesian3),g=FreeDo.Cartesian3.multiplyByScalar(g,C,new FreeDo.Cartesian3);var b=FreeDo.Cartesian3.add(i,m,new FreeDo.Cartesian3),P=FreeDo.Cartesian3.add(i,g,new FreeDo.Cartesian3);return FreeDo.Cartesian3.distance(n,b)<FreeDo.Cartesian3.distance(n,P)?[b,P]:[P,b]},c.prototype.smoothPolyline=function(e){var t=[];if(e.length<3)for(var r=0;r<e.length;r++)t.push(e[r].position);else for(r=0;r<=e.length-2;r++){var n={},i={},a={},s={};0==r?(n=e[0],i.position=this.calcCP(e[0],e[1],e[2])[0],a=e[0],s=e[1]):r==e.length-2?(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i=e[r+1],a=e[r],s=e[r+1]):(n.position=this.calcCP(e[r-1],e[r],e[r+1])[1],i.position=this.calcCP(e[r],e[r+1],e[r+2])[0],a=e[r],s=e[r+1]);var c=new o.FdBezierCurveAlgorithm(a,s,n,i).getVertexForCurve(this._smoothRate);t=t.concat(c)}var u=[];for(r=0;r<t.length;r++){var l;if(l=t[r],u.length>0)FreeDo.Cartesian3.distance(u[u.length-1],l)>1e-4&&u.push(l);else u.push(l)}return u},c.prototype.drawRoad=function(e,t,r){for(var n=this.TransfPointToCartesian3(e),i=[],o=0;o<n.length;o++)i[o]={position:n[o]};n=this.smoothPolyline(i),u.x=n[0].x,u.y=n[0].y,u.z=n[0].z;for(var a=this.TransfCartesian3ToSelf(n),s=this.getPointArray(n,a,t),c=s,l=[],h=0;h<e.length;h++)l[h]={lon:e[h].lon,lat:e[h].lat,height:e[h].height-3};var d=t+4,p=this.TransfPointToCartesian3(l);i=[];for(var f=0;f<p.length;f++)i[f]={position:p[f]};p=this.smoothPolyline(i);for(var v=this.TransfCartesian3ToSelf(p),_=this.getPointArray(p,v,d),y=[],m=0;m<_.length;m++)m%2==0?(y.push(_[m].x),y.push(_[m].y),y.push(_[m].z),y.push(c[m].x),y.push(c[m].y),y.push(c[m].z)):(y.push(c[m].x),y.push(c[m].y),y.push(c[m].z),y.push(_[m].x),y.push(_[m].y),y.push(_[m].z));var g=new Float64Array(y),F=[],w=0;F.push(w,0),F.push(w,.1),F.push(w,.9),F.push(w,.99);for(var C=s.length/2-1,b=2*t+2*Math.sqrt(25),P=0;P<C;P++)w+=(FreeDo.Cartesian3.distance(c[2*P+2],c[2*P])/b+FreeDo.Cartesian3.distance(c[2*P+3],c[2*P+1])/b)/2,F.push(w,0),F.push(w,.1),F.push(w,.9),F.push(w,.99);for(var M=new Float32Array(F),x=[],S=4*(s.length/2-2)+2,T=0;T<=S;T++)(T-3)%4!=0&&(x.push(T+0),x.push(T+4),x.push(T+5),x.push(T+5),x.push(T+1),x.push(T+0));for(var E=new Uint16Array(x),D=[],A=0;A<n.length;A++)D.push(n[A].x),D.push(n[A].y),D.push(n[A].z);var O=FreeDo.BoundingSphere.fromVertices(D),k=new FreeDo.Geometry({attributes:{position:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:g}),st:new FreeDo.GeometryAttribute({componentDatatype:FreeDo.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:M})},indices:E,primitiveType:FreeDo.PrimitiveType.TRIANGLES,boundingSphere:FreeDo.BoundingSphere.fromVertices(g)}),L=new FreeDo.GeometryInstance({geometry:k,modelMatrix:new FreeDo.Matrix4(1,0,0,u.x,0,1,0,u.y,0,0,1,u.z,0,0,0,1),attributes:{color:FreeDo.ColorGeometryInstanceAttribute.fromColor(FreeDo.Color.RED)},id:"trangle"});return{primitive:this._viewer.scene.primitives.add(new FreeDo.Primitive({geometryInstances:L,appearance:new FreeDo.MaterialAppearance({material:new FreeDo.Material({fabric:{type:"Image",uniforms:{image:r}}})})})),boundingsphere:O}},c.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})},c.prototype.cancel=function(){this.reset(),this._event.raiseEvent("Cancel",{})},c.prototype.setSmoothRate=function(e){this._smoothRate=e,this.reDraw()},c.prototype.setNearRate=function(e){this._nearRate=e,this.reDraw()},c.prototype.setCenterLineHide=function(e){this._hideCenterLine=e,this.reDraw()},c.prototype.reDraw=function(){var e=Freedo.clone(this.roadsOptions,!0);for(var t in this.clearRoads(),this._data=[],e)this.addRoad(e[t].id,e[t].pts,e[t].level,e[t].width)},c.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},c.prototype.startEdit=function(e){for(var t in this.addLsnr(),this._roadsOptions)this._roadsOptions[t].id==e&&(this._currentId=e,this._ple.startEdit(this._roadsOptions[t].pts))},c.prototype.editPre=function(){this._ple.editPre()},c.prototype.editNext=function(){this._ple.editNext()},c.prototype.endEdit=function(){this._ple.endEdit()},c.prototype.clearRoads=function(){for(var e in this._roads)this._viewer.scene.primitives.remove(this._roads[e].primitive);for(var e in this._centerLines)this._viewer.scene.primitives.remove(this._centerLines[e]);this._viewer.scene.requestRender(),this._roads=[],this._roadsOptions=[],this._centerLines=[]},c.prototype.getData=function(){return Freedo.clone(this._roadsOptions,!0)},c.prototype.removeAll=function(){this.clearRoads()},c.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel()},c.prototype.dispose=function(){this.reset(),this.clearRoads()},t.FdDrawRoad=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdAnalysisHeight=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(11);var a=function e(t){(0,o.default)(this,e),this._viewer=t,this._data=[],this._points=[],this._labels=[],this._vLines=[],this._bInSurvey=!1,this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._tmpPoint=void 0,this._tmpPosition=void 0,this._tmpLabel=void 0,this._tmpVLine=void 0};a.prototype.addPoint=function(e){var t=Freedo.FdMisc.FdGeometric.tc(e);Freedo.defined(this._viewer.scene.globe)||(t={x:e[0],y:e[1],z:e[2]});var r,n=this._viewer.entities.add({position:t,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0}}),i=Freedo.FdMisc.FdMath.round;if(r=this._viewer.scene.globe?this.createLabel(t,"高度："+i(e[2],4)):this.createLabel(t,"X："+i(e[0],8)+"\nY："+i(e[1],8)+"\nZ："+i(e[2],4)),this._viewer.scene.globe){var o=Freedo.FdMisc.FdGeometric.tc([e[0],e[1],0]),a=this._viewer.scene.primitives.add(this.createLinePrimitive([t,o]));this._vLines.push(a)}this._labels.push(r),this._points.push(n);var s={};s.pointG=[i(e[0],8),i(e[1],8),i(e[2],8)],s.pointC=t,this._data.push(s),this._event.raiseEvent("HeightPoint",{point:e}),this._event.raiseEvent("DataChanged",s),this._viewer.scene.requestRender()},a.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:2,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,0,0,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.5,.5,.5)}}})})})},a.prototype.callbackPosition=function(){return this._viewer.scene.requestRender(),Freedo.FdMisc.FdGeometric.tc(this._tmpPosition)},a.prototype.callbackPositionHalf=function(){return this._viewer.scene.requestRender(),Freedo.FdMisc.FdGeometric.tc(this._tmpPosition)},a.prototype.callbackVLine=function(){this._viewer.scene.requestRender();var e=Freedo.clone(this._tmpPosition,!0);return e[2]=0,[Freedo.FdMisc.FdGeometric.tc(this._tmpPosition),Freedo.FdMisc.FdGeometric.tc(e)]},a.prototype.callbackVLineText=function(){return this._viewer.scene.requestRender(),"高程："+(0,Freedo.FdMisc.FdMath.round)(this._tmpPosition[2],2)},a.prototype.updateTmpPoint=function(){if(void 0==this._tmpPoint){var e=new Freedo.CallbackProperty(this.callbackPosition.bind(this),!1);this._tmpPoint=this._viewer.entities.add({position:e,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0}})}if(void 0==this._tmpLabel){var t=new Freedo.CallbackProperty(this.callbackPositionHalf.bind(this),!1),r=new Freedo.CallbackProperty(this.callbackVLineText.bind(this),!1);this._tmpLabel=this._viewer.entities.add({position:t,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:r,show:!0,showBackground:!0,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(10,-10),disableDepthTestDistance:Number.POSITIVE_INFINITY}})}if(void 0==this._tmpVLine){e=new Freedo.CallbackProperty(this.callbackVLine.bind(this),!1);this._tmpVLine=this._viewer.entities.add({polyline:{positions:e,width:2,material:Freedo.Color.RED,depthFailMaterial:Freedo.Color.RED}})}this._viewer.scene.requestRender()},a.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:!0,showBackground:!0,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})},a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.handleLeftClick=function(e){0!=this._bInSurvey&&this._tmpPosition&&this.addPoint(this._tmpPosition)},a.prototype.handleMouseMove=function(e){if(0!=this._bInSurvey){var t=e.endPosition;t.x-=0,t.x-=0;var r=Freedo.FdMisc.FdGeometric.pickPositionG(this._viewer,t);r&&(this._tmpPosition=r),this.updateTmpPoint()}},a.prototype.getData=function(){return{height:Freedo.clone(this._data,!0)}},a.prototype.setData=function(e){for(var t in e)this.addPoint(e[t].pointG)},a.prototype.run=function(e){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK),this._hanlder.setInputAction(this.handleMouseMove.bind(this),Freedo.ScreenSpaceEventType.MOUSE_MOVE),this._bInSurvey=!0},a.prototype.delTmpEntities=function(){this._viewer.entities.remove(this._tmpLabel),this._viewer.entities.remove(this._tmpPoint),this._viewer.entities.remove(this._tmpVLine),this._tmpPoint=void 0,this._tmpPosition=void 0,this._tmpLabel=void 0,this._tmpVLine=void 0,this._viewer.scene.requestRender()},a.prototype.reset=function(){this._bInSurvey=!1,this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK),this.delTmpEntities()},a.prototype.removeAll=function(){for(var e in this._points)this._viewer.entities.remove(this._points[e]);for(var e in this._labels)this._viewer.entities.remove(this._labels[e]);for(var e in this._vLines)this._viewer.scene.primitives.remove(this._vLines[e]);this._points=[],this._data=[],this.delTmpEntities()},a.prototype.dispose=function(){this.reset(),this.removeAll()},t.FdAnalysisHeight=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTransformManipulator=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(11);var a=function e(t){(0,o.default)(this,e),this._viewer=t,this._bInTransform=!1,this._transType="MOVE",this._bInRun=!1,this._xAxisPL=void 0,this._yAxisPL=void 0,this._zAxisPL=void 0,this._XYPlane=void 0,this._YZPlane=void 0,this._XZPlane=void 0,this._XYCircle=void 0,this._XZCircle=void 0,this._YZCircle=void 0,this._basePt=void 0,this._basePtOriPosition=void 0,this._basePtOri=void 0,this._selectedAxis="",this._mouseDownPos=void 0,this._initSphere=void 0,this._useDepthPicking=!0,this._pickTranslucentDepth=!0,this._fixedAxis="",this._DISPERRAD=111e3,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._oldPt=void 0,this._started=!1,this._mouseDown=!1,this._lastDis=-1,this._alpha=.5,this._axisZoom=1,this._axisSize=4,this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3},this._handler=void 0,this._mouseDownXY=void 0,this._xPts=void 0};a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.startTransform=function(e){this._transType=e,this._bInTransform||(this._bInTransform=!0,this.addListeners(),this._bInRun=!0)},a.prototype.start=function(e){this.startTransform(e)},a.prototype.createLinePrimitive=function(e){return new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:new Freedo.PolylineGeometry({positions:e,width:6,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT})}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineArrow",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-100,units:-100},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",width:1,uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})},a.prototype.redraw=function(){this.calcAxisZoom()},a.prototype.updateSceneSphere=function(e){this._initSphere=FreeDo.clone(e,!0),void 0===this._xAxisPL&&this.showAxis()},a.prototype.updatePosition=function(e,t,r){var n=Freedo.Cartesian3.fromDegrees(e,t,r);this._initSphere={center:n},void 0===this._xAxisPL&&this.showAxis()},a.prototype.updateBasePt=function(e,t,r){this._basePtOriPosition=Freedo.Cartesian3.fromDegrees(e,t,r)},a.prototype.cancelTransform=function(){this.reset()},a.prototype.cancel=function(){this.reset()},a.prototype.addListeners=function(){this._handler=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._handler.setInputAction(this.onLeftDown.bind(this),FreeDo.ScreenSpaceEventType.LEFT_DOWN),this._handler.setInputAction(this.onMouseMove.bind(this),FreeDo.ScreenSpaceEventType.MOUSE_MOVE),this._handler.setInputAction(this.onLeftUp.bind(this),FreeDo.ScreenSpaceEventType.LEFT_UP),this._handler.setInputAction(this.onWheel.bind(this),FreeDo.ScreenSpaceEventType.WHEEL),this._handler.setInputAction(this.onClick.bind(this),FreeDo.ScreenSpaceEventType.LEFT_CLICK);this._viewer.scene.camera.changed.addEventListener(a.prototype.onWheel,this),window.addEventListener("keydown",this.onKeyDown.bind(this))},a.prototype.calcFixedAxis=function(){"X_AXIS"!==this._selectedAxis?"Y_AXIS"!==this._selectedAxis?"Z_AXIS"!==this._selectedAxis||(this._fixedAxis="Z"):this._fixedAxis="Y":this._fixedAxis="X"},a.prototype.calcAxisZoom=function(){if(!1!==this._bInTransform){if(this._initSphere){var e,t=this._initSphere.center,r=this._viewer.camera.positionWC;e=Freedo.Cartesian3.distance(t,r)/this._axisSize,this._axisZoom=e,this._viewer.scene._mode===Freedo.SceneMode.COLUMBUS_VIEW&&(this._axisZoom=this._viewer.camera.positionWC.x/3),this._axisZoom>4e5&&(this._axisZoom=4e5)}}else this._axisZoom=1},a.prototype.setAxisSize=function(e){this._axisSize=e},a.prototype.onWheel=function(){!1!==this._bInTransform&&this.calcAxisZoom()},a.prototype.onKeyDown=function(){!1!==this._bInTransform&&27===window.event.keyCode&&""!==this._selectedAxis&&(this._event.raiseEvent("OnKeyDown",{keyCode:window.event.keyCode}),this._selectedAxis="",this.onLeftUp())},a.prototype.onMouseMove=function(e){if(""!=this._selectedAxis){var t=void 0;return"XY_QCIRCLE"!==this._selectedAxis&&"XY_CIRCLE"!==this._selectedAxis&&"X_AXIS"!==this._selectedAxis&&"Y_AXIS"!==this._selectedAxis&&"Z_AXIS"!==this._selectedAxis||(t=this.pickPositionOnEllipsoid(e.endPosition)),"YZ"!==this._selectedAxis&&"YZ_CIRCLE"!==this._selectedAxis||(t=this.pickPositionOnPlane(e.endPosition,"YZ")),"XZ"!==this._selectedAxis&&"XZ_CIRCLE"!==this._selectedAxis||(t=this.pickPositionOnPlane(e.endPosition,"XZ")),void this._event.raiseEvent("Transforming",{MouseDownPos:this._mouseDownPos,MouseMovePos:t,MouseDownXY:this._mouseDownXY,MouseMoveXY:e.endPosition,SelectedAxis:this._selectedAxis,FixedAxis:this._fixedAxis})}},a.prototype.onClick=function(e){var t=this.pickPosition(e.position);this._event.raiseEvent("GotoPoint",t)},a.prototype.onLeftDown=function(e){if(this._bInTransform){this._mouseDown=!0,this._oldPt=void 0,this._started=!1,this._lastDis=-1;var t=this._viewer.scene.pick(e.position);if(FreeDo.defined(t)){if(FreeDo.defined(t.id)&&FreeDo.defined(t.id._name)){var r=t.id._name;("X_AXIS"===r||"Y_AXIS"===r||"Z_AXIS"===r)&&this._transType.indexOf("MOVE")>=0&&(t.id.polyline.material.color=new Freedo.Color(1,1,0,1)),"YZ"!==r&&"XZ"!==r||(t.id.wall.material.color=new Freedo.Color(1,0,0,.2)),"XY_QCIRCLE"===r&&(t.id.polygon.material.color=new Freedo.Color(1,1,0,1)),"XY_CIRCLE"!==r&&"YZ_CIRCLE"!==r&&"XZ_CIRCLE"!==r||(t.id.polyline.material.color=new Freedo.Color(1,1,0,1)),"XY_CIRCLE"!==r&&"XZ_CIRCLE"!==r&&"YZ_CIRCLE"!==r&&"XY_QCIRCLE"!==r&&"XZ"!==r&&"YZ"!==r&&"X_AXIS"!==r&&"Y_AXIS"!==r&&"Z_AXIS"!==r||(this._selectedAxis=FreeDo.clone(r,!0),this._viewer.scene.screenSpaceCameraController.enableRotate=!1,this._viewer.scene.screenSpaceCameraController.enableLook=!1,this._mouseDownPos=void 0,this._event.raiseEvent("Transform",{}))}"XY_QCIRCLE"!==this._selectedAxis&&"XY_CIRCLE"!==this._selectedAxis&&"X_AXIS"!==this._selectedAxis&&"Y_AXIS"!==this._selectedAxis||(this._mouseDownPos=this.pickPositionOnEllipsoid(e.position),this._transType.indexOf("MOVE")>=0&&this.calcFixedAxis()),"YZ"!==this._selectedAxis&&"YZ_CIRCLE"!==this._selectedAxis||(this._mouseDownPos=this.pickPositionOnPlane(e.position,"YZ"),this._transType.indexOf("MOVE")>=0&&this.calcFixedAxis()),"XZ"!==this._selectedAxis&&"Z_AXIS"!==this._selectedAxis&&"XZ_CIRCLE"!==this._selectedAxis||(this._mouseDownPos=this.pickPositionOnPlane(e.position,"XZ"),this._transType.indexOf("MOVE")>=0&&this.calcFixedAxis()),"X"===this._fixedAxis&&(this._xAxisPL.polyline.material.color=FreeDo.Color.YELLOW),"Y"===this._fixedAxis&&(this._yAxisPL.polyline.material.color=FreeDo.Color.YELLOW),"Z"===this._fixedAxis&&(this._zAxisPL.polyline.material.color=FreeDo.Color.YELLOW),this._mouseDownXY=e.position}}},a.prototype.backToEnableRotate=function(e){""===this._selectedAxis&&(this._viewer.scene.screenSpaceCameraController.enableRotate=!0,this._viewer.scene.screenSpaceCameraController.enableLook=!0)},a.prototype.onLeftUp=function(e){setTimeout(this.backToEnableRotate.bind(this),500),this._mouseDownPos=void 0,this._mouseDown=!1,"XY_QCIRCLE"===this._selectedAxis&&(this._XYPlane.polygon.material.color=new Freedo.Color(0,0,1,this._alpha)),"XZ"===this._selectedAxis&&(this._XZPlane.wall.material.color=new Freedo.Color(1,0,1,this._alpha)),"YZ"===this._selectedAxis&&(this._YZPlane.wall.material.color=new Freedo.Color(0,1,1,this._alpha)),"XY_CIRCLE"===this._selectedAxis&&(this._XYCircle.polyline.material.color=new Freedo.Color(0,0,1,this._alpha)),"XZ_CIRCLE"===this._selectedAxis&&(this._XZCircle.polyline.material.color=new Freedo.Color(0,1,0,this._alpha)),"YZ_CIRCLE"===this._selectedAxis&&(this._YZCircle.polyline.material.color=new Freedo.Color(1,0,0,this._alpha)),"X"===this._fixedAxis&&(this._xAxisPL.polyline.material.color=FreeDo.Color.RED),"Y"===this._fixedAxis&&(this._yAxisPL.polyline.material.color=FreeDo.Color.GREEN),"Z"===this._fixedAxis&&(this._zAxisPL.polyline.material.color=FreeDo.Color.BLUE),""!==this._selectedAxis&&this._event.raiseEvent("Transformed",{}),this.calcAxisZoom(),this._selectedAxis="",this._fixedAxis=""},a.prototype.clearAxis2=function(){void 0!=this._xAxisPL&&(this._viewer.entities.remove(this._basePt),this._viewer.entities.remove(this._basePtOri),this._viewer.scene.primitives.remove(this._xAxisPL),this._viewer.scene.primitives.remove(this._yAxisPL),this._viewer.scene.primitives.remove(this._zAxisPL),this._viewer.entities.remove(this._XZPlane),this._viewer.entities.remove(this._YZPlane),this._viewer.entities.remove(this._XYPlane),this._viewer.entities.remove(this._XYCircle),this._viewer.entities.remove(this._XZCircle),this._viewer.entities.remove(this._YZCircle)),this._basePt=void 0,this._basePtOri=void 0,this._xAxisPL=void 0,this._yAxisPL=void 0,this._zAxisPL=void 0,this._XZPlane=void 0,this._YZPlane=void 0,this._XYPlane=void 0,this._XYCircle=void 0,this._XZCircle=void 0,this._YZCircle=void 0,this._selectedAxis=""},a.prototype.clearAxis=function(){void 0!=this._xAxisPL&&(this._viewer.entities.remove(this._basePt),this._viewer.entities.remove(this._basePtOri),this._viewer.entities.remove(this._xAxisPL),this._viewer.entities.remove(this._yAxisPL),this._viewer.entities.remove(this._zAxisPL),this._viewer.entities.remove(this._XZPlane),this._viewer.entities.remove(this._YZPlane),this._viewer.entities.remove(this._XYPlane),this._viewer.entities.remove(this._XYCircle),this._viewer.entities.remove(this._XZCircle),this._viewer.entities.remove(this._YZCircle)),this._basePt=void 0,this._basePtOri=void 0,this._xAxisPL=void 0,this._yAxisPL=void 0,this._zAxisPL=void 0,this._XZPlane=void 0,this._YZPlane=void 0,this._XYPlane=void 0,this._XYCircle=void 0,this._XZCircle=void 0,this._YZCircle=void 0,this._selectedAxis=""};var s=void 0,c=void 0,u=void 0,l=void 0,h=void 0,d=void 0;a.prototype.calcCallbackArgs=function(){s=this._initSphere.center,u=Freedo.Cartographic.fromCartesian(s),l=Freedo.Math.toDegrees(u.longitude),h=Freedo.Math.toDegrees(u.latitude),d=u.height,c=this._axisZoom,this._viewer.scene.requestRender()},a.prototype.pickPositionOnEllipsoid=function(e){var t=Freedo.Cartographic.fromCartesian(this._initSphere.center),r=Freedo.clone(Freedo.Ellipsoid.WGS84,!0);r.radii.x+=t.height,r.radii.y+=t.height,r.radii.z+=t.height;var n=new Freedo.Ellipsoid(r.radii.x,r.radii.y,r.radii.z),i=this._viewer.camera.pickEllipsoid(e,n,new Freedo.Cartesian3);if(void 0!==i)return Freedo.Cartographic.fromCartesian(i)},a.prototype.pickPositionOnPlane=function(e,t){this.calcCallbackArgs();var r=1e-5*this._axisZoom,n=Freedo.Cartesian3.fromRadians(u.longitude-r,u.latitude,-2e3),i=Freedo.Cartesian3.fromRadians(u.longitude,u.latitude,u.height+.95*c+1e3),o=Freedo.Cartesian3.fromRadians(u.longitude+r,u.latitude,-2e3);"YZ"===t&&(n=Freedo.Cartesian3.fromRadians(u.longitude,u.latitude-r,-2e3),i=Freedo.Cartesian3.fromRadians(u.longitude,u.latitude,u.height+.95*c+1e3),o=Freedo.Cartesian3.fromRadians(u.longitude,u.latitude+r,-2e3));var a,s,l=this._viewer.camera.getPickRay(e),h=Freedo.Cartographic.fromCartesian(this._initSphere.center);a=Math.cos(h.longitude),s=Math.sin(h.longitude);new Freedo.Plane.fromPointNormal(new Freedo.Cartesian3(0,0,0),new Freedo.Cartesian3(a,s,0));var d={};d.x=l.origin.x+1e6*l.direction.x,d.y=l.origin.y+1e6*l.direction.y,d.z=l.origin.z+1e6*l.direction.z;var p=Freedo.IntersectionTests.lineSegmentTriangle(l.origin,d,n,i,o);if(void 0!==p)return Freedo.Cartographic.fromCartesian(p)},a.prototype.pickPosition=function(e){var t,r=this.PositionType.NONE;if(this._viewer.scene.pickPositionSupported){var n=this._viewer.scene.drillPick(e);if(Freedo.defined(n)&&n.length>0)for(var i=0;i<n.length;++i)if(n[i]instanceof Freedo.FreedoPModelFeature&&(t=this._viewer.scene.pickPosition(e),Freedo.defined(t))){r=this.PositionType.ON_MODEL;break}}if(r===this.PositionType.NONE){if(this._useDepthPicking=FreeDo.clone(this._viewer.scene.useDepthPicking,!0),this._pickTranslucentDepth=FreeDo.clone(this._viewer.scene.pickTranslucentDepth,!0),this._viewer.scene.pickPositionSupported){t=this._viewer.scene.pickPosition(e,new Freedo.Cartesian3);Freedo.Cartographic.fromCartesian(t);Freedo.defined(t)&&(r=this.PositionType.ON_TERRAIN)}this._viewer.scene.useDepthPicking=FreeDo.clone(this._useDepthPicking,!0),this._viewer.scene.pickTranslucentDepth=FreeDo.clone(this._pickTranslucentDepth,!0)}return r===this.PositionType.NONE&&(t=this._viewer.camera.pickEllipsoid(e,this._viewer.scene.globe.ellipsoid),Freedo.defined(t)&&(r=this.PositionType.ON_ELLIPSOID)),{type:r,position:t}},a.prototype.callbackXY=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),n=FreeDo.Math.toDegrees(.5*c*r[0]),i=FreeDo.Math.toDegrees(.5*c*r[1]);return Freedo.Cartesian3.fromDegreesArray([l,h,l+n,h,l+n,h+i,l,h+i,l,h])},a.prototype.callbackQXY=function(e,t){this.calcCallbackArgs();var r=[],n=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),i=FreeDo.Math.toDegrees(.55*c*n[0]),o=FreeDo.Math.toDegrees(.55*c*n[1]);r.push(Freedo.Cartesian3.fromRadians(u.longitude,u.latitude,u.height));for(var a=0;a<=Math.PI/2;a+=.001){var s=l+i*Math.cos(a),p=h+o*Math.sin(a),f=Freedo.Cartesian3.fromDegrees(s,p,d);r.push(f)}return r},a.prototype.callbackXYHalfCircle=function(e,t){this.calcCallbackArgs();for(var r=[],n=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),i=FreeDo.Math.toDegrees(.65*c*n[0]),o=FreeDo.Math.toDegrees(.65*c*n[1]),a=0;a<=Math.PI/2;a+=.001){var s=l+i*Math.cos(a),p=h+o*Math.sin(a),f=Freedo.Cartesian3.fromDegrees(s,p,d);r.push(f)}return r},a.prototype.callbackXZHalfCircle=function(e,t){this.calcCallbackArgs();for(var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),n=FreeDo.Math.toDegrees(.65*c*r[0]),i=(FreeDo.Math.toDegrees(.65*c*r[1]),[]),o=Math.PI/2;o>=0;o-=.001){var a=l+n*Math.cos(o),s=h,p=d+.65*c*Math.sin(o),f=Freedo.Cartesian3.fromDegrees(a,s,p);i.push(f)}return i},a.prototype.callbackYZHalfCircle=function(e,t){this.calcCallbackArgs();for(var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),n=(FreeDo.Math.toDegrees(.65*c*r[0]),FreeDo.Math.toDegrees(.65*c*r[1])),i=[],o=Math.PI/2;o>=0;o-=.001){var a=l,s=h+n*Math.cos(o),p=d+.65*c*Math.sin(o),f=Freedo.Cartesian3.fromDegrees(a,s,p);i.push(f)}return i},a.prototype.callbackXYShow=function(e,t){return this.calcCallbackArgs(),t=!0,"XY_CIRCLE"==this._selectedAxis&&(t=!1),t},a.prototype.callbackXYH=function(e,t){return d+.1},a.prototype.callbackXZ=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),n=FreeDo.Math.toDegrees(.5*c*r[0]);return Freedo.Cartesian3.fromDegreesArray([l,h,l+n,h])},a.prototype.callbackXZMinimumHeights=function(e,t){return this.calcCallbackArgs(),[d,d]},a.prototype.callbackXZMaximumHeights=function(e,t){return this.calcCallbackArgs(),[d+.5*c,d+.5*c]},a.prototype.callbackYZ=function(e,t){return this.calcCallbackArgs(),Freedo.Cartesian3.fromDegreesArray([l,h,l,h+.5*c/this._DISPERRAD])},a.prototype.callbackXYCCBP=function(e,t){return this.calcCallbackArgs(),Freedo.Cartesian3.fromDegrees(l,h)},a.prototype.callbackX=function(e,t){this.calcCallbackArgs();var r=Freedo.FdMisc.FdGeometric.getLongAndLatRatio(u),n=FreeDo.Math.toDegrees(c*r[0]);return Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l+n,h,d])},a.prototype.callbackY=function(e,t){return this.calcCallbackArgs(),Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l,h+c/this._DISPERRAD,d])},a.prototype.callbackZ=function(e,t){return this.calcCallbackArgs(),Freedo.Cartesian3.fromDegreesArrayHeights([l,h,d,l,h,d+c])},a.prototype.callbackH=function(e,t){return this.calcCallbackArgs(),d},a.prototype.callbackBasePt=function(e,t){return this.calcCallbackArgs(),s.clone()},a.prototype.callbackBasePtOri=function(e,t){return this._basePtOriPosition.clone()},a.prototype.showAxis=function(){this.clearAxis(),this.calcAxisZoom();new Freedo.CallbackProperty(this.callbackXY.bind(this),!1);var e=new Freedo.CallbackProperty(this.callbackQXY.bind(this),!1),t=new Freedo.CallbackProperty(this.callbackXYHalfCircle.bind(this),!1),r=new Freedo.CallbackProperty(this.callbackXZHalfCircle.bind(this),!1),n=new Freedo.CallbackProperty(this.callbackYZHalfCircle.bind(this),!1),i=(new Freedo.CallbackProperty(this.callbackXYShow.bind(this),!1),new Freedo.CallbackProperty(this.callbackXYH.bind(this),!1),new Freedo.CallbackProperty(this.callbackXZ.bind(this),!1),new Freedo.CallbackProperty(this.callbackXZMaximumHeights.bind(this),!1),new Freedo.CallbackProperty(this.callbackXZMinimumHeights.bind(this),!1),new Freedo.CallbackProperty(this.callbackYZ.bind(this),!1),new Freedo.CallbackProperty(this.callbackXYCCBP.bind(this),!1),new Freedo.CallbackProperty(this.callbackX.bind(this),!1)),o=new Freedo.CallbackProperty(this.callbackY.bind(this),!1),a=new Freedo.CallbackProperty(this.callbackZ.bind(this),!1),s=new Freedo.CallbackProperty(this.callbackH.bind(this),!1),c=new Freedo.CallbackProperty(this.callbackBasePt.bind(this),!1),u=new Freedo.CallbackProperty(this.callbackBasePtOri.bind(this),!1);this._basePt=this._viewer.entities.add({position:c,point:{pixelSize:10,color:Freedo.Color.YELLOW.withAlpha(.9)}}),this._basePtOri=this._viewer.entities.add({name:"xxxx",position:u,point:{pixelSize:10,color:Freedo.Color.GREEN.withAlpha(.9)}}),this._xAxisPL=this._viewer.entities.add({name:"X_AXIS",polyline:{positions:i,width:16,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.RED)}}),this._yAxisPL=this._viewer.entities.add({name:"Y_AXIS",polyline:{positions:o,width:16,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.GREEN)}}),this._zAxisPL=this._viewer.entities.add({name:"Z_AXIS",polyline:{positions:a,width:16,show:!0,followSurface:!1,material:new Freedo.PolylineArrowMaterialProperty(Freedo.Color.BLUE)}}),this._transType.indexOf("SCALE")>=0&&(this._XYPlane=this._viewer.entities.add({name:"XY_QCIRCLE",polygon:{hierarchy:e,height:s,outline:!1,show:!0,outlineColor:Freedo.Color.WHITE,outlineWidth:0,material:new Freedo.Color(0,0,1,this._alpha)}})),this._transType.indexOf("ROTATE")>=0&&(this._XYCircle=this._viewer.entities.add({name:"XY_CIRCLE",polyline:{positions:t,width:4,show:!0,material:new Freedo.Color(0,0,1,this._alpha)}})),this._transType.indexOf("ROTATE")>=0&&(this._XZCircle=this._viewer.entities.add({name:"XZ_CIRCLE",polyline:{positions:r,width:4,show:!0,material:new Freedo.Color(0,1,0,this._alpha)}}),this._YZCircle=this._viewer.entities.add({name:"YZ_CIRCLE",polyline:{positions:n,width:4,show:!0,material:new Freedo.Color(1,0,0,this._alpha)}}))},a.prototype.reset=function(){void 0===this._handler||this._handler.isDestroyed()||this._handler.destroy(),this._viewer.scene.camera.changed.removeEventListener(a.prototype.onWheel,this),this._bInTransform=!1,this.clearAxis(),this._mouseDownPos=void 0,this._initSphere=void 0,this._fixedAxis=""},a.prototype.dispose=function(){this.reset()},t.FdTransformManipulator=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdAnalysisArea=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=(r(11),r(25));Math.PI;var s=Math.PI/180,c=180/Math.PI,u=function e(t){(0,o.default)(this,e),this._viewer=t,this._scene=this._viewer.scene,this._polygons=[],this._polygons3D=[],this._labels=[],this._data=[],this._lsner=void 0,this._currentType=void 0,this._ple=new a.FdPolylineEditor(t),this._ple.setAutoDelLines(!1),this._ple.setHeightOffset(0),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper,this._labelOpt={style:Freedo.LabelStyle.FILL_AND_OUTLINE,show:!1,showBackground:!0,backgroundColor:FreeDo.Color.BLACK.withAlpha(.8),fillColor:FreeDo.Color.WHITE,font:"20px 雅黑",pixelOffset:new FreeDo.Cartesian2(0,0),disableDepthTestDistance:Number.POSITIVE_INFINITY}};u.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},u.prototype.run=function(e){this._ple.run(),this._lsner&&(this._lsner(),this._lsner=void 0);var t=this;this._lsner=this._ple.on(function(e,r){"PLAdd"==e&&t.onPLAdd(r),"PointAdded"==e&&(Freedo.defined(r.position[3])&&0==r.position[3]?void 0==t._currentType&&(t._currentType="OnModel"):t._currentType="OnEarth")}),this._event.raiseEvent("Start",{})},u.prototype.createAreaPrimitive=function(e){new Freedo.Cartesian3;var t,r=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),n=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);t=Freedo.Cartesian3.cross(r,n,new Freedo.Cartesian3),t=Freedo.Cartesian3.normalize(t,new Freedo.Cartesian3);var i,o=Freedo.Cartesian3.angleBetween(t,Freedo.Cartesian3.UNIT_Z),a=Freedo.Cartesian3.cross(t,Freedo.Cartesian3.UNIT_Z,new Freedo.Cartesian3),s=Freedo.Quaternion.fromAxisAngle(a,o,new Freedo.Quaternion),c=Freedo.Matrix4.fromTranslationQuaternionRotationScale(new Freedo.Cartesian3,s,new Freedo.Cartesian3(1,1,1)),u=(Freedo.Matrix4.multiplyByPointAsVector(c,t,new Freedo.Cartesian3),[]);for(var l in e){var h=Freedo.Matrix4.multiplyByPointAsVector(c,e[l],new Freedo.Cartesian3);u.push(h)}for(var d=[],p=0;p<e.length;p++)d.push(1*e[p].x),d.push(1*e[p].y),d.push(1*e[p].z);var f=Freedo.PolygonPipeline.triangulate(u),v=new Float64Array(d);return i=new Freedo.Geometry({attributes:{position:new Freedo.GeometryAttribute({componentDatatype:Freedo.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v})},indices:new Uint16Array(f),primitiveType:Freedo.PrimitiveType.TRIANGLES,boundingSphere:Freedo.BoundingSphere.fromVertices(v)}),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:i,attributes:{color:Freedo.ColorGeometryInstanceAttribute.fromColor(new Freedo.Color(1,1,0,1))}}),appearance:new Freedo.PerInstanceColorAppearance({flat:!0,translucent:!0}),asynchronous:!1})},u.prototype.addArea=function(e){var t;t=this._viewer.scene.globe&&("OnEarth"==this._currentType||""==this._currentType||void 0==this._currentType)?this._viewer.entities.add({name:"AREAGEO",polygon:{hierarchy:new Freedo.PolygonHierarchy(e),material:Freedo.Color.ORANGE.withAlpha(.5),outline:!0,outlineColor:Freedo.Color.BLACK}}):this._viewer.scene.primitives.add(this.createAreaPrimitive(e));for(var r=this.xyzCenter(e),n=[],i=0;i<e.length-1;i++){var o=this.toLonLat(e[i]);n.push(o)}var a=[],s=[],c=[];for(i=0;i<e.length-1;i++){o=this.toLonLat(e[i]);a.push(o.lon),s.push(o.lat),c.push([o.lon,o.lat])}var u=0;(u=(this._viewer.scene.globe&&this._currentType,this.calcArea3D(e)))<0&&(u*=-1),u=Freedo.FdMisc.FdMath.round(u,2);var l=this._viewer.entities.add({label:this._labelOpt});u>1e6?(u=Freedo.FdMisc.FdMath.round(u/1e6,2),l.label.text=u+"平方公里"):l.label.text=u+"平方米",this._viewer.scene.globe&&"OnModel"!=this._currentType?l.position=FreeDo.Cartesian3.fromDegrees(r.lon,r.lat,.1):l.position=new FreeDo.Cartesian3(r.lon,r.lat,r.height),l.label.show=!0,this._labels.push(l),this._viewer.scene.globe?this._polygons.push(t):this._polygons3D.push(t);var h={pointsG:c,pointsC:e,area:u,type:this._currentType};this._data.push(h),this._event.raiseEvent("DataChanged",h),this._viewer.scene.requestRender(),this._currentType=void 0},u.prototype.onPLAdd=function(e){e.polyline&&(2!=e.polyline.pts.length?this.addArea(e.polyline.pts):this._ple.delResult())},u.prototype.toLonLat=function(e){var t=FreeDo.Cartographic.fromCartesian(e);return{lon:FreeDo.Math.toDegrees(t.longitude),lat:FreeDo.Math.toDegrees(t.latitude),height:t.height}},u.prototype.getData=function(){return{area:this._data}},u.prototype.setData=function(e){for(var t in e)this._currentType=e[t].type,this.addArea(e[t].pointsC)},u.prototype.SphericalPolygonAreaMeters=function(e){for(var t=0,r=0;r<e.length;r++){var n=(r+1)%e.length,i=(r+2)%e.length;t+=this.Angle(e[r],e[n],e[i])}var o=180*(e.length-2),a=t-o;return a>420?a=t-o:a>300&&a<420&&(a=Math.abs(360-a)),a*s*6371e3*6371e3},u.prototype.Angle=function(e,t,r){var n=this.Bearing(t,e)-this.Bearing(t,r);return n<0&&(n+=360),n},u.prototype.Bearing=function(e,t){var r=e.lat*s,n=e.lon*s,i=t.lat*s,o=t.lon*s,a=-Math.atan2(Math.sin(n-o)*Math.cos(i),Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n-o));return a<0&&(a+=2*Math.PI),a*=c},u.prototype.xyzCenter=function(e){var t=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=-Number.MAX_VALUE,a=-Number.MAX_VALUE;if(0==e.length)console.error("只有一个点，无法计算");else{if(1!=e.length){for(var s=0;s<e.length;s++)e[s].x<t&&(t=e[s].x),e[s].y<r&&(r=e[s].y),e[s].z<n&&(n=e[s].z),e[s].x>i&&(i=e[s].x),e[s].y>o&&(o=e[s].y),e[s].z>a&&(a=e[s].z);var c=new Freedo.Cartesian3((i+t)/2,(o+r)/2,(a+n)/2);if(this._viewer.scene.globe&&"OnModel"!=this._currentType){var u=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(c);return{lon:FreeDo.Math.toDegrees(u.longitude),lat:FreeDo.Math.toDegrees(u.latitude),height:u.height}}return{lon:c.x,lat:c.y,height:c.z}}console.error("有两个点，无法计算")}},u.prototype.calcArea3D=function(e){var t,r,n;t=e.length,(r=Freedo.clone(e,!0)).push(e[0]),r.push(e[1]);new Freedo.Cartesian3;var i=Freedo.Cartesian3.subtract(e[1],e[0],new Freedo.Cartesian3),o=Freedo.Cartesian3.subtract(e[2],e[1],new Freedo.Cartesian3);n=Freedo.Cartesian3.cross(i,o,new Freedo.Cartesian3);var a,s,c,u,l,h,d,p,f=0;for(s=(n=Freedo.Cartesian3.normalize(n,new Freedo.Cartesian3)).x>0?n.x:-n.x,c=n.y>0?n.y:-n.y,u=n.z>0?n.z:-n.z,l=3,s>c?s>u&&(l=1):c>u&&(l=2),h=1,d=2,p=0;h<=t;h++,d++,p++)switch(l){case 1:f+=r[h].y*(r[d].z-r[p].z);continue;case 2:f+=r[h].x*(r[d].z-r[p].z);continue;case 3:f+=r[h].x*(r[d].y-r[p].y);continue}switch(a=Math.sqrt(s*s+c*c+u*u),l){case 1:f*=a/(2*s);break;case 2:f*=a/(2*c);break;case 3:f*=a/(2*u)}return f},u.prototype.reset=function(){this._lsner&&this._lsner(),this._lsner=void 0,this._ple.cancel(),this._event.raiseEvent("Cancel",{})},u.prototype.removeAll=function(){for(var e in this._polygons)this._viewer.entities.remove(this._polygons[e]),this._viewer.scene.primitives.remove(this._polygons[e]);for(var e in this._polygons3D)this._viewer.scene.primitives.remove(this._polygons3D[e]);for(var e in this._labels)this._viewer.entities.remove(this._labels[e]);this._polygons=[],this._polygons3D=[],this._labels=[],this._data=[],this._ple.removeAll(),this._viewer.scene.requestRender()},u.prototype.dispose=function(){this.reset(),this.removeAll()},t.FdAnalysisArea=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdAnalysisPoint=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(11);var a=function e(t){(0,o.default)(this,e),this._viewer=t,this._tempPoint=void 0,this._points=[],this._data=[],this._labels=[],this._bInSurvey=!1,this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._tmpPoint=void 0,this._singleMode=!1};a.prototype.addPoint=function(e){var t=Freedo.FdMisc.FdGeometric.tc(e);Freedo.defined(this._viewer.scene.globe)||(t={x:e[0],y:e[1],z:e[2]}),this._tmpPoint,this._tmpPoint=this._viewer.entities.add({position:t,point:{color:Freedo.Color.YELLOW,pixelSize:5,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0}});var r,n=Freedo.FdMisc.FdMath.round;r=this._viewer.scene.globe?this.createLabel(t,"经度："+n(e[0],8)+"\n纬度："+n(e[1],8)+"\n高度："+n(e[2],4)):this.createLabel(t,"X："+n(e[0],8)+"\nY："+n(e[1],8)+"\nZ："+n(e[2],4)),this._labels.push(r),this._points.push(this._tmpPoint);var i={};i.pointG=[n(e[0],8),n(e[1],8),n(e[2],8)],i.pointC=t,this._data.push(i),this._event.raiseEvent("Point",{point:e}),this._event.raiseEvent("DataChanged",i),this._viewer.scene.requestRender()},a.prototype.pickPosition=function(e){var t=Freedo.FdMisc.FdGeometric.pickPositionG(this._viewer,e);t&&this.addPoint(t)},a.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:!0,showBackground:!0,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:"16px 黑体",horizontalOrigin:Freedo.HorizontalOrigin.LEFT,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})},a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.handleLeftClick=function(e){0!=this._bInSurvey&&(this._singleMode&&this.removeAll(),this.pickPosition(e.position))},a.prototype.setSingleMode=function(e){this._singleMode=e},a.prototype.getData=function(){return{point:Freedo.clone(this._data,!0)}},a.prototype.setData=function(e){for(var t in e)this.addPoint(e[t].pointG)},a.prototype.run=function(e){this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK),this._bInSurvey=!0},a.prototype.reset=function(){this._bInSurvey=!1,this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK)},a.prototype.removeAll=function(){for(var e in this._points)this._viewer.entities.remove(this._points[e]);for(var e in this._labels)this._viewer.entities.remove(this._labels[e]);this._points=[],this._data=[]},a.prototype.dispose=function(){this.reset(),this.removeAll()},t.FdAnalysisPoint=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdAnalysisLineDistance=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(11);var a=function e(t){(0,o.default)(this,e),this.PositionType={NONE:0,ON_MODEL:1,ON_TERRAIN:2,ON_ELLIPSOID:3},this.ResultType={StraightLine:1,HorizontalAndVertical:2},this._viewer=t,this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._data={line:[],polyline:[]},this._results=[],this._startPoint=void 0,this._tempPoint=void 0,this._polylineCollection=new Freedo.PolylineCollection,this._viewer.scene.primitives.add(this._polylineCollection),this._collection=new Freedo.PrimitiveCollection,this._viewer.scene.primitives.add(this._collection),this._tempLine,this._tempPointEntities=[null,null],this._tempSumLabelEntity=void 0,this._sumLabel=[],this._lastLabel=void 0,this._points=[],this._pointsCalced=[],this._hanlder={},this._ballSize=.5,this._lineWidth=3,this._fontSize="22px 黑体",this._bInSurvey=!1,this._surveyType="",this._useDepthPicking=!0,this._pickTranslucentDepth=!0,this._bRmStarting=!1};a.prototype.pickPosition=function(e){var t=Freedo.FdMisc.FdGeometric.pickPosition(this._viewer,e);return t?{type:this.PositionType.ON_TERRAIN,position:t}:{type:this.PositionType.NONE,position:t}},a.prototype.removeTmpLine=function(){this._tempLine&&(this._viewer.entities.remove(this._tempLine),this._tempLine=void 0),this._tempSumLabelEntity&&(this._viewer.entities.remove(this._tempSumLabelEntity),this._tempSumLabelEntity=void 0);for(var e=0;e<this._tempPointEntities.length;e++)this._tempPointEntities[e]&&(this._viewer.entities.remove(this._tempPointEntities[e]),this._tempPointEntities[e]=null);"LINE_DISTANCE"==this._surveyType&&(this._startPoint=void 0),this._bRmStarting=!1,this._viewer.scene.requestRender()},a.prototype.calcLineType=function(e,t){if(!this._viewer.scene.globe)return this.ResultType.StraightLine;var r=Freedo.Cartographic.fromCartesian(e.position),n=Freedo.Cartographic.fromCartesian(t.position),i=Freedo.FdMisc.FdGeometric.calculateLength([e.position,t.position]);return Math.abs(r.height-n.height)>i/10?this.ResultType.HorizontalAndVertical:this.ResultType.StraightLine},a.prototype.createLinePrimitive=function(e,t){var r,n;return n=!!this._viewer.scene.globe,r=new Freedo.PolylineGeometry({positions:[e,t],width:2,followSurface:n,vertexFormat:Freedo.PolylineMaterialAppearance.VERTEX_FORMAT}),new Freedo.Primitive({geometryInstances:new Freedo.GeometryInstance({geometry:r}),appearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"Color",uniforms:{color:new Freedo.Color(1,.3,.3,1)}}}),renderState:new Freedo.RenderState({polygonOffset:{enabled:!0,factor:-1,units:-1},depthTest:{enabled:!0,func:Freedo.WebGLConstants.LEQUAL}})}),depthFailAppearance:new Freedo.PolylineMaterialAppearance({material:new Freedo.Material({fabric:{type:"PolylineDash",uniforms:{color:new Freedo.Color(1,.3,.3,.5)}}})})})},a.prototype.createLabel=function(e,t){return this._viewer.entities.add({position:e,label:{style:Freedo.LabelStyle.FILL_AND_OUTLINE,text:t,show:!0,showBackground:!0,backgroundColor:new Freedo.Color(.165,.165,.165,1),font:this._fontSize,horizontalOrigin:Freedo.HorizontalOrigin.CENTER,verticalOrigin:Freedo.VerticalOrigin.BOTTOM,pixelOffset:new Freedo.Cartesian2(1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY}})},a.prototype.addResult=function(e){var t=Freedo.FdMisc.FdGeometric,r=this.calcLineType(this._startPoint,e);if(this._points.pop(),this._points.push(e.position),this._points.push(e.position),this._ballSize=t.calculateLength(this._points)/1e3,r===this.ResultType.StraightLine){var n=[this._startPoint.position,e.position];if(t.calculateLength(n)<.01)return void this._points.pop();var i=this._viewer.scene.primitives.add(this.createLinePrimitive(this._startPoint.position,e.position)),o=t.getCenter(this._startPoint.position,e.position),a=t.calculateLength(n),s=this.getLengthText(a),c=this.createLabel(o,s),u=this._viewer.entities.add({position:this._startPoint.position,show:!0,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:!1,point:!1}}),l=this._viewer.entities.add({position:e.position,show:!0,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:!1,point:!1}});this._results.push({type:r,labelEntity:c,line:i,startPointEntity:u,endPointEntity:l});var h={pointsG:[t.tg(this._startPoint.position),t.tg(e.position)],pointsC:[this._startPoint.position,e.position],length:a,vLength:0,hLength:0};"LINE_DISTANCE"==this._surveyType&&(this._data.line.push(h),this._event.raiseEvent("DataChanged",h)),"SEGMENTS_DISTANCE"==this._surveyType&&this._pointsCalced.push(h)}else if(r===this.ResultType.HorizontalAndVertical){var d,p,f,v,_=Freedo.Cartographic.fromCartesian(this._startPoint.position),y=Freedo.Cartographic.fromCartesian(e.position);n=[this._startPoint.position,e.position];if(t.calculateLength(n)<.01)return void this._points.pop();_.height>y.height?(p=this._startPoint.position,d=e.position,f=_.height-y.height):(p=e.position,d=this._startPoint.position,f=y.height-_.height);var m=new Freedo.Cartesian3;Freedo.Cartesian3.normalize(d,m),Freedo.Cartesian3.multiplyByScalar(m,f,m);var g=new Freedo.Cartesian3;Freedo.Cartesian3.add(d,m,g),v=Freedo.Cartesian3.distance(g,p);i=this._viewer.scene.primitives.add(this.createLinePrimitive(p,d));var F=this._viewer.scene.primitives.add(this.createLinePrimitive(d,g)),w=this._viewer.scene.primitives.add(this.createLinePrimitive(p,g)),C=t.getCenter(p,d),b=t.calculateLength([p,d]),P=this.getLengthText(b),M=this.createLabel(C,P);C=t.getCenter(g,d),P=this.getLengthText(f);var x=this.createLabel(C,P);C=t.getCenter(g,p),P=this.getLengthText(v);var S=this.createLabel(C,P);u=this._viewer.entities.add({position:this._startPoint.position,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:!1,point:!1}}),l=this._viewer.entities.add({position:e.position,point:{color:Freedo.Color.YELLOW,show:!1,pixelSize:5,point:!1}});this._results.push({type:r,line:i,verticalLine:F,horizontalLine:w,lineLabelEntity:M,verticalLineLabelEntity:x,horizontalLineLabelEntity:S,startPointEntity:u,endPointEntity:l});h={pointsG:[t.tg(this._startPoint.position),t.tg(e.position)],pointsC:[this._startPoint.position,e.position],length:b,vLength:f,hLength:v};"LINE_DISTANCE"==this._surveyType&&(this._data.line.push(h),this._event.raiseEvent("DataChanged",h)),"SEGMENTS_DISTANCE"==this._surveyType&&this._pointsCalced.push(h)}if(this._points.length>3&&"SEGMENTS_DISTANCE"==this._surveyType)if(void 0==this._lastLabel){var T=this.getLengthText(t.calculateLength(this._points));this._lastLabel=this.createLabel(e.position,T)}else this._lastLabel.position=e.position,this._lastLabel.label.text=this.getLengthText(t.calculateLength(this._points));"SEGMENTS_DISTANCE"==this._surveyType&&(this._startPoint=Freedo.clone(e,!0)),e=void 0,this._viewer.scene.requestRender()},a.prototype.clearResults=function(){this.removeTmpLine(),this._lastLabel&&(this._viewer.entities.remove(this._lastLabel),this._lastLabel=void 0);for(var e=0;e<this._results.length;++e)this._results[e].type===this.ResultType.StraightLine?(this._viewer.scene.primitives.remove(this._results[e].line),this._viewer.entities.remove(this._results[e].labelEntity),this._viewer.entities.remove(this._results[e].startPointEntity),this._viewer.entities.remove(this._results[e].endPointEntity)):this._results[e].type===this.ResultType.HorizontalAndVertical&&(this._viewer.scene.primitives.remove(this._results[e].line),this._viewer.scene.primitives.remove(this._results[e].verticalLine),this._viewer.scene.primitives.remove(this._results[e].horizontalLine),this._viewer.entities.remove(this._results[e].lineLabelEntity),this._viewer.entities.remove(this._results[e].verticalLineLabelEntity),this._viewer.entities.remove(this._results[e].horizontalLineLabelEntity),this._viewer.entities.remove(this._results[e].startPointEntity),this._viewer.entities.remove(this._results[e].endPointEntity));for(var t in this._sumLabel)this._viewer.entities.remove(this._sumLabel[t]);this._viewer.scene.primitives.remove(this._polylineCollection),this._results=[],this._sumLabel=[],this._data={line:[],polyline:[]},this._points=[],this._pointsCalced=[],this._viewer.scene.requestRender()},a.prototype.pickStartPoint=function(e){this._points=[],this._pointsCalced=[];var t=this.pickPosition(e);t.type!==this.PositionType.NONE&&(this._startPoint=t,this._points.push(t.position),this._points.push(t.position),this._tempPointEntities[0]=this._viewer.entities.add({position:this._startPoint.position,show:!1,point:{color:Freedo.Color.YELLOW,pixelSize:5,show:!1,point:!1}}))},a.prototype.getLengthText=function(e){return e>1e3?(e/1e3).toFixed(2)+"千米":e.toFixed(2)+"米"},a.prototype.pickEndPoint=function(e){var t=this.pickPosition(e);t.type!==this.PositionType.NONE&&(this.addResult(t),this._bRmStarting=!0,setTimeout(this.removeTmpLine.bind(this),100))},a.prototype.handleLeftClick=function(e){0!=this._bInSurvey&&(this._startPoint?this.pickEndPoint(e.position):this.pickStartPoint(e.position))},a.prototype.addSumInfo=function(){if("SEGMENTS_DISTANCE"==this._surveyType){var e=Freedo.FdMisc.FdGeometric.calculateLength(this._points);this._points.length>=2&&(this._data.polyline.push({lines:Freedo.clone(this._pointsCalced,!0),sumLenght:e}),this._event.raiseEvent("DataChanged",{lines:Freedo.clone(this._pointsCalced,!0),sumLenght:e}))}this._viewer.scene.requestRender()},a.prototype.handleRightClick=function(e){0!=this._bInSurvey&&(this._startPoint&&(this._startPoint=void 0,this.addSumInfo()),this.removeTmpLine())},a.prototype.callbackPosition=function(){return this._viewer.scene.requestRender(),[this._startPoint.position,this._tempPoint.position]},a.prototype.handleMouseMove=function(e){if(0!=this._bInSurvey&&!this._bRmStarting&&this._startPoint&&!Freedo.Cartesian3.equals(e.endPosition,e.startPosition)){var t=this.pickPosition(e.endPosition);if(!Freedo.defined(t.position))return;if(this._tempPoint=t,void 0===this._tempLine){var r=new Freedo.CallbackProperty(this.callbackPosition.bind(this),!1);this._tempLine=this._viewer.entities.add({name:"MeasureLine",polyline:{positions:r,width:this._lineWidth,material:Freedo.Color.RED,depthFailMaterial:Freedo.Color.GREEN}})}}},a.prototype.onKeyDown=function(){0!=this._bInSurvey&&27==window.event.keyCode&&this.handleRightClick()},a.prototype.getData=function(e){return Freedo.clone(this._data,!0)},a.prototype.setData=function(e){for(var t in this._surveyType="LINE_DISTANCE",e.line)this._points=[],this._startPoint={position:e.line[t].pointsC[0]},this.addResult({position:e.line[t].pointsC[1]});for(var t in this._surveyType="SEGMENTS_DISTANCE",e.polyline){this._points=[];var r=e.polyline[t];for(var n in r.lines)"0"==n&&(this._points.push(r.lines[n].pointsC[0]),this._points.push(r.lines[n].pointsC[0])),this._startPoint={position:r.lines[n].pointsC[0]},this.addResult({position:r.lines[n].pointsC[1]});this.addSumInfo()}this._startPoint=void 0},a.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},a.prototype.run=function(e){this._surveyType=e,this._hanlder=new Freedo.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._hanlder.setInputAction(this.handleLeftClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_CLICK),this._hanlder.setInputAction(this.handleRightClick.bind(this),Freedo.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._hanlder.setInputAction(this.handleRightClick.bind(this),Freedo.ScreenSpaceEventType.RIGHT_CLICK),this._hanlder.setInputAction(this.handleMouseMove.bind(this),Freedo.ScreenSpaceEventType.MOUSE_MOVE),window.addEventListener("keydown",this.onKeyDown.bind(this)),this._bInSurvey=!0},a.prototype.reset=function(){this._bInSurvey=!1,this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_CLICK),this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.RIGHT_CLICK),this._hanlder.removeInputAction(Freedo.ScreenSpaceEventType.MOUSE_MOVE),window.removeEventListener("keydown",this.onKeyDown.bind(this))},a.prototype.removeAll=function(){this.clearResults()},a.prototype.dispose=function(){this.reset(),this.clearResults()},t.FdAnalysisLineDistance=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdAnalysisManager=void 0;var n=u(r(1)),i=u(r(6)),o=r(311),a=r(310),s=r(309),c=r(307);function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this._viewer=t,this._survey=void 0,this._depthTestAgainstTerrain=!0,this._mode="",this._event=new FreeDo.Event,this._eventHelper=new FreeDo.EventHelper,this._surveyLine=new o.FdAnalysisLineDistance(this._viewer),this._surveyPoint=new a.FdAnalysisPoint(this._viewer),this._surveyArea=new s.FdAnalysisArea(this._viewer),this._surveyHeight=new c.FdAnalysisHeight(this._viewer),this._lsnr=void 0}return(0,i.default)(e,[{key:"surveyOptions",get:function(){return this.getData()},set:function(e){Freedo.defined(e)&&(this._surveyLine.setData(e),this._surveyPoint.setData(e.point),this._surveyArea.setData(e.area),this._surveyHeight.setData(e.height))}}]),e}();l.prototype.start=function(e){this.setMode(e)},l.prototype.setMode=function(e){if("CANCEL"!=e)if("LINE_DISTANCE"===e||"SEGMENTS_DISTANCE"===e||"SINGLE_POINT"===e||"AREA"===e||"HEIGHT"===e){this.reset(),this._mode=e,"LINE_DISTANCE"!==e&&"SEGMENTS_DISTANCE"!==e||(this._survey=this._surveyLine),"SINGLE_POINT"===e&&(this._survey=this._surveyPoint),"AREA"===e&&(this._survey=this._surveyArea),"HEIGHT"===e&&(this._survey=this._surveyHeight);var t=this;this._lsnr=this._survey.on(function(e,r){"Point"==e&&t._event.raiseEvent("Point",r),"HeightPoint"==e&&t._event.raiseEvent("Point",r),"DataChanged"==e&&t._event.raiseEvent(e,r)}),this._survey.run(this._mode),this._event.raiseEvent("Start",{mode:this._mode})}else console.warn("不支持此种量测模式："+e);else this.reset()},l.prototype.getMode=function(){return this._mode},l.prototype.setSingleMode=function(e){"SINGLE_POINT"==this._mode&&this._survey.setSingleMode(e)},l.prototype.getData=function(){var e=this._surveyLine.getData(),t=this._surveyPoint.getData(),r=this._surveyArea.getData(),n=this._surveyHeight.getData();return{line:e.line,polyline:e.polyline,point:t.point,area:r.area,height:n.height}},l.prototype.cancel=function(){this.reset(),this._event.raiseEvent("Cancel",{mode:this._mode})},l.prototype.on=function(e,t){return this._eventHelper.add(this._event,e,t)},l.prototype.reset=function(){this._survey&&this._survey.reset(),this._lsnr&&this._lsnr()},l.prototype.removeAll=function(){this._surveyLine.removeAll(),this._surveyPoint.removeAll(),this._surveyArea.removeAll(),this._surveyHeight.removeAll(),this._event.raiseEvent("DataChanged",{}),this._viewer.scene.requestRender()},l.prototype.dispose=function(){this.reset()},t.FdAnalysisManager=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdMicroApp=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(312),s=r(306),c=r(305),u=r(303),l=r(301),h=r(25),d=r(278),p=r(269),f=r(172),v=r(268),_=r(263);var y=function e(){(0,o.default)(this,e)};y.FdAnalysisManager=a.FdAnalysisManager,y.FdDrawRoad=s.FdDrawRoad,y.FdPathsManager=c.FdPathsManager,y.FdClipPlane=u.FdClipPlane,y.FdPickPModel=l.FdPickPModel,y.FdGeologySimulationHandler=d.FdGeologySimulationHandler,y.FdEraseGroundHandler=p.FdEraseGroundHandler,y.FdTransformHelper=f.FdTransformHelper,y.FdPickPMComponent=v.FdPickPMComponent,y.FdDrawPolyline=_.FdDrawPolyline,y.FdPolylineEditor=h.FdPolylineEditor,t.FdMicroApp=y},function(e,t,r){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),n.getHeading=function(e){if(!Freedo.defined(e))throw new Freedo.DeveloperError("camera is required");return v(e.direction,e.up)},n.getPitch=function(e){if(!Freedo.defined(e))throw new Freedo.DeveloperError("camera is required");return _(e.direction)},n.lookAt=function(e,t,r){if(!Freedo.defined(e))throw new Freedo.DeveloperError("camera is required");if(!Freedo.defined(t))throw new Freedo.DeveloperError("target is required");if(!Freedo.defined(r))throw new Freedo.DeveloperError("offset is required");var n;n=Freedo.defined(r.heading)?c(r.heading,r.pitch,r.range):r,Freedo.Cartesian3.add(t,n,e.position),Freedo.Cartesian3.subtract(t,e.position,y),Freedo.Cartesian3.normalize(y,e.direction),Freedo.Cartesian3.equalsEpsilon(e.direction,Freedo.Cartesian3.UNIT_Z,Freedo.Math.EPSILON4)?Freedo.Cartesian3.fromElements(0,-1,0,g):Freedo.Cartesian3.equalsEpsilon(e.direction,w,Freedo.Math.EPSILON4)?Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,g):Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,g),Freedo.Cartesian3.cross(y,g,m),Freedo.Cartesian3.cross(m,y,g),Freedo.Cartesian3.normalize(g,e.up),Freedo.Cartesian3.normalize(m,e.right)},n.setView=function(e,t){if(!Freedo.defined(e))throw new Freedo.DeveloperError("camera is required");t=Freedo.defaultValue(t,Freedo.defaultValue.EMPTY_OBJECT);var r=Freedo.defaultValue(t.orientation,Freedo.defaultValue.EMPTY_OBJECT),n=Freedo.defaultValue(t.destination,Freedo.Cartesian3.clone(e.position,F)),i=e.direction,o=e.up;if(Freedo.defined(r.direction)&&Freedo.defined(r.up))i=r.direction,o=r.up;else if(Freedo.defined(r.heading)||Freedo.defined(r.pitch)){var a=Freedo.defaultValue(r.heading,0),s=Freedo.defaultValue(r.pitch,0),u=c(a,s,1);Freedo.Cartesian3.negate(u,y),i=Freedo.Cartesian3.normalize(y,y),o=Freedo.Cartesian3.equalsEpsilon(i,Freedo.Cartesian3.UNIT_Z,Freedo.Math.EPSILON4)?Freedo.Cartesian3.fromElements(0,-1,0,g):Freedo.Cartesian3.equalsEpsilon(i,w,Freedo.Math.EPSILON4)?Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,g):Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,g)}var l=Freedo.Cartesian3.cross(i,o,m);o=Freedo.Cartesian3.cross(l,i,g),Freedo.Cartesian3.clone(n,e.position),Freedo.Cartesian3.normalize(i,e.direction),Freedo.Cartesian3.normalize(o,e.up),Freedo.Cartesian3.normalize(l,e.right)},n.flyTo=function(e,t){var r=(t=Freedo.defaultValue(t,Freedo.defaultValue.EMPTY_OBJECT)).destination;if(!Freedo.defined(e))throw new Freedo.DeveloperError("scene is required.");if(!Freedo.defined(r))throw new Freedo.DeveloperError("destination is required.");n.cancelFlight();var i,o=Freedo.defaultValue(t.orientation,Freedo.defaultValue.EMPTY_OBJECT);Freedo.defined(o.direction)&&(o=function(e,t,r,n){var i=Freedo.Cartesian3.clone(r.direction,P),o=Freedo.Cartesian3.clone(r.up,M);Freedo.Cartesian3.cross(i,o,x);return n.heading=v(i,o),n.pitch=_(i),n.roll=0,n}(e.camera,0,o,b.orientation)),C.destination=r,C.heading=o.heading,C.pitch=o.pitch,C.roll=o.roll,C.duration=t.duration,C.complete=function(){i===S._currentFlight&&(S._currentFlight=void 0),Freedo.defined(t.complete)&&t.complete()},C.cancel=t.cancel,C.easingFunction=t.easingFunction,i=e.tweens.add(S.createTween(e,C)),n._currentFlight=i};var i=new Freedo.Cartesian3,o=new Freedo.Quaternion,a=new Freedo.Quaternion,s=new Freedo.Matrix3;function c(e,t,r){t=Freedo.Math.clamp(t,-Freedo.Math.PI_OVER_TWO,Freedo.Math.PI_OVER_TWO),e=Freedo.Math.zeroToTwoPi(e)-Freedo.Math.PI_OVER_TWO;var n=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Y,-t,o),c=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Z,-e,a),u=Freedo.Quaternion.multiply(c,n,c),l=Freedo.Matrix3.fromQuaternion(u,s),h=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_X,i);return Freedo.Matrix3.multiplyByVector(l,h,h),Freedo.Cartesian3.negate(h,h),Freedo.Cartesian3.multiplyByScalar(h,r,h),h}new Freedo.Matrix4;var u=new Freedo.Cartesian3,l=new Freedo.Cartesian3,h=new Freedo.Cartesian3,d=new Freedo.Cartesian3,p=(new Freedo.Cartesian4,new Freedo.Quaternion),f=new Freedo.Matrix3;function v(e,t){var r=0;if(r=e.z<Freedo.Math.EPSILON5-1?Math.atan2(t.x,t.y):e.z>1-Freedo.Math.EPSILON5?Math.atan2(-t.x,-t.y):Math.atan2(e.x,e.y),isNaN(r))throw new Freedo.DeveloperError("");return r}function _(e){var t=0;if(e.z<Freedo.Math.EPSILON5-1)t=-Freedo.Math.PI_OVER_TWO;else if(e.z>1-Freedo.Math.EPSILON5)t=Freedo.Math.PI_OVER_TWO;else{var r=Math.sqrt(e.x*e.x+e.y*e.y);t=Math.atan(e.z/r)}if(isNaN(t))throw new Freedo.DeveloperError("");return t}n.flyToBoundingSphere=function(e,t,r){if(!Freedo.defined(t))throw new DeveloperError("boundingSphere is required.");var i=e.camera;r=Freedo.defaultValue(r,Freedo.defaultValue.EMPTY_OBJECT),i._setTransform(Freedo.Matrix4.IDENTITY);var o=r.offset;Freedo.defined(o)||(o=Freedo.HeadingPitchRange.clone(Freedo.Camera.DEFAULT_OFFSET)),Freedo.defined(o.range)&&0!==o.range||(o.range=function(e,t){var r=e.frustum,n=Math.tan(.5*r.fovy),i=r.aspectRatio*n;return Math.max(t/i,t/n)}(i,t.radius));var a,s,v=c(o.heading,o.pitch,o.range);if(v=Freedo.Cartesian3.add(v,t.center,u),a=Freedo.Cartesian3.subtract(t.center,v,l),Freedo.Cartesian3.normalize(a,a),s=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Z,h),1-Math.abs(Freedo.Cartesian3.dot(a,s))<Freedo.Math.EPSILON6){var _=Freedo.Quaternion.fromAxisAngle(a,o.heading,p),y=Freedo.Matrix3.fromQuaternion(_,f);s=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,h),Freedo.Matrix3.multiplyByVector(y,s,s)}var m=Freedo.Cartesian3.cross(a,s,d);Freedo.Cartesian3.cross(m,a,s),Freedo.Cartesian3.normalize(s,s),n.flyTo(e,{destination:v,orientation:{direction:a,up:s},duration:r.duration,complete:r.complete,cancel:r.cancel,endTransform:r.endTransform,maximumHeight:r.maximumHeight,easingFunction:r.easingFunction,flyOverLongitude:r.flyOverLongitude,flyOverLongitudeWeight:r.flyOverLongitudeWeight,pitchAdjustHeight:r.pitchAdjustHeight})},n.cancelFlight=function(){Freedo.defined(n._currentFlight)&&(n._currentFlight.cancelTween(),n._currentFlight=void 0)};i=new Freedo.Cartesian3,o=new Freedo.Quaternion,a=new Freedo.Quaternion,s=new Freedo.Matrix3;function c(e,t,r){t=Freedo.Math.clamp(t,-Freedo.Math.PI_OVER_TWO,Freedo.Math.PI_OVER_TWO),e=Freedo.Math.zeroToTwoPi(e);var n=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_X,t,o),c=Freedo.Quaternion.fromAxisAngle(Freedo.Cartesian3.UNIT_Z,-e,a),u=Freedo.Quaternion.multiply(c,n,c),l=Freedo.Matrix3.fromQuaternion(u,s),h=Freedo.Cartesian3.clone(Freedo.Cartesian3.UNIT_Y,i);return Freedo.Matrix3.multiplyByVector(l,h,h),Freedo.Cartesian3.negate(h,h),Freedo.Cartesian3.multiplyByScalar(h,r,h),h}var y=new Freedo.Cartesian3,m=new Freedo.Cartesian3,g=new Freedo.Cartesian3,F=new Freedo.Cartesian3,w=new Freedo.Cartesian3(0,0,-1);n._currentFlight=void 0;var C={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,easingFunction:void 0},b={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0}},P=new Freedo.Cartesian3,M=new Freedo.Cartesian3,x=new Freedo.Cartesian3;var S={};function T(e,t){return function(){"function"==typeof t&&t(),e.enableInputs=!0}}var E=new Freedo.Cartesian3,D=new Freedo.Cartesian3;function A(e,t,r,i,o,a){var s,c,u=Freedo.Cartesian3.clone(e.position,E),l=(s=n.getHeading(e),c=i,Freedo.Math.equalsEpsilon(s,Freedo.Math.TWO_PI,Freedo.Math.EPSILON11)&&(s=0),c>s+Math.PI?s+=Freedo.Math.TWO_PI:c<s-Math.PI&&(s-=Freedo.Math.TWO_PI),s),h=n.getPitch(e);return function(s){var c=s.time/t,d=Freedo.Cartesian3.lerp(u,r,c,D);n.setView(e,{destination:d,orientation:{heading:Freedo.Math.lerp(l,i,c),pitch:Freedo.Math.lerp(h,o,c),roll:Freedo.Math.lerp(0,a,c)}})}}S.createTween=function(e,t){var r=e.camera,n=t.destination,i=Freedo.defaultValue(t.easingFunction,Freedo.EasingFunction.LINEAR_NONE),o=t.duration;Freedo.defined(o)||(o=Math.ceil(Freedo.Cartesian3.distance(r.position,n)/100)+2,o=Math.min(o,3));var a=Freedo.defaultValue(t.heading,0),s=Freedo.defaultValue(t.pitch,0),c=Freedo.defaultValue(t.roll,0),u=e.screenSpaceCameraController;u.enableInputs=!1;var l=T(u,t.complete),h=T(u,t.cancel);if(o<=0){return function(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}(function(){A(r,1,n,a,s,c)({time:1}),"function"==typeof l&&l()},h)}return{duration:o,easingFunction:i,startObject:{time:0},stopObject:{time:o},update:A(r,o,n,a,s,c),complete:l,cancel:h}},t.FdPlaneViewCameraHelper=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdTrackManager=void 0;var n=o(r(1)),i=o(r(6));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),this._scene=t,this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper}return(0,i.default)(e,[{key:"trackByBoundingSphere",value:function(e){this._scene.screenSpaceCameraController.bimTrackByBoundingSphere(e),this._event.raiseEvent("beginTrack",e)}},{key:"cancelTrack",value:function(){this._scene.screenSpaceCameraController.bimUnTrack(),this._event.raiseEvent("cancelTrack")}},{key:"isTracking",value:function(){return this._scene.screenSpaceCameraController.isTracking()}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"dispose",value:function(){this._scene.screenSpaceCameraController.bimUnTrack(),this._eventHelper.removeAll()}}]),e}();t.FdTrackManager=a},function(e,t,r){var n=r(17);n(n.S+n.F*!r(29),"Object",{defineProperty:r(31).f})},function(e,t,r){r(316);var n=r(14).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(17);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){r(318),e.exports=9007199254740991},function(e,t,r){e.exports={default:r(319),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdCameraHistory=void 0;var n=a(r(320)),i=a(r(1)),o=a(r(6));function a(e){return e&&e.__esModule?e:{default:e}}var s=r(123),c=function(){function e(t){var r=this;if((0,i.default)(this,e),this._camera=t,void 0!==t._cameraHistory)throw new Error("Current camera has already create history!");t._cameraHistory=this,this._cameraPath=[],s.extendObservable(this,{_cameraPathCurrentIndex:-1}),s.autorun(function(){r._cameraPathCurrentIndex,void 0!==r._event&&r._event.raiseEvent("CameraPathChanged")}),this._lastHistoryOpFrameCount=0,this._delayRecordViewValid=!0;var n=this;this._delayRecordView=_.debounce(function(){var e=n._camera;if(n._delayRecordViewValid){var t=function(e,t){return void 0===t&&(t={}),t.position=e.positionWC.clone(),t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t}(e);n._cameraPath.length>=10&&(n._cameraPath.splice(0,1),n._cameraPathCurrentIndex=n._cameraPathCurrentIndex-1),n._cameraPath.splice(n._cameraPathCurrentIndex+1,n._cameraPath.length-1-n._cameraPathCurrentIndex,t),n._cameraPathCurrentIndex=n._cameraPath.length-1,n._updateCameraHistoryStatus()}},1e3),this._delayRecordView(),this._camera.percentageChanged=1e-4,this._cameraChangedEventListener=this._camera.changed.addEventListener(function(){n._camera._scene._frameState.frameNumber<=n._lastHistoryOpFrameCount?n._delayRecordViewValid=!1:(n._delayRecordViewValid=!0,n._delayRecordView())}),this._event=new Freedo.Event,this._eventHelper=new Freedo.EventHelper}return(0,o.default)(e,[{key:"_updateCameraHistoryStatus",value:function(){this._event.raiseEvent("CameraPathChanged")}},{key:"prev",value:function(){if(0!=this._cameraPath.length){this._camera.cancelFlight();var e={};if(this._lastHistoryOpFrameCount=n.default,this._cameraPathCurrentIndex>0){this._cameraPathCurrentIndex-=1;var t=this._cameraPath[this._cameraPathCurrentIndex];e.destination=t.position,e.orientation={heading:t.heading,pitch:t.pitch,roll:t.roll},e.duration=1;var r=this;e.complete=function(){r._lastHistoryOpFrameCount=r._camera._scene._frameState.frameNumber},e.cancel=function(){r._lastHistoryOpFrameCount=r._camera._scene._frameState.frameNumber};var i=this._camera;Freedo.Matrix4.equals(i.transform,Freedo.Matrix4.IDENTITY)||(e.endTransform=Freedo.Matrix4.clone(i.transform),i.lookAtTransform(Freedo.Matrix4.IDENTITY)),this._camera.flyTo(e)}}}},{key:"next",value:function(){if(0!=this._cameraPath.length){this._camera.cancelFlight();var e={};if(this._lastHistoryOpFrameCount=n.default,this._cameraPathCurrentIndex+1<this._cameraPath.length){this._cameraPathCurrentIndex=this._cameraPathCurrentIndex+1;var t=this._cameraPath[this._cameraPathCurrentIndex];e.destination=t.position,e.orientation={heading:t.heading,pitch:t.pitch,roll:t.roll},e.duration=1;var r=this;e.complete=function(){r._lastHistoryOpFrameCount=r._camera._scene._frameState.frameNumber},e.cancel=function(){r._lastHistoryOpFrameCount=r._camera._scene._frameState.frameNumber};var i=this._camera;Freedo.Matrix4.equals(i.transform,Freedo.Matrix4.IDENTITY)||(e.endTransform=Freedo.Matrix4.clone(i.transform),i.lookAtTransform(Freedo.Matrix4.IDENTITY)),this._camera.flyTo(e)}}}},{key:"on",value:function(e,t){return this._eventHelper.add(this._event,e,t)}},{key:"dispose",value:function(){void 0!==this._cameraChangedEventListener&&(this._cameraChangedEventListener(),this._cameraChangedEventListener=void 0),this._camera._cameraHistory===this&&(this._camera._cameraHistory=void 0),void 0!==this._delayRecordView&&(this._delayRecordView=void 0),void 0!==this._camera&&(this._camera=void 0),this._eventHelper.removeAll(),this._event=void 0,this._eventHelper=void 0}},{key:"pathLength",get:function(){return this._cameraPath.length}},{key:"currentIndex",get:function(){return this._cameraPathCurrentIndex}}]),e}();t.FdCameraHistory=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setKeyboardV=t.enableKeyboard=void 0;var n=r(84),i=void 0,o=void 0,a=void 0,s=10;t.enableKeyboard=function(e,t){i=e.camera,o&&(a(),o=void 0),o=new n.FdKeyboard(e),a=o.on(function(e,t){"timer"===e&&(t.metaData[37]&&Freedo.FdCamera.lookLeft(i,5),t.metaData[39]&&Freedo.FdCamera.lookRight(i,5),t.metaData[38]&&i.lookUp(5/180*Freedo.Math.PI),t.metaData[40]&&i.lookDown(5/180*Freedo.Math.PI),t.metaData[65]&&i.moveLeft(s/33),t.metaData[68]&&i.moveRight(s/33),t.metaData[87]&&i.moveForward(s/33),t.metaData[83]&&i.moveBackward(s/33))}),t?o.enable():o.disable()},t.setKeyboardV=function(e){s=e}},function(e,t,r){"use strict";function n(e,t){var r=e.positionWC,n=Freedo.Matrix4.clone(e.transform,n);e.lookAtTransform(Freedo.Matrix4.IDENTITY),e.look(r,Freedo.Math.toRadians(t)),e.lookAtTransform(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.lookLeft=function(e,t){n(e,-t)},t.lookRight=function(e,t){n(e,t)}},function(e,t,r){"use strict";function n(e){if(!(e instanceof Freedo.Scene))throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.")}function i(e){if(!Freedo.defined(e))throw new Freedo.DeveloperError("boundingSphere is required.")}function o(e,t,r,n){var i=new Freedo.Cartographic.fromCartesian(t.center).height,o=function(){e.flyToBoundingSphere(t,{offset:new Freedo.HeadingPitchRange(r,n,3*t.radius),maximumHeight:i,duration:2})};e.distanceToBoundingSphere(t)>5*t.radius?e.flyToBoundingSphere(t,{duration:6,offset:new Freedo.HeadingPitchRange(e.heading,e.pitch,5*t.radius),complete:o}):o()}Object.defineProperty(t,"__esModule",{value:!0}),t.flyToSouth=function(e,t){n(e),i(t),o(e.camera,t,0,0)},t.flyToWest=function(e,t){n(e),i(t),o(e.camera,t,FreeDo.Math.toRadians(90),0)},t.flyToNorth=function(e,t){n(e),i(t),o(e.camera,t,FreeDo.Math.toRadians(180),0)},t.flyToEast=function(e,t){n(e),i(t),o(e.camera,t,FreeDo.Math.toRadians(270),0)},t.flyToTop=function(e,t){n(e),i(t);var r=e.camera;o(r,t,r.heading,FreeDo.Math.toRadians(-90))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.capture=function(e,t,r,i){r=Freedo.defaultValue(r,128),i=Freedo.defaultValue(i,128),e.requestRender();var o=e._postRender.addEventListener(function(){var a=function(e,t,r){Freedo.defined(n)||(n=document.createElement("canvas")),n.setAttribute("width",t),n.setAttribute("height",r);var i,o,a,s,c=e.canvas,u=c.width,l=c.height;return u>=l?(i=.5*(u-l),o=0,a=s=l):(i=0,o=.5*(l-u),a=s=u),n.getContext("2d").drawImage(c,i,o,a,s,0,0,t,r),n.toDataURL("image/jpeg")}(e,r,i);t(a,r,i),o()},null)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aerialView=function(e,t,r,n,i,o){if(!(e instanceof Freedo.Scene))throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.");var a=e.camera;r=Freedo.defaultValue(r,80),n=Freedo.defaultValue(n,5),i=Freedo.defaultValue(i,135),o=Freedo.defaultValue(o,55);var s=Freedo.Rectangle.fromDegrees(r,n,i,o),c=a._mode;if(c===Freedo.SceneMode.MORPHING&&a._scene.completeMorph(),c===Freedo.SceneMode.SCENE2D)a.flyTo({destination:s,duration:t,endTransform:Freedo.Matrix4.IDENTITY});else if(c===Freedo.SceneMode.SCENE3D){var u=a.getRectangleCameraCoordinates(s),l=Freedo.Cartesian3.magnitude(u);l+=l*Freedo.Camera.DEFAULT_VIEW_FACTOR,Freedo.Cartesian3.normalize(u,u),Freedo.Cartesian3.multiplyByScalar(u,l,u),a.flyTo({destination:u,duration:t,endTransform:Freedo.Matrix4.IDENTITY})}else if(c===Freedo.SceneMode.COLUMBUS_VIEW){var h=a._projection.ellipsoid.maximumRadius,d=new Freedo.Cartesian3(0,-1,1);d=Freedo.Cartesian3.multiplyByScalar(Freedo.Cartesian3.normalize(d,d),5*h,d),a.flyTo({destination:d,duration:t,orientation:{heading:0,pitch:-Freedo.Math.acos(Freedo.Cartesian3.normalize(d,pitchScratch).z),roll:0},endTransform:Freedo.Matrix4.IDENTITY,convert:!1})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=new Freedo.Matrix4;t.flyAround=function(e,t,r){var i=t.camera;Freedo.defined(r)||(r={});var o=Freedo.defaultValue(r.duration,3),a=Freedo.defaultValue(r.rotateAngleRange,4*Freedo.Math.PI),s=Freedo.defaultValue(r.easingFunction,Freedo.EasingFunction.QUADRACTIC_IN_OUT),c=Freedo.defaultValue(r.delay,0),u=Freedo.Matrix4.clone(i.transform,n),l=Freedo.Transforms.eastNorthUpToFixedFrame(e);i.lookAtTransform(l);var h,d=t.tweens.add({duration:o,easingFunction:s,startObject:{angle:0},stopObject:{angle:a},delay:c,update:(h=0,function(e){var t=e.angle-h;t>0&&i.rotate(Freedo.Cartesian3.UNIT_Z,t),h=e.angle}),complete:function(){d.cancelTween()},cancel:function(){i.lookAtTransform(u)}});return function(){d.cancelTween()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdCamera=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(327),s=r(326),c=r(325),u=r(324),l=r(122),h=r(323),d=(r(84),r(322)),p=r(321),f=r(315),v=r(314);var _=function e(){(0,o.default)(this,e)};_.flyAround=a.flyAround,_.aerialView=s.aerialView,_.capture=c.capture,_.flyToSouth=u.flyToSouth,_.flyToWest=u.flyToWest,_.flyToNorth=u.flyToNorth,_.flyToEast=u.flyToEast,_.flyToTop=u.flyToTop,_.getCurrentCameraInfo=l.getCurrentCameraInfo,_.flyToByCameraInfo=l.flyToByCameraInfo,_.goToByCameraInfo=l.goToByCameraInfo,_.lookLeft=h.lookLeft,_.lookRight=h.lookRight,_.enableKeyboard=d.enableKeyboard,_.setKeyboardV=d.setKeyboardV,_.FdCameraHistory=p.FdCameraHistory,_.FdTrackManager=f.FdTrackManager,_.FdPlaneViewCameraHelper=v.FdPlaneViewCameraHelper,t.FdCamera=_},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,h=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||l||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdGeometric=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n};r(175);var a=function e(){(0,o.default)(this,e)};a.calculateLength=function(e){for(var t=0,r=1;r<e.length;++r)t+=Freedo.Cartesian3.distance(e[r-1],e[r]);return t},a.getLengthText=function(e){return e>1e3?(e/1e3).toFixed(2)+"千米":e.toFixed(2)+"米"},a.getCenter=function(e,t){var r=new Freedo.Cartesian3;return Freedo.Cartesian3.add(e,t,r),Freedo.Cartesian3.multiplyByScalar(r,.5,r),r},a.getLongAndLatRatio=function(e){var t=e.clone();t.latitude+=1e-7;var r=new FreeDo.EllipsoidGeodesic,n=t.clone();n.longitude+=.001,r.setEndPoints(t,n);var i=.001/r.surfaceDistance,o=new FreeDo.EllipsoidGeodesic,a=t.clone();return a.latitude+=.001,o.setEndPoints(t,a),[i,.001/o.surfaceDistance]},a.pickPosition=function(e,t){var r=void 0,n=(e=e).scene;if(n.mode!==Freedo.SceneMode.MORPHING){var i=n.pick(t);if(n.pickPositionSupported&&Freedo.defined(i))(r=e.scene.pickPosition(t))&&(r.type=0);else{if(e.terrainProvider instanceof Freedo.EllipsoidTerrainProvider)r=e.camera.pickEllipsoid(t,n.globe.ellipsoid);else{var o=n.camera.getPickRay(t);n.globe&&(r=n.globe.pick(o,n))}r&&(r.type=1)}}return r},a.pickPositionG=function(e,t){var r=void 0,n=this.pickPosition(e,t);if(n){var i;if(r=[],e.scene.globe){i=Freedo.Cartographic.fromCartesian(n,e.scene.globe.ellipsoid);var o=Freedo.Math.toDegrees;r[0]=o(i.longitude),r[1]=o(i.latitude),r[2]=i.height}else r[0]=n.x,r[1]=n.y,r[2]=n.z;r[3]=n.type}return r},a.tc=function(e){var t=Freedo.Math.toRadians;return Freedo.Cartesian3.fromRadians(t(e[0]),t(e[1]),e[2])},a.tg=function(e){var t=[],r=Freedo.Cartographic.fromCartesian(e),n=Freedo.Math.toDegrees;return t[0]=n(r.longitude),t[1]=n(r.latitude),t[2]=r.height,t},a.leftOfLine=function(e,t,r){var n=e.x,i=e.y,o=t.x,a=t.y,s=r.x,c=r.y;return((n-s)*(a-c)-(i-c)*(o-s))/2>0?1:-1},a.calcAngle=function(e,t,r,n){var i=[t.x-e.x,t.y-e.y],o=[n.x-r.x,n.y-r.y],s=(i[0]*o[0]+i[1]*o[1])/(Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))*Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)));return Freedo.Math.toDegrees(Math.acos(s))*a.leftOfLine(e,t,n)},a.calcArea=function(e,t,r){var n=e.length;if(n>2){var i=0;if("DEGREES"==r){for(var o=0,a=0,s=0,c=0,u=0,l=0,h=0,d=0,p=0,f=0,v=0,_=0,y=0,m=0,g=0,F=0,w=0,C=0,b=0,P=0,M=0,x=0,S=0,T=0,E=0,D=0,A=0,O=0,k=0;k<n;k++)0==k?(o=e[n-1]*Math.PI/180,a=t[n-1]*Math.PI/180,s=e[0]*Math.PI/180,c=t[0]*Math.PI/180,u=e[1]*Math.PI/180,l=t[1]*Math.PI/180):k==n-1?(o=e[n-2]*Math.PI/180,a=t[n-2]*Math.PI/180,s=e[n-1]*Math.PI/180,c=t[n-1]*Math.PI/180,u=e[0]*Math.PI/180,l=t[0]*Math.PI/180):(o=e[k-1]*Math.PI/180,a=t[k-1]*Math.PI/180,s=e[k]*Math.PI/180,c=t[k]*Math.PI/180,u=e[k+1]*Math.PI/180,l=t[k+1]*Math.PI/180),h=Math.cos(c)*Math.cos(s),d=Math.cos(c)*Math.sin(s),p=Math.sin(c),f=Math.cos(a)*Math.cos(o),v=Math.cos(a)*Math.sin(o),_=Math.sin(a),T=((M=(w=(h*h+d*d+p*p)/(h*(y=Math.cos(l)*Math.cos(u))+d*(m=Math.cos(l)*Math.sin(u))+p*(g=Math.sin(l))))*y-h)*(C=(F=(h*h+d*d+p*p)/(h*f+d*v+p*_))*f-h)+(x=w*m-d)*(b=F*v-d)+(S=w*g-p)*(P=F*_-p))/(Math.sqrt(M*M+x*x+S*S)*Math.sqrt(C*C+b*b+P*P)),T=Math.acos(T),(0!=h?(x*P-S*b)/h:0!=d?(0-(M*P-S*C))/d:(M*b-x*C)/p)>0?(E+=T,O++):(D+=T,A++);i=6378e3*((E>D?E+(2*Math.PI*A-D):2*Math.PI*O-E+D)-(n-2)*Math.PI)*6378e3}else{var L,I,R,N;for(k=n-1,L=0;L<n;k=L,L++)I=e[k],R=t[k],N=e[L],i+=I*t[L]-N*R;i/=2}return i}return 0},t.FdGeometric=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSkyBox=function(e,t){if(!(e instanceof Freedo.Scene))throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.");if(!Freedo.defined(t))throw new Freedo.DeveloperError("option is required.");var r=t.color,n=t.imagePaths;if(!Freedo.defined(r)&&!Freedo.defined(n))throw new Freedo.DeveloperError("color or imagePaths is required in option.");if(Freedo.defined(r)&&Freedo.defined(n))throw new Freedo.DeveloperError("color & imagePaths can't be set at the same time.");if(e.skyAtmosphere=void 0,Freedo.defined(r))e.backgroundColor=new Freedo.Color(r[0],r[1],r[2],r[3]),e.skyBox=void 0;else{if(6!==n.length)throw new Freedo.DeveloperError("imagePaths must have six valid image path.");e.backgroundColor=new Freedo.Color(0,0,0,1),e.skyBox=new Freedo.SkyBox({sources:{positiveX:n[0],negativeX:n[1],positiveY:n[2],negativeY:n[3],positiveZ:n[4],negativeZ:n[5]}})}e.requestRender()},t.setSkyBoxOnGround=function(e,t){if(!(e instanceof Freedo.Scene))throw new Freedo.DeveloperError("The parameter is not an instance of Freedo.Scene.");if(!Freedo.defined(t))throw new Freedo.DeveloperError("imagePaths is required.");if(6!==t.length)throw new Freedo.DeveloperError("imagePaths must have six valid image path.");e.skyAtmosphere=void 0,e.skyBox=void 0,e.backgroundColor=new Freedo.Color(0,0,0,1),e.skyBoxOnGround=new Freedo.SkyBox({sources:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}}),e.requestRender()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Freedo;function i(e){if(!n.defined(e))throw new DeveloperError("scene is required.");this.enableCollisionDetection=!1,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.maximumMovementRatio=.1,this.enableInputs=!0,this.enableRotate=!0,this.enablePan=!0,this.enableZoom=!0,this.inertiaRotate=.5,this.inertiaPan=.5,this.inertiaZoom=.5,this.defaultZoomReference=void 0,this.defaultRotateReference=void 0,this.rotateEventTypes=n.CameraEventType.LEFT_DRAG,this.panEventTypes=[n.CameraEventType.RIGHT_DRAG,n.CameraEventType.MIDDLE_DRAG],this.zoomEventTypes=[n.CameraEventType.WHEEL,n.CameraEventType.PINCH],this._scene=e,this._aggregator=new n.CameraEventAggregator(e.canvas),this._zoomFactor=5,this._rotateFactor=.01}function o(e){return n.Cartesian2.equalsEpsilon(e.startPosition,e.endPosition,n.Math.EPSILON14)}var a=.4;function s(e,t,r,i,s,c,u){var l=c[u];n.defined(l)||(l=c[u]={startPosition:new n.Cartesian2,endPosition:new n.Cartesian2,motion:new n.Cartesian2,active:!1});var h=e.getButtonPressTime(t,r),d=e.getButtonReleaseTime(t,r),p=h&&d&&(d.getTime()-h.getTime())/1e3,f=new Date,v=d&&(f.getTime()-d.getTime())/1e3;if(h&&d&&p<a){var _=function(e,t){if(e<0)return 0;var r=25*(1-t);return Math.exp(-r*e)}(v,i);if(l.active)l.startPosition=n.Cartesian2.clone(l.endPosition,l.startPosition),l.endPosition=n.Cartesian2.multiplyByScalar(l.motion,_,l.endPosition),l.endPosition=n.Cartesian2.add(l.startPosition,l.endPosition,l.endPosition),l.motion=n.Cartesian2.clone(n.Cartesian2.ZERO,l.motion);else{var y=e.getLastMovement(t,r);if(!n.defined(y)||o(y))return;l.motion.x=.5*(y.endPosition.x-y.startPosition.x),l.motion.y=.5*(y.endPosition.y-y.startPosition.y),l.startPosition=n.Cartesian2.clone(y.startPosition,l.startPosition),l.endPosition=n.Cartesian2.multiplyByScalar(l.motion,_,l.endPosition),l.endPosition=n.Cartesian2.add(l.startPosition,l.endPosition,l.endPosition),l.active=!0}if(isNaN(l.endPosition.x)||isNaN(l.endPosition.y)||n.Cartesian2.distance(l.startPosition,l.endPosition)<.5)return void(l.active=!1);if(!e.isButtonDown(t,r))s(c,e.getStartMousePosition(t,r),l)}else l.active=!1}var c=[];function u(e,t,r,i,o,a){if(n.defined(r)){var u=e._aggregator;n.isArray(r)||(c[0]=r,r=c);for(var l=r.length,h=0;h<l;++h){var d=r[h],p=n.defined(d.eventType)?d.eventType:d,f=d.modifier,v=u.isMoving(p,f)&&u.getMovement(p,f),_=u.getStartMousePosition(p,f);e.enableInputs&&t&&(v?i(e,_,v):o<1&&s(u,p,f,o,i,e,a))}}}var l=new n.Cartesian2,h=new n.Cartesian3,d=new n.Cartesian3,p=new n.Cartesian3,f=new n.Cartesian3,v=new n.Ray,_=new n.Plane(new n.Cartesian3(0,0,1),1),y=new n.Cartesian2,m=new n.Cartesian3,g=new n.Cartesian3,F=new n.Cartesian3,w=new n.Cartesian3,C=new n.Cartesian2,b=new n.Cartesian3;function P(e,t,r,i,o){r.x=Math.cos(t)*Math.cos(e),r.y=Math.cos(t)*Math.sin(e),r.z=Math.sin(t),n.Cartesian3.normalize(r,r);var a=e+n.Math.PI_OVER_TWO;i.x=Math.cos(a),i.y=Math.sin(a),i.z=0,n.Cartesian3.normalize(i,i),n.Cartesian3.cross(r,i,o),n.Cartesian3.normalize(o,o)}function M(e,t,r){var i=e._scene,a=i.camera,s=i.canvas;if(!o(r)){if(!n.Cartesian2.equalsEpsilon(C,t,n.Math.EPSILON14)){n.Cartesian2.clone(t,C);var c=i.pickPosition(r.startPosition,b);if(!n.defined(c)){var u=l;u.x=s.clientWidth/2,u.y=s.clientHeight/2,c=i.pickPosition(u,b),n.defined(c)||(n.defined(e.defaultRotateReference)?n.Cartesian3.clone(e.defaultRotateReference,b):n.Cartesian3.clone(n.Cartesian3.ZERO,b))}}var h=n.Cartesian2.subtract(r.endPosition,r.startPosition,y),f=-h.x*e._rotateFactor,v=-h.y*e._rotateFactor,_=function(e){var t=e.direction,r=e.up,i=0;if(i=t.z<-.99999?Math.atan2(r.y,r.x):t.z>.99999?Math.atan2(-r.y,-r.x):Math.atan2(t.y,t.x),isNaN(i))throw new n.DeveloperError("");return i}(a),M=function(e){var t=e.direction,r=0;if(t.z<-.99999)r=-n.Math.PI_OVER_TWO;else if(t.z>.99999)r=n.Math.PI_OVER_TWO;else{var i=Math.sqrt(t.x*t.x+t.y*t.y);r=Math.atan(t.z/i)}if(isNaN(r))throw new n.DeveloperError("");return r}(a),x=_+f,S=M+v;S=n.Math.clamp(S,-n.Math.PI_OVER_TWO,n.Math.PI_OVER_TWO);var T=n.Cartesian3.subtract(a.position,b,p);n.Cartesian3.magnitude(T);P(_,M,m,g,F);var E=n.Cartesian3.dot(T,m),D=n.Cartesian3.dot(T,g),A=n.Cartesian3.dot(T,F);P(x,S,m,g,F),n.Cartesian3.multiplyByScalar(m,E,d),n.Cartesian3.add(b,d,w),n.Cartesian3.multiplyByScalar(g,D,d),n.Cartesian3.add(d,w,w),n.Cartesian3.multiplyByScalar(F,A,d);var O=n.Cartesian3.add(d,w,w);n.Cartesian3.clone(O,a.position),n.Cartesian3.normalize(m,a.direction),n.Cartesian3.normalize(F,a.up),n.Cartesian3.cross(m,F,a.right)}}function x(e,t,r){var i=e._scene,a=i.camera;i.canvas;if(!o(r)){var s=n.Cartesian3.negate(a.direction,f),c=i.pickPosition(r.startPosition,h);if(n.defined(c)){var u=n.Plane.fromPointNormal(c,s,_),l=a.getPickRay(r.endPosition,v),y=n.IntersectionTests.rayPlane(l,u,d);if(n.defined(y)){var m=n.Cartesian3.subtract(c,y,p);return void a.move(m,1)}}u=n.Plane.fromPointNormal(n.Cartesian3.ZERO,s,_),l=a.getPickRay(r.startPosition,v);if(c=n.IntersectionTests.rayPlane(l,u,h),l=a.getPickRay(r.endPosition,v),y=n.IntersectionTests.rayPlane(l,u,d),n.defined(c)&&n.defined(y)){m=n.Cartesian3.subtract(c,y,p);a.move(m,1)}else;}}function S(e,t,r){n.defined(r.distance)&&(r=r.distance);var i=e._scene,o=i.camera,a=i.canvas,s=r.endPosition.y-r.startPosition.y;if(!(Math.abs(s)<n.Math.EPSILON14)){var c=s/a.clientHeight;c=Math.min(c,e.maximumMovementRatio);var u=i.pickPosition(t,h);if(!n.defined(u)){var d=l;d.x=a.clientWidth/2,d.y=a.clientHeight/2,u=i.pickPosition(d,h),n.defined(u)||(u=n.defined(e.defaultZoomReference)?n.Cartesian3.clone(e.defaultZoomReference,h):n.Cartesian3.clone(n.Cartesian3.ZERO,h))}var f=n.Cartesian3.subtract(u,o.position,p),v=n.Cartesian3.magnitude(f);f=n.Cartesian3.normalize(f,p),v=v*c*e._zoomFactor,o.move(f,v)}}i.prototype.update=function(){var e;this._scene.mode===n.SceneMode.SCENE3D&&(u(e=this,e.enableRotate,e.rotateEventTypes,M,e.inertiaRotate,"_lastInertiaSpinMovement"),u(e,e.enablePan,e.panEventTypes,x,e.inertiaPan,"_lastInertiaPanMovement"),u(e,e.enableZoom,e.zoomEventTypes,S,e.inertiaZoom,"_lastInertiaZoomMovement")),this._aggregator.reset()},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),destroyObject(this)};var T=i;t.FdScreenSpaceCameraController=T},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDefaultViewer=void 0;var n=r(124),i=r(332);window.mobilecheck=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t};var o={globe:!1,skyBox:!1,sun:!1,scene3DOnly:!0,skyAtmosphere:!1},a={imageryProvider:Freedo.createTileMapServiceImageryProvider({url:Freedo.buildModuleUrl("Assets/Textures/NaturalEarthII")}),baseLayerPicker:!1,geocoder:!1,timeline:!1,animation:!1,vrButton:!1,navigationHelpButton:!1,sceneModePicker:!1,fullscreenButton:!1,homeButton:!1,selectionIndicator:!1,infoBox:!1,contextOptions:{webgl:{antialias:!mobilecheck()}}};t.createDefaultViewer=function(e,t,r){var s,c;Freedo.Camera.DEFAULT_VIEW_RECTANGLE=Freedo.Rectangle.fromDegrees(80,5,135,55),Freedo.BingMapsApi.defaultKey="AsosOjY68GIcKsRMisb8KcmGD266hYjtDHD5-EC-YTJUHi1Cxj1K3zWhLcp-SPNZ",r=Freedo.defaultValue(r,Freedo.defaultValue.EMPTY_OBJECT);var u=Freedo.defaultValue(r.planeMode,!1);if(u){var l=_.assign(a,o);t=_.assign(l,t)}else t=_.assign(a,t);var h=new Freedo.Viewer(e,t);h._cesiumWidget._creditContainer.style.display="none",h.scene._useBD=Freedo.defaultValue(r.batchDraw,!1),h.scene._useBD&&Freedo.defined(r.batchDrawTargetFPS)&&(h.scene._maxTimeToBeUsedPerRender=1e3/r.batchDrawTargetFPS),s=Freedo.defaultValue(r.hasSkyBoxOnGround,!0),c=Freedo.defaultValue(r.hasProvinceBoundaries,!1);var d=(0,n.getFreedoXPath)();if(c){var p=new Freedo.GeoJsonDataSource;p.load(d+"Assets/Misc/china.topojson",{stroke:Freedo.Color.YELLOW,fill:new Freedo.Color(0,0,0,0),strokeWidth:5,markerSymbol:"?"}).then(function(e){var t=e._entityCollection,r=t.values;t.suspendEvents();for(var n=0;n<r.length;n++)r[n].polygon.distanceDisplayCondition=new Freedo.DistanceDisplayCondition(5,2e8);t.resumeEvents()}),h.dataSources.add(p)}if(h.camera.percentageChanged=1e-4,h.scene.globe&&(h.scene.globe.depthTestAgainstTerrain=!0),h.scene.pickTranslucentDepth=!0,h.scene.moon&&(h.scene.moon.show=!1),h.scene.sun&&(h.scene.sun.show=!1),h.extend(Freedo.viewerFreedoPModelInspectorMixin),h.cesium3DTilesInspector.setVisibility(!1),h._cesiumWidget._supportsImageRenderingPixelated=Freedo.FeatureDetection.supportsImageRenderingPixelated(),h._cesiumWidget._forceResize=!0,Freedo.FeatureDetection.supportsImageRenderingPixelated()){for(var f=window.devicePixelRatio;f>=2;)f/=2;h.resolutionScale=f}return h.scene.requestRenderMode=!0,h.scene.maximumRenderTimeChange=1/0,h.scene.screenSpaceCameraController.enableCollisionDetection=!1,s&&!u&&(h.scene.skyboxOnGround=new Freedo.SkyBox({sources:{positiveX:d+"Assets/Textures/SkyBoxOnGround/rightav9.jpg",negativeX:d+"Assets/Textures/SkyBoxOnGround/leftav9.jpg",positiveY:d+"Assets/Textures/SkyBoxOnGround/frontav9.jpg",negativeY:d+"Assets/Textures/SkyBoxOnGround/backav9.jpg",positiveZ:d+"Assets/Textures/SkyBoxOnGround/topav9.jpg",negativeZ:d+"Assets/Textures/SkyBoxOnGround/bottomav9.jpg"}})),u&&(h.scene._screenSpaceCameraController=new i.FdScreenSpaceCameraController(h.scene)),h.canvas.addEventListener("keydown",function(e){187===(e.keyCode?e.keyCode:e.which)&&("hidden"===h.cesium3DTilesInspector._container.style.visibility?h.cesium3DTilesInspector.setVisibility(!0):h.cesium3DTilesInspector.setVisibility(!1))}),h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FdApp=void 0;var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(333),s=r(124),c=r(331);var u=function e(){(0,o.default)(this,e)};u.createDefaultViewer=a.createDefaultViewer,u.getFreedoXPath=s.getFreedoXPath,u.setSkyBox=c.setSkyBox,u.setSkyBoxOnGround=c.setSkyBoxOnGround,t.FdApp=u},function(e,t){e.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},function(e,t,r){var n=r(0),i=r(335)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(e){return i(e)}})},function(e,t,r){r(336),e.exports=r(37).RegExp.escape},function(e,t,r){(function(t){!function(t){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",u="object"==typeof e,l=t.regeneratorRuntime;if(l)u&&(e.exports=l);else{(l=t.regeneratorRuntime=u?e.exports:{}).wrap=F;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",v={},_={};_[a]=function(){return this};var y=Object.getPrototypeOf,m=y&&y(y(A([])));m&&m!==n&&i.call(m,a)&&(_=m);var g=P.prototype=C.prototype=Object.create(_);b.prototype=g.constructor=P,P.constructor=b,P[c]=b.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(g),e},l.awrap=function(e){return{__await:e}},M(x.prototype),x.prototype[s]=function(){return this},l.AsyncIterator=x,l.async=function(e,t,r,n){var i=new x(F(e,t,r,n));return l.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},M(g),g[c]="Generator",g[a]=function(){return this},g.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},l.values=A,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),v}}}function F(e,t,r,n){var i=t&&t.prototype instanceof C?t:C,o=Object.create(i.prototype),a=new D(n||[]);return o._invoke=function(e,t,r){var n=h;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=S(a,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=w(e,t,r);if("normal"===c.type){if(n=r.done?f:d,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,a),o}function w(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function C(){}function b(){}function P(){}function M(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function x(e){function r(t,n,o,a){var s=w(e[t],e,n);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):Promise.resolve(u).then(function(e){c.value=e,o(c)},a)}a(s.arg)}var n;"object"==typeof t.process&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise(function(n,i){r(e,t,n,i)})}return n=n?n.then(i,i):i()}}function S(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,S(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=w(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:r,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,r(152))},function(e,t,r){for(var n=r(130),i=r(56),o=r(19),a=r(3),s=r(20),c=r(66),u=r(7),l=u("iterator"),h=u("toStringTag"),d=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=i(p),v=0;v<f.length;v++){var _,y=f[v],m=p[y],g=a[y],F=g&&g.prototype;if(F&&(F[l]||s(F,l,d),F[h]||s(F,h,y),c[y]=d,m))for(_ in n)F[_]||o(F,_,n[_],!0)}},function(e,t,r){var n=r(0),i=r(129);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,r){var n=r(3),i=r(0),o=r(125),a=[].slice,s=/MSIE .\./.test(o),c=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&a.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*s,{setTimeout:c(n.setTimeout),setInterval:c(n.setInterval)})},function(e,t,r){"use strict";var n=r(0),i=r(3),o=r(37),a=r(128)(),s=r(7)("observable"),c=r(15),u=r(2),l=r(51),h=r(49),d=r(20),p=r(50),f=p.RETURN,v=function(e){return null==e?void 0:c(e)},_=function(e){var t=e._c;t&&(e._c=void 0,t())},y=function(e){return void 0===e._o},m=function(e){y(e)||(e._o=void 0,_(e))},g=function(e,t){u(e),this._c=void 0,this._o=e,e=new F(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:c(r),this._c=r)}catch(t){return void e.error(t)}y(this)&&_(this)};g.prototype=h({},{unsubscribe:function(){m(this)}});var F=function(e){this._s=e};F.prototype=h({},{next:function(e){var t=this._s;if(!y(t)){var r=t._o;try{var n=v(r.next);if(n)return n.call(r,e)}catch(e){try{m(t)}finally{throw e}}}},error:function(e){var t=this._s;if(y(t))throw e;var r=t._o;t._o=void 0;try{var n=v(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{_(t)}finally{throw e}}return _(t),e},complete:function(e){var t=this._s;if(!y(t)){var r=t._o;t._o=void 0;try{var n=v(r.complete);e=n?n.call(r,e):void 0}catch(e){try{_(t)}finally{throw e}}return _(t),e}}});var w=function(e){l(this,w,"Observable","_f")._f=c(e)};h(w.prototype,{subscribe:function(e){return new g(e,this._f)},forEach:function(e){var t=this;return new(o.Promise||i.Promise)(function(r,n){c(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})})}}),h(w,{from:function(e){var t="function"==typeof this?this:w,r=v(u(e)[s]);if(r){var n=u(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return a(function(){if(!r){try{if(p(e,!1,function(e){if(t.next(e),r)return f})===f)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:w)(function(e){var t=!1;return a(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),d(w.prototype,s,function(){return this}),n(n.G,{Observable:w}),r(52)("Observable")},function(e,t,r){var n=r(0),i=r(128)(),o=r(3).process,a="process"==r(27)(o);n(n.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},function(e,t,r){var n=r(41),i=r(2),o=r(15),a=n.key,s=n.set;n.exp({metadata:function(e,t){return function(r,n){s(e,t,(void 0!==n?i:o)(r),a(n))}}})},function(e,t,r){var n=r(41),i=r(2),o=n.has,a=n.key;n.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,r){var n=r(41),i=r(2),o=r(21),a=n.has,s=n.key,c=function(e,t,r){if(a(e,t,r))return!0;var n=o(t);return null!==n&&c(e,n,r)};n.exp({hasMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,r){var n=r(41),i=r(2),o=n.keys,a=n.key;n.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},function(e,t,r){var n=r(41),i=r(2),o=n.get,a=n.key;n.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,r){var n=r(186),i=r(177),o=r(41),a=r(2),s=r(21),c=o.keys,u=o.key,l=function(e,t){var r=c(e,t),o=s(e);if(null===o)return r;var a=l(o,t);return a.length?r.length?i(new n(r.concat(a))):a:r};o.exp({getMetadataKeys:function(e){return l(a(e),arguments.length<2?void 0:u(arguments[1]))}})},function(e,t,r){var n=r(41),i=r(2),o=r(21),a=n.has,s=n.get,c=n.key,u=function(e,t,r){if(a(e,t,r))return s(e,t,r);var n=o(t);return null!==n?u(e,n,r):void 0};n.exp({getMetadata:function(e,t){return u(e,i(t),arguments.length<3?void 0:c(arguments[2]))}})},function(e,t,r){var n=r(41),i=r(2),o=n.key,a=n.map,s=n.store;n.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:o(arguments[2]),n=a(i(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var c=s.get(t);return c.delete(r),!!c.size||s.delete(t)}})},function(e,t,r){var n=r(41),i=r(2),o=n.key,a=n.set;n.exp({defineMetadata:function(e,t,r,n){a(e,t,i(r),o(n))}})},function(e,t,r){"use strict";var n=r(0),i=r(127),o=r(190);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){"use strict";var n=r(0),i=r(37),o=r(3),a=r(90),s=r(189);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,s=n>>>16,c=(a*o>>>0)+(i*o>>>16);return a*s+(c>>>16)+((i*s>>>0)+(65535&c)>>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{scale:r(176)})},function(e,t,r){var n=r(0),i=Math.PI/180;n(n.S,"Math",{radians:function(e){return e*i}})},function(e,t,r){var n=r(0);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,r){var n=r(0);n(n.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,s=n>>16,c=(a*o>>>0)+(i*o>>>16);return a*s+(c>>16)+((i*s>>>0)+(65535&c)>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(e,t,r){var n=r(0),i=r(176),o=r(196);n(n.S,"Math",{fscale:function(e,t,r,n,a){return o(i(e,t,r,n,a))}})},function(e,t,r){var n=r(0),i=180/Math.PI;n(n.S,"Math",{degrees:function(e){return e*i}})},function(e,t,r){var n=r(0);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,r){var n=r(0);n(n.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}})},function(e,t,r){var n=r(0),i=r(27);n(n.S,"Error",{isError:function(e){return"Error"===i(e)}})},function(e,t,r){var n=r(0);n(n.S,"System",{global:r(3)})},function(e,t,r){var n=r(0);n(n.G,{global:r(3)})},function(e,t,r){r(85)("WeakSet")},function(e,t,r){r(85)("WeakMap")},function(e,t,r){r(85)("Set")},function(e,t,r){r(85)("Map")},function(e,t,r){r(86)("WeakSet")},function(e,t,r){r(86)("WeakMap")},function(e,t,r){r(86)("Set")},function(e,t,r){r(86)("Map")},function(e,t,r){var n=r(0);n(n.P+n.R,"Set",{toJSON:r(178)("Set")})},function(e,t,r){var n=r(0);n(n.P+n.R,"Map",{toJSON:r(178)("Map")})},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(36),a=r(21),s=r(22).f;r(10)&&n(n.P+r(87),"Object",{__lookupSetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.set}while(r=a(r))}})},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(36),a=r(21),s=r(22).f;r(10)&&n(n.P+r(87),"Object",{__lookupGetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.get}while(r=a(r))}})},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(15),a=r(9);r(10)&&n(n.P+r(87),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(15),a=r(9);r(10)&&n(n.P+r(87),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},function(e,t,r){var n=r(0),i=r(179)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},function(e,t,r){var n=r(0),i=r(179)(!1);n(n.S,"Object",{values:function(e){return i(e)}})},function(e,t,r){var n=r(0),i=r(182),o=r(23),a=r(22),s=r(134);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),c=a.f,u=i(n),l={},h=0;u.length>h;)void 0!==(r=c(n,t=u[h++]))&&s(l,t,r);return l}})},function(e,t,r){r(150)("observable")},function(e,t,r){r(150)("asyncIterator")},function(e,t,r){"use strict";var n=r(0),i=r(35),o=r(8),a=r(94),s=r(92),c=RegExp.prototype,u=function(e,t){this._r=e,this._s=t};r(138)(u,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),n(n.P,"String",{matchAll:function(e){if(i(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in c?String(e.flags):s.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=o(e.lastIndex),new u(n,t)}})},function(e,t,r){"use strict";r(67)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,r){"use strict";r(67)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,r){"use strict";var n=r(0),i=r(180),o=r(125);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,r){"use strict";var n=r(0),i=r(180),o=r(125);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,r){"use strict";var n=r(0),i=r(140)(!0);n(n.P,"String",{at:function(e){return i(this,e)}})},function(e,t,r){"use strict";var n=r(0),i=r(181),o=r(12),a=r(8),s=r(34),c=r(132);n(n.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),r=a(t.length),n=c(t,0);return i(n,t,t,r,0,void 0===e?1:s(e)),n}}),r(45)("flatten")},function(e,t,r){"use strict";var n=r(0),i=r(181),o=r(12),a=r(8),s=r(15),c=r(132);n(n.P,"Array",{flatMap:function(e){var t,r,n=o(this);return s(e),t=a(n.length),r=c(n,0),i(r,n,n,t,0,1,e,arguments[1]),r}}),r(45)("flatMap")},function(e,t,r){"use strict";var n=r(0),i=r(97)(!0);n(n.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(45)("includes")},function(e,t,r){var n=r(0),i=r(146);i&&n(n.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,r){var n=r(9),i=r(22),o=r(21),a=r(24),s=r(0),c=r(59),u=r(2),l=r(5);s(s.S,"Reflect",{set:function e(t,r,s){var h,d,p=arguments.length<4?t:arguments[3],f=i.f(u(t),r);if(!f){if(l(d=o(t)))return e(d,r,s,p);f=c(0)}if(a(f,"value")){if(!1===f.writable||!l(p))return!1;if(h=i.f(p,r)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,n.f(p,r,h)}else n.f(p,r,c(0,s));return!0}return void 0!==f.set&&(f.set.call(p,s),!0)}})},function(e,t,r){var n=r(0),i=r(2),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{ownKeys:r(182)})},function(e,t,r){var n=r(0),i=r(2),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,r){var n=r(0),i=r(21),o=r(2);n(n.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,r){var n=r(22),i=r(0),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(o(e),t)}})},function(e,t,r){var n=r(22),i=r(21),o=r(24),a=r(0),s=r(5),c=r(2);a(a.S,"Reflect",{get:function e(t,r){var a,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[r]:(a=n.f(t,r))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(u=i(t))?e(u,r,l):void 0}})},function(e,t,r){"use strict";var n=r(0),i=r(2),o=function(e){this._t=i(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r(138)(o,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),n(n.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,r){var n=r(0),i=r(22).f,o=r(2);n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},function(e,t,r){var n=r(9),i=r(0),o=r(2),a=r(36);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){o(e),t=a(t,!0),o(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},function(e,t,r){var n=r(0),i=r(54),o=r(15),a=r(2),s=r(5),c=r(4),u=r(203),l=(r(3).Reflect||{}).construct,h=c(function(){function e(){}return!(l(function(){},[],e)instanceof e)}),d=!c(function(){l(function(){})});n(n.S+n.F*(h||d),"Reflect",{construct:function(e,t){o(e),a(t);var r=arguments.length<3?e:o(arguments[2]);if(d&&!h)return l(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var c=r.prototype,p=i(s(c)?c:Object.prototype),f=Function.apply.call(e,p,t);return s(f)?f:p}})},function(e,t,r){var n=r(0),i=r(15),o=r(2),a=(r(3).Reflect||{}).apply,s=Function.apply;n(n.S+n.F*!r(4)(function(){a(function(){})}),"Reflect",{apply:function(e,t,r){var n=i(e),c=o(r);return a?a(n,t,c):s.call(n,t,c)}})},function(e,t,r){r(42)("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0)},function(e,t,r){r(42)("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){r(42)("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},function(e,t,r){var n=r(0);n(n.G+n.W+n.F*!r(88).ABV,{DataView:r(126).DataView})},function(e,t,r){"use strict";var n=r(0),i=r(88),o=r(126),a=r(2),s=r(55),c=r(8),u=r(5),l=r(3).ArrayBuffer,h=r(90),d=o.ArrayBuffer,p=o.DataView,f=i.ABV&&l.isView,v=d.prototype.slice,_=i.VIEW;n(n.G+n.W+n.F*(l!==d),{ArrayBuffer:d}),n(n.S+n.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return f&&f(e)||u(e)&&_ in e}}),n(n.P+n.U+n.F*r(4)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==v&&void 0===t)return v.call(a(this),e);for(var r=a(this).byteLength,n=s(e,r),i=s(void 0===t?r:t,r),o=new(h(this,d))(c(i-n)),u=new p(this),l=new p(o),f=0;n<i;)l.setUint8(f++,u.getUint8(n++));return o}}),r(52)("ArrayBuffer")},function(e,t,r){"use strict";var n=r(184),i=r(65);r(89)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"WeakSet"),e,!0)}},n,!1,!0)},function(e,t,r){"use strict";var n,i,o,a,s=r(57),c=r(3),u=r(28),l=r(74),h=r(0),d=r(5),p=r(15),f=r(51),v=r(50),_=r(90),y=r(129).set,m=r(128)(),g=r(127),F=r(190),w=r(189),C=c.TypeError,b=c.process,P=c.Promise,M="process"==l(b),x=function(){},S=i=g.f,T=!!function(){try{var e=P.resolve(1),t=(e.constructor={})[r(7)("species")]=function(e){e(x,x)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t}catch(e){}}(),E=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var r=e._c;m(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&k(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?u(C("Promise-chain cycle")):(o=E(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!a&&l.exit(),u(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){y.call(c,function(){var t,r,n,i=e._v,o=O(e);if(o&&(t=F(function(){M?b.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=M||O(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},k=function(e){y.call(c,function(){var t;M?b.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},I=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw C("Promise can't be resolved itself");(t=E(e))?m(function(){var n={_w:r,_d:!1};try{t.call(e,u(I,n,1),u(L,n,1))}catch(e){L.call(n,e)}}):(r._v=e,r._s=1,D(r,!1))}catch(e){L.call({_w:r,_d:!1},e)}}};T||(P=function(e){f(this,P,"Promise","_h"),p(e),n.call(this);try{e(u(I,this,1),u(L,this,1))}catch(e){L.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(49)(P.prototype,{then:function(e,t){var r=S(_(this,P));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=M?b.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&D(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(I,e,1),this.reject=u(L,e,1)},g.f=S=function(e){return e===P||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!T,{Promise:P}),r(68)(P,"Promise"),r(52)("Promise"),a=r(37).Promise,h(h.S+h.F*!T,"Promise",{reject:function(e){var t=S(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!T),"Promise",{resolve:function(e){return w(s&&this===a?P:this,e)}}),h(h.S+h.F*!(T&&r(93)(function(e){P.all(e).catch(x)})),"Promise",{all:function(e){var t=this,r=S(t),n=r.resolve,i=r.reject,o=F(function(){var r=[],o=0,a=1;v(e,!1,function(e){var s=o++,c=!1;r.push(void 0),a++,t.resolve(e).then(function(e){c||(c=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=S(t),n=r.reject,i=F(function(){v(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(e,t,r){r(91)("split",2,function(e,t,n){"use strict";var i=r(94),o=n,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];n=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!i(e))return o.call(r,e,t);var n,c,u,l,h,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,v=void 0===t?4294967295:t>>>0,_=new RegExp(e.source,p+"g");for(s||(n=new RegExp("^"+_.source+"$(?!\\s)",p));(c=_.exec(r))&&!((u=c.index+c[0].length)>f&&(d.push(r.slice(f,c.index)),!s&&c.length>1&&c[0].replace(n,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(c[h]=void 0)}),c.length>1&&c.index<r.length&&a.apply(d,c.slice(1)),l=c[0].length,f=u,d.length>=v));)_.lastIndex===c.index&&_.lastIndex++;return f===r.length?!l&&_.test("")||d.push(""):d.push(r.slice(f)),d.length>v?d.slice(0,v):d}}else"0".split(void 0,0).length&&(n=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(r,i){var o=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(e,t,r){r(91)("search",1,function(e,t,r){return[function(r){"use strict";var n=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]})},function(e,t,r){r(91)("replace",2,function(e,t,r){return[function(n,i){"use strict";var o=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(e,t,r){r(91)("match",1,function(e,t,r){return[function(r){"use strict";var n=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]})},function(e,t,r){"use strict";r(191);var n=r(2),i=r(92),o=r(10),a=/./.toString,s=function(e){r(19)(RegExp.prototype,"toString",e,!0)};r(4)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(e,t,r){var n=r(3),i=r(144),o=r(9).f,a=r(53).f,s=r(94),c=r(92),u=n.RegExp,l=u,h=u.prototype,d=/a/g,p=/a/g,f=new u(d)!==d;if(r(10)&&(!f||r(4)(function(){return p[r(7)("match")]=!1,u(d)!=d||u(p)==p||"/a/i"!=u(d,"i")}))){u=function(e,t){var r=this instanceof u,n=s(e),o=void 0===t;return!r&&n&&e.constructor===u&&o?e:i(f?new l(n&&!o?e.source:e,t):l((n=e instanceof u)?e.source:e,n&&o?c.call(e):t),r?this:h,u)};for(var v=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},_=a(l),y=0;_.length>y;)v(_[y++]);h.constructor=u,u.prototype=h,r(19)(n,"RegExp",u)}r(52)("RegExp")},function(e,t,r){r(52)("Array")},function(e,t,r){"use strict";var n=r(0),i=r(32)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(45)(o)},function(e,t,r){"use strict";var n=r(0),i=r(32)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(45)("find")},function(e,t,r){var n=r(0);n(n.P,"Array",{fill:r(131)}),r(45)("fill")},function(e,t,r){var n=r(0);n(n.P,"Array",{copyWithin:r(193)}),r(45)("copyWithin")},function(e,t,r){"use strict";var n=r(0),i=r(23),o=r(34),a=r(8),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(c||!r(26)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),r=a(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},function(e,t,r){"use strict";var n=r(0),i=r(97)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(a||!r(26)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(194);n(n.P+n.F*!r(26)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,r){"use strict";var n=r(0),i=r(194);n(n.P+n.F*!r(26)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,r){"use strict";var n=r(0),i=r(32)(4);n(n.P+n.F*!r(26)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(32)(3);n(n.P+n.F*!r(26)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(32)(2);n(n.P+n.F*!r(26)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(32)(1);n(n.P+n.F*!r(26)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,r){var n=r(5),i=r(95),o=r(7)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){"use strict";var n=r(0),i=r(32)(0),o=r(26)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(15),o=r(12),a=r(4),s=[].sort,c=[1,2,3];n(n.P+n.F*(a(function(){c.sort(void 0)})||!a(function(){c.sort(null)})||!r(26)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,r){"use strict";var n=r(0),i=r(147),o=r(27),a=r(55),s=r(8),c=[].slice;n(n.P+n.F*r(4)(function(){i&&c.call(i)}),"Array",{slice:function(e,t){var r=s(this.length),n=o(this);if(t=void 0===t?r:t,"Array"==n)return c.call(this,e,t);for(var i=a(e,r),u=a(t,r),l=s(u-i),h=new Array(l),d=0;d<l;d++)h[d]="String"==n?this.charAt(i+d):this[i+d];return h}})},function(e,t,r){"use strict";var n=r(0),i=r(23),o=[].join;n(n.P+n.F*(r(76)!=Object||!r(26)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,r){"use strict";var n=r(0),i=r(134);n(n.S+n.F*r(4)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)i(r,e,arguments[e++]);return r.length=t,r}})},function(e,t,r){"use strict";var n=r(28),i=r(0),o=r(12),a=r(195),s=r(135),c=r(8),u=r(134),l=r(133);i(i.S+i.F*!r(93)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,i,h,d=o(e),p="function"==typeof this?this:Array,f=arguments.length,v=f>1?arguments[1]:void 0,_=void 0!==v,y=0,m=l(d);if(_&&(v=n(v,f>2?arguments[2]:void 0,2)),void 0==m||p==Array&&s(m))for(r=new p(t=c(d.length));t>y;y++)u(r,y,_?v(d[y],y):d[y]);else for(h=m.call(d),r=new p;!(i=h.next()).done;y++)u(r,y,_?a(h,v,[i.value,y],!0):i.value);return r.length=y,r}})},function(e,t,r){var n=r(0);n(n.S,"Array",{isArray:r(95)})},function(e,t,r){"use strict";var n=r(2),i=r(36);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),"number"!=e)}},function(e,t,r){var n=r(7)("toPrimitive"),i=Date.prototype;n in i||r(20)(i,n,r(452))},function(e,t,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r(19)(n,"toString",function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"})},function(e,t,r){"use strict";var n=r(4),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!n(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(r>99?r:"0"+a(r))+"Z"}:o},function(e,t,r){var n=r(0),i=r(455);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(36);n(n.P+n.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),r=o(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},function(e,t,r){var n=r(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,r){"use strict";r(18)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,r){"use strict";r(18)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,r){"use strict";r(18)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,r){"use strict";r(18)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,r){"use strict";r(18)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,r){"use strict";r(18)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,r){"use strict";r(18)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,r){"use strict";r(18)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,r){"use strict";r(18)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,r){"use strict";r(18)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,r){"use strict";r(18)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,r){"use strict";r(18)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,r){"use strict";r(18)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,r){"use strict";var n=r(0),i=r(8),o=r(137),a="".startsWith;n(n.P+n.F*r(136)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},function(e,t,r){var n=r(0);n(n.P,"String",{repeat:r(143)})},function(e,t,r){"use strict";var n=r(0),i=r(137);n(n.P+n.F*r(136)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";var n=r(0),i=r(8),o=r(137),a="".endsWith;n(n.P+n.F*r(136)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=i(t.length),s=void 0===r?n:Math.min(i(r),n),c=String(e);return a?a.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,r){"use strict";var n=r(0),i=r(140)(!1);n(n.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,r){"use strict";var n=r(140)(!0);r(139)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){"use strict";r(67)("trim",function(e){return function(){return e(this,3)}})},function(e,t,r){var n=r(0),i=r(23),o=r(8);n(n.S,"String",{raw:function(e){for(var t=i(e.raw),r=o(t.length),n=arguments.length,a=[],s=0;r>s;)a.push(String(t[s++])),s<n&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,r){var n=r(0),i=r(55),o=String.fromCharCode,a=String.fromCodePoint;n(n.S+n.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,a=0;n>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},function(e,t,r){var n=r(0);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,r){var n=r(0),i=r(141),o=Math.exp;n(n.S,"Math",{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},function(e,t,r){var n=r(0),i=r(141),o=Math.exp;n(n.S+n.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{sign:r(142)})},function(e,t,r){var n=r(0);n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,r){var n=r(0);n(n.S,"Math",{log1p:r(197)})},function(e,t,r){var n=r(0);n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,r){var n=r(0),i=Math.imul;n(n.S+n.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}})},function(e,t,r){var n=r(0),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var r,n,o=0,a=0,s=arguments.length,c=0;a<s;)c<(r=i(arguments[a++]))?(o=o*(n=c/r)*n+1,c=r):o+=r>0?(n=r/c)*n:r;return c===1/0?1/0:c*Math.sqrt(o)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{fround:r(196)})},function(e,t,r){var n=r(0),i=r(141);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,r){var n=r(0),i=Math.exp;n(n.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,r){var n=r(0);n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,r){var n=r(0),i=r(142);n(n.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,r){var n=r(0),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,r){var n=r(0),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,r){var n=r(0),i=r(197),o=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,r){var n=r(0),i=r(201);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,r){var n=r(0),i=r(200);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,r){var n=r(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,r){var n=r(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){var n=r(0),i=r(198),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,r){var n=r(0);n(n.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,r){var n=r(0);n(n.S,"Number",{isInteger:r(198)})},function(e,t,r){var n=r(0),i=r(3).isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,r){var n=r(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,r){"use strict";var n=r(0),i=r(4),o=r(199),a=1..toPrecision;n(n.P+n.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,r){"use strict";var n=r(0),i=r(34),o=r(199),a=r(143),s=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*u[r],u[r]=n%1e7,n=c(n/1e7)},d=function(e){for(var t=6,r=0;--t>=0;)r+=u[t],u[t]=c(r/e),r=r%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var r=String(u[e]);t=""===t?r:t+a.call("0",7-r.length)+r}return t},f=function(e,t,r){return 0===t?r:t%2==1?f(e,t-1,r*e):f(e*e,t/2,r)};n(n.P+n.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){s.call({})})),"Number",{toFixed:function(e){var t,r,n,s,c=o(this,l),u=i(e),v="",_="0";if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(v="-",c=-c),c>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(c*f(2,69,1))-69)<0?c*f(2,-t,1):c/f(2,t,1),r*=4503599627370496,(t=52-t)>0){for(h(0,r),n=u;n>=7;)h(1e7,0),n-=7;for(h(f(10,n,1),0),n=t-1;n>=23;)d(1<<23),n-=23;d(1<<n),h(1,1),d(2),_=p()}else h(0,r),h(1<<-t,0),_=p()+a.call("0",u);return _=u>0?v+((s=_.length)<=u?"0."+a.call("0",u-s)+_:_.slice(0,s-u)+"."+_.slice(s-u)):v+_}})},function(e,t,r){"use strict";var n=r(3),i=r(24),o=r(27),a=r(144),s=r(36),c=r(4),u=r(53).f,l=r(22).f,h=r(9).f,d=r(67).trim,p=n.Number,f=p,v=p.prototype,_="Number"==o(r(54)(v)),y="trim"in String.prototype,m=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=y?t.trim():d(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,c=t.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||a>i)return NaN;return parseInt(c,n)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof p&&(_?c(function(){v.valueOf.call(r)}):"Number"!=o(r))?a(new f(m(t)),r,p):m(t)};for(var g,F=r(10)?u(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;F.length>w;w++)i(f,g=F[w])&&!i(p,g)&&h(p,g,l(f,g));p.prototype=v,v.constructor=p,r(19)(n,"Number",p)}},function(e,t,r){var n=r(0),i=r(200);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},function(e,t,r){var n=r(0),i=r(201);n(n.G+n.F*(parseInt!=i),{parseInt:i})},function(e,t,r){"use strict";var n=r(5),i=r(21),o=r(7)("hasInstance"),a=Function.prototype;o in a||r(9).f(a,o,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,r){var n=r(9).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||r(10)&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,r){var n=r(0);n(n.P,"Function",{bind:r(203)})},function(e,t,r){"use strict";var n=r(74),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(19)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(e,t,r){var n=r(0);n(n.S,"Object",{setPrototypeOf:r(146).set})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,r){var n=r(0);n(n.S,"Object",{is:r(517)})},function(e,t,r){var n=r(0);n(n.S+n.F,"Object",{assign:r(204)})},function(e,t,r){var n=r(5);r(33)("isExtensible",function(e){return function(t){return!!n(t)&&(!e||e(t))}})},function(e,t,r){var n=r(5);r(33)("isSealed",function(e){return function(t){return!n(t)||!!e&&e(t)}})},function(e,t,r){var n=r(5);r(33)("isFrozen",function(e){return function(t){return!n(t)||!!e&&e(t)}})},function(e,t,r){var n=r(5),i=r(46).onFreeze;r(33)("preventExtensions",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},function(e,t,r){var n=r(5),i=r(46).onFreeze;r(33)("seal",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},function(e,t,r){var n=r(5),i=r(46).onFreeze;r(33)("freeze",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},function(e,t,r){r(33)("getOwnPropertyNames",function(){return r(205).f})},function(e,t,r){var n=r(12),i=r(56);r(33)("keys",function(){return function(e){return i(n(e))}})},function(e,t,r){var n=r(12),i=r(21);r(33)("getPrototypeOf",function(){return function(e){return i(n(e))}})},function(e,t,r){var n=r(23),i=r(22).f;r(33)("getOwnPropertyDescriptor",function(){return function(e,t){return i(n(e),t)}})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperties:r(206)})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperty:r(9).f})},function(e,t,r){var n=r(0);n(n.S,"Object",{create:r(54)})},function(e,t,r){var n=r(56),i=r(96),o=r(75);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,r){"use strict";var n=r(3),i=r(24),o=r(10),a=r(0),s=r(19),c=r(46).KEY,u=r(4),l=r(98),h=r(68),d=r(58),p=r(7),f=r(208),v=r(150),_=r(533),y=r(95),m=r(2),g=r(5),F=r(23),w=r(36),C=r(59),b=r(54),P=r(205),M=r(22),x=r(9),S=r(56),T=M.f,E=x.f,D=P.f,A=n.Symbol,O=n.JSON,k=O&&O.stringify,L=p("_hidden"),I=p("toPrimitive"),R={}.propertyIsEnumerable,N=l("symbol-registry"),B=l("symbols"),G=l("op-symbols"),j=Object.prototype,H="function"==typeof A,V=n.QObject,X=!V||!V.prototype||!V.prototype.findChild,Y=o&&u(function(){return 7!=b(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=T(j,t);n&&delete j[t],E(e,t,r),n&&e!==j&&E(j,t,n)}:E,z=function(e){var t=B[e]=b(A.prototype);return t._k=e,t},Z=H&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},U=function(e,t,r){return e===j&&U(G,t,r),m(e),t=w(t,!0),m(r),i(B,t)?(r.enumerable?(i(e,L)&&e[L][t]&&(e[L][t]=!1),r=b(r,{enumerable:C(0,!1)})):(i(e,L)||E(e,L,C(1,{})),e[L][t]=!0),Y(e,t,r)):E(e,t,r)},W=function(e,t){m(e);for(var r,n=_(t=F(t)),i=0,o=n.length;o>i;)U(e,r=n[i++],t[r]);return e},q=function(e){var t=R.call(this,e=w(e,!0));return!(this===j&&i(B,e)&&!i(G,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,L)&&this[L][e])||t)},Q=function(e,t){if(e=F(e),t=w(t,!0),e!==j||!i(B,t)||i(G,t)){var r=T(e,t);return!r||!i(B,t)||i(e,L)&&e[L][t]||(r.enumerable=!0),r}},K=function(e){for(var t,r=D(F(e)),n=[],o=0;r.length>o;)i(B,t=r[o++])||t==L||t==c||n.push(t);return n},J=function(e){for(var t,r=e===j,n=D(r?G:F(e)),o=[],a=0;n.length>a;)!i(B,t=n[a++])||r&&!i(j,t)||o.push(B[t]);return o};H||(s((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===j&&t.call(G,r),i(this,L)&&i(this[L],e)&&(this[L][e]=!1),Y(this,e,C(1,r))};return o&&X&&Y(j,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",function(){return this._k}),M.f=Q,x.f=U,r(53).f=P.f=K,r(75).f=q,r(96).f=J,o&&!r(57)&&s(j,"propertyIsEnumerable",q,!0),f.f=function(e){return z(p(e))}),a(a.G+a.W+a.F*!H,{Symbol:A});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;$.length>ee;)p($[ee++]);for(var te=S(p.store),re=0;te.length>re;)v(te[re++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return i(N,e+="")?N[e]:N[e]=A(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in N)if(N[t]===e)return t},useSetter:function(){X=!0},useSimple:function(){X=!1}}),a(a.S+a.F*!H,"Object",{create:function(e,t){return void 0===t?b(e):W(b(e),t)},defineProperty:U,defineProperties:W,getOwnPropertyDescriptor:Q,getOwnPropertyNames:K,getOwnPropertySymbols:J}),O&&a(a.S+a.F*(!H||u(function(){var e=A();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(g(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Z(t))return t}),n[1]=t,k.apply(O,n)}}),A.prototype[I]||r(20)(A.prototype,I,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},function(e,t,r){r(534),r(532),r(531),r(530),r(529),r(528),r(527),r(526),r(525),r(524),r(523),r(522),r(521),r(520),r(519),r(518),r(516),r(515),r(514),r(513),r(512),r(511),r(510),r(509),r(508),r(507),r(506),r(505),r(504),r(503),r(502),r(501),r(500),r(499),r(498),r(497),r(496),r(495),r(494),r(493),r(492),r(491),r(490),r(489),r(488),r(487),r(486),r(485),r(484),r(483),r(482),r(481),r(480),r(479),r(478),r(477),r(476),r(475),r(474),r(473),r(472),r(471),r(470),r(469),r(468),r(467),r(466),r(465),r(464),r(463),r(462),r(461),r(460),r(459),r(458),r(457),r(456),r(454),r(453),r(451),r(450),r(449),r(448),r(447),r(446),r(445),r(443),r(442),r(441),r(440),r(439),r(438),r(437),r(436),r(435),r(434),r(433),r(432),r(431),r(130),r(430),r(429),r(191),r(428),r(427),r(426),r(425),r(424),r(188),r(186),r(185),r(423),r(422),r(421),r(420),r(419),r(418),r(417),r(416),r(415),r(414),r(413),r(412),r(411),r(410),r(409),r(408),r(407),r(406),r(405),r(404),r(403),r(402),r(401),r(400),r(399),r(398),r(397),r(396),r(395),r(394),r(393),r(392),r(391),r(390),r(389),r(388),r(387),r(386),r(385),r(384),r(383),r(382),r(381),r(380),r(379),r(378),r(377),r(376),r(375),r(374),r(373),r(372),r(371),r(370),r(369),r(368),r(367),r(366),r(365),r(364),r(363),r(362),r(361),r(360),r(359),r(358),r(357),r(356),r(355),r(354),r(353),r(352),r(351),r(350),r(349),r(348),r(347),r(346),r(345),r(344),r(343),r(342),r(341),r(340),r(339),e.exports=r(37)},function(e,t,r){"use strict";(function(e){if(r(535),r(338),r(337),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var t="defineProperty";function n(e,r,n){e[r]||Object[t](e,r,{writable:!0,configurable:!0,value:n})}n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&n(Array,e,Function.call.bind([][e]))})}).call(this,r(152))},function(e,t,r){"use strict";r(536);var n=r(334),i=r(11),o=r(328),a=r(313),s=r(262),c=r(232),u=r(229),l="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};void 0===l.Freedo&&(l.Freedo={},console.warn("You should include freedo.js first! 你需要首先引用freedo.js，再使用freedox.js库！")),window.FreedoX=l.Freedo,FreedoX.FdApp=n.FdApp,FreedoX.FdWidgets=c.FdWidgets,FreedoX.FdMisc=i.FdMisc,FreedoX.FdCamera=o.FdCamera,FreedoX.FdMicroApp=a.FdMicroApp,FreedoX.FdTools=s.FdTools,FreedoX.FdServer=u.FdServer}]);
//# sourceMappingURL=FreedoX.js.map